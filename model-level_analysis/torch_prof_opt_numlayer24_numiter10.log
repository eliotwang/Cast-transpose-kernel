starting training

    torchrun --nproc_per_node 8 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 6000 pretrain_bert.py         --num-layers 24 --hidden-size 1024 --num-attention-heads 16 --seq-length 16384 --max-position-embeddings 131072         --micro-batch-size 1 --global-batch-size 8 --train-iters 10 --weight-decay 1e-2 --clip-grad 1.0 --fp16 --lr 0.0001 --lr-decay-iters 990000 --lr-decay-style linear --min-lr 1.0e-5 --weight-decay 1e-2 --lr-warmup-fraction .01 --clip-grad 1.0 --fp8-format hybrid --fp8-amax-compute-algo max --fp8-amax-history-len 1024         --tensor-model-parallel-size 8 --pipeline-model-parallel-size 1 --context-parallel-size 1         --data-path /workspace/datasets//bookcorpus_bert_text_sentence --vocab-file /workspace/datasets//vocab.txt --split 949,50,1         --no-gradient-accumulation-fusion --seed 1234         --log-interval 1 --log-throughput --save-interval 10000 --eval-interval 1000 --load /workspace/heyi_te/Megatron-LM/experiments/ckpts-bert --eval-iters 10 --tensorboard-dir ./tb_tmp |& tee /workspace/heyi_te/Megatron-LM/experiments/train_bert.log
W0124 07:28:41.895000 140198693766976 torch/distributed/run.py:779] 
W0124 07:28:41.895000 140198693766976 torch/distributed/run.py:779] *****************************************
W0124 07:28:41.895000 140198693766976 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0124 07:28:41.895000 140198693766976 torch/distributed/run.py:779] *****************************************
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
using world size: 8, data-parallel size: 1, context-parallel size: 1, tensor-model-parallel size: 8, encoder-tensor-model-parallel size: 0, pipeline-model-parallel size: 1, encoder-pipeline-model-parallel size: 0
WARNING: Setting args.check_for_nan_in_loss_and_grad to False since dynamic loss scaling is being used
using torch.float16 for parameters ...
------------------------ arguments ------------------------
  accumulate_allreduce_grads_in_fp32 .............. False
  adam_beta1 ...................................... 0.9
  adam_beta2 ...................................... 0.999
  adam_eps ........................................ 1e-08
  add_bias_linear ................................. True
  add_position_embedding .......................... True
  add_qkv_bias .................................... False
  adlr_autoresume ................................. False
  adlr_autoresume_interval ........................ 1000
  align_grad_reduce ............................... True
  align_param_gather .............................. False
  app_tag_run_name ................................ None
  app_tag_run_version ............................. 0.0.0
  apply_layernorm_1p .............................. False
  apply_query_key_layer_scaling ................... False
  apply_residual_connection_post_layernorm ........ False
  apply_rope_fusion ............................... True
  async_save ...................................... None
  async_tensor_model_parallel_allreduce ........... True
  attention_dropout ............................... 0.1
  attention_softmax_in_fp32 ....................... False
  auto_detect_ckpt_format ......................... False
  barrier_with_L1_time ............................ True
  bert_binary_head ................................ True
  bert_embedder_type .............................. megatron
  bert_load ....................................... None
  bf16 ............................................ False
  bias_dropout_fusion ............................. True
  bias_gelu_fusion ................................ True
  bias_swiglu_fusion .............................. True
  biencoder_projection_dim ........................ 0
  biencoder_shared_query_context_model ............ False
  block_data_path ................................. None
  calculate_per_token_loss ........................ False
  check_for_nan_in_loss_and_grad .................. False
  check_weight_hash_across_dp_replicas_interval ... None
  ckpt_assume_constant_structure .................. False
  ckpt_convert_format ............................. None
  ckpt_convert_save ............................... None
  ckpt_convert_update_legacy_dist_opt_format ...... False
  ckpt_format ..................................... torch_dist
  ckpt_fully_parallel_load ........................ False
  ckpt_fully_parallel_save ........................ True
  ckpt_fully_parallel_save_deprecated ............. False
  ckpt_step ....................................... None
  classes_fraction ................................ 1.0
  clip_grad ....................................... 1.0
  clone_scatter_output_in_embedding ............... True
  config_logger_dir ............................... 
  consumed_train_samples .......................... 0
  consumed_valid_samples .......................... 0
  context_parallel_size ........................... 1
  create_attention_mask_in_dataloader ............. True
  cross_entropy_loss_fusion ....................... False
  data_cache_path ................................. None
  data_parallel_random_init ....................... False
  data_parallel_size .............................. 1
  data_path ....................................... ['/workspace/datasets//bookcorpus_bert_text_sentence']
  data_per_class_fraction ......................... 1.0
  data_sharding ................................... True
  dataloader_type ................................. single
  ddp_average_in_collective ....................... False
  ddp_bucket_size ................................. None
  decoder_first_pipeline_num_layers ............... None
  decoder_last_pipeline_num_layers ................ None
  decoder_num_layers .............................. None
  decoder_seq_length .............................. None
  decoupled_lr .................................... None
  decoupled_min_lr ................................ None
  decrease_batch_size_if_needed ................... False
  defer_embedding_wgrad_compute ................... False
  deprecated_use_mcore_models ..................... False
  deterministic_mode .............................. False
  dino_bottleneck_size ............................ 256
  dino_freeze_last_layer .......................... 1
  dino_head_hidden_size ........................... 2048
  dino_local_crops_number ......................... 10
  dino_local_img_size ............................. 96
  dino_norm_last_layer ............................ False
  dino_teacher_temp ............................... 0.07
  dino_warmup_teacher_temp ........................ 0.04
  dino_warmup_teacher_temp_epochs ................. 30
  disable_straggler_on_startup .................... False
  disable_te_fused_rope ........................... False
  dist_ckpt_format_deprecated ..................... None
  dist_ckpt_strictness ............................ assume_ok_unexpected
  distribute_saved_activations .................... False
  distributed_backend ............................. nccl
  distributed_timeout_minutes ..................... 10
  embedding_path .................................. None
  empty_unused_memory_level ....................... 0
  enable_ft_package ............................... False
  enable_one_logger ............................... True
  encoder_num_layers .............................. 24
  encoder_pipeline_model_parallel_size ............ 0
  encoder_seq_length .............................. 16384
  encoder_tensor_model_parallel_size .............. 0
  end_weight_decay ................................ 0.01
  eod_mask_loss ................................... False
  eval_interval ................................... 1000
  eval_iters ...................................... 10
  evidence_data_path .............................. None
  exit_duration_in_mins ........................... None
  exit_interval ................................... None
  exit_on_missing_checkpoint ...................... False
  exit_signal_handler ............................. False
  expert_model_parallel_size ...................... 1
  ffn_hidden_size ................................. 4096
  finetune ........................................ False
  fp16 ............................................ True
  fp16_lm_cross_entropy ........................... False
  fp32_residual_connection ........................ False
  fp8 ............................................. hybrid
  fp8_amax_compute_algo ........................... max
  fp8_amax_history_len ............................ 1024
  fp8_interval .................................... 1
  fp8_margin ...................................... 0
  fp8_param_gather ................................ False
  fp8_wgrad ....................................... True
  global_batch_size ............................... 8
  gradient_accumulation_fusion .................... False
  group_query_attention ........................... False
  head_lr_mult .................................... 1.0
  hidden_dropout .................................. 0.1
  hidden_size ..................................... 1024
  hybrid_attention_ratio .......................... 0.0
  hybrid_mlp_ratio ................................ 0.0
  hybrid_override_pattern ......................... None
  hysteresis ...................................... 2
  ict_head_size ................................... None
  ict_load ........................................ None
  img_h ........................................... 224
  img_w ........................................... 224
  indexer_batch_size .............................. 128
  indexer_log_interval ............................ 1000
  inference_batch_times_seqlen_threshold .......... 512
  init_method_std ................................. 0.02
  init_method_xavier_uniform ...................... False
  initial_loss_scale .............................. 4294967296
  iter_per_epoch .................................. 1250
  kv_channels ..................................... 64
  kv_lora_rank .................................... 32
  lazy_mpu_init ................................... None
  load ............................................ /workspace/heyi_te/Megatron-LM/experiments/ckpts-bert
  local_rank ...................................... 0
  log_interval .................................... 1
  log_loss_scale_to_tensorboard ................... True
  log_memory_to_tensorboard ....................... False
  log_num_zeros_in_grad ........................... False
  log_params_norm ................................. False
  log_progress .................................... False
  log_straggler ................................... False
  log_throughput .................................. True
  log_timers_to_tensorboard ....................... False
  log_validation_ppl_to_tensorboard ............... False
  log_world_size_to_tensorboard ................... False
  logging_level ................................... None
  loss_scale ...................................... None
  loss_scale_window ............................... 1000
  lr .............................................. 0.0001
  lr_decay_iters .................................. 990000
  lr_decay_samples ................................ None
  lr_decay_style .................................. linear
  lr_warmup_fraction .............................. 0.01
  lr_warmup_init .................................. 0.0
  lr_warmup_iters ................................. 0
  lr_warmup_samples ............................... 0
  lr_wsd_decay_iters .............................. None
  lr_wsd_decay_samples ............................ None
  lr_wsd_decay_style .............................. exponential
  make_vocab_size_divisible_by .................... 128
  manual_gc ....................................... False
  manual_gc_eval .................................. True
  manual_gc_interval .............................. 0
  mask_factor ..................................... 1.0
  mask_prob ....................................... 0.15
  mask_type ....................................... random
  masked_softmax_fusion ........................... True
  max_position_embeddings ......................... 131072
  max_tokens_to_oom ............................... 12000
  merge_file ...................................... None
  micro_batch_size ................................ 1
  min_loss_scale .................................. 1.0
  min_lr .......................................... 1e-05
  mmap_bin_files .................................. True
  mock_data ....................................... False
  moe_aux_loss_coeff .............................. 0.0
  moe_expert_capacity_factor ...................... None
  moe_extended_tp ................................. False
  moe_grouped_gemm ................................ False
  moe_input_jitter_eps ............................ None
  moe_layer_recompute ............................. False
  moe_pad_expert_input_to_capacity ................ False
  moe_per_layer_logging ........................... False
  moe_router_load_balancing_type .................. aux_loss
  moe_router_pre_softmax .......................... False
  moe_router_topk ................................. 2
  moe_shared_expert_intermediate_size ............. None
  moe_shared_expert_overlap ....................... False
  moe_token_dispatcher_type ....................... allgather
  moe_token_drop_policy ........................... probs
  moe_use_upcycling ............................... False
  moe_z_loss_coeff ................................ None
  multi_latent_attention .......................... False
  nccl_communicator_config_path ................... None
  no_load_optim ................................... None
  no_load_rng ..................................... None
  no_persist_layer_norm ........................... False
  no_save_optim ................................... None
  no_save_rng ..................................... None
  non_persistent_ckpt_type ........................ None
  non_persistent_global_ckpt_dir .................. None
  non_persistent_local_ckpt_algo .................. fully_parallel
  non_persistent_local_ckpt_dir ................... None
  non_persistent_save_interval .................... None
  norm_epsilon .................................... 1e-05
  normalization ................................... LayerNorm
  num_attention_heads ............................. 16
  num_channels .................................... 3
  num_classes ..................................... 1000
  num_dataset_builder_threads ..................... 1
  num_experts ..................................... None
  num_layers ...................................... 24
  num_layers_per_virtual_pipeline_stage ........... None
  num_query_groups ................................ 1
  num_workers ..................................... 2
  one_logger_async ................................ False
  one_logger_project .............................. megatron-lm
  one_logger_run_name ............................. None
  onnx_safe ....................................... None
  openai_gelu ..................................... False
  optimizer ....................................... adam
  output_bert_embeddings .......................... False
  overlap_grad_reduce ............................. False
  overlap_p2p_comm ................................ False
  overlap_param_gather ............................ False
  overlap_param_gather_with_optimizer_step ........ False
  override_opt_param_scheduler .................... False
  params_dtype .................................... torch.float16
  patch_dim ....................................... 16
  perform_initialization .......................... True
  pipeline_model_parallel_size .................... 1
  pipeline_model_parallel_split_rank .............. None
  position_embedding_type ......................... learned_absolute
  pretrained_checkpoint ........................... None
  profile ......................................... False
  profile_ranks ................................... [0]
  profile_step_end ................................ 12
  profile_step_start .............................. 10
  q_lora_rank ..................................... None
  qk_head_dim ..................................... 128
  qk_layernorm .................................... False
  qk_pos_emb_head_dim ............................. 64
  query_in_block_prob ............................. 0.1
  rampup_batch_size ............................... None
  rank ............................................ 0
  recompute_granularity ........................... None
  recompute_method ................................ None
  recompute_num_layers ............................ None
  renormalize_blend_weights ....................... False
  reset_attention_mask ............................ False
  reset_position_ids .............................. False
  retriever_report_topk_accuracies ................ []
  retriever_score_scaling ......................... False
  retriever_seq_length ............................ 256
  retro_add_retriever ............................. False
  retro_attention_gate ............................ 1
  retro_cyclic_train_iters ........................ None
  retro_encoder_attention_dropout ................. 0.1
  retro_encoder_hidden_dropout .................... 0.1
  retro_encoder_layers ............................ 2
  retro_num_neighbors ............................. 2
  retro_num_retrieved_chunks ...................... 2
  retro_project_dir ............................... None
  retro_verify_neighbor_count ..................... True
  rotary_base ..................................... 10000
  rotary_interleaved .............................. False
  rotary_percent .................................. 1.0
  rotary_scaling_factor ........................... 1.0
  rotary_seq_len_interpolation_factor ............. None
  s3_cache_path ................................... None
  sample_rate ..................................... 1.0
  save ............................................ None
  save_interval ................................... 10000
  scatter_gather_tensors_in_pipeline .............. True
  seed ............................................ 1234
  seq_length ...................................... 16384
  sequence_parallel ............................... False
  sgd_momentum .................................... 0.9
  short_seq_prob .................................. 0.1
  skip_train ...................................... False
  skipped_train_samples ........................... 0
  spec ............................................ None
  split ........................................... 949,50,1
  squared_relu .................................... False
  standalone_embedding_stage ...................... False
  start_weight_decay .............................. 0.01
  straggler_ctrlr_port ............................ 65535
  straggler_minmax_count .......................... 1
  swiglu .......................................... False
  swin_backbone_type .............................. tiny
  tensor_model_parallel_size ...................... 8
  tensorboard_dir ................................. ./tb_tmp
  tensorboard_log_interval ........................ 1
  tensorboard_queue_size .......................... 1000
  test_data_path .................................. None
  test_mode ....................................... False
  tiktoken_num_special_tokens ..................... 1000
  tiktoken_pattern ................................ None
  tiktoken_special_tokens ......................... None
  timing_log_level ................................ 0
  timing_log_option ............................... minmax
  titles_data_path ................................ None
  tokenizer_model ................................. None
  tokenizer_type .................................. BertWordPieceLowerCase
  tp_comm_bootstrap_backend ....................... nccl
  tp_comm_bulk_dgrad .............................. True
  tp_comm_bulk_wgrad .............................. True
  tp_comm_overlap ................................. False
  tp_comm_overlap_ag .............................. True
  tp_comm_overlap_cfg ............................. None
  tp_comm_overlap_rs .............................. True
  tp_comm_overlap_rs_dgrad ........................ False
  tp_comm_split_ag ................................ True
  tp_comm_split_rs ................................ True
  train_data_path ................................. None
  train_iters ..................................... 10
  train_samples ................................... None
  train_sync_interval ............................. None
  transformer_impl ................................ transformer_engine
  transformer_pipeline_model_parallel_size ........ 1
  untie_embeddings_and_output_weights ............. False
  use_checkpoint_args ............................. False
  use_checkpoint_opt_param_scheduler .............. False
  use_cpu_initialization .......................... None
  use_dist_ckpt ................................... True
  use_dist_ckpt_deprecated ........................ False
  use_distributed_optimizer ....................... False
  use_flash_attn .................................. False
  use_legacy_models ............................... False
  use_one_sent_docs ............................... False
  use_pytorch_profiler ............................ False
  use_ring_exchange_p2p ........................... False
  use_rope_scaling ................................ False
  use_rotary_position_embeddings .................. False
  use_tp_pp_dp_mapping ............................ False
  v_head_dim ...................................... 128
  valid_data_path ................................. None
  variable_seq_lengths ............................ False
  virtual_pipeline_model_parallel_size ............ None
  vision_backbone_type ............................ vit
  vision_pretraining .............................. False
  vision_pretraining_type ......................... classify
  vocab_extra_ids ................................. 0
  vocab_file ...................................... /workspace/datasets//vocab.txt
  vocab_size ...................................... None
  wandb_exp_name .................................. 
  wandb_project ................................... 
  wandb_save_dir .................................. 
  weight_decay .................................... 0.01
  weight_decay_incr_style ......................... constant
  wgrad_deferral_limit ............................ 0
  world_size ...................................... 8
  yaml_cfg ........................................ None
-------------------- end of arguments ---------------------
INFO:megatron.core.num_microbatches_calculator:setting number of microbatches to constant 8
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30524) with 196 dummy tokens (new size: 30720)
> initializing torch distributed ...
> initialized tensor model parallel with size 8
> initialized pipeline model parallel with size 1
> setting random seeds to 1234 ...
> compiling dataset index builder ...
make: Entering directory '/workspace/heyi_te/Megatron-LM/megatron/core/datasets'
make: Nothing to be done for 'default'.
make: Leaving directory '/workspace/heyi_te/Megatron-LM/megatron/core/datasets'
>>> done with dataset index builder. Compilation time: 0.052 seconds
WARNING: constraints for invoking optimized fused softmax kernel are not met. We default back to unfused kernel invocations.
> compiling and loading fused kernels ...
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
>>> done with compiling and loading fused kernels. Compilation time: 2.154 seconds
[rank5]:[W124 07:28:55.263653127 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank3]:[W124 07:28:55.263653196 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank6]:[W124 07:28:55.263653451 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank4]:[W124 07:28:55.263654908 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank1]:[W124 07:28:55.263654530 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank2]:[W124 07:28:55.263659527 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank7]:[W124 07:28:55.263672113 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank0]:[W124 07:28:55.263691639 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
time to initialize megatron (seconds): 6.234
[after megatron is initialized] datetime: 2025-01-24 07:28:57 
building BERT model ...
 > number of parameters on (tensor, pipeline) model parallel rank (4, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (5, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (7, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (2, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (1, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (6, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (3, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 178178818
INFO:megatron.core.distributed.distributed_data_parallel:Setting up DistributedDataParallel with config DistributedDataParallelConfig(grad_reduce_in_fp32=False, overlap_grad_reduce=False, overlap_param_gather=False, align_param_gather=False, use_distributed_optimizer=False, check_for_nan_in_grad=False, bucket_size=None, average_in_collective=False, fp8_param_gather=False)
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (178178818 elements):
	module.encoder.layers.15.mlp.linear_fc1.weight
	module.encoder.layers.14.mlp.linear_fc1.bias
	module.encoder.layers.13.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.10.self_attention.linear_proj.bias
	module.encoder.layers.8.self_attention.linear_proj.bias
	module.encoder.layers.6.self_attention.linear_proj.bias
	module.encoder.layers.5.mlp.linear_fc1.bias
	module.encoder.layers.1.self_attention.linear_proj.weight
	module.encoder.layers.23.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.22.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.14.self_attention.linear_proj.weight
	module.encoder.layers.13.self_attention.linear_proj.bias
	module.encoder.layers.11.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.9.self_attention.linear_qkv.bias
	module.encoder.layers.9.self_attention.linear_proj.bias
	module.encoder.layers.6.mlp.linear_fc2.bias
	module.encoder.layers.1.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.15.mlp.linear_fc2.bias
	module.encoder.layers.9.mlp.linear_fc2.bias
	module.encoder.layers.9.mlp.linear_fc1.bias
	module.encoder.layers.8.self_attention.linear_qkv.weight
	module.encoder.layers.7.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.6.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.3.mlp.linear_fc1.weight
	module.encoder.layers.1.mlp.linear_fc2.weight
	module.encoder.layers.21.mlp.linear_fc2.weight
	module.encoder.layers.20.mlp.linear_fc2.weight
	module.encoder.layers.19.mlp.linear_fc2.weight
	module.encoder.layers.4.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.2.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.0.mlp.linear_fc1.bias
	module.encoder.layers.11.mlp.linear_fc2.bias
	module.encoder.layers.7.mlp.linear_fc2.bias
	module.encoder.layers.5.mlp.linear_fc1.layer_norm_bias
	module.lm_head.layer_norm.bias
	module.encoder.layers.16.mlp.linear_fc2.weight
	module.encoder.layers.15.self_attention.linear_qkv.weight
	module.encoder.layers.14.self_attention.linear_qkv.bias
	module.encoder.layers.13.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.11.self_attention.linear_proj.weight
	module.encoder.layers.9.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.7.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.4.self_attention.linear_qkv.weight
	module.encoder.layers.3.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.2.mlp.linear_fc2.weight
	module.encoder.layers.23.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.22.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.14.mlp.linear_fc1.weight
	module.encoder.layers.13.mlp.linear_fc1.bias
	module.encoder.layers.12.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.11.mlp.linear_fc1.weight
	module.encoder.layers.3.self_attention.linear_qkv.bias
	module.encoder.layers.23.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.22.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.13.self_attention.linear_proj.weight
	module.encoder.layers.11.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.7.self_attention.linear_proj.weight
	module.encoder.layers.2.self_attention.linear_qkv.weight
	module.encoder.layers.1.mlp.linear_fc2.bias
	module.encoder.layers.18.mlp.linear_fc1.layer_norm_weight
	module.pooler.dense.weight
	module.encoder.layers.23.self_attention.linear_proj.bias
	module.encoder.layers.22.self_attention.linear_proj.bias
	module.encoder.layers.17.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.14.mlp.linear_fc2.bias
	module.encoder.layers.6.self_attention.linear_qkv.weight
	module.encoder.layers.5.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.3.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.0.self_attention.linear_proj.weight
	module.encoder.layers.10.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.8.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.5.self_attention.linear_qkv.bias
	module.encoder.layers.4.mlp.linear_fc1.bias
	module.encoder.layers.2.self_attention.linear_proj.weight
	module.encoder.layers.2.mlp.linear_fc1.weight
	module.encoder.layers.10.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.15.mlp.linear_fc2.weight
	module.encoder.layers.14.self_attention.linear_qkv.weight
	module.encoder.layers.13.self_attention.linear_qkv.bias
	module.encoder.layers.12.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.8.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.6.mlp.linear_fc1.bias
	module.encoder.layers.5.self_attention.linear_qkv.weight
	module.encoder.layers.4.self_attention.linear_proj.weight
	module.encoder.layers.23.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.22.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.13.mlp.linear_fc1.weight
	module.encoder.layers.12.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.11.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.9.mlp.linear_fc1.weight
	module.encoder.layers.9.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.4.mlp.linear_fc2.bias
	module.encoder.layers.4.self_attention.linear_proj.bias
	module.encoder.layers.3.self_attention.linear_proj.weight
	module.encoder.layers.1.mlp.linear_fc1.weight
	module.encoder.layers.0.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.23.mlp.linear_fc1.bias
	module.encoder.layers.22.mlp.linear_fc1.bias
	module.encoder.layers.21.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.20.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.19.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.18.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.17.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.18.mlp.linear_fc1.layer_norm_bias
	module.pooler.dense.bias
	module.encoder.layers.23.self_attention.linear_proj.weight
	module.encoder.layers.22.self_attention.linear_proj.weight
	module.encoder.layers.17.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.16.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.13.mlp.linear_fc2.bias
	module.encoder.layers.12.self_attention.linear_qkv.weight
	module.encoder.layers.0.mlp.linear_fc2.weight
	module.encoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.18.self_attention.linear_proj.bias
	module.encoder.layers.17.self_attention.linear_proj.bias
	module.encoder.layers.10.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.8.mlp.linear_fc1.weight
	module.encoder.layers.4.mlp.linear_fc1.weight
	module.encoder.layers.3.mlp.linear_fc1.bias
	module.encoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.2.mlp.linear_fc2.bias
	module.encoder.layers.0.self_attention.linear_qkv.weight
	module.encoder.layers.1.self_attention.linear_qkv.layer_norm_bias
	module.embedding.word_embeddings.weight
	module.encoder.layers.14.mlp.linear_fc2.weight
	module.encoder.layers.13.self_attention.linear_qkv.weight
	module.encoder.layers.12.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.9.self_attention.linear_proj.weight
	module.encoder.layers.8.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.1.self_attention.linear_qkv.weight
	module.encoder.layers.0.self_attention.linear_qkv.bias
	module.embedding.tokentype_embeddings.weight
	module.encoder.layers.0.mlp.linear_fc1.weight
	module.encoder.layers.23.self_attention.linear_qkv.bias
	module.encoder.layers.22.self_attention.linear_qkv.bias
	module.encoder.layers.21.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.20.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.19.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.12.mlp.linear_fc1.bias
	module.encoder.layers.6.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.5.mlp.linear_fc1.weight
	module.encoder.layers.4.mlp.linear_fc2.weight
	module.encoder.layers.3.self_attention.linear_proj.bias
	module.encoder.layers.0.self_attention.linear_proj.bias
	module.encoder.layers.5.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.23.mlp.linear_fc1.weight
	module.encoder.layers.22.mlp.linear_fc1.weight
	module.encoder.layers.21.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.20.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.19.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.18.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.17.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.16.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.7.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.6.mlp.linear_fc2.weight
	module.encoder.layers.2.self_attention.linear_qkv.bias
	module.encoder.layers.21.self_attention.linear_proj.bias
	module.encoder.layers.20.self_attention.linear_proj.bias
	module.encoder.layers.19.self_attention.linear_proj.bias
	module.encoder.layers.18.mlp.linear_fc1.bias
	module.encoder.layers.17.mlp.linear_fc1.bias
	module.encoder.layers.16.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.15.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.12.self_attention.linear_proj.weight
	module.encoder.layers.10.self_attention.linear_qkv.bias
	module.encoder.layers.8.mlp.linear_fc2.bias
	module.encoder.layers.23.mlp.linear_fc2.bias
	module.encoder.layers.22.mlp.linear_fc2.bias
	module.encoder.layers.18.self_attention.linear_proj.weight
	module.encoder.layers.17.self_attention.linear_proj.weight
	module.encoder.layers.16.self_attention.linear_proj.bias
	module.encoder.layers.10.mlp.linear_fc1.bias
	module.encoder.layers.7.self_attention.linear_qkv.bias
	module.encoder.layers.6.mlp.linear_fc1.weight
	module.encoder.layers.3.mlp.linear_fc2.weight
	module.encoder.layers.3.mlp.linear_fc1.layer_norm_weight
	module.binary_head.weight
	module.encoder.layers.13.mlp.linear_fc2.weight
	module.encoder.layers.8.mlp.linear_fc2.weight
	module.encoder.layers.5.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.3.self_attention.linear_qkv.weight
	module.encoder.layers.20.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.23.self_attention.linear_qkv.weight
	module.encoder.layers.22.self_attention.linear_qkv.weight
	module.encoder.layers.21.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.19.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.12.mlp.linear_fc1.weight
	module.encoder.layers.10.self_attention.linear_qkv.weight
	module.encoder.layers.10.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.7.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.5.mlp.linear_fc2.bias
	module.encoder.layers.0.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.6.self_attention.linear_proj.weight
	module.lm_head.dense.bias
	module.encoder.layers.21.mlp.linear_fc1.bias
	module.encoder.layers.20.mlp.linear_fc1.bias
	module.encoder.layers.19.mlp.linear_fc1.bias
	module.encoder.layers.18.self_attention.linear_qkv.bias
	module.encoder.layers.17.self_attention.linear_qkv.bias
	module.encoder.layers.16.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.15.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.6.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.5.self_attention.linear_proj.bias
	module.encoder.layers.18.mlp.linear_fc1.weight
	module.output_layer.bias
	module.encoder.layers.21.self_attention.linear_proj.weight
	module.encoder.layers.20.self_attention.linear_proj.weight
	module.encoder.layers.19.self_attention.linear_proj.weight
	module.encoder.layers.17.mlp.linear_fc1.weight
	module.encoder.layers.16.mlp.linear_fc1.bias
	module.encoder.layers.15.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.14.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.12.mlp.linear_fc2.bias
	module.encoder.layers.6.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.1.self_attention.linear_proj.bias
	module.embedding.position_embeddings.weight
	module.encoder.final_layernorm.bias
	module.encoder.layers.16.self_attention.linear_proj.weight
	module.encoder.layers.15.self_attention.linear_proj.bias
	module.encoder.layers.11.self_attention.linear_qkv.weight
	module.encoder.layers.10.mlp.linear_fc1.weight
	module.encoder.layers.7.self_attention.linear_proj.bias
	module.encoder.layers.4.self_attention.linear_qkv.bias
	module.encoder.layers.2.self_attention.linear_proj.bias
	module.binary_head.bias
	module.encoder.layers.18.mlp.linear_fc2.bias
	module.encoder.layers.17.mlp.linear_fc2.bias
	module.encoder.layers.12.self_attention.linear_qkv.bias
	module.encoder.layers.12.self_attention.linear_proj.bias
	module.encoder.layers.8.self_attention.linear_proj.weight
	module.encoder.layers.7.mlp.linear_fc2.weight
	module.encoder.layers.7.mlp.linear_fc1.weight
	module.encoder.layers.7.self_attention.linear_qkv.weight
	module.encoder.layers.5.mlp.linear_fc2.weight
	module.encoder.layers.1.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.23.mlp.linear_fc2.weight
	module.encoder.layers.22.mlp.linear_fc2.weight
	module.encoder.layers.21.self_attention.linear_qkv.bias
	module.encoder.layers.20.self_attention.linear_qkv.bias
	module.encoder.layers.19.self_attention.linear_qkv.bias
	module.encoder.layers.10.mlp.linear_fc2.bias
	module.encoder.layers.10.mlp.linear_fc2.weight
	module.encoder.layers.10.self_attention.linear_proj.weight
	module.encoder.layers.9.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.5.self_attention.linear_proj.weight
	module.encoder.layers.21.mlp.linear_fc1.weight
	module.encoder.layers.20.mlp.linear_fc1.weight
	module.encoder.layers.19.mlp.linear_fc1.weight
	module.encoder.layers.18.self_attention.linear_qkv.weight
	module.encoder.layers.17.self_attention.linear_qkv.weight
	module.encoder.layers.16.self_attention.linear_qkv.bias
	module.encoder.layers.15.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.14.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.11.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.7.mlp.linear_fc1.bias
	module.encoder.layers.16.mlp.linear_fc1.weight
	module.encoder.layers.15.mlp.linear_fc1.bias
	module.encoder.layers.14.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.13.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.11.self_attention.linear_proj.bias
	module.encoder.layers.4.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.4.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.2.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.0.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.3.mlp.linear_fc2.bias
	module.encoder.final_layernorm.weight
	module.encoder.layers.21.mlp.linear_fc2.bias
	module.encoder.layers.20.mlp.linear_fc2.bias
	module.encoder.layers.19.mlp.linear_fc2.bias
	module.encoder.layers.15.self_attention.linear_proj.weight
	module.encoder.layers.14.self_attention.linear_proj.bias
	module.encoder.layers.11.mlp.linear_fc2.weight
	module.encoder.layers.11.mlp.linear_fc1.bias
	module.encoder.layers.8.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.6.self_attention.linear_qkv.bias
	module.encoder.layers.16.mlp.linear_fc2.bias
	module.encoder.layers.12.mlp.linear_fc2.weight
	module.encoder.layers.11.self_attention.linear_qkv.bias
	module.encoder.layers.9.self_attention.linear_qkv.weight
	module.encoder.layers.0.mlp.linear_fc2.bias
	module.lm_head.dense.weight
	module.encoder.layers.21.self_attention.linear_qkv.weight
	module.encoder.layers.20.self_attention.linear_qkv.weight
	module.encoder.layers.19.self_attention.linear_qkv.weight
	module.encoder.layers.8.mlp.linear_fc1.bias
	module.encoder.layers.2.mlp.linear_fc1.bias
	module.encoder.layers.1.mlp.linear_fc1.bias
	module.encoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.18.mlp.linear_fc2.weight
	module.lm_head.layer_norm.weight
	module.encoder.layers.17.mlp.linear_fc2.weight
	module.encoder.layers.16.self_attention.linear_qkv.weight
	module.encoder.layers.15.self_attention.linear_qkv.bias
	module.encoder.layers.14.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.13.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.9.mlp.linear_fc2.weight
	module.encoder.layers.9.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.8.self_attention.linear_qkv.bias
	module.encoder.layers.2.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.1.self_attention.linear_qkv.bias
INFO:megatron.core.optimizer:Setting up optimizer with config OptimizerConfig(optimizer='adam', lr=0.0001, min_lr=1e-05, decoupled_lr=None, decoupled_min_lr=None, weight_decay=0.01, fp16=True, bf16=False, params_dtype=torch.float16, loss_scale=None, initial_loss_scale=4294967296, min_loss_scale=1.0, loss_scale_window=1000, hysteresis=2, adam_beta1=0.9, adam_beta2=0.999, adam_eps=1e-08, sgd_momentum=0.9, use_distributed_optimizer=False, overlap_param_gather_with_optimizer_step=False, clip_grad=1.0, log_num_zeros_in_grad=False, barrier_with_L1_time=True, timers=<megatron.core.timers.Timers object at 0x7f512cbc28c0>, config_logger_dir='')
INFO:megatron.core.optimizer_param_scheduler:> learning rate decay style: linear
WARNING: could not find the metadata file /workspace/heyi_te/Megatron-LM/experiments/ckpts-bert/latest_checkpointed_iteration.txt
    will not load any checkpoints and will start from random
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
(min, max) time across ranks (ms):
    load-checkpoint ................................: (0.58, 6.23)
[after model, optimizer, and learning rate scheduler are built] datetime: 2025-01-24 07:28:59 
> building train, validation, and test datasets ...
 > datasets target sizes (minimum size):
    train:      80
    validation: 80
    test:       80
INFO:megatron.core.datasets.blended_megatron_dataset_config:Let split_matrix = [(0, 0.949), (0.949, 0.999), (0.999, 1.0)]
> building train, validation, and test datasets for BERT ...
INFO:megatron.core.datasets.blended_megatron_dataset_builder:Building dataset splits with cls=BERTMaskedWordPieceDataset, sizes=(80, 80, 80), and config=BERTMaskedWordPieceDatasetConfig(random_seed=1234, sequence_length=16384, blend=(['/workspace/datasets//bookcorpus_bert_text_sentence'], None), blend_per_split=[None, None, None], renormalize_blend_weights=False, split='949,50,1', split_matrix=[(0, 0.949), (0.949, 0.999), (0.999, 1.0)], num_dataset_builder_threads=1, path_to_cache=None, mmap_bin_files=True, mock=False, tokenizer=<megatron.training.tokenizer.tokenizer._BertWordPieceTokenizer object at 0x7f512cbaa5c0>, masking_probability=0.15, short_sequence_probability=0.1, masking_max_ngram=3, masking_do_full_word=True, masking_do_permutation=False, masking_use_longer_ngrams=False, masking_use_geometric_distribution=False, classification_head=True)
INFO:megatron.core.datasets.indexed_dataset:Load the _IndexReader from /workspace/datasets//bookcorpus_bert_text_sentence.idx
INFO:megatron.core.datasets.indexed_dataset:	Extract the sequence lengths
INFO:megatron.core.datasets.indexed_dataset:	Extract the sequence pointers
INFO:megatron.core.datasets.indexed_dataset:	Extract the document indices
INFO:megatron.core.datasets.indexed_dataset:> total number of sequences: 74157091
INFO:megatron.core.datasets.indexed_dataset:> total number of documents: 74004228
INFO:megatron.core.datasets.masked_dataset:Load the BERTMaskedWordPieceDataset train indices
INFO:megatron.core.datasets.masked_dataset:	Load the sample index from ec05163be455a8ac28060961cf9b1fd6-BERTMaskedWordPieceDataset-sample_index.npy
INFO:megatron.core.datasets.masked_dataset:Load the BERTMaskedWordPieceDataset valid indices
INFO:megatron.core.datasets.masked_dataset:	Load the sample index from c215a53154c6e396365106d43b4f252a-BERTMaskedWordPieceDataset-sample_index.npy
INFO:megatron.core.datasets.masked_dataset:Load the BERTMaskedWordPieceDataset test indices
INFO:megatron.core.datasets.masked_dataset:	Load the sample index from 5a48370cfc4bb4cae37f7c9e366f15f2-BERTMaskedWordPieceDataset-sample_index.npy
> finished creating BERT datasets ...
[after dataloaders are built] datetime: 2025-01-24 07:28:59 
done with setup ...
(min, max) time across ranks (ms):
    model-and-optimizer-setup ......................: (1394.48, 1397.15)
    train/valid/test-data-iterators-setup ..........: (69.07, 262.48)
training ...
[before the start of training step] datetime: 2025-01-24 07:28:59 
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
 [2025-01-24 07:29:12] iteration        1/      10 | consumed samples:            8 | elapsed time per iteration (ms): 12571.8 | throughput per GPU (TFLOP/s/GPU): 8.9 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 4294967296.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
 [2025-01-24 07:29:17] iteration        2/      10 | consumed samples:           16 | elapsed time per iteration (ms): 5602.8 | throughput per GPU (TFLOP/s/GPU): 20.0 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 2147483648.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 07:29:23] iteration        3/      10 | consumed samples:           24 | elapsed time per iteration (ms): 5593.1 | throughput per GPU (TFLOP/s/GPU): 20.0 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 1073741824.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 07:29:29] iteration        4/      10 | consumed samples:           32 | elapsed time per iteration (ms): 5675.4 | throughput per GPU (TFLOP/s/GPU): 19.7 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 536870912.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 07:29:34] iteration        5/      10 | consumed samples:           40 | elapsed time per iteration (ms): 5638.4 | throughput per GPU (TFLOP/s/GPU): 19.9 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 268435456.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 07:29:40] iteration        6/      10 | consumed samples:           48 | elapsed time per iteration (ms): 5755.3 | throughput per GPU (TFLOP/s/GPU): 19.5 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 134217728.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 07:29:46] iteration        7/      10 | consumed samples:           56 | elapsed time per iteration (ms): 5784.3 | throughput per GPU (TFLOP/s/GPU): 19.4 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 67108864.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 07:29:51] iteration        8/      10 | consumed samples:           64 | elapsed time per iteration (ms): 5672.1 | throughput per GPU (TFLOP/s/GPU): 19.7 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 33554432.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 07:29:57] iteration        9/      10 | consumed samples:           72 | elapsed time per iteration (ms): 5682.1 | throughput per GPU (TFLOP/s/GPU): 19.7 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 16777216.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 07:30:03] iteration       10/      10 | consumed samples:           80 | elapsed time per iteration (ms): 5703.4 | throughput per GPU (TFLOP/s/GPU): 19.6 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 8388608.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
[after training is done] datetime: 2025-01-24 07:30:03 
Evaluating on 80 samples
Evaluating iter 1/10
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/heyi_te/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
Evaluating iter 2/10
Evaluating iter 3/10
Evaluating iter 4/10
Evaluating iter 5/10
Evaluating iter 6/10
Evaluating iter 7/10
Evaluating iter 8/10
Evaluating iter 9/10
Evaluating iter 10/10
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
(min, max) time across ranks (ms):
    evaluate .......................................: (22700.07, 22700.11)
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 10 on validation set | lm loss value: 1.048558E+01 | lm loss PPL: 3.579554E+04 | sop loss value: 7.758579E-01 | sop loss PPL: 2.172455E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Evaluating on 80 samples
Evaluating iter 1/10
Evaluating iter 2/10
Evaluating iter 3/10
Evaluating iter 4/10
Evaluating iter 5/10
Evaluating iter 6/10
Evaluating iter 7/10
Evaluating iter 8/10
Evaluating iter 9/10
Evaluating iter 10/10
(min, max) time across ranks (ms):
    evaluate .......................................: (22312.28, 22312.44)
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 10 on test set | lm loss value: 1.055231E+01 | lm loss PPL: 3.826566E+04 | sop loss value: 8.092998E-01 | sop loss PPL: 2.246335E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
[rank4]:[W124 07:30:57.211995353 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank2]:[W124 07:30:57.559008592 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank6]:[W124 07:30:57.577161437 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank1]:[W124 07:30:57.594361881 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank5]:[W124 07:30:57.629983528 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank7]:[W124 07:30:57.650596034 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank0]:[W124 07:30:58.169470337 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank3]:[W124 07:30:58.280884104 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       76.395s        49.00%       76.395s       76.395s             1  
                                             bert_train        34.06%       55.810s        70.97%      116.279s      116.279s       0.000us         0.00%       41.467s       41.467s             1  
                                            aten::copy_        15.70%       25.728s        18.69%       30.618s     388.481us       16.260s        10.43%       16.306s     206.886us         78815  
                                     record_param_comms         4.07%        6.670s         5.57%        9.132s     263.065us       10.198s         6.54%       15.269s     439.849us         34714  
                                               aten::to         0.03%      55.066ms        18.67%       30.587s     582.736us       0.000us         0.00%       11.741s     223.678us         52489  
                                         aten::_to_copy         0.10%     164.378ms        18.64%       30.532s     704.399us       0.000us         0.00%       11.741s     270.864us         43345  
                                      aten::masked_fill         0.04%      64.770ms         0.25%     402.276ms      41.904us       0.000us         0.00%       11.541s       1.202ms          9600  
                                     aten::masked_fill_         0.10%     163.497ms         0.25%     402.935ms      24.569us       10.933s         7.01%       10.937s     666.874us         16400  
                                       c10d::allreduce_         0.23%     377.389ms         2.54%        4.163s     247.642us       0.000us         0.00%       10.409s     619.175us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us       10.169s         6.52%       10.169s       1.047ms          9710  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us       10.059s         6.45%       10.059s       1.026ms          9804  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      15.232ms         0.10%     169.992ms      44.269us       0.000us         0.00%        7.592s       1.977ms          3840  
                                    MaskedFillBackward0         0.00%       6.460ms         0.09%     154.760ms      40.302us       0.000us         0.00%        7.592s       1.977ms          3840  
autograd::engine::evaluate_function: _LayerNormLinea...         0.05%      79.534ms         1.88%        3.082s     802.663us       0.000us         0.00%        6.963s       1.813ms          3840  
                                              aten::bmm         0.26%     423.255ms         0.31%     513.521ms      38.208us        6.880s         4.41%        6.881s     511.961us         13440  
                               _LayerNormLinearBackward         0.99%        1.615s         1.80%        2.947s     767.443us     322.669ms         0.21%        6.822s       1.776ms          3840  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       6.925ms         0.04%      65.320ms      34.021us       0.000us         0.00%        6.471s       3.370ms          1920  
                                       SoftmaxBackward0         0.00%       5.959ms         0.04%      58.395ms      30.414us       0.000us         0.00%        6.471s       3.370ms          1920  
                           aten::_softmax_backward_data         0.01%      17.253ms         0.03%      52.436ms      27.311us        3.338s         2.14%        6.471s       3.370ms          1920  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.448s         4.14%        6.448s       1.420ms          4540  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.069s         3.89%        6.069s     732.964us          8280  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.523s         3.54%        5.523s       1.173ms          4710  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      12.181ms         0.05%      81.893ms      20.891us       0.000us         0.00%        4.901s       1.250ms          3920  
                                        ToCopyBackward0         0.00%       5.841ms         0.04%      69.712ms      17.784us       0.000us         0.00%        4.901s       1.250ms          3920  
                                            aten::clone         0.06%     105.493ms         0.41%     666.660ms      19.298us       0.000us         0.00%        4.560s     132.000us         34546  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.483s         2.88%        4.483s     947.807us          4730  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.469s         2.87%        4.469s     551.378us          8106  
                                          aten::softmax         0.01%      11.545ms         0.08%     127.886ms      22.202us       0.000us         0.00%        4.441s     770.943us          5760  
                                         aten::_softmax         0.04%      70.930ms         0.07%     116.338ms      20.198us        4.439s         2.85%        4.441s     770.943us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.439s         2.85%        4.439s       1.694ms          2620  
                                     tex_ts::te_gemm_ts         1.15%        1.883s         1.68%        2.760s      71.880us        4.024s         2.58%        4.029s     104.913us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.668s         2.35%        3.668s     807.859us          4540  
                                                _Linear         0.87%        1.425s         1.52%        2.491s     648.747us      63.174ms         0.04%        3.620s     942.656us          3840  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.467s         2.22%        3.467s     300.962us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.338s         2.14%        3.338s       1.739ms          1920  
                                          c10d::barrier         0.00%     765.873us         2.09%        3.423s      90.081ms       0.000us         0.00%        3.168s      83.367ms            38  
                                              aten::mul         0.08%     132.070ms         0.12%     193.071ms      23.907us        3.162s         2.03%        3.163s     391.650us          8076  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.135s         2.01%        3.135s       1.426ms          2198  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      15.193ms         0.11%     180.107ms      93.806us       0.000us         0.00%        2.985s       1.555ms          1920  
                                       BaddbmmBackward0         0.01%      16.128ms         0.10%     164.914ms      85.892us       0.000us         0.00%        2.985s       1.555ms          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.878s         1.20%        1.878s     404.043us          4649  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      18.174ms         0.11%     185.375ms      96.550us       0.000us         0.00%        1.753s     913.033us          1920  
                                           BmmBackward0         0.01%      11.680ms         0.10%     167.202ms      87.084us       0.000us         0.00%        1.753s     913.033us          1920  
                                       aten::logical_or         0.06%     100.557ms         0.19%     303.122ms      26.313us     801.244ms         0.51%        1.606s     139.373us         11520  
                                   hipDeviceGetPCIBusId         0.01%      11.100ms         0.01%      11.100ms       0.670us        1.577s         1.01%        1.577s      95.119us         16579  
                                       c10d::broadcast_         0.03%      43.490ms         0.51%     833.492ms       1.733ms       0.000us         0.00%        1.572s       3.269ms           481  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      32.708ms         0.90%        1.472s     383.223us       0.000us         0.00%        1.552s     404.208us          3840  
                                        _LinearBackward         0.59%     960.906ms         0.88%        1.439s     374.705us      76.941ms         0.05%        1.552s     404.208us          3840  
                                   hipStreamSynchronize         0.48%     779.789ms         0.48%     779.853ms     241.515us        1.526s         0.98%        1.527s     472.858us          3229  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.460s         0.94%        1.460s     760.283us          1920  
                                          aten::dropout         0.01%      10.245ms         0.07%     109.324ms      18.175us       0.000us         0.00%        1.458s     242.410us          6015  
                                   aten::native_dropout         0.02%      39.666ms         0.06%      94.292ms      46.935us        1.458s         0.94%        1.458s     725.781us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.458s         0.94%        1.458s     729.042us          2000  
                                              aten::sub         0.06%      94.761ms         0.08%     127.735ms      19.442us        1.416s         0.91%        1.417s     215.717us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.414s         0.91%        1.414s     539.739us          2620  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%       9.716ms         0.04%      58.279ms      29.096us       0.000us         0.00%        1.382s     689.762us          2003  
                                 NativeDropoutBackward0         0.00%       5.904ms         0.03%      48.563ms      24.245us       0.000us         0.00%        1.382s     689.762us          2003  
                          aten::native_dropout_backward         0.01%      16.134ms         0.03%      42.659ms      21.298us        1.382s         0.89%        1.382s     689.762us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.382s         0.89%        1.382s     690.796us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.333s         0.85%        1.333s      76.252us         17479  
                                   hipStreamIsCapturing         0.03%      52.763ms         0.03%      52.763ms       1.018us        1.286s         0.82%        1.286s      24.802us         51842  
                                          aten::baddbmm         0.20%     333.525ms         0.41%     673.672ms     116.957us        1.204s         0.77%        1.205s     209.227us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.120s         0.72%        1.120s     583.401us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      20.321ms         0.58%     945.994ms     246.353us       0.000us         0.00%     975.608ms     254.065us          3840  
                               CompiledFunctionBackward         0.27%     439.670ms         0.56%     925.673ms     241.061us       0.000us         0.00%     975.608ms     254.065us          3840  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.155ms         0.00%       2.155ms       0.151us     934.644ms         0.60%     934.644ms      65.635us         14240  
                                 triton_red_fused_sum_1         0.02%      30.765ms         0.03%      52.256ms      13.608us     879.108ms         0.56%     879.108ms     228.934us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     801.244ms         0.51%     801.244ms     305.818us          2620  
                                      aten::logical_not         0.08%     134.133ms         0.24%     400.987ms      17.404us     319.517ms         0.20%     642.013ms      27.865us         23040  
                                        hipEventDestroy         0.04%      59.388ms         0.04%      60.058ms       2.957us     591.542ms         0.38%     594.536ms      29.269us         20313  
                                      hipGetProcAddress         0.04%      66.173ms         0.04%      66.175ms       0.961us     413.869ms         0.27%     413.877ms       6.011us         68854  
                                  Torch-Compiled Region         0.50%     811.589ms         1.52%        2.484s     129.258us       0.000us         0.00%     383.700ms      19.964us         19220  
                                       hipCtxGetCurrent         0.01%       8.861ms         0.01%       8.861ms       0.177us     341.117ms         0.22%     341.117ms       6.796us         50194  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     319.517ms         0.20%     319.517ms      60.977us          5240  
                                             aten::add_         0.09%     139.770ms         0.17%     272.017ms       8.657us     312.961ms         0.20%     312.961ms       9.961us         31420  
                                       hipStreamDestroy         0.03%      44.047ms         0.03%      44.047ms      16.472us     288.136ms         0.18%     288.136ms     107.755us          2674  
                                       _LayerNormLinear         0.40%     658.699ms         1.01%        1.654s     430.790us     164.982ms         0.11%     279.952ms      72.904us          3840  
                                       CompiledFunction         0.61%     992.616ms         0.89%        1.462s     126.730us       0.000us         0.00%     276.118ms      23.927us         11540  
                                              aten::sum         0.20%     335.541ms         0.44%     728.474ms      35.792us     201.466ms         0.13%     264.442ms      12.993us         20353  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     257.489ms         0.17%     257.489ms      67.054us          3840  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     218.951ms         0.14%     218.951ms     218.951ms             1  
                  triton_poi_fused_add_native_dropout_0         0.05%      87.690ms         0.08%     133.068ms      34.563us     210.308ms         0.13%     210.314ms      54.627us          3850  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     191.342ms         0.12%     191.342ms      36.516us          5240  
autograd::engine::evaluate_function: torch::autograd...         0.16%     259.366ms         0.33%     539.958ms      22.349us       0.000us         0.00%     170.809ms       7.070us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     169.262ms         0.11%     169.262ms       7.076us         23920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     151.364ms         0.10%     151.364ms      33.938us          4460  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.01%      22.773ms         0.36%     586.449ms     305.442us       0.000us         0.00%     147.233ms      76.684us          1920  
                                  hipExtMallocWithFlags         0.02%      40.642ms         0.02%      40.642ms       9.518us     147.186ms         0.09%     147.186ms      34.470us          4270  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     146.335ms         0.09%     146.335ms      27.932us          5239  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     137.469ms         0.09%     137.469ms     622.031us           221  
                             _VocabParallelCrossEntropy         0.04%      62.959ms         0.15%     240.996ms       1.004ms       0.000us         0.00%     135.976ms     566.567us           240  
                                         hipMemcpyAsync         0.11%     187.662ms         0.11%     187.690ms      15.307us     135.080ms         0.09%     135.080ms      11.016us         12262  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     133.912ms         0.09%     133.912ms      34.161us          3920  
                                              aten::cat         0.08%     137.625ms         0.11%     183.556ms      22.717us     124.199ms         0.08%     124.221ms      15.374us          8080  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       5.606ms        24.04%       39.380s     164.082ms       0.000us         0.00%     124.141ms     517.255us           240  
                                     EmbeddingBackward0         0.00%       3.356ms        24.03%       39.373s     164.053ms       0.000us         0.00%     123.288ms     513.701us           240  
                               aten::embedding_backward         0.00%       3.314ms        24.03%       39.369s     164.039ms       0.000us         0.00%     123.288ms     513.701us           240  
                         aten::embedding_dense_backward         2.19%        3.594s        24.03%       39.366s     164.026ms     117.987ms         0.08%     123.288ms     513.701us           240  
                                     hipIpcGetMemHandle         0.01%       9.750ms         0.01%       9.750ms       5.512us     116.675ms         0.07%     116.675ms      65.956us          1769  
                             c10d::allreduce_coalesced_         0.00%       1.692ms         0.05%      90.021ms       9.002ms       0.000us         0.00%     116.675ms      11.668ms            10  
                         _ReduceFromModelParallelRegion         0.01%      17.686ms         0.03%      56.247ms     234.361us       0.000us         0.00%     110.611ms     460.880us           240  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     107.178ms         0.07%     107.178ms      49.620us          2160  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      13.925ms         0.12%     202.980ms     105.719us       0.000us         0.00%     106.988ms      55.723us          1920  
                                 _SplitAlongDimBackward         0.09%     142.502ms         0.12%     189.055ms      98.466us       0.000us         0.00%     106.988ms      55.723us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     106.988ms         0.07%     106.988ms      55.723us          1920  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     104.272ms         0.07%     104.272ms      18.103us          5760  
                                               aten::mm         0.03%      50.397ms         0.06%     104.139ms     118.340us     103.619ms         0.07%     103.619ms     117.749us           880  
                                         hipMemsetAsync         0.07%     113.269ms         0.07%     113.277ms       9.409us     103.009ms         0.07%     103.009ms       8.556us         12039  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.459ms         0.07%     113.132ms       1.414ms       0.000us         0.00%     100.373ms       1.255ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      18.204ms         0.07%     111.673ms       1.396ms       0.000us         0.00%     100.373ms       1.255ms            80  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      98.346ms         0.06%      98.346ms       9.288us         10589  
             triton_poi_fused_native_dropout_backward_0         0.03%      57.225ms         0.05%      86.757ms      22.593us      96.500ms         0.06%      96.500ms      25.130us          3840  
                                       aten::contiguous         0.02%      25.348ms         0.28%     465.886ms      20.221us       0.000us         0.00%      95.423ms       4.142us         23040  
                                           aten::matmul         0.00%       2.662ms         0.05%      78.731ms     196.827us       0.000us         0.00%      87.211ms     218.029us           400  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      82.657ms         0.05%      82.657ms      31.549us          2620  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us      76.249ms         0.05%      76.249ms      14.709us          5184  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      71.925ms         0.05%      71.925ms       9.151us          7860  
                                           aten::arange         0.07%     121.956ms         0.22%     365.218ms      14.822us      34.131ms         0.02%      70.460ms       2.860us         24640  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      70.034ms         0.04%      70.034ms      26.731us          2620  
                                    hipMemcpyWithStream        27.10%       44.404s        27.10%       44.409s      55.442ms       0.000us         0.00%      67.560ms      84.345us           801  
                                 hipDeviceCanAccessPeer         0.00%     301.158us         0.00%     301.158us       0.151us      67.082ms         0.04%      67.082ms      33.676us          1992  
                                  hipModuleLaunchKernel         0.14%     234.294ms         0.14%     234.332ms       6.849us      64.092ms         0.04%      66.747ms       1.951us         34212  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      65.792ms         0.04%      65.792ms     274.133us           240  
                                           GeLUFunction         0.09%     148.549ms         0.55%     906.109ms     157.311us       0.000us         0.00%      64.696ms      11.232us          5760  
                        triton_poi_fused_add_mul_tanh_0         0.07%     109.102ms         0.08%     134.404ms      23.294us      63.338ms         0.04%      64.311ms      11.146us          5770  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      63.951ms         0.04%      63.951ms      16.314us          3920  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      62.720ms         0.04%      62.720ms       5.218us         12021  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      62.237ms         0.04%      62.237ms      14.301us          4352  
                               hipStreamCreateWithFlags         0.25%     409.688ms         0.25%     409.688ms     152.074us      59.791ms         0.04%      59.791ms      22.194us          2694  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.18%     292.629ms         0.32%     516.533ms      67.257us      59.349ms         0.04%      59.349ms       7.728us          7680  
                                    hipIpcOpenMemHandle         0.05%      83.408ms         0.05%      83.408ms      46.990us      59.035ms         0.04%      59.035ms      33.259us          1775  
        LinearWithGradAccumulationAndAsyncCommunication         0.00%       6.354ms         0.01%      22.242ms      92.676us       0.000us         0.00%      53.557ms     223.156us           240  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      48.035ms         0.03%      48.035ms      12.509us          3840  
                                 triton_poi_fused_add_0         0.11%     176.562ms         0.12%     193.509ms      25.197us      42.465ms         0.03%      42.465ms       5.529us          7680  
                                   GeLUFunctionBackward         0.03%      48.659ms         0.30%     490.786ms     255.618us       0.000us         0.00%      41.096ms      21.404us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      28.811ms         0.03%      44.980ms      23.427us      41.096ms         0.03%      41.096ms      21.404us          1920  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      37.452ms         0.02%      37.452ms      19.506us          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      32.364ms         0.02%      32.364ms       6.176us          5240  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      31.584ms         0.02%      31.584ms       6.027us          5240  
                                            aten::fill_         0.07%     120.177ms         0.09%     152.261ms       5.265us      29.574ms         0.02%      29.574ms       1.023us         28919  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      28.086ms         0.02%      28.086ms     175.537us           160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      27.927ms         0.02%      27.927ms      10.659us          2620  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      27.031ms         0.02%      27.031ms       7.039us          3840  
                                            aten::zero_         0.04%      65.431ms         0.13%     207.958ms       9.183us       0.000us         0.00%      26.894ms       1.188us         22646  
                                            aten::zeros         0.04%      70.444ms         0.19%     312.491ms      13.947us       0.000us         0.00%      25.480ms       1.137us         22406  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.413ms         0.03%      50.191ms     627.384us       0.000us         0.00%      25.447ms     318.090us            80  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.221ms         0.02%      24.221ms     302.761us            80  
                                              aten::exp         0.00%       2.310ms         0.01%      16.152ms      67.302us      24.087ms         0.02%      24.087ms     100.364us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      24.087ms         0.02%      24.087ms     220.985us           109  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.532ms         0.03%      47.140ms     196.416us       0.000us         0.00%      22.892ms      95.382us           240  
                                             aten::div_         0.00%       4.929ms         0.01%      10.338ms      21.537us      21.923ms         0.01%      21.923ms      45.672us           480  
                                              aten::add         0.04%      65.564ms         0.06%      93.900ms      52.575us      21.898ms         0.01%      21.898ms      12.261us          1786  
                                             aten::sub_         0.00%       4.152ms         0.00%       5.559ms      17.371us      21.436ms         0.01%      21.436ms      66.989us           320  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      21.385ms         0.01%      21.385ms      33.259us           643  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      21.274ms         0.01%      21.274ms     195.171us           109  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.912ms         0.01%      20.912ms     191.850us           109  
                                          aten::randint         0.02%      37.257ms         0.09%     143.150ms      37.143us       0.000us         0.00%      20.312ms       5.270us          3854  
                                          aten::random_         0.04%      60.782ms         0.06%     103.397ms      26.856us      20.253ms         0.01%      20.296ms       5.272us          3850  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      20.253ms         0.01%      20.253ms       5.260us          3850  
                                           aten::linear         0.00%       2.964ms         0.03%      50.928ms      70.734us       0.000us         0.00%      19.895ms      27.632us           720  
                                            aten::addmm         0.02%      36.173ms         0.03%      43.244ms      60.062us      19.895ms         0.01%      19.895ms      27.632us           720  
                                     hipStreamWaitEvent         0.21%     336.510ms         0.21%     336.566ms      16.025us      18.105ms         0.01%      19.563ms       0.931us         21002  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      19.385ms         0.01%      19.385ms      88.924us           218  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      17.212ms         0.01%      17.212ms       5.958us          2889  
                                 tex_ts::cast_to_fp8_ts         0.07%     112.537ms         0.11%     172.772ms      22.496us      16.864ms         0.01%      16.881ms       2.198us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      16.864ms         0.01%      16.864ms      12.054us          1399  
                                           aten::cumsum         0.06%      97.093ms         0.08%     125.920ms      21.861us      16.106ms         0.01%      16.634ms       2.888us          5760  
                                        aten::embedding         0.00%       5.589ms         0.02%      24.898ms      34.580us       0.000us         0.00%      16.485ms      22.896us           720  
                                     aten::index_select         0.01%      10.335ms         0.01%      16.836ms      23.383us      16.485ms         0.01%      16.485ms      22.896us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.485ms         0.01%      16.485ms      49.955us           330  
                                         AddmmBackward0         0.00%       2.824ms         0.02%      36.593ms     152.472us       0.000us         0.00%      16.408ms      68.365us           240  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      16.262ms         0.01%      16.262ms       6.207us          2620  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      16.106ms         0.01%      16.106ms       6.147us          2620  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      16.050ms         0.01%      16.050ms       6.093us          2634  
                     _VocabParallelCrossEntropyBackward         0.01%      18.472ms         0.03%      44.520ms     556.497us       0.000us         0.00%      15.716ms     196.455us            80  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      13.475ms         0.01%      13.475ms       7.018us          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      13.007ms         0.01%      13.007ms     119.331us           109  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.593ms         0.01%      12.593ms      78.704us           160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.204ms         0.01%      12.204ms     111.959us           109  
                                             aten::mul_         0.00%       6.196ms         0.00%       6.956ms       5.435us      12.073ms         0.01%      12.073ms       9.432us          1280  
                                       aten::index_put_         0.00%       4.895ms         0.11%     179.026ms     159.845us       0.000us         0.00%      11.416ms      10.192us          1120  
                                 aten::_index_put_impl_         0.00%       6.903ms         0.11%     174.129ms     155.472us     762.075us         0.00%      11.416ms      10.192us          1120  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      10.255ms         0.01%      10.255ms      94.086us           109  
                                            aten::index         0.01%      11.470ms         0.04%      57.389ms     101.216us       1.916ms         0.00%       9.862ms      17.393us           567  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.558ms         0.01%       9.558ms      39.825us           240  
                                              aten::max         0.00%       5.614ms         0.02%      26.966ms     106.165us       9.199ms         0.01%       9.220ms      36.300us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.184ms         0.01%       9.184ms      84.261us           109  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       9.031ms         0.01%       9.031ms      37.630us           240  
                                        hipLaunchKernel         0.82%        1.346s         0.82%        1.346s       8.640us       3.568ms         0.00%       8.554ms       0.055us        155840  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.418ms         0.01%       8.418ms      19.715us           427  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.209ms         0.01%      11.635ms     145.436us       0.000us         0.00%       8.274ms     103.420us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.012ms         0.01%       9.426ms     117.827us       8.274ms         0.01%       8.274ms     103.420us            80  
                                          aten::nonzero         0.00%       5.329ms         0.02%      32.960ms     134.529us       7.921ms         0.01%       7.946ms      32.432us           245  
autograd::engine::evaluate_function: torch::autograd...         0.00%       1.965ms         0.02%      28.124ms     351.547us       0.000us         0.00%       7.922ms      99.021us            80  
                            torch::autograd::CopySlices         0.00%       4.675ms         0.02%      26.159ms     326.985us       0.000us         0.00%       7.922ms      99.021us            80  
                           FusedLayerNormAffineFunction         0.01%       9.765ms         0.01%      17.079ms      71.163us       7.694ms         0.00%       7.694ms      32.056us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.694ms         0.00%       7.694ms      70.583us           109  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.333ms         0.00%       7.333ms      10.689us           686  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.467ms         0.00%       6.467ms      80.835us            80  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     498.048us         0.00%       2.144ms     214.389us       6.224ms         0.00%       6.224ms     622.356us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.224ms         0.00%       6.224ms      56.578us           110  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       6.192ms         0.00%       6.192ms       6.857us           903  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       5.799ms         0.00%       5.799ms      24.162us           240  
                                  hipMemGetAddressRange         0.00%     180.890us         0.00%     180.890us       0.403us       4.901ms         0.00%       4.901ms      10.914us           449  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       4.879ms         0.00%       4.879ms       5.082us           960  
                                  hipDeviceGetAttribute         0.00%     220.989us         0.00%     220.989us       3.298us       4.407ms         0.00%       4.407ms      65.780us            67  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       4.387ms         0.00%       4.387ms      27.416us           160  
                                        aten::index_put         0.00%       1.420ms         0.01%      11.080ms     133.498us       0.000us         0.00%       4.173ms      50.279us            83  
                                      IndexPutBackward0         0.00%       1.023ms         0.01%      11.685ms     146.067us       0.000us         0.00%       4.173ms      52.165us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.035ms         0.00%       4.035ms      50.442us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       3.724ms         0.00%       3.724ms      46.548us            80  
                            hipGetDevicePropertiesR0600         0.05%      81.683ms         0.05%      81.683ms       0.878us       3.690ms         0.00%       3.690ms       0.040us         93067  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     941.902us         0.01%      20.892ms     261.155us       0.000us         0.00%       3.520ms      44.002us            80  
                                     _LayerNormBackward         0.00%       4.864ms         0.01%      19.950ms     249.381us       3.520ms         0.00%       3.520ms      44.002us            80  
                                    hipFuncSetAttribute         0.00%       9.166us         0.00%       9.166us       0.382us       3.477ms         0.00%       3.477ms     144.890us            24  
                                             aten::ones         0.00%     906.958us         0.00%       5.560ms      11.584us       0.000us         0.00%       3.408ms       7.100us           480  
         _compile.<locals>.compile_inner (dynamo_timed)         0.07%     113.772ms         1.59%        2.599s     259.908ms       0.000us         0.00%       3.401ms     340.115us            10  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     629.490us         0.00%       2.662ms      33.275us       0.000us         0.00%       3.220ms      40.251us            80  
                                          GeluBackward0         0.00%     385.737us         0.00%       2.033ms      25.406us       0.000us         0.00%       3.220ms      40.251us            80  
                                    aten::gelu_backward         0.00%       1.071ms         0.00%       1.647ms      20.585us       3.220ms         0.00%       3.220ms      40.251us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.220ms         0.00%       3.220ms      40.251us            80  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     656.687us         0.00%       4.380ms      54.745us       0.000us         0.00%       2.983ms      37.292us            80  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      26.493ms         1.49%        2.445s     244.524ms       0.000us         0.00%       2.792ms     279.191us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.30%     489.445ms         1.48%        2.419s     241.875ms       0.000us         0.00%       2.792ms     279.191us            10  
                                             aten::gelu         0.00%       3.156ms         0.00%       7.477ms      31.153us       2.709ms         0.00%       2.709ms      11.287us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.709ms         0.00%       2.709ms      24.852us           109  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.548ms         0.00%       2.548ms       4.727us           539  
                                              aten::all         0.04%      67.367ms         0.05%      77.144ms      13.171us       0.000us         0.00%       2.496ms       0.426us          5857  
                                 c10d::_allgather_base_         0.00%     241.417us         0.00%       1.559ms     111.369us       0.000us         0.00%       2.450ms     174.991us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       2.450ms         0.00%       2.450ms     204.157us            12  
                                            aten::empty         0.47%     772.072ms         0.47%     776.923ms       2.959us       0.000us         0.00%       2.425ms       0.009us        262555  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.310ms         0.00%       2.310ms       5.275us           438  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.196ms         0.00%       2.196ms      20.149us           109  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.125ms         0.00%       2.125ms       5.421us           392  
                                              aten::div         0.01%       9.814ms         0.01%      13.070ms      19.684us       1.999ms         0.00%       1.999ms       3.010us           664  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     561.672us         0.00%       7.093ms      44.331us       0.000us         0.00%       1.947ms      12.171us           160  
                                         SliceBackward0         0.00%     433.067us         0.00%       6.531ms      40.820us       0.000us         0.00%       1.947ms      12.171us           160  
                                   aten::slice_backward         0.00%     877.635us         0.00%       6.098ms      38.114us       0.000us         0.00%       1.947ms      12.171us           160  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.916ms         0.00%       1.916ms       9.980us           192  
                                               aten::lt         0.01%      15.216ms         0.01%      17.854ms      24.797us       1.745ms         0.00%       1.841ms       2.557us           720  
                                          hipHostMalloc         0.08%     127.066ms         0.08%     127.066ms       3.850ms       1.831ms         0.00%       1.831ms      55.500us            33  
                                   hipFuncGetAttributes         0.13%     218.648ms         0.13%     218.648ms       1.656ms       1.808ms         0.00%       1.808ms      13.696us           132  
                                            aten::slice         0.05%      82.148ms         0.06%      97.504ms       3.733us       0.000us         0.00%       1.723ms       0.066us         26118  
                               hipExtModuleLaunchKernel         0.17%     285.356ms         0.17%     285.394ms       7.139us       0.000us         0.00%       1.664ms       0.042us         39975  
                                             _LayerNorm         0.00%       5.637ms         0.01%      10.152ms     126.900us       1.618ms         0.00%       1.618ms      20.228us            80  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.594ms         0.00%       1.594ms       6.642us           240  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.556ms         0.00%       1.556ms      14.274us           109  
      autograd::engine::evaluate_function: MulBackward0         0.01%      12.550ms         0.04%      59.996ms     348.812us       0.000us         0.00%       1.534ms       8.921us           172  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.473ms         0.00%       1.473ms       4.631us           318  
                                        SelectBackward0         0.00%     206.300us         0.00%       2.754ms      34.423us       0.000us         0.00%       1.357ms      16.964us            80  
                                  aten::select_backward         0.00%     406.759us         0.00%       2.548ms      31.844us       0.000us         0.00%       1.357ms      16.964us            80  
                                          aten::squeeze         0.04%      63.693ms         0.05%      76.439ms       3.318us       0.000us         0.00%       1.330ms       0.058us         23040  
                               aten::cross_entropy_loss         0.00%       1.190ms         0.01%      15.911ms      66.298us       0.000us         0.00%       1.320ms       5.499us           240  
                                        aten::transpose         0.14%     236.471ms         0.18%     291.857ms       3.063us       0.000us         0.00%       1.274ms       0.013us         95285  
                                   hipDeviceSynchronize         0.00%     583.451us         0.00%     583.451us      17.160us       1.200ms         0.00%       1.200ms      35.281us            34  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.175ms         0.00%       1.175ms       6.218us           189  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.145ms         0.00%       1.145ms       5.227us           219  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.138ms         0.00%       1.138ms       2.357us           483  
                                           aten::__or__         0.00%       1.242ms         0.01%      19.968ms      41.600us       0.000us         0.00%       1.123ms       2.339us           480  
                                       aten::bitwise_or         0.00%       6.903ms         0.01%      18.726ms      39.012us       1.123ms         0.00%       1.123ms       2.339us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.123ms         0.00%       1.123ms       5.127us           219  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.123ms         0.00%       1.123ms       5.127us           219  
                                               aten::ge         0.00%       5.804ms         0.00%       7.009ms      14.602us       1.116ms         0.00%       1.116ms       2.326us           480  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.052ms         0.00%       1.052ms      13.152us            80  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.931ms         0.01%      10.786ms     134.825us       0.000us         0.00%       1.018ms      12.728us            80  
                                       NllLossBackward0         0.00%       1.044ms         0.01%       8.855ms     110.683us       0.000us         0.00%       1.018ms      12.728us            80  
                                aten::nll_loss_backward         0.00%       3.190ms         0.00%       7.810ms      97.629us     515.951us         0.00%       1.018ms      12.728us            80  
                                           MulBackward0         0.01%       8.711ms         0.02%      35.159ms     204.415us       0.000us         0.00%       1.016ms       5.906us           172  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.973ms         0.01%       8.965ms      56.033us       0.000us         0.00%     994.647us       6.217us           160  
                                           DivBackward0         0.00%       1.230ms         0.00%       6.992ms      43.699us       0.000us         0.00%     994.647us       6.217us           160  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us     965.906us         0.00%     965.906us       6.037us           160  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     818.845us         0.00%     818.845us       7.512us           109  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      13.219ms         0.98%        1.608s     160.781ms       0.000us         0.00%     796.153us      79.615us            10  
                        compile_fx_inner (dynamo_timed)         0.04%      61.023ms         1.18%        1.941s     176.422ms       0.000us         0.00%     796.153us      72.378us            11  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     762.075us         0.00%     762.075us       9.526us            80  
                                                hipFree         0.07%     108.615ms         0.07%     108.658ms       6.037ms     618.143us         0.00%     749.887us      41.660us            18  
                              hipDevicePrimaryCtxRetain         0.00%       1.329us         0.00%       1.329us       0.222us     731.924us         0.00%     731.924us     121.987us             6  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     723.390us         0.00%     723.390us       9.042us            80  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     720.060us         0.00%     720.060us       3.000us           240  
                                             aten::tanh         0.01%      12.632ms         0.01%      23.454ms      86.545us     693.876us         0.00%     693.876us       2.560us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     693.876us         0.00%     693.876us       6.366us           109  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     675.794us         0.00%     675.794us       6.200us           109  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     674.833us         0.00%     674.833us       8.435us            80  
                                      aten::log_softmax         0.00%     931.460us         0.00%       5.371ms      22.378us       0.000us         0.00%     668.901us       2.787us           240  
                                     aten::_log_softmax         0.00%       3.229ms         0.00%       4.338ms      18.074us     668.901us         0.00%     668.901us       2.787us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     668.901us         0.00%     668.901us       6.137us           109  
                                             aten::item         0.02%      26.032ms         0.38%     627.485ms      37.353us       0.000us         0.00%     666.653us       0.040us         16799  
                              aten::_local_scalar_dense         0.01%      12.125ms         0.37%     601.453ms      35.803us     666.653us         0.00%     666.653us       0.040us         16799  
                                              hipMemcpy         0.01%      11.363ms         0.01%      11.363ms     236.732us     664.970us         0.00%     664.970us      13.854us            48  
                                      aten::nll_loss_nd         0.00%     690.097us         0.01%       9.351ms      38.961us       0.000us         0.00%     650.781us       2.712us           240  
                                         aten::nll_loss         0.00%     678.182us         0.01%       8.661ms      36.086us       0.000us         0.00%     650.781us       2.712us           240  
                                 aten::nll_loss_forward         0.00%       3.781ms         0.00%       7.982ms      33.260us     650.781us         0.00%     650.781us       2.712us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     650.781us         0.00%     650.781us       5.970us           109  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     646.655us         0.00%     646.655us       2.694us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     638.551us         0.00%     638.551us       5.858us           109  
                                          aten::normal_         0.62%        1.021s         0.62%        1.023s       9.838ms     620.394us         0.00%     620.394us       5.965us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     620.394us         0.00%     620.394us       6.396us            97  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     618.181us         0.00%     618.181us       7.727us            80  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     591.556us         0.00%     591.556us       2.434us           243  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       4.727ms         0.01%       9.388ms      58.673us     577.978us         0.00%     577.978us       3.612us           160  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     551.186us         0.00%     551.186us       5.011us           110  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     526.173us         0.00%     526.173us       6.577us            80  
                                             aten::rsub         0.00%       2.799ms         0.01%       8.572ms      99.670us       0.000us         0.00%     523.719us       6.090us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     523.719us         0.00%     523.719us       6.546us            80  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     515.951us         0.00%     515.951us       6.449us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     515.142us         0.00%     515.142us       6.439us            80  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     514.379us         0.00%     514.379us       6.430us            80  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     505.601us         0.00%     505.601us       2.081us           243  
                                        aten::ones_like         0.00%     607.346us         0.00%       2.370ms      29.622us       0.000us         0.00%     500.396us       6.255us            80  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     844.258us         0.00%       5.275ms      65.943us       0.000us         0.00%     486.674us       6.083us            80  
                                    LogSoftmaxBackward0         0.00%       1.301ms         0.00%       4.431ms      55.389us       0.000us         0.00%     486.674us       6.083us            80  
                       aten::_log_softmax_backward_data         0.00%       1.703ms         0.00%       3.130ms      39.125us     486.674us         0.00%     486.674us       6.083us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     486.674us         0.00%     486.674us       6.083us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.217ms         0.02%      24.636ms     300.441us       0.000us         0.00%     486.156us       5.929us            82  
                                          TanhBackward0         0.00%       2.102ms         0.01%      23.419ms     285.601us       0.000us         0.00%     486.156us       5.929us            82  
                                    aten::tanh_backward         0.00%       3.019ms         0.01%      18.776ms     228.981us     486.156us         0.00%     486.156us       5.929us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     486.156us         0.00%     486.156us       6.077us            80  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     482.829us         0.00%     482.829us       2.012us           240  
                                               aten::gt         0.02%      36.925ms         0.03%      42.967ms       9.898us     445.955us         0.00%     451.488us       0.104us          4341  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     444.509us         0.00%     444.509us       1.852us           240  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     443.629us         0.00%     443.629us       1.833us           242  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     441.981us         0.00%     441.981us       1.819us           243  
                                              aten::log         0.00%       2.971ms         0.00%       7.225ms      30.104us     336.981us         0.00%     336.981us       1.404us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     336.981us         0.00%     336.981us       3.092us           109  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     319.891us         0.00%     319.891us       1.999us           160  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     284.930us         0.00%     284.930us       3.562us            80  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     224.553us         0.00%     224.553us       2.389us            94  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     215.901us         0.00%     215.901us       3.722us            58  
                                             aten::rand         0.00%       1.951ms         0.00%       5.139ms     367.071us       0.000us         0.00%     141.636us      10.117us            14  
                                         aten::uniform_         0.00%       6.757ms         0.01%       8.727ms     671.301us     141.636us         0.00%     141.636us      10.895us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     141.636us         0.00%     141.636us      28.327us             5  
                                               aten::eq         0.02%      37.061ms         0.02%      37.068ms       6.329us       0.000us         0.00%      65.641us       0.011us          5857  
                                       aten::lift_fresh         0.03%      43.955ms         0.03%      49.097ms      27.801us       0.000us         0.00%      43.983us       0.025us          1766  
         GraphLowering.compile_to_module (dynamo_timed)         0.52%     856.921ms         1.04%        1.696s     154.169ms       0.000us         0.00%      42.818us       3.893us            11  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      35.600us         0.00%      35.600us       3.560us            10  
                                           aten::narrow         0.00%       7.585ms         0.02%      25.928ms       9.821us       0.000us         0.00%      31.272us       0.012us          2640  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      28.343us         0.00%      28.343us       2.834us            10  
                       Scheduler.codegen (dynamo_timed)         0.06%     103.315ms         0.06%     103.364ms       9.397ms       0.000us         0.00%      22.450us       2.041us            11  
                                          aten::maximum         0.00%     131.640us         0.01%      16.620ms       1.847ms      21.770us         0.00%      21.770us       2.419us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      21.770us         0.00%      21.770us       2.419us             9  
                                       aten::reciprocal         0.00%     149.141us         0.00%       8.100ms     809.993us      20.930us         0.00%      20.930us       2.093us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      20.930us         0.00%      20.930us       2.093us            10  
                            hipGetDevicePropertiesR0000         0.00%      42.585us         0.00%      42.585us       4.259us      15.996us         0.00%      15.996us       1.600us            10  
                                              aten::min         0.00%      98.103us         0.00%       3.438ms     687.684us      15.757us         0.00%      15.757us       3.151us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.757us         0.00%      15.757us       5.252us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      14.031us         0.00%      14.031us       4.677us             3  
                                    hipFuncGetAttribute         0.00%       6.240us         0.00%       6.240us       0.520us      13.432us         0.00%      13.432us       1.119us            12  
                                     MakeViewlessTensor         0.00%       5.171ms         0.00%       6.203ms      25.844us       0.000us         0.00%       9.141us       0.038us           240  
                               TorchDynamo Cache Lookup         0.11%     183.119ms         0.11%     183.134ms       9.528us       0.000us         0.00%       8.740us       0.000us         19221  
                                    hipModuleLoadDataEx         0.37%     606.883ms         0.37%     606.883ms      50.574ms       6.936us         0.00%       6.936us       0.578us            12  
                                           aten::detach         0.04%      59.685ms         0.11%     175.441ms       4.945us       0.000us         0.00%       6.816us       0.000us         35476  
                                                 detach         0.06%      90.569ms         0.07%     110.170ms       3.257us       0.000us         0.00%       6.816us       0.000us         33825  
                                           aten::select         0.20%     329.028ms         0.24%     400.082ms       4.087us       0.000us         0.00%       5.613us       0.000us         97887  
                                           aten::expand         0.04%      61.355ms         0.05%      81.727ms       2.256us       0.000us         0.00%       2.366us       0.000us         36229  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.365us         0.00%       2.365us       2.365us             1  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.326us         0.00%       2.326us       2.326us             1  
                                         _SplitAlongDim         0.08%     122.939ms         0.11%     180.954ms      31.416us       0.000us         0.00%       1.604us       0.000us          5760  
                        hipDeviceGetStreamPriorityRange         0.00%       1.798us         0.00%       1.798us       1.798us       0.000us         0.00%       0.000us       0.000us             1  
                                              hipMalloc         0.01%      14.351ms         0.01%      14.351ms      87.505us       0.000us         0.00%       0.000us       0.000us           164  
                            hipStreamCreateWithPriority         0.00%     482.768us         0.00%     482.768us      80.461us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.065s      63.194us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      13.182ms         0.01%      13.182ms       1.310us       0.000us         0.00%       0.000us       0.000us         10059  
                                     hipExtLaunchKernel         0.07%     110.370ms         0.07%     110.430ms      10.980us       0.000us         0.00%       0.000us       0.000us         10057  
                                    aten::empty_strided         0.18%     297.168ms         0.19%     303.842ms       3.428us       0.000us         0.00%       0.000us       0.000us         88647  
                            prims::convert_element_type         0.01%       8.669ms         0.01%      15.948ms     128.610us       0.000us         0.00%       0.000us       0.000us           124  
                                prims::broadcast_in_dim         0.00%     269.239us         0.00%     367.349us      45.919us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.13%     219.513ms         0.13%     219.743ms       0.653us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%       1.084ms         0.00%       1.568ms      82.526us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     495.730us         0.00%       1.002ms      23.849us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     854.997us         0.00%       1.162ms      83.021us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     137.152us         0.00%     189.476us      94.738us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       3.689ms         0.00%       7.519ms     197.864us       0.000us         0.00%       0.000us       0.000us            38  
                                             aten::view         0.17%     272.404ms         0.17%     279.393ms       1.932us       0.000us         0.00%       0.000us       0.000us        144633  
                                         prims::view_of         0.00%     521.809us         0.00%     664.080us      27.670us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       5.158ms         0.00%       5.271ms       5.497us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       7.925ms         0.01%       8.883ms      11.008us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%     958.436us         0.00%     958.436us       1.188us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     393.895us         0.00%     393.895us      12.706us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     113.454us         0.00%     113.454us      10.314us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      11.474ms         0.02%      25.170ms      98.322us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     753.173us         0.00%     753.173us       2.942us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     194.873us         0.00%     268.522us      89.507us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     116.540us         0.00%     116.540us      58.270us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     149.527us         0.00%     161.057us      80.529us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      31.777us         0.00%      31.777us       2.270us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%     933.661us         0.00%       1.828ms     365.553us       0.000us         0.00%       0.000us       0.000us             5  
                                        aten::index_add         0.00%     190.852us         0.00%       1.049ms       1.049ms       0.000us         0.00%       0.000us       0.000us             1  
                                       aten::empty_like         0.10%     169.414ms         0.29%     478.915ms       5.385us       0.000us         0.00%       0.000us       0.000us         88930  
                                        aten::new_empty         0.00%     352.277us         0.00%     399.568us     199.784us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     196.646us         0.00%     196.646us     196.646us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.09%     143.522ms         0.09%     145.607ms      13.237ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.08%     128.646ms         0.08%     128.687ms      11.699ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.00%       7.266ms         0.00%       7.266ms     660.575us       0.000us         0.00%       0.000us       0.000us            11  
                                 hipPointerGetAttribute         0.03%      51.094ms         0.03%      51.094ms       0.804us       0.000us         0.00%       0.000us       0.000us         63574  
                                        aten::expand_as         0.00%     817.622us         0.00%       2.934ms       5.403us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.299ms         0.00%       4.718ms     428.914us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     104.095us         0.00%     118.804us      59.402us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     112.386us         0.00%     112.386us      56.193us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      58.154us         0.00%      75.448us      75.448us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     275.794us         0.00%       2.433ms     811.158us       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     264.750us         0.00%     296.054us      98.685us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.014ms         0.00%       3.143ms     523.894us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%     711.970us         0.00%       3.422ms     380.262us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.004ms         0.00%       2.268ms     378.001us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     283.620us         0.00%     733.954us     244.651us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     182.144us         0.00%     938.523us     312.841us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     395.082us         0.00%     756.379us     252.126us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     320.807us         0.00%     336.435us      84.109us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.06%      95.376ms         0.06%      95.633ms       2.760us       0.000us         0.00%       0.000us       0.000us         34655  
                aten::_has_compatible_shallow_copy_type         0.00%       3.457ms         0.00%       3.457ms       0.141us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     788.463us      56.319us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       4.868ms         0.01%      11.639ms       5.184us       0.000us         0.00%       0.000us       0.000us          2245  
                                          aten::reshape         0.06%      98.071ms         0.11%     174.926ms       4.049us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      67.010ms     139.314us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.01%       9.304ms         0.01%      20.168ms       4.943us       0.000us         0.00%       0.000us       0.000us          4080  
                                        aten::unsqueeze         0.02%      27.477ms         0.02%      33.524ms       4.555us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.153ms         0.00%       2.465ms       3.424us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      31.958ms         0.02%      38.149ms       4.769us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.219us         0.00%       1.219us       0.203us       0.000us         0.00%       0.000us       0.000us             6  
                             hipDevicePrimaryCtxRelease         0.00%       0.810us         0.00%       0.810us       0.135us       0.000us         0.00%       0.000us       0.000us             6  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.02%      40.488ms         0.02%      40.488ms       2.179us       0.000us         0.00%       0.000us       0.000us         18578  
                                              hipMemset         0.00%      22.425us         0.00%      22.425us      11.212us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.20%     334.754ms         0.20%     334.754ms     111.585ms       0.000us         0.00%       0.000us       0.000us             3  
                                 aten::split_with_sizes         0.03%      44.587ms         0.04%      57.980ms      10.066us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      29.417ms         0.02%      29.417ms       1.915us       0.000us         0.00%       0.000us       0.000us         15360  
                                      hipModuleLoadData         0.24%     395.078ms         0.24%     395.078ms      98.769ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     650.998us         0.00%       1.529ms     382.200us       0.000us         0.00%       0.000us       0.000us             4  
                                     aten::_unsafe_view         0.00%     702.683us         0.00%     702.683us       2.196us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      35.770ms         0.06%     104.380ms       6.657us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      16.862ms         0.04%      68.611ms       4.376us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     499.769us         0.00%       3.192ms      39.905us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.193ms         0.00%       2.693ms      33.657us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      49.351ms         0.07%     118.003ms       5.545us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      17.780ms         0.04%      68.652ms       3.226us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      35.772ms         0.05%      81.076ms       3.356us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%     988.108us         0.00%       2.540ms      10.583us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     353.154us         0.00%       1.552ms       6.466us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     302.950us         0.00%     856.491us      10.706us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     553.541us         0.00%     553.541us       6.919us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     936.308us         0.21%     346.989ms     346.989ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      16.732ms         0.01%      18.994ms       2.472us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.261ms         0.00%       2.261ms       0.294us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       4.591ms         0.01%      17.873ms       8.936us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       3.621ms         0.01%      13.282ms       6.641us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       4.124ms         0.01%      11.285ms       5.877us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       1.933ms         0.00%       7.161ms       3.729us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     313.424us         0.00%     313.424us       0.163us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.129ms         0.00%       2.669ms      33.360us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.540ms         0.00%       1.540ms      19.252us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.952ms         0.00%       2.688ms      33.604us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.128ms     212.800us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      16.651us         0.00%      31.341us       7.835us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 163.843s
Self CUDA time total: 155.892s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       76.345s        49.18%       76.345s       76.345s             1  
                                             bert_train        33.44%       55.645s        70.02%      116.519s      116.519s       0.000us         0.00%       41.523s       41.523s             1  
                                            aten::copy_        15.60%       25.955s        19.24%       32.010s     406.141us       16.359s        10.54%       16.403s     208.119us         78815  
                                     record_param_comms         4.00%        6.652s         5.43%        9.031s     260.161us        9.711s         6.26%       14.473s     416.910us         34714  
                                               aten::to         0.03%      48.138ms        19.21%       31.962s     608.919us       0.000us         0.00%       11.839s     225.550us         52489  
                                         aten::_to_copy         0.08%     139.802ms        19.18%       31.913s     736.265us       0.000us         0.00%       11.839s     273.132us         43345  
                                      aten::masked_fill         0.03%      56.679ms         0.21%     345.845ms      36.026us       0.000us         0.00%       11.623s       1.211ms          9600  
                                     aten::masked_fill_         0.09%     141.637ms         0.19%     313.917ms      19.141us       11.025s         7.10%       11.025s     672.234us         16400  
                                       c10d::allreduce_         0.20%     326.329ms         2.33%        3.883s     231.004us       0.000us         0.00%        9.951s     591.954us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        9.681s         6.24%        9.681s     998.027us          9700  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        9.551s         6.15%        9.551s     974.981us          9796  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      13.949ms         0.09%     150.867ms      39.288us       0.000us         0.00%        7.655s       1.994ms          3840  
                                    MaskedFillBackward0         0.00%       5.729ms         0.08%     136.919ms      35.656us       0.000us         0.00%        7.655s       1.994ms          3840  
                                              aten::bmm         0.21%     351.772ms         0.26%     429.990ms      31.993us        6.966s         4.49%        6.966s     518.292us         13440  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.521s         4.20%        6.521s       1.438ms          4536  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       6.287ms         0.03%      57.386ms      29.888us       0.000us         0.00%        6.471s       3.370ms          1920  
                                       SoftmaxBackward0         0.00%       5.424ms         0.03%      51.099ms      26.614us       0.000us         0.00%        6.471s       3.370ms          1920  
                           aten::_softmax_backward_data         0.01%      15.356ms         0.03%      45.675ms      23.789us        3.341s         2.15%        6.471s       3.370ms          1920  
autograd::engine::evaluate_function: _LayerNormLinea...         0.04%      71.239ms         1.68%        2.788s     725.932us       0.000us         0.00%        6.144s       1.600ms          3840  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.106s         3.93%        6.106s     737.961us          8274  
                               _LayerNormLinearBackward         0.89%        1.486s         1.60%        2.668s     694.688us     319.048ms         0.21%        6.002s       1.563ms          3840  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.585s         3.60%        5.585s       1.187ms          4706  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      11.038ms         0.04%      70.484ms      17.981us       0.000us         0.00%        4.937s       1.260ms          3920  
                                        ToCopyBackward0         0.00%       5.115ms         0.04%      59.446ms      15.165us       0.000us         0.00%        4.937s       1.260ms          3920  
                                            aten::clone         0.05%      89.473ms         0.35%     585.129ms      16.938us       0.000us         0.00%        4.560s     131.986us         34546  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.502s         2.90%        4.502s     952.730us          4725  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.469s         2.88%        4.469s     551.809us          8099  
                                          aten::softmax         0.01%       9.623ms         0.07%     113.815ms      19.759us       0.000us         0.00%        4.450s     772.575us          5760  
                                         aten::_softmax         0.04%      62.540ms         0.06%     104.180ms      18.087us        4.450s         2.87%        4.450s     772.575us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.450s         2.87%        4.450s       1.701ms          2616  
                                     tex_ts::te_gemm_ts         1.02%        1.705s         1.50%        2.495s      64.966us        4.070s         2.62%        4.071s     106.028us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.721s         2.40%        3.721s     820.246us          4536  
                                                _Linear         0.73%        1.216s         1.23%        2.050s     533.957us      64.239ms         0.04%        3.639s     947.580us          3840  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.513s         2.26%        3.513s     304.930us         11520  
                                          c10d::barrier         0.00%     698.562us         2.19%        3.649s      96.039ms       0.000us         0.00%        3.422s      90.060ms            38  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.341s         2.15%        3.341s       1.740ms          1920  
                                              aten::mul         0.07%     117.862ms         0.10%     168.535ms      21.143us        3.159s         2.04%        3.159s     396.372us          7971  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.132s         2.02%        3.132s       1.426ms          2197  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      13.017ms         0.09%     155.771ms      81.131us       0.000us         0.00%        3.029s       1.577ms          1920  
                                       BaddbmmBackward0         0.01%      14.593ms         0.09%     142.755ms      74.351us       0.000us         0.00%        3.029s       1.577ms          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.905s         1.23%        1.905s     410.011us          4645  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      15.967ms         0.10%     159.653ms      83.153us       0.000us         0.00%        1.764s     918.531us          1920  
                                           BmmBackward0         0.01%      10.428ms         0.09%     143.687ms      74.837us       0.000us         0.00%        1.764s     918.531us          1920  
                                       aten::logical_or         0.05%      88.952ms         0.16%     263.468ms      22.870us     824.189ms         0.53%        1.652s     143.436us         11520  
                                   hipDeviceGetPCIBusId         0.01%      11.234ms         0.01%      11.234ms       0.609us        1.596s         1.03%        1.596s      86.576us         18435  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      29.846ms         0.99%        1.653s     430.348us       0.000us         0.00%        1.565s     407.587us          3840  
                                        _LinearBackward         0.71%        1.189s         0.98%        1.623s     422.575us      76.172ms         0.05%        1.565s     407.587us          3840  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.482s         0.95%        1.482s     771.681us          1920  
                                          aten::dropout         0.00%       8.152ms         0.05%      87.335ms      14.520us       0.000us         0.00%        1.457s     242.205us          6015  
                                   aten::native_dropout         0.02%      32.941ms         0.05%      76.241ms      37.949us        1.457s         0.94%        1.457s     725.163us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.457s         0.94%        1.457s     728.426us          2000  
                                              aten::sub         0.05%      81.758ms         0.06%     106.892ms      16.270us        1.445s         0.93%        1.445s     219.905us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.442s         0.93%        1.442s     551.406us          2616  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%       8.885ms         0.03%      52.437ms      26.179us       0.000us         0.00%        1.380s     689.107us          2003  
                                 NativeDropoutBackward0         0.00%       5.266ms         0.03%      43.552ms      21.743us       0.000us         0.00%        1.380s     689.107us          2003  
                          aten::native_dropout_backward         0.01%      14.883ms         0.02%      38.286ms      19.114us        1.380s         0.89%        1.380s     689.107us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.380s         0.89%        1.380s     690.140us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.338s         0.86%        1.338s      76.574us         17468  
                                   hipStreamIsCapturing         0.02%      38.397ms         0.02%      38.397ms       0.743us        1.250s         0.80%        1.250s      24.175us         51685  
                                          aten::baddbmm         0.17%     284.307ms         0.38%     626.849ms     108.828us        1.221s         0.79%        1.221s     211.935us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.121s         0.72%        1.121s     583.688us          1920  
                                       c10d::broadcast_         0.02%      35.204ms         0.49%     818.565ms       1.702ms       0.000us         0.00%     979.360ms       2.036ms           481  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      18.568ms         0.53%     888.263ms     231.318us       0.000us         0.00%     977.846ms     254.648us          3840  
                               CompiledFunctionBackward         0.23%     390.323ms         0.52%     869.695ms     226.483us       0.000us         0.00%     977.846ms     254.648us          3840  
                                  hipMemGetAddressRange         0.00%     116.686us         0.00%     116.686us       0.260us     962.424ms         0.62%     962.424ms       2.143ms           449  
                                 triton_red_fused_sum_1         0.02%      26.997ms         0.03%      45.529ms      11.857us     882.571ms         0.57%     882.571ms     229.836us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     824.189ms         0.53%     824.189ms     315.057us          2616  
                                         hipMemsetAsync         0.06%      98.556ms         0.06%      98.568ms       8.229us     757.930ms         0.49%     757.930ms      63.277us         11978  
                                      aten::logical_not         0.07%     115.675ms         0.21%     343.002ms      14.887us     318.198ms         0.20%     637.487ms      27.669us         23040  
                                        hipEventDestroy         0.03%      53.904ms         0.03%      54.533ms       2.688us     499.533ms         0.32%     501.937ms      24.742us         20287  
                     hipThreadExchangeStreamCaptureMode         0.00%       1.835ms         0.00%       1.835ms       0.130us     423.898ms         0.27%     423.898ms      29.919us         14168  
                                      hipGetProcAddress         0.04%      59.064ms         0.04%      59.064ms       0.858us     390.668ms         0.25%     390.668ms       5.676us         68830  
                                  Torch-Compiled Region         0.42%     692.142ms         1.25%        2.077s     108.064us       0.000us         0.00%     388.470ms      20.212us         19220  
                                       hipCtxGetCurrent         0.00%       7.147ms         0.00%       7.147ms       0.142us     342.973ms         0.22%     342.973ms       6.836us         50170  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     318.198ms         0.20%     318.198ms      60.818us          5232  
                                             aten::add_         0.08%     129.194ms         0.14%     239.191ms       7.613us     308.585ms         0.20%     308.592ms       9.822us         31420  
                                       _LayerNormLinear         0.30%     500.470ms         0.83%        1.387s     361.131us     164.788ms         0.11%     281.106ms      73.205us          3840  
                                       CompiledFunction         0.50%     824.845ms         0.73%        1.207s     104.627us       0.000us         0.00%     279.170ms      24.192us         11540  
                                              aten::sum         0.17%     286.587ms         0.37%     613.639ms      30.148us     203.168ms         0.13%     266.570ms      13.097us         20354  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     257.998ms         0.17%     257.998ms      67.187us          3840  
                                     hipIpcGetMemHandle         0.01%       9.583ms         0.01%       9.583ms       5.530us     224.626ms         0.14%     224.626ms     129.617us          1733  
                                  hipExtMallocWithFlags         0.02%      38.593ms         0.02%      38.593ms       9.115us     224.496ms         0.14%     224.496ms      53.022us          4234  
                  triton_poi_fused_add_native_dropout_0         0.04%      65.247ms         0.06%      99.700ms      25.896us     212.227ms         0.14%     213.749ms      55.519us          3850  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     190.719ms         0.12%     190.719ms      36.452us          5232  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     178.274ms         0.11%     178.274ms     178.274ms             1  
                         _ReduceFromModelParallelRegion         0.01%      18.801ms         0.03%      56.469ms     235.285us       0.000us         0.00%     173.942ms     724.759us           240  
autograd::engine::evaluate_function: torch::autograd...         0.15%     250.704ms         0.30%     498.757ms      20.644us       0.000us         0.00%     166.572ms       6.895us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     164.979ms         0.11%     164.979ms       6.897us         23920  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     155.572ms         0.10%     155.572ms     710.373us           219  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     151.059ms         0.10%     151.059ms      33.885us          4458  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.01%      20.535ms         0.37%     612.281ms     318.896us       0.000us         0.00%     149.876ms      78.061us          1920  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     147.887ms         0.10%     147.887ms      28.266us          5232  
                             _VocabParallelCrossEntropy         0.03%      53.849ms         0.13%     211.594ms     881.641us       0.000us         0.00%     135.465ms     564.438us           240  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.402ms         0.06%     107.499ms       1.344ms       0.000us         0.00%     134.122ms       1.677ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      16.484ms         0.06%     106.097ms       1.326ms       0.000us         0.00%     134.122ms       1.677ms            80  
                                       hipStreamDestroy         0.02%      40.642ms         0.02%      40.642ms      15.406us     133.230ms         0.09%     133.230ms      50.504us          2638  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     131.516ms         0.08%     131.516ms      33.550us          3920  
                                              aten::cat         0.07%     120.494ms         0.10%     159.723ms      19.768us     130.178ms         0.08%     130.178ms      16.111us          8080  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.157ms        25.29%       42.078s     175.327ms       0.000us         0.00%     123.673ms     515.302us           240  
                                     EmbeddingBackward0         0.00%       2.567ms        25.28%       42.071s     175.295ms       0.000us         0.00%     122.825ms     511.771us           240  
                               aten::embedding_backward         0.00%       2.628ms        25.28%       42.068s     175.284ms       0.000us         0.00%     122.825ms     511.771us           240  
                         aten::embedding_dense_backward         2.78%        4.624s        25.28%       42.066s     175.273ms     117.730ms         0.08%     122.825ms     511.771us           240  
                             c10d::allreduce_coalesced_         0.00%       1.626ms         0.05%      83.631ms       8.363ms       0.000us         0.00%     116.153ms      11.615ms            10  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      12.548ms         0.11%     182.613ms      95.111us       0.000us         0.00%     112.943ms      58.825us          1920  
                                 _SplitAlongDimBackward         0.08%     128.675ms         0.10%     170.065ms      88.575us       0.000us         0.00%     112.943ms      58.825us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     112.943ms         0.07%     112.943ms      58.825us          1920  
                                         hipMemcpyAsync         0.10%     171.634ms         0.10%     171.648ms      14.053us     112.314ms         0.07%     112.314ms       9.196us         12214  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     107.956ms         0.07%     107.956ms      49.980us          2160  
                                               aten::mm         0.03%      43.681ms         0.06%      95.971ms     109.057us     103.923ms         0.07%     103.923ms     118.094us           880  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     103.283ms         0.07%     103.283ms      17.931us          5760  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      98.967ms         0.06%      98.967ms       9.360us         10573  
                                       aten::contiguous         0.01%      21.268ms         0.24%     391.727ms      17.002us       0.000us         0.00%      95.833ms       4.159us         23040  
             triton_poi_fused_native_dropout_backward_0         0.03%      50.654ms         0.05%      75.438ms      19.645us      95.275ms         0.06%      95.275ms      24.811us          3840  
                                   hipStreamSynchronize         0.44%     725.750ms         0.44%     725.919ms     227.347us      90.043ms         0.06%      90.853ms      28.454us          3193  
                                           aten::matmul         0.00%       2.448ms         0.05%      75.311ms     188.277us       0.000us         0.00%      87.190ms     217.976us           400  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      82.410ms         0.05%      82.410ms      31.502us          2616  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us      77.578ms         0.05%      77.578ms      14.965us          5184  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      72.944ms         0.05%      72.944ms       9.295us          7848  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      69.361ms         0.04%      69.361ms      26.514us          2616  
                                           aten::arange         0.06%     106.354ms         0.19%     310.767ms      12.612us      33.670ms         0.02%      69.030ms       2.802us         24640  
                               hipStreamCreateWithFlags         0.24%     402.087ms         0.24%     402.087ms     151.274us      68.979ms         0.04%      68.979ms      25.951us          2658  
                                 hipDeviceCanAccessPeer         0.00%     253.949us         0.00%     253.949us       0.130us      67.100ms         0.04%      67.100ms      34.305us          1956  
                                           GeLUFunction         0.07%     124.415ms         0.46%     769.634ms     133.617us       0.000us         0.00%      66.121ms      11.479us          5760  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      66.108ms         0.04%      66.108ms     275.449us           240  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      63.924ms         0.04%      63.924ms      16.307us          3920  
                        triton_poi_fused_add_mul_tanh_0         0.06%      92.313ms         0.07%     110.634ms      19.174us      63.404ms         0.04%      63.404ms      10.989us          5770  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      61.860ms         0.04%      61.860ms      14.336us          4315  
                                    hipMemcpyWithStream        29.12%       48.454s        29.12%       48.461s      60.501ms       0.000us         0.00%      61.743ms      77.082us           801  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      60.806ms         0.04%      60.806ms       5.077us         11977  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.16%     272.725ms         0.28%     472.326ms      61.501us      57.975ms         0.04%      57.975ms       7.549us          7680  
                                    hipIpcOpenMemHandle         0.05%      77.402ms         0.05%      77.402ms      44.510us      55.201ms         0.04%      55.201ms      31.743us          1739  
                                  hipModuleLaunchKernel         0.11%     187.351ms         0.11%     187.369ms       5.483us      54.238ms         0.03%      54.240ms       1.587us         34175  
        LinearWithGradAccumulationAndAsyncCommunication         0.00%       5.775ms         0.01%      19.273ms      80.305us       0.000us         0.00%      53.173ms     221.556us           240  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      47.151ms         0.03%      47.151ms      12.279us          3840  
                                   GeLUFunctionBackward         0.03%      43.063ms         0.32%     527.255ms     274.612us       0.000us         0.00%      43.206ms      22.503us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.01%      24.255ms         0.02%      37.497ms      19.529us      43.206ms         0.03%      43.206ms      22.503us          1920  
                                 triton_poi_fused_add_0         0.09%     156.610ms         0.10%     167.995ms      21.874us      40.911ms         0.03%      40.911ms       5.327us          7680  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      37.584ms         0.02%      37.584ms      19.575us          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      32.467ms         0.02%      32.467ms       6.206us          5232  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      31.320ms         0.02%      31.320ms       5.986us          5232  
                                            aten::fill_         0.06%     108.066ms         0.08%     134.444ms       4.649us      29.427ms         0.02%      29.427ms       1.018us         28919  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      28.296ms         0.02%      28.296ms     176.852us           160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      28.289ms         0.02%      28.289ms      10.814us          2616  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      26.911ms         0.02%      26.911ms       7.008us          3840  
                                            aten::zero_         0.04%      58.581ms         0.11%     183.951ms       8.123us       0.000us         0.00%      26.005ms       1.148us         22646  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       1.722ms         0.02%      37.450ms     468.129us       0.000us         0.00%      25.524ms     319.054us            80  
                                     hipStreamWaitEvent         0.18%     295.330ms         0.18%     295.398ms      14.097us      24.444ms         0.02%      24.799ms       1.183us         20954  
                                            aten::zeros         0.04%      62.265ms         0.17%     274.812ms      12.265us       0.000us         0.00%      24.697ms       1.102us         22406  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.465ms         0.02%      24.465ms     305.817us            80  
                                              aten::exp         0.00%       2.268ms         0.01%      16.539ms      68.914us      23.885ms         0.02%      23.885ms      99.519us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.885ms         0.02%      23.885ms     219.124us           109  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.104ms         0.02%      40.325ms     168.019us       0.000us         0.00%      23.378ms      97.408us           240  
                                          aten::randint         0.02%      29.897ms         0.07%     114.826ms      29.794us       0.000us         0.00%      22.263ms       5.777us          3854  
                                          aten::random_         0.03%      47.774ms         0.05%      82.875ms      21.526us      20.134ms         0.01%      22.256ms       5.781us          3850  
                                              aten::add         0.03%      57.735ms         0.05%      81.382ms      45.566us      21.657ms         0.01%      21.657ms      12.126us          1786  
                                             aten::div_         0.00%       4.609ms         0.01%       9.945ms      20.718us      21.421ms         0.01%      21.421ms      44.627us           480  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      21.034ms         0.01%      21.034ms      32.764us           642  
                                             aten::sub_         0.00%       3.598ms         0.00%       4.733ms      14.790us      21.003ms         0.01%      21.003ms      65.636us           320  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.763ms         0.01%      20.763ms     192.246us           108  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.492ms         0.01%      20.492ms     188.004us           109  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      20.134ms         0.01%      20.134ms       5.230us          3850  
                                           aten::linear         0.00%       2.634ms         0.03%      43.038ms      59.776us       0.000us         0.00%      19.883ms      27.615us           720  
                                            aten::addmm         0.02%      30.641ms         0.02%      36.354ms      50.491us      19.877ms         0.01%      19.877ms      27.607us           720  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      19.408ms         0.01%      19.408ms      89.027us           218  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      17.235ms         0.01%      17.235ms       5.976us          2884  
                                         AddmmBackward0         0.00%       2.484ms         0.02%      30.852ms     128.549us       0.000us         0.00%      16.733ms      69.719us           240  
                                 tex_ts::cast_to_fp8_ts         0.06%     102.085ms         0.09%     151.861ms      19.774us      16.614ms         0.01%      16.684ms       2.172us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      16.614ms         0.01%      16.614ms      11.935us          1392  
                                        aten::embedding         0.00%       5.907ms         0.02%      25.373ms      35.241us       0.000us         0.00%      16.299ms      22.637us           720  
                                     aten::index_select         0.01%      10.817ms         0.01%      17.068ms      23.705us      16.299ms         0.01%      16.299ms      22.637us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.299ms         0.01%      16.299ms      49.843us           327  
                                           aten::cumsum         0.05%      83.668ms         0.06%     105.875ms      18.381us      16.102ms         0.01%      16.108ms       2.797us          5760  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      16.102ms         0.01%      16.102ms       6.155us          2616  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      16.031ms         0.01%      16.031ms       6.095us          2630  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      15.999ms         0.01%      15.999ms       6.116us          2616  
                     _VocabParallelCrossEntropyBackward         0.01%      13.787ms         0.02%      33.197ms     414.959us       0.000us         0.00%      15.744ms     196.805us            80  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      13.250ms         0.01%      13.250ms       6.901us          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.805ms         0.01%      12.805ms     117.474us           109  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.631ms         0.01%      12.631ms      78.945us           160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.212ms         0.01%      12.212ms     112.034us           109  
                                             aten::mul_         0.00%       6.149ms         0.00%       6.785ms       5.301us      12.105ms         0.01%      12.105ms       9.457us          1280  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      10.236ms         0.01%      10.236ms      93.909us           109  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.532ms         0.01%       9.532ms      39.715us           240  
                                              aten::max         0.00%       5.096ms         0.02%      26.347ms     103.727us       9.383ms         0.01%       9.403ms      37.021us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.370ms         0.01%       9.370ms      85.959us           109  
                                            aten::index         0.01%       9.900ms         0.03%      55.116ms      97.206us       1.949ms         0.00%       9.319ms      16.436us           567  
                                       aten::index_put_         0.00%       4.656ms         0.08%     125.983ms     112.485us       0.000us         0.00%       9.145ms       8.165us          1120  
                                 aten::_index_put_impl_         0.00%       6.584ms         0.07%     121.326ms     108.327us     747.119us         0.00%       9.145ms       8.165us          1120  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       8.886ms         0.01%       8.886ms      37.026us           240  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.440ms         0.01%       8.440ms      19.859us           425  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.075ms         0.01%      11.418ms     142.725us       0.000us         0.00%       8.264ms     103.304us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       3.874ms         0.01%       9.343ms     116.788us       8.264ms         0.01%       8.264ms     103.304us            80  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.212ms         0.02%      28.255ms     353.187us       0.000us         0.00%       7.966ms      99.577us            80  
                            torch::autograd::CopySlices         0.00%       4.111ms         0.02%      26.043ms     325.535us       0.000us         0.00%       7.966ms      99.577us            80  
                           FusedLayerNormAffineFunction         0.01%       8.957ms         0.01%      15.466ms      64.443us       7.825ms         0.01%       7.825ms      32.603us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.825ms         0.01%       7.825ms      71.787us           109  
                                          aten::nonzero         0.00%       4.744ms         0.02%      31.713ms     129.440us       7.364ms         0.00%       7.370ms      30.083us           245  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.164ms         0.00%       7.164ms      10.443us           686  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.601ms         0.00%       6.601ms      82.510us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       6.232ms         0.00%       6.232ms       6.901us           903  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     465.232us         0.00%       2.082ms     208.166us       6.199ms         0.00%       6.199ms     619.887us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.199ms         0.00%       6.199ms      56.353us           110  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       5.782ms         0.00%       5.782ms      24.091us           240  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       4.798ms         0.00%       4.798ms       4.998us           960  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       4.592ms         0.00%       4.592ms      28.701us           160  
                                        aten::index_put         0.00%       1.570ms         0.01%      11.327ms     136.464us       0.000us         0.00%       4.228ms      50.939us            83  
                                      IndexPutBackward0         0.00%       1.112ms         0.01%      11.983ms     149.793us       0.000us         0.00%       4.228ms      52.850us            80  
                                 c10d::_allgather_base_         0.00%     213.376us         0.00%       1.282ms      91.575us       0.000us         0.00%       4.014ms     286.740us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       4.014ms         0.00%       4.014ms     334.530us            12  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       3.962ms         0.00%       3.962ms      49.526us            80  
                            hipGetDevicePropertiesR0600         0.04%      65.557ms         0.04%      65.557ms       0.706us       3.841ms         0.00%       3.841ms       0.041us         92873  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       3.727ms         0.00%       3.727ms      46.585us            80  
                                              hipMemcpy         0.01%      11.325ms         0.01%      11.325ms     235.933us       3.642ms         0.00%       3.642ms      75.874us            48  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     923.667us         0.01%      21.478ms     268.480us       0.000us         0.00%       3.592ms      44.903us            80  
                                     _LayerNormBackward         0.00%       5.062ms         0.01%      20.555ms     256.934us       3.592ms         0.00%       3.592ms      44.903us            80  
                                             aten::ones         0.00%     902.788us         0.00%       5.599ms      11.664us       0.000us         0.00%       3.412ms       7.108us           480  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     633.478us         0.00%       2.735ms      34.182us       0.000us         0.00%       3.313ms      41.408us            80  
                                          GeluBackward0         0.00%     405.719us         0.00%       2.101ms      26.263us       0.000us         0.00%       3.313ms      41.408us            80  
                                    aten::gelu_backward         0.00%       1.101ms         0.00%       1.695ms      21.192us       3.313ms         0.00%       3.313ms      41.408us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.313ms         0.00%       3.313ms      41.408us            80  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     660.526us         0.00%       4.352ms      54.399us       0.000us         0.00%       3.038ms      37.975us            80  
         _compile.<locals>.compile_inner (dynamo_timed)         0.06%      98.908ms         1.50%        2.490s     249.031ms       0.000us         0.00%       2.822ms     282.160us            10  
                                             aten::gelu         0.00%       3.004ms         0.00%       7.442ms      31.010us       2.670ms         0.00%       2.670ms      11.127us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.670ms         0.00%       2.670ms      24.499us           109  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.350ms         0.00%       2.350ms       4.368us           538  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.240ms         0.00%       2.240ms       5.138us           436  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.200ms         0.00%       2.200ms      20.185us           109  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.117ms         0.00%       2.117ms       5.428us           390  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     538.550us         0.00%       7.247ms      45.296us       0.000us         0.00%       2.051ms      12.818us           160  
                                         SliceBackward0         0.00%     475.366us         0.00%       6.709ms      41.930us       0.000us         0.00%       2.051ms      12.818us           160  
                                   aten::slice_backward         0.00%     941.690us         0.00%       6.233ms      38.959us       0.000us         0.00%       2.051ms      12.818us           160  
                                              aten::div         0.00%       7.744ms         0.01%      10.457ms      15.748us       2.026ms         0.00%       2.026ms       3.052us           664  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.949ms         0.00%       1.949ms      10.150us           192  
                                     hipExtLaunchKernel         0.06%      95.056ms         0.06%      95.083ms       9.477us       0.000us         0.00%       1.693ms       0.169us         10033  
                                             _LayerNorm         0.00%       4.397ms         0.00%       7.950ms      99.371us       1.649ms         0.00%       1.649ms      20.607us            80  
                                               aten::lt         0.01%      15.670ms         0.01%      18.063ms      25.088us       1.642ms         0.00%       1.642ms       2.281us           720  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.617ms         0.00%       1.617ms      14.839us           109  
      autograd::engine::evaluate_function: MulBackward0         0.01%       9.146ms         0.03%      43.394ms     252.291us       0.000us         0.00%       1.548ms       9.002us           172  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.501ms         0.00%       1.501ms       4.751us           316  
          OutputGraph.call_user_compiler (dynamo_timed)         0.01%      24.296ms         1.42%        2.357s     235.749ms       0.000us         0.00%       1.485ms     148.469us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.26%     428.671ms         1.40%        2.333s     233.319ms       0.000us         0.00%       1.485ms     148.469us            10  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.474ms         0.00%       1.474ms       6.142us           240  
                                        SelectBackward0         0.00%     221.621us         0.00%       2.734ms      34.172us       0.000us         0.00%       1.409ms      17.617us            80  
                                  aten::select_backward         0.00%     448.912us         0.00%       2.512ms      31.402us       0.000us         0.00%       1.409ms      17.617us            80  
                               aten::cross_entropy_loss         0.00%       1.235ms         0.01%      15.229ms      63.452us       0.000us         0.00%       1.357ms       5.653us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.183ms         0.00%       1.183ms       6.294us           188  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.121ms         0.00%       1.121ms       5.143us           218  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.097ms         0.00%       1.097ms      13.716us            80  
                                           aten::__or__         0.00%       1.104ms         0.01%      16.856ms      35.116us       0.000us         0.00%       1.088ms       2.266us           480  
                                       aten::bitwise_or         0.00%       6.837ms         0.01%      15.752ms      32.816us       1.088ms         0.00%       1.088ms       2.266us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.088ms         0.00%       1.088ms       4.989us           218  
                                   hipFuncGetAttributes         0.17%     282.448ms         0.17%     282.448ms       2.140ms       1.084ms         0.00%       1.084ms       8.215us           132  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.081ms         0.00%       1.081ms       4.958us           218  
                                               aten::ge         0.00%       5.674ms         0.00%       6.686ms      13.928us       1.080ms         0.00%       1.080ms       2.251us           480  
                                           MulBackward0         0.00%       6.346ms         0.02%      25.449ms     147.957us       0.000us         0.00%       1.028ms       5.975us           172  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.367ms         0.00%       8.032ms     100.406us       0.000us         0.00%       1.020ms      12.745us            80  
                                       NllLossBackward0         0.00%     720.286us         0.00%       6.666ms      83.319us       0.000us         0.00%       1.020ms      12.745us            80  
                                aten::nll_loss_backward         0.00%       2.360ms         0.00%       5.945ms      74.316us     507.122us         0.00%       1.020ms      12.745us            80  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.411ms         0.00%       6.419ms      40.117us       0.000us         0.00%       1.008ms       6.303us           160  
                                           DivBackward0         0.00%     932.348us         0.00%       5.008ms      31.298us       0.000us         0.00%       1.008ms       6.303us           160  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.000ms         0.00%       1.000ms       2.071us           483  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us     948.668us         0.00%     948.668us       5.929us           160  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     824.184us         0.00%     824.184us       7.561us           109  
                                                hipFree         0.07%     109.391ms         0.07%     109.461ms       6.081ms     767.648us         0.00%     767.648us      42.647us            18  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     748.123us         0.00%     748.123us       9.352us            80  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     747.119us         0.00%     747.119us       9.339us            80  
                                             aten::tanh         0.01%      10.444ms         0.01%      18.789ms      69.333us     702.781us         0.00%     702.781us       2.593us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     702.781us         0.00%     702.781us       6.448us           109  
                                      aten::log_softmax         0.00%     877.408us         0.00%       4.872ms      20.299us       0.000us         0.00%     701.859us       2.924us           240  
                                     aten::_log_softmax         0.00%       2.967ms         0.00%       3.901ms      16.255us     701.859us         0.00%     701.859us       2.924us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     701.859us         0.00%     701.859us       6.499us           108  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     688.984us         0.00%     688.984us       2.871us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     688.555us         0.00%     688.555us       6.317us           109  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     687.223us         0.00%     687.223us       8.590us            80  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     678.799us         0.00%     678.799us       8.485us            80  
                                      aten::nll_loss_nd         0.00%     719.613us         0.01%       9.118ms      37.992us       0.000us         0.00%     654.745us       2.728us           240  
                                         aten::nll_loss         0.00%     681.143us         0.01%       8.399ms      34.994us       0.000us         0.00%     654.745us       2.728us           240  
                                 aten::nll_loss_forward         0.00%       3.465ms         0.00%       7.714ms      32.143us     654.745us         0.00%     654.745us       2.728us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     654.745us         0.00%     654.745us       6.062us           108  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     649.410us         0.00%     649.410us       2.672us           243  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     638.750us         0.00%     638.750us       5.914us           108  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     604.310us         0.00%     604.310us       2.487us           243  
                                        hipLaunchKernel         0.67%        1.117s         0.67%        1.117s       7.185us     494.498us         0.00%     587.932us       0.004us        155491  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      12.820ms         0.97%        1.620s     161.974ms       0.000us         0.00%     585.600us      58.560us            10  
                        compile_fx_inner (dynamo_timed)         0.04%      60.387ms         1.18%        1.964s     178.583ms       0.000us         0.00%     585.600us      53.236us            11  
                                             aten::item         0.01%      24.954ms         0.46%     761.088ms      45.306us       0.000us         0.00%     581.552us       0.035us         16799  
                              aten::_local_scalar_dense         0.01%      11.605ms         0.44%     736.115ms      43.819us     581.552us         0.00%     581.552us       0.035us         16799  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     578.329us         0.00%     578.329us       2.410us           240  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     575.488us         0.00%     575.488us       7.194us            80  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       4.492ms         0.01%       8.717ms      54.481us     551.588us         0.00%     551.588us       3.447us           160  
                                  hipDeviceGetAttribute         0.00%     217.188us         0.00%     217.188us       3.242us     541.036us         0.00%     541.036us       8.075us            67  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     537.318us         0.00%     537.318us       6.716us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     537.152us         0.00%     537.152us       6.714us            80  
                                             aten::rsub         0.00%       2.885ms         0.00%       8.243ms      95.851us       0.000us         0.00%     536.155us       6.234us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     536.155us         0.00%     536.155us       6.702us            80  
                                          aten::normal_         0.64%        1.060s         0.64%        1.061s      10.205ms     521.242us         0.00%     521.242us       5.012us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     521.242us         0.00%     521.242us       5.374us            97  
                                               aten::gt         0.02%      35.083ms         0.02%      41.377ms       9.532us     509.048us         0.00%     509.048us       0.117us          4341  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     507.122us         0.00%     507.122us       6.339us            80  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     506.401us         0.00%     506.401us       2.093us           242  
                                        aten::ones_like         0.00%     460.965us         0.00%       1.863ms      23.289us       0.000us         0.00%     503.152us       6.289us            80  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     570.873us         0.00%       4.122ms      51.531us       0.000us         0.00%     499.313us       6.241us            80  
                                    LogSoftmaxBackward0         0.00%     827.085us         0.00%       3.552ms      44.395us       0.000us         0.00%     499.313us       6.241us            80  
                       aten::_log_softmax_backward_data         0.00%       1.775ms         0.00%       2.725ms      34.057us     499.313us         0.00%     499.313us       6.241us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     499.313us         0.00%     499.313us       6.241us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.004ms         0.01%      19.850ms     242.079us       0.000us         0.00%     497.461us       6.067us            82  
                                          TanhBackward0         0.00%       1.698ms         0.01%      18.847ms     229.839us       0.000us         0.00%     497.461us       6.067us            82  
                                    aten::tanh_backward         0.00%       2.416ms         0.01%      15.192ms     185.266us     497.461us         0.00%     497.461us       6.067us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     497.461us         0.00%     497.461us       6.218us            80  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     482.189us         0.00%     482.189us       4.424us           109  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     455.289us         0.00%     455.289us       1.874us           243  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     435.641us         0.00%     435.641us       1.815us           240  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     372.657us         0.00%     372.657us       1.553us           240  
                                              aten::log         0.00%       2.615ms         0.00%       6.860ms      28.582us     343.190us         0.00%     343.190us       1.430us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     343.190us         0.00%     343.190us       3.178us           108  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     291.909us         0.00%     291.909us       1.824us           160  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     284.770us         0.00%     284.770us       3.560us            80  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     204.870us         0.00%     204.870us       2.179us            94  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     202.505us         0.00%     202.505us       3.491us            58  
                                             aten::rand         0.00%       1.763ms         0.00%       4.855ms     346.755us       0.000us         0.00%     145.746us      10.410us            14  
                                         aten::uniform_         0.01%       8.799ms         0.01%      10.798ms     830.591us     145.746us         0.00%     145.746us      11.211us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     145.746us         0.00%     145.746us      29.149us             5  
                                   hipDeviceSynchronize         0.00%     519.415us         0.00%     519.415us      15.277us     102.036us         0.00%     102.036us       3.001us            34  
                                           aten::select         0.17%     282.924ms         0.21%     344.616ms       3.521us       0.000us         0.00%      71.164us       0.001us         97887  
                                       aten::lift_fresh         0.02%      37.063ms         0.02%      41.279ms      23.374us       0.000us         0.00%      54.123us       0.031us          1766  
         GraphLowering.compile_to_module (dynamo_timed)         0.53%     880.009ms         1.03%        1.716s     156.018ms       0.000us         0.00%      47.380us       4.307us            11  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      37.046us         0.00%      37.046us       3.705us            10  
                                    hipFuncSetAttribute         0.00%       9.333us         0.00%       9.333us       0.389us      36.363us         0.00%      36.363us       1.515us            24  
                            hipGetDevicePropertiesR0000         0.00%      37.229us         0.00%      37.229us       3.723us      32.906us         0.00%      32.906us       3.291us            10  
                       Scheduler.codegen (dynamo_timed)         0.05%      90.552ms         0.05%      90.572ms       8.234ms       0.000us         0.00%      25.970us       2.361us            11  
                               hipExtModuleLaunchKernel         0.14%     227.925ms         0.14%     227.948ms       5.713us       0.000us         0.00%      23.053us       0.001us         39902  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      22.971us         0.00%      22.971us       2.297us            10  
                                       aten::reciprocal         0.00%     149.437us         0.01%       8.589ms     858.895us      21.769us         0.00%      21.769us       2.177us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      21.769us         0.00%      21.769us       2.177us            10  
                                          aten::maximum         0.00%     112.213us         0.01%      16.500ms       1.833ms      20.448us         0.00%      20.448us       2.272us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      20.448us         0.00%      20.448us       2.272us             9  
                                          hipHostMalloc         0.07%     120.641ms         0.07%     120.666ms       3.657ms       0.000us         0.00%      15.916us       0.482us            33  
                                              aten::min         0.00%      88.824us         0.00%       3.435ms     686.943us      15.636us         0.00%      15.636us       3.127us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.636us         0.00%      15.636us       5.212us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.431us         0.00%      13.431us       4.477us             3  
                                              aten::all         0.03%      57.406ms         0.04%      65.902ms      11.252us       0.000us         0.00%       8.219us       0.001us          5857  
                                                aten::t         0.00%       4.429ms         0.01%      10.468ms       4.663us       0.000us         0.00%       5.934us       0.003us          2245  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.647us         0.00%       2.647us       2.647us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.165us         0.00%       2.165us       2.165us             1  
                                            aten::empty         0.40%     657.592ms         0.40%     662.025ms       2.521us       0.000us         0.00%       0.000us       0.000us        262555  
                        hipDeviceGetStreamPriorityRange         0.00%       2.821us         0.00%       2.821us       2.821us       0.000us         0.00%       0.000us       0.000us             1  
                                              hipMalloc         0.01%      14.678ms         0.01%      14.678ms      89.502us       0.000us         0.00%       0.000us       0.000us           164  
                            hipStreamCreateWithPriority         0.00%     520.511us         0.00%     520.511us      86.752us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0     875.990ms      51.991us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      10.923ms         0.01%      10.923ms       1.088us       0.000us         0.00%       0.000us       0.000us         10035  
                               TorchDynamo Cache Lookup         0.09%     155.870ms         0.09%     155.873ms       8.110us       0.000us         0.00%       0.000us       0.000us         19221  
                                    aten::empty_strided         0.15%     252.038ms         0.16%     258.848ms       2.920us       0.000us         0.00%       0.000us       0.000us         88647  
                                           aten::detach         0.03%      52.434ms         0.09%     156.753ms       4.419us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.05%      83.239ms         0.06%      99.553ms       2.943us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.00%       7.147ms         0.01%      12.770ms     102.986us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.03%      52.850ms         0.04%      70.422ms       1.944us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     222.241us         0.00%     291.332us      36.416us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.11%     186.464ms         0.11%     186.674ms       0.555us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%     871.368us         0.00%       1.262ms      66.426us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     398.643us         0.00%     814.452us      19.392us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     632.415us         0.00%     861.530us      61.538us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%      87.966us         0.00%     119.670us      59.835us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       2.784ms         0.00%       5.718ms     150.472us       0.000us         0.00%       0.000us       0.000us            38  
                                             aten::view         0.14%     226.800ms         0.14%     231.801ms       1.603us       0.000us         0.00%       0.000us       0.000us        144633  
                                         prims::view_of         0.00%     419.172us         0.00%     533.109us      22.213us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       4.431ms         0.00%       4.508ms       4.701us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       6.197ms         0.00%       7.122ms       8.825us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%     925.326us         0.00%     925.326us       1.147us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     280.843us         0.00%     280.843us       9.059us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%      77.150us         0.00%      77.150us       7.014us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%       8.501ms         0.01%      18.243ms      71.262us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     667.987us         0.00%     667.987us       2.609us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     196.602us         0.00%     275.974us      91.991us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%      82.805us         0.00%      82.805us      41.402us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     110.084us         0.00%     118.491us      59.246us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      24.859us         0.00%      24.859us       1.776us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%     938.239us         0.00%       1.835ms     366.978us       0.000us         0.00%       0.000us       0.000us             5  
                                            aten::slice         0.04%      71.403ms         0.05%      84.732ms       3.244us       0.000us         0.00%       0.000us       0.000us         26118  
                                        aten::index_add         0.00%     196.644us         0.00%       1.137ms       1.137ms       0.000us         0.00%       0.000us       0.000us             1  
                                       aten::empty_like         0.09%     142.715ms         0.24%     405.818ms       4.563us       0.000us         0.00%       0.000us       0.000us         88930  
                                        aten::new_empty         0.00%     360.955us         0.00%     412.069us     206.035us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     189.302us         0.00%     189.302us     189.302us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.09%     148.843ms         0.09%     150.894ms      13.718ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.07%     114.965ms         0.07%     114.991ms      10.454ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.00%       6.178ms         0.00%       6.178ms     561.648us       0.000us         0.00%       0.000us       0.000us            11  
                                    hipModuleLoadDataEx         0.38%     632.251ms         0.38%     632.251ms      52.688ms       0.000us         0.00%       0.000us       0.000us            12  
                                    hipFuncGetAttribute         0.00%       4.793us         0.00%       4.793us       0.399us       0.000us         0.00%       0.000us       0.000us            12  
                                 hipPointerGetAttribute         0.02%      38.599ms         0.02%      38.599ms       0.608us       0.000us         0.00%       0.000us       0.000us         63437  
                                        aten::expand_as         0.00%     915.423us         0.00%       3.179ms       5.855us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.222ms         0.00%       4.348ms     395.239us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     100.664us         0.00%     114.925us      57.463us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     104.706us         0.00%     104.706us      52.353us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      60.547us         0.00%      76.202us      76.202us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     263.031us         0.00%       2.320ms     773.215us       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     187.300us         0.00%     210.120us      70.040us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.037ms         0.00%       3.175ms     529.120us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%     675.072us         0.00%       3.292ms     365.756us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%     987.415us         0.00%       2.187ms     364.457us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     257.923us         0.00%     673.613us     224.538us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     167.714us         0.00%     883.972us     294.657us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     359.878us         0.00%     716.258us     238.753us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     309.169us         0.00%     323.071us      80.768us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.05%      82.041ms         0.05%      82.294ms       2.375us       0.000us         0.00%       0.000us       0.000us         34655  
                                               aten::eq         0.02%      31.608ms         0.02%      31.608ms       5.397us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       2.902ms         0.00%       2.902ms       0.118us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     711.487us      50.820us       0.000us         0.00%       0.000us       0.000us            14  
                                        aten::transpose         0.12%     199.073ms         0.15%     245.388ms       2.575us       0.000us         0.00%       0.000us       0.000us         95285  
                                          aten::reshape         0.05%      85.264ms         0.09%     149.294ms       3.455us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      64.519ms     134.136us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.01%       8.612ms         0.01%      19.497ms       4.779us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.00%       8.012ms         0.02%      27.517ms      10.423us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.01%      24.039ms         0.02%      29.355ms       3.988us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.076ms         0.00%       2.310ms       3.209us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      27.079ms         0.02%      32.150ms       4.019us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.239us         0.00%       1.239us       0.206us       0.000us         0.00%       0.000us       0.000us             6  
                              hipDevicePrimaryCtxRetain         0.00%       1.564us         0.00%       1.564us       0.261us       0.000us         0.00%       0.000us       0.000us             6  
                             hipDevicePrimaryCtxRelease         0.00%       0.982us         0.00%       0.982us       0.164us       0.000us         0.00%       0.000us       0.000us             6  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.02%      37.663ms         0.02%      37.663ms       2.033us       0.000us         0.00%       0.000us       0.000us         18528  
                                              hipMemset         0.00%      25.788us         0.00%      25.788us      12.894us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.21%     342.479ms         0.21%     342.479ms     114.160ms       0.000us         0.00%       0.000us       0.000us             3  
                                         _SplitAlongDim         0.07%     108.858ms         0.09%     157.095ms      27.274us       0.000us         0.00%       0.000us       0.000us          5760  
                                 aten::split_with_sizes         0.02%      37.596ms         0.03%      48.229ms       8.373us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      25.053ms         0.02%      25.053ms       1.631us       0.000us         0.00%       0.000us       0.000us         15360  
                                          aten::squeeze         0.03%      53.888ms         0.04%      64.181ms       2.786us       0.000us         0.00%       0.000us       0.000us         23040  
                                      hipModuleLoadData         0.24%     402.079ms         0.24%     402.079ms     100.520ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     500.676us         0.00%       1.166ms     291.547us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       4.620ms         0.00%       5.497ms      22.906us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     680.079us         0.00%     680.079us       2.125us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      31.717ms         0.06%      92.349ms       5.890us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      15.024ms         0.04%      60.632ms       3.867us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     350.150us         0.00%       1.837ms      22.965us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%     716.140us         0.00%       1.487ms      18.588us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      44.159ms         0.06%     105.096ms       4.939us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      15.950ms         0.04%      60.937ms       2.864us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      33.030ms         0.04%      74.067ms       3.066us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%     907.096us         0.00%       2.371ms       9.878us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     348.674us         0.00%       1.464ms       6.098us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     284.657us         0.00%     813.425us      10.168us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     528.768us         0.00%     528.768us       6.610us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     912.041us         0.22%     358.406ms     358.406ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      14.732ms         0.01%      16.668ms       2.170us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       1.936ms         0.00%       1.936ms       0.252us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       4.151ms         0.01%      15.911ms       7.955us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       3.362ms         0.01%      11.759ms       5.880us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       3.642ms         0.01%      10.010ms       5.214us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       1.731ms         0.00%       6.368ms       3.317us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     274.098us         0.00%     274.098us       0.143us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.043ms         0.00%       2.647ms      33.081us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.604ms         0.00%       1.604ms      20.046us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.385ms         0.00%       2.223ms      27.786us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       1.934ms     193.431us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      12.817us         0.00%      26.027us       6.507us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 166.411s
Self CUDA time total: 155.224s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       76.541s        49.69%       76.541s       76.541s             1  
                                             bert_train        35.85%       59.463s        70.11%      116.300s      116.300s       0.000us         0.00%       40.996s       40.996s             1  
                                            aten::copy_        14.43%       23.938s        17.35%       28.775s     365.101us       16.671s        10.82%       16.736s     212.348us         78815  
                                     record_param_comms         4.04%        6.701s         5.44%        9.030s     260.130us        8.807s         5.72%       13.069s     376.487us         34714  
                                               aten::to         0.03%      55.095ms        17.31%       28.719s     547.143us       0.000us         0.00%       12.156s     231.598us         52489  
                                         aten::_to_copy         0.10%     162.542ms        17.28%       28.664s     661.296us       0.000us         0.00%       12.156s     280.455us         43345  
                                      aten::masked_fill         0.04%      63.158ms         0.24%     391.744ms      40.807us       0.000us         0.00%       11.717s       1.220ms          9600  
                                     aten::masked_fill_         0.10%     165.091ms         0.21%     349.022ms      21.282us       10.884s         7.07%       10.884s     663.654us         16400  
                                       c10d::allreduce_         0.22%     369.429ms         2.47%        4.104s     244.133us       0.000us         0.00%        9.045s     538.062us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        8.776s         5.70%        8.776s     901.372us          9736  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        8.683s         5.64%        8.683s     883.282us          9830  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      14.168ms         0.09%     156.852ms      40.847us       0.000us         0.00%        7.678s       1.999ms          3840  
                                    MaskedFillBackward0         0.00%       5.846ms         0.09%     142.684ms      37.157us       0.000us         0.00%        7.678s       1.999ms          3840  
                                              aten::bmm         0.24%     402.764ms         0.29%     486.133ms      36.171us        7.098s         4.61%        7.102s     528.405us         13440  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       6.404ms         0.04%      59.574ms      31.028us       0.000us         0.00%        6.470s       3.370ms          1920  
                                       SoftmaxBackward0         0.00%       5.683ms         0.03%      53.170ms      27.693us       0.000us         0.00%        6.470s       3.370ms          1920  
                           aten::_softmax_backward_data         0.01%      15.419ms         0.03%      47.487ms      24.733us        3.341s         2.17%        6.470s       3.370ms          1920  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.378s         4.14%        6.378s       1.401ms          4553  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.206s         4.03%        6.206s     748.399us          8293  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.779s         3.75%        5.779s       1.224ms          4723  
autograd::engine::evaluate_function: _LayerNormLinea...         0.04%      71.227ms         1.88%        3.118s     811.858us       0.000us         0.00%        5.682s       1.480ms          3840  
                               _LayerNormLinearBackward         1.07%        1.780s         1.81%        2.996s     780.116us     311.127ms         0.20%        5.543s       1.444ms          3840  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      10.956ms         0.04%      74.249ms      18.941us       0.000us         0.00%        5.012s       1.279ms          3920  
                                        ToCopyBackward0         0.00%       5.338ms         0.04%      63.293ms      16.146us       0.000us         0.00%        5.012s       1.279ms          3920  
                                            aten::clone         0.06%     105.223ms         0.41%     685.219ms      19.835us       0.000us         0.00%        4.578s     132.517us         34546  
                                          aten::softmax         0.01%      10.857ms         0.08%     127.397ms      22.118us       0.000us         0.00%        4.512s     783.255us          5760  
                                         aten::_softmax         0.04%      72.797ms         0.07%     116.540ms      20.233us        4.512s         2.93%        4.512s     783.255us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.512s         2.93%        4.512s       1.713ms          2633  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.504s         2.92%        4.504s     949.581us          4743  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.482s         2.91%        4.482s     552.099us          8119  
                                     tex_ts::te_gemm_ts         1.13%        1.879s         1.64%        2.726s      70.989us        4.130s         2.68%        4.142s     107.860us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.831s         2.49%        3.831s     841.482us          4553  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.570s         2.32%        3.570s     309.939us         11520  
                                                _Linear         0.76%        1.265s         1.29%        2.138s     556.667us      64.868ms         0.04%        3.528s     918.671us          3840  
                                          c10d::barrier         0.00%     779.987us         2.07%        3.430s      90.254ms       0.000us         0.00%        3.351s      88.197ms            38  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.341s         2.17%        3.341s       1.740ms          1920  
                                              aten::mul         0.08%     126.844ms         0.11%     183.182ms      22.981us        3.157s         2.05%        3.157s     396.118us          7971  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.131s         2.03%        3.131s       1.425ms          2198  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      13.351ms         0.10%     163.209ms      85.005us       0.000us         0.00%        3.073s       1.601ms          1920  
                                       BaddbmmBackward0         0.01%      14.748ms         0.09%     149.858ms      78.051us       0.000us         0.00%        3.073s       1.601ms          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.893s         1.23%        1.893s     406.038us          4662  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      16.273ms         0.10%     165.320ms      86.104us       0.000us         0.00%        1.764s     918.548us          1920  
                                           BmmBackward0         0.01%      10.477ms         0.09%     149.046ms      77.628us       0.000us         0.00%        1.764s     918.548us          1920  
                                       aten::logical_or         0.06%     104.127ms         0.18%     306.621ms      26.616us     842.342ms         0.55%        1.685s     146.247us         11520  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      29.584ms         0.98%        1.630s     424.495us       0.000us         0.00%        1.575s     410.263us          3840  
                                        _LinearBackward         0.71%        1.170s         0.96%        1.600s     416.791us      75.770ms         0.05%        1.575s     410.263us          3840  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.503s         0.98%        1.503s     783.032us          1920  
                                              aten::sub         0.06%      96.267ms         0.07%     124.097ms      18.888us        1.489s         0.97%        1.490s     226.736us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.487s         0.97%        1.487s     564.764us          2633  
                                          aten::dropout         0.01%       9.672ms         0.06%      93.454ms      15.537us       0.000us         0.00%        1.430s     237.821us          6015  
                                   aten::native_dropout         0.02%      33.784ms         0.05%      79.032ms      39.339us        1.430s         0.93%        1.430s     712.043us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.430s         0.93%        1.430s     715.247us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%       8.946ms         0.03%      53.737ms      26.828us       0.000us         0.00%        1.381s     689.284us          2003  
                                 NativeDropoutBackward0         0.00%       5.514ms         0.03%      44.791ms      22.362us       0.000us         0.00%        1.381s     689.284us          2003  
                          aten::native_dropout_backward         0.01%      14.846ms         0.02%      39.277ms      19.609us        1.381s         0.90%        1.381s     689.284us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.381s         0.90%        1.381s     690.318us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.342s         0.87%        1.342s      76.626us         17517  
                                   hipStreamIsCapturing         0.03%      44.891ms         0.03%      44.891ms       0.864us        1.241s         0.81%        1.241s      23.882us         51978  
                                          aten::baddbmm         0.20%     334.060ms         0.40%     668.306ms     116.025us        1.207s         0.78%        1.208s     209.642us          5760  
                                   hipDeviceGetPCIBusId         0.01%      11.875ms         0.01%      11.875ms       0.821us        1.158s         0.75%        1.158s      80.048us         14463  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.118s         0.73%        1.118s     582.519us          1920  
                                         hipMemsetAsync         0.07%     112.370ms         0.07%     112.383ms       9.298us        1.063s         0.69%        1.064s      88.068us         12087  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      18.193ms         0.54%     888.565ms     231.397us       0.000us         0.00%     976.630ms     254.331us          3840  
                               CompiledFunctionBackward         0.24%     391.802ms         0.52%     870.372ms     226.659us       0.000us         0.00%     976.630ms     254.331us          3840  
                                 triton_red_fused_sum_1         0.02%      27.922ms         0.03%      47.820ms      12.453us     883.004ms         0.57%     883.004ms     229.949us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     842.342ms         0.55%     842.342ms     319.917us          2633  
                               hipStreamCreateWithFlags         0.17%     286.945ms         0.17%     286.945ms     105.417us     697.607ms         0.45%     697.607ms     256.285us          2722  
                                      aten::logical_not         0.08%     138.489ms         0.25%     407.218ms      17.674us     319.322ms         0.21%     639.267ms      27.746us         23040  
                                        hipEventDestroy         0.03%      47.598ms         0.03%      48.206ms       2.366us     624.047ms         0.41%     628.138ms      30.824us         20378  
                                       c10d::broadcast_         0.03%      42.544ms         0.50%     829.125ms       1.724ms       0.000us         0.00%     554.165ms       1.152ms           481  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.466ms         0.00%       2.466ms       0.172us     518.153ms         0.34%     518.153ms      36.245us         14296  
                                  Torch-Compiled Region         0.48%     802.260ms         1.46%        2.417s     125.747us       0.000us         0.00%     397.443ms      20.679us         19220  
                                      hipGetProcAddress         0.04%      58.086ms         0.04%      58.086ms       0.843us     377.238ms         0.24%     377.238ms       5.477us         68874  
                                       hipCtxGetCurrent         0.00%       7.303ms         0.00%       7.303ms       0.145us     347.755ms         0.23%     347.755ms       6.925us         50214  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     319.322ms         0.21%     319.322ms      60.638us          5266  
                                             aten::add_         0.08%     128.262ms         0.15%     252.760ms       8.045us     300.775ms         0.20%     300.775ms       9.573us         31420  
                                       _LayerNormLinear         0.31%     520.501ms         0.86%        1.420s     369.858us     166.256ms         0.11%     292.642ms      76.209us          3840  
                                       CompiledFunction         0.59%     973.210ms         0.85%        1.410s     122.169us       0.000us         0.00%     283.528ms      24.569us         11540  
                                              aten::sum         0.20%     336.721ms         0.44%     724.964ms      35.620us     203.599ms         0.13%     266.352ms      13.087us         20353  
                                   hipStreamSynchronize         0.44%     733.398ms         0.44%     733.510ms     225.210us     256.313ms         0.17%     256.485ms      78.749us          3257  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     255.926ms         0.17%     255.926ms      66.648us          3840  
                  triton_poi_fused_add_native_dropout_0         0.04%      67.690ms         0.06%     103.968ms      27.005us     212.730ms         0.14%     212.743ms      55.258us          3850  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     194.136ms         0.13%     194.136ms      36.866us          5266  
                         _ReduceFromModelParallelRegion         0.01%      19.641ms         0.04%      60.053ms     250.221us       0.000us         0.00%     174.852ms     728.550us           240  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     168.271ms         0.11%     168.271ms     168.271ms             1  
autograd::engine::evaluate_function: torch::autograd...         0.15%     249.785ms         0.31%     509.824ms      21.102us       0.000us         0.00%     161.768ms       6.696us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     160.293ms         0.10%     160.293ms       6.701us         23920  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     150.605ms         0.10%     150.605ms      28.605us          5265  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     147.927ms         0.10%     147.927ms      33.168us          4460  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.01%      20.621ms         0.40%     666.677ms     347.227us       0.000us         0.00%     147.620ms      76.885us          1920  
                                  hipExtMallocWithFlags         0.03%      41.719ms         0.03%      41.719ms       9.707us     145.251ms         0.09%     145.251ms      33.795us          4298  
                             _VocabParallelCrossEntropy         0.04%      62.924ms         0.15%     242.238ms       1.009ms       0.000us         0.00%     141.329ms     588.870us           240  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.840ms         0.08%     125.402ms       1.568ms       0.000us         0.00%     134.062ms       1.676ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      22.440ms         0.07%     123.562ms       1.545ms       0.000us         0.00%     134.062ms       1.676ms            80  
                                              aten::cat         0.08%     138.432ms         0.11%     181.826ms      22.503us     129.585ms         0.08%     129.700ms      16.052us          8080  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       5.946ms        24.90%       41.298s     172.076ms       0.000us         0.00%     129.597ms     539.989us           240  
                                     EmbeddingBackward0         0.00%       3.090ms        24.89%       41.291s     172.045ms       0.000us         0.00%     128.738ms     536.407us           240  
                               aten::embedding_backward         0.00%       2.796ms        24.89%       41.288s     172.032ms       0.000us         0.00%     128.738ms     536.407us           240  
                         aten::embedding_dense_backward         1.27%        2.099s        24.89%       41.285s     172.021ms     123.453ms         0.08%     128.738ms     536.407us           240  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     125.205ms         0.08%     125.205ms      31.940us          3920  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     122.012ms         0.08%     122.012ms     552.091us           221  
                                         hipMemcpyAsync         0.12%     203.296ms         0.12%     203.310ms      16.521us     120.584ms         0.08%     121.875ms       9.904us         12306  
                             c10d::allreduce_coalesced_         0.00%       1.635ms         0.06%      98.873ms       9.887ms       0.000us         0.00%     116.791ms      11.679ms            10  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      12.663ms         0.11%     183.323ms      95.481us       0.000us         0.00%     112.416ms      58.550us          1920  
                                 _SplitAlongDimBackward         0.08%     128.510ms         0.10%     170.659ms      88.885us       0.000us         0.00%     112.416ms      58.550us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     112.416ms         0.07%     112.416ms      58.550us          1920  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     107.598ms         0.07%     107.598ms      49.814us          2160  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     102.945ms         0.07%     102.945ms      17.872us          5760  
                                               aten::mm         0.03%      56.076ms         0.07%     110.111ms     125.126us     102.431ms         0.07%     102.431ms     116.398us           880  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     101.139ms         0.07%     101.139ms       9.505us         10641  
                                       aten::contiguous         0.01%      24.811ms         0.28%     469.328ms      20.370us       0.000us         0.00%      99.779ms       4.331us         23040  
             triton_poi_fused_native_dropout_backward_0         0.03%      50.665ms         0.05%      77.315ms      20.134us      93.626ms         0.06%      93.626ms      24.382us          3840  
                                           aten::matmul         0.00%       2.993ms         0.05%      81.774ms     204.435us       0.000us         0.00%      85.858ms     214.645us           400  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      83.114ms         0.05%      83.114ms      31.578us          2632  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us      78.217ms         0.05%      78.217ms      15.088us          5184  
                                    hipMemcpyWithStream        27.96%       46.383s        27.96%       46.388s      57.912ms       0.000us         0.00%      75.763ms      94.586us           801  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      74.183ms         0.05%      74.183ms       9.391us          7899  
                                           GeLUFunction         0.09%     148.039ms         0.56%     922.064ms     160.081us       0.000us         0.00%      72.129ms      12.522us          5760  
                        triton_poi_fused_add_mul_tanh_0         0.07%     110.372ms         0.08%     131.822ms      22.846us      70.263ms         0.05%      70.873ms      12.283us          5770  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      69.869ms         0.05%      69.869ms      26.536us          2633  
                                       hipStreamDestroy         0.03%      52.081ms         0.03%      52.081ms      19.275us      68.517ms         0.04%      68.517ms      25.358us          2702  
                                           aten::arange         0.08%     126.091ms         0.22%     369.942ms      15.014us      33.588ms         0.02%      67.293ms       2.731us         24640  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      65.961ms         0.04%      65.961ms     274.835us           240  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      64.976ms         0.04%      64.976ms      14.835us          4380  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      63.517ms         0.04%      63.517ms      16.203us          3920  
                                 hipDeviceCanAccessPeer         0.00%     414.317us         0.00%     414.317us       0.205us      62.008ms         0.04%      62.008ms      30.697us          2020  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      61.595ms         0.04%      61.595ms       5.101us         12075  
                                  hipModuleLaunchKernel         0.13%     210.477ms         0.13%     210.507ms       6.147us      61.208ms         0.04%      61.208ms       1.787us         34244  
                                     hipIpcGetMemHandle         0.01%      10.138ms         0.01%      10.138ms       5.642us      61.094ms         0.04%      61.094ms      33.998us          1797  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.20%     331.848ms         0.35%     588.847ms      76.673us      60.787ms         0.04%      60.797ms       7.916us          7680  
        LinearWithGradAccumulationAndAsyncCommunication         0.00%       6.654ms         0.01%      23.230ms      96.791us       0.000us         0.00%      52.335ms     218.064us           240  
                                    hipIpcOpenMemHandle         0.05%      88.879ms         0.05%      88.879ms      49.295us      48.800ms         0.03%      48.800ms      27.066us          1803  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      46.928ms         0.03%      46.928ms      12.221us          3840  
                                 triton_poi_fused_add_0         0.12%     196.228ms         0.13%     213.294ms      27.773us      40.834ms         0.03%      41.830ms       5.447us          7680  
                                   GeLUFunctionBackward         0.03%      42.717ms         0.35%     580.330ms     302.255us       0.000us         0.00%      41.793ms      21.767us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.01%      23.775ms         0.02%      37.872ms      19.725us      41.793ms         0.03%      41.793ms      21.767us          1920  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      36.872ms         0.02%      36.872ms      19.204us          1920  
                                     hipStreamWaitEvent         0.19%     314.846ms         0.19%     314.910ms      14.959us      36.426ms         0.02%      36.562ms       1.737us         21052  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      31.950ms         0.02%      31.950ms       6.067us          5266  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      31.156ms         0.02%      31.156ms       5.916us          5266  
                                            aten::fill_         0.07%     123.686ms         0.09%     153.372ms       5.304us      28.824ms         0.02%      28.824ms       0.997us         28919  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      28.498ms         0.02%      28.498ms      10.823us          2633  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      27.874ms         0.02%      27.874ms     174.213us           160  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      26.247ms         0.02%      26.247ms      40.820us           643  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      25.845ms         0.02%      25.845ms       6.730us          3840  
                                            aten::zero_         0.04%      65.603ms         0.13%     209.323ms       9.243us       0.000us         0.00%      25.203ms       1.113us         22646  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.455ms         0.03%      50.930ms     636.630us       0.000us         0.00%      25.024ms     312.794us            80  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.136ms         0.02%      24.136ms     301.694us            80  
                                              aten::exp         0.00%       2.536ms         0.01%      16.444ms      68.515us      24.008ms         0.02%      24.008ms     100.034us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      24.008ms         0.02%      24.008ms     220.259us           109  
                                            aten::zeros         0.04%      69.519ms         0.19%     313.353ms      13.985us       0.000us         0.00%      23.852ms       1.065us         22406  
                                          aten::randint         0.02%      30.586ms         0.07%     119.241ms      30.939us       0.000us         0.00%      23.590ms       6.121us          3854  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.982ms         0.03%      53.382ms     222.423us       0.000us         0.00%      23.113ms      96.304us           240  
                                          aten::random_         0.03%      49.064ms         0.05%      86.467ms      22.459us      20.965ms         0.01%      22.205ms       5.768us          3850  
                                              aten::add         0.04%      65.849ms         0.06%      92.080ms      51.557us      21.427ms         0.01%      21.427ms      11.997us          1786  
                                             aten::div_         0.00%       5.200ms         0.01%      10.659ms      22.207us      21.165ms         0.01%      21.165ms      44.095us           480  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      20.965ms         0.01%      20.965ms       5.445us          3850  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.532ms         0.01%      20.532ms     188.366us           109  
                                             aten::sub_         0.00%       4.398ms         0.00%       5.874ms      18.355us      20.239ms         0.01%      20.239ms      63.248us           320  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      20.231ms         0.01%      20.231ms      92.802us           218  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.752ms         0.01%      19.752ms     181.215us           109  
                                           aten::linear         0.00%       3.022ms         0.03%      51.403ms      71.394us       0.000us         0.00%      19.403ms      26.949us           720  
                                            aten::addmm         0.02%      36.819ms         0.03%      43.516ms      60.439us      19.386ms         0.01%      19.403ms      26.949us           720  
                                 tex_ts::cast_to_fp8_ts         0.08%     126.739ms         0.12%     193.922ms      25.250us      17.284ms         0.01%      17.290ms       2.251us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      17.284ms         0.01%      17.284ms      12.129us          1425  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      17.169ms         0.01%      17.169ms       5.916us          2902  
                                         AddmmBackward0         0.00%       3.185ms         0.02%      41.281ms     172.004us       0.000us         0.00%      16.572ms      69.052us           240  
                                        aten::embedding         0.00%       6.206ms         0.02%      27.405ms      38.063us       0.000us         0.00%      16.409ms      22.790us           720  
                                     aten::index_select         0.01%      11.553ms         0.01%      18.451ms      25.627us      16.409ms         0.01%      16.409ms      22.790us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.409ms         0.01%      16.409ms      49.724us           330  
                                           aten::cumsum         0.06%     100.016ms         0.08%     126.120ms      21.896us      15.970ms         0.01%      16.034ms       2.784us          5760  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      16.032ms         0.01%      16.032ms       6.089us          2633  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      16.020ms         0.01%      16.020ms       6.052us          2647  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      15.970ms         0.01%      15.970ms       6.065us          2633  
                     _VocabParallelCrossEntropyBackward         0.01%      18.322ms         0.03%      45.035ms     562.933us       0.000us         0.00%      15.152ms     189.399us            80  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      12.894ms         0.01%      12.894ms       6.716us          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.472ms         0.01%      12.472ms     114.420us           109  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.205ms         0.01%      12.205ms      76.282us           160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.012ms         0.01%      12.012ms     110.200us           109  
                                             aten::mul_         0.00%       6.585ms         0.00%       7.441ms       5.813us      11.727ms         0.01%      11.727ms       9.162us          1280  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      11.453ms         0.01%      11.453ms     105.076us           109  
                                       aten::index_put_         0.00%       5.122ms         0.08%     128.689ms     114.901us       0.000us         0.00%      10.697ms       9.551us          1120  
                                 aten::_index_put_impl_         0.00%       7.574ms         0.07%     123.565ms     110.325us     742.266us         0.00%      10.697ms       9.551us          1120  
                                            aten::index         0.01%      11.686ms         0.03%      58.040ms     102.363us       1.926ms         0.00%      10.600ms      18.695us           567  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.555ms         0.01%       9.555ms      39.811us           240  
                                              aten::max         0.00%       5.802ms         0.02%      27.346ms     107.663us       9.141ms         0.01%       9.164ms      36.079us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.127ms         0.01%       9.127ms      83.730us           109  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       8.992ms         0.01%       8.992ms      37.465us           240  
                                          aten::nonzero         0.00%       4.713ms         0.02%      32.179ms     131.342us       8.674ms         0.01%       8.674ms      35.406us           245  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.413ms         0.01%       8.413ms      19.704us           427  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.704ms         0.01%      14.653ms     183.157us       0.000us         0.00%       8.126ms     101.569us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.895ms         0.01%      11.949ms     149.362us       8.126ms         0.01%       8.126ms     101.569us            80  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.054ms         0.02%      28.488ms     356.097us       0.000us         0.00%       8.031ms     100.381us            80  
                            torch::autograd::CopySlices         0.00%       4.180ms         0.02%      26.434ms     330.423us       0.000us         0.00%       8.031ms     100.381us            80  
                           FusedLayerNormAffineFunction         0.01%      10.129ms         0.01%      17.441ms      72.670us       7.723ms         0.01%       7.723ms      32.180us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.723ms         0.01%       7.723ms      70.854us           109  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.272ms         0.00%       7.272ms      10.601us           686  
                            hipGetDevicePropertiesR0600         0.04%      69.194ms         0.04%      69.194ms       0.742us       6.881ms         0.00%       6.881ms       0.074us         93235  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.702ms         0.00%       6.702ms      83.770us            80  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     479.090us         0.00%       2.130ms     213.014us       6.235ms         0.00%       6.235ms     623.483us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.235ms         0.00%       6.235ms      56.680us           110  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       5.905ms         0.00%       5.905ms      24.606us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.532ms         0.00%       5.532ms       6.127us           903  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       4.984ms         0.00%       4.984ms       5.192us           960  
                                  hipMemGetAddressRange         0.00%     118.793us         0.00%     118.793us       0.265us       4.881ms         0.00%       4.881ms      10.871us           449  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       4.546ms         0.00%       4.546ms      28.411us           160  
                                        aten::index_put         0.00%       1.455ms         0.01%      11.281ms     135.911us       0.000us         0.00%       4.286ms      51.638us            83  
                                      IndexPutBackward0         0.00%       1.081ms         0.01%      11.978ms     149.730us       0.000us         0.00%       4.286ms      53.575us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       3.924ms         0.00%       3.924ms      49.045us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       3.713ms         0.00%       3.713ms      46.418us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     919.274us         0.01%      21.562ms     269.524us       0.000us         0.00%       3.546ms      44.324us            80  
                                     _LayerNormBackward         0.00%       5.171ms         0.01%      20.643ms     258.033us       3.546ms         0.00%       3.546ms      44.324us            80  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     829.374us         0.00%       3.358ms      41.971us       0.000us         0.00%       3.222ms      40.274us            80  
                                          GeluBackward0         0.00%     484.832us         0.00%       2.528ms      31.603us       0.000us         0.00%       3.222ms      40.274us            80  
                                    aten::gelu_backward         0.00%       1.332ms         0.00%       2.043ms      25.543us       3.222ms         0.00%       3.222ms      40.274us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.222ms         0.00%       3.222ms      40.274us            80  
                                             aten::ones         0.00%     902.854us         0.00%       5.702ms      11.880us       0.000us         0.00%       3.021ms       6.294us           480  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     687.608us         0.00%       4.582ms      57.271us       0.000us         0.00%       2.927ms      36.592us            80  
                                 c10d::_allgather_base_         0.00%     212.335us         0.00%       1.511ms     107.909us       0.000us         0.00%       2.770ms     197.832us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       2.770ms         0.00%       2.770ms     230.805us            12  
                                           aten::select         0.19%     322.012ms         0.24%     391.055ms       3.995us       0.000us         0.00%       2.604ms       0.027us         97887  
                                        hipLaunchKernel         0.75%        1.236s         0.75%        1.236s       7.915us       2.531ms         0.00%       2.592ms       0.017us        156165  
                                             aten::gelu         0.00%       3.289ms         0.00%       7.829ms      32.619us       2.564ms         0.00%       2.564ms      10.682us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.564ms         0.00%       2.564ms      23.521us           109  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.432ms         0.00%       2.432ms       4.511us           539  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.250ms         0.00%       2.250ms       5.136us           438  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.205ms         0.00%       2.205ms      20.227us           109  
                                  hipDeviceGetAttribute         0.00%     240.868us         0.00%     240.868us       3.595us       2.136ms         0.00%       2.136ms      31.886us            67  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.084ms         0.00%       2.084ms       5.316us           392  
                                              aten::div         0.01%       9.907ms         0.01%      13.059ms      19.667us       1.936ms         0.00%       1.936ms       2.916us           664  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.926ms         0.00%       1.926ms      10.031us           192  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     575.671us         0.00%       7.804ms      48.777us       0.000us         0.00%       1.896ms      11.851us           160  
                                         SliceBackward0         0.00%     496.703us         0.00%       7.229ms      45.179us       0.000us         0.00%       1.896ms      11.851us           160  
                                   aten::slice_backward         0.00%     978.463us         0.00%       6.732ms      42.075us       0.000us         0.00%       1.896ms      11.851us           160  
                                               aten::lt         0.01%      16.663ms         0.01%      19.386ms      26.925us       1.677ms         0.00%       1.677ms       2.329us           720  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.618ms         0.00%       1.618ms       6.740us           240  
                                             _LayerNorm         0.00%       4.402ms         0.00%       8.063ms     100.785us       1.595ms         0.00%       1.595ms      19.938us            80  
         _compile.<locals>.compile_inner (dynamo_timed)         0.07%     112.531ms         1.62%        2.689s     268.910ms       0.000us         0.00%       1.566ms     156.589us            10  
                                             aten::item         0.02%      26.534ms         0.44%     724.488ms      43.127us       0.000us         0.00%       1.563ms       0.093us         16799  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.546ms         0.00%       1.546ms      14.183us           109  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.447ms         0.00%       1.447ms       4.551us           318  
      autograd::engine::evaluate_function: MulBackward0         0.01%      10.073ms         0.03%      50.215ms     291.949us       0.000us         0.00%       1.417ms       8.238us           172  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.384ms         0.00%       1.384ms       2.866us           483  
                                        SelectBackward0         0.00%     221.779us         0.00%       2.862ms      35.779us       0.000us         0.00%       1.330ms      16.625us            80  
                                  aten::select_backward         0.00%     427.624us         0.00%       2.641ms      33.006us       0.000us         0.00%       1.330ms      16.625us            80  
                               TorchDynamo Cache Lookup         0.11%     175.884ms         0.11%     175.900ms       9.151us       0.000us         0.00%       1.298ms       0.068us         19221  
                               aten::cross_entropy_loss         0.00%       1.297ms         0.01%      16.628ms      69.281us       0.000us         0.00%       1.275ms       5.313us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.150ms         0.00%       1.150ms       5.252us           219  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.122ms         0.00%       1.122ms       5.939us           189  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.101ms         0.00%       1.101ms       5.028us           219  
                                               aten::ge         0.00%       6.180ms         0.00%       7.307ms      15.223us       1.100ms         0.00%       1.100ms       2.292us           480  
                                           aten::__or__         0.00%       1.155ms         0.01%      17.582ms      36.629us       0.000us         0.00%       1.085ms       2.261us           480  
                                       aten::bitwise_or         0.00%       7.465ms         0.01%      16.427ms      34.223us       1.085ms         0.00%       1.085ms       2.261us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.085ms         0.00%       1.085ms       4.956us           219  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      26.646ms         1.53%        2.540s     254.019ms       0.000us         0.00%       1.071ms     107.071us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.27%     449.113ms         1.52%        2.514s     251.354ms       0.000us         0.00%       1.071ms     107.071us            10  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.066ms         0.00%       1.066ms      13.320us            80  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.030ms         0.00%       1.030ms       6.438us           160  
                                               aten::eq         0.02%      37.381ms         0.02%      37.386ms       6.383us       0.000us         0.00%     953.184us       0.163us          5857  
                                           MulBackward0         0.00%       6.831ms         0.02%      29.529ms     171.680us       0.000us         0.00%     940.715us       5.469us           172  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.970ms         0.01%       8.978ms      56.112us       0.000us         0.00%     940.534us       5.878us           160  
                                           DivBackward0         0.00%       1.346ms         0.00%       7.008ms      43.799us       0.000us         0.00%     940.534us       5.878us           160  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.888ms         0.01%      10.782ms     134.779us       0.000us         0.00%     927.010us      11.588us            80  
                                       NllLossBackward0         0.00%     986.495us         0.01%       8.894ms     111.175us       0.000us         0.00%     927.010us      11.588us            80  
                                aten::nll_loss_backward         0.00%       3.379ms         0.00%       7.908ms      98.844us     461.024us         0.00%     927.010us      11.588us            80  
                                                hipFree         0.07%     109.141ms         0.07%     109.210ms       6.067ms     571.917us         0.00%     910.897us      50.605us            18  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     826.738us         0.00%     826.738us       3.402us           243  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     808.383us         0.00%     808.383us       7.416us           109  
                                   hipDeviceSynchronize         0.00%     566.746us         0.00%     566.746us      16.669us     769.571us         0.00%     769.571us      22.634us            34  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     742.266us         0.00%     742.266us       9.278us            80  
                                              aten::all         0.04%      68.119ms         0.05%      78.052ms      13.326us       0.000us         0.00%     741.016us       0.127us          5857  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     732.241us         0.00%     732.241us       3.051us           240  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     711.998us         0.00%     711.998us       8.900us            80  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     706.615us         0.00%     706.615us       2.944us           240  
                                             aten::tanh         0.01%      12.041ms         0.01%      20.729ms      76.490us     667.978us         0.00%     677.480us       2.500us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     667.978us         0.00%     667.978us       6.128us           109  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     660.636us         0.00%     660.636us       6.061us           109  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     653.463us         0.00%     653.463us       8.168us            80  
                                      aten::log_softmax         0.00%     987.184us         0.00%       5.528ms      23.032us       0.000us         0.00%     650.295us       2.710us           240  
                                     aten::_log_softmax         0.00%       3.336ms         0.00%       4.439ms      18.495us     650.295us         0.00%     650.295us       2.710us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     650.295us         0.00%     650.295us       5.966us           109  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     646.164us         0.00%     646.164us       8.077us            80  
                                       aten::empty_like         0.10%     167.109ms         0.29%     473.821ms       5.328us       0.000us         0.00%     644.604us       0.007us         88930  
                              aten::_local_scalar_dense         0.01%      12.686ms         0.42%     697.946ms      41.547us     638.312us         0.00%     638.312us       0.038us         16799  
                                        aten::transpose         0.14%     232.758ms         0.17%     286.738ms       3.009us       0.000us         0.00%     635.102us       0.007us         95285  
                                     hipExtLaunchKernel         0.06%      99.585ms         0.06%      99.609ms       9.881us       0.000us         0.00%     628.769us       0.062us         10081  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     626.166us         0.00%     626.166us       2.577us           243  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     625.001us         0.00%     625.001us       5.734us           109  
                                      aten::nll_loss_nd         0.00%     785.167us         0.01%       9.803ms      40.847us       0.000us         0.00%     624.798us       2.603us           240  
                                         aten::nll_loss         0.00%     735.880us         0.01%       9.018ms      37.575us       0.000us         0.00%     624.798us       2.603us           240  
                                 aten::nll_loss_forward         0.00%       3.915ms         0.00%       8.282ms      34.509us     624.798us         0.00%     624.798us       2.603us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     624.798us         0.00%     624.798us       5.732us           109  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       5.580ms         0.01%      10.946ms      68.413us     609.745us         0.00%     609.745us       3.811us           160  
                                          aten::normal_         0.64%        1.057s         0.64%        1.059s      10.182ms     609.639us         0.00%     609.639us       5.862us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     609.639us         0.00%     609.639us       6.285us            97  
                                          aten::permute         0.02%      30.966ms         0.02%      36.839ms       4.605us       0.000us         0.00%     597.937us       0.075us          8000  
                               hipExtModuleLaunchKernel         0.16%     261.261ms         0.16%     261.289ms       6.526us       0.000us         0.00%     580.656us       0.015us         40040  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     544.535us         0.00%     544.535us       2.241us           243  
                                    hipFuncSetAttribute         0.00%       9.044us         0.00%       9.044us       0.377us     531.583us         0.00%     531.583us      22.149us            24  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     527.577us         0.00%     527.577us       4.796us           110  
                                               aten::gt         0.02%      37.239ms         0.03%      43.532ms      10.028us     525.602us         0.00%     525.602us       0.121us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     523.036us         0.00%     523.036us       2.161us           242  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     488.447us         0.00%     488.447us       6.106us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     487.441us         0.00%     487.441us       6.093us            80  
                                             aten::rsub         0.00%       3.220ms         0.01%       9.314ms     108.297us       0.000us         0.00%     484.953us       5.639us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     484.953us         0.00%     484.953us       6.062us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     484.672us         0.00%     484.672us       6.058us            80  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     480.420us         0.00%     480.420us       2.002us           240  
                                        aten::ones_like         0.00%     479.545us         0.00%       1.979ms      24.732us       0.000us         0.00%     471.927us       5.899us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.072ms         0.01%      19.854ms     242.125us       0.000us         0.00%     471.168us       5.746us            82  
                                          TanhBackward0         0.00%       1.670ms         0.01%      18.783ms     229.055us       0.000us         0.00%     471.168us       5.746us            82  
                                    aten::tanh_backward         0.00%       2.471ms         0.01%      15.243ms     185.895us     471.168us         0.00%     471.168us       5.746us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     471.168us         0.00%     471.168us       5.890us            80  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     854.059us         0.00%       5.651ms      70.635us       0.000us         0.00%     471.041us       5.888us            80  
                                    LogSoftmaxBackward0         0.00%       1.374ms         0.00%       4.797ms      59.959us       0.000us         0.00%     471.041us       5.888us            80  
                       aten::_log_softmax_backward_data         0.00%       1.973ms         0.00%       3.422ms      42.780us     471.041us         0.00%     471.041us       5.888us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     471.041us         0.00%     471.041us       5.888us            80  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     461.024us         0.00%     461.024us       5.763us            80  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     424.548us         0.00%     424.548us       1.769us           240  
                                              aten::log         0.00%       3.173ms         0.00%       7.486ms      31.191us     361.952us         0.00%     361.952us       1.508us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     361.952us         0.00%     361.952us       3.321us           109  
                                             aten::view         0.16%     267.486ms         0.16%     273.190ms       1.889us       0.000us         0.00%     335.933us       0.002us        144633  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     297.492us         0.00%     297.492us       1.859us           160  
                                              hipMemcpy         0.01%      11.455ms         0.01%      11.455ms     238.656us     276.597us         0.00%     276.597us       5.762us            48  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     264.606us         0.00%     264.606us       3.308us            80  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     218.185us         0.00%     218.185us       2.321us            94  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     209.438us         0.00%     209.438us       3.611us            58  
                                             aten::rand         0.00%       1.794ms         0.00%       5.049ms     360.609us       0.000us         0.00%     150.356us      10.740us            14  
                                         aten::uniform_         0.01%       9.043ms         0.01%      11.198ms     861.399us     150.356us         0.00%     150.356us      11.566us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     150.356us         0.00%     150.356us      30.071us             5  
                                          hipHostMalloc         0.09%     157.292ms         0.09%     157.314ms       4.767ms      64.749us         0.00%      64.749us       1.962us            33  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      15.451ms         1.05%        1.746s     174.640ms       0.000us         0.00%      54.205us       5.420us            10  
                        compile_fx_inner (dynamo_timed)         0.04%      68.946ms         1.26%        2.083s     189.408ms       0.000us         0.00%      54.205us       4.928us            11  
                                       aten::lift_fresh         0.03%      43.562ms         0.03%      48.495ms      27.460us       0.000us         0.00%      51.401us       0.029us          1766  
                                          aten::squeeze         0.04%      65.252ms         0.05%      78.128ms       3.391us       0.000us         0.00%      39.450us       0.002us         23040  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      35.922us         0.00%      35.922us       3.592us            10  
         GraphLowering.compile_to_module (dynamo_timed)         0.56%     934.202ms         1.08%        1.796s     163.237ms       0.000us         0.00%      31.312us       2.847us            11  
                                    hipFuncGetAttribute         0.00%       5.206us         0.00%       5.206us       0.434us      25.459us         0.00%      25.459us       2.122us            12  
                                          aten::maximum         0.00%     113.193us         0.01%      16.580ms       1.842ms      23.053us         0.00%      23.053us       2.561us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.053us         0.00%      23.053us       2.561us             9  
                                   hipFuncGetAttributes         0.13%     219.096ms         0.13%     219.096ms       1.660ms      22.209us         0.00%      22.209us       0.168us           132  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      21.330us         0.00%      21.330us       2.133us            10  
                                       aten::reciprocal         0.00%     149.108us         0.00%       7.731ms     773.072us      19.442us         0.00%      19.442us       1.944us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      19.442us         0.00%      19.442us       1.944us            10  
                                              aten::min         0.00%      96.648us         0.00%       3.473ms     694.679us      14.433us         0.00%      14.433us       2.887us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      14.433us         0.00%      14.433us       4.811us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      14.353us         0.00%      14.353us       4.784us             3  
                                          aten::reshape         0.06%      95.017ms         0.10%     167.952ms       3.887us       0.000us         0.00%       6.174us       0.000us         43206  
                            hipGetDevicePropertiesR0000         0.00%      45.475us         0.00%      45.475us       4.548us       5.853us         0.00%       5.853us       0.585us            10  
                                    hipModuleLoadDataEx         0.36%     605.454ms         0.36%     605.454ms      50.454ms       5.573us         0.00%       5.573us       0.464us            12  
                                           hipDeviceGet         0.00%       1.469us         0.00%       1.469us       0.245us       5.492us         0.00%       5.492us       0.915us             6  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.846us         0.00%       2.846us       2.846us             1  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.566us         0.00%       2.566us       2.566us             1  
                                            aten::empty         0.45%     753.467ms         0.46%     757.833ms       2.886us       0.000us         0.00%       0.000us       0.000us        262555  
                        hipDeviceGetStreamPriorityRange         0.00%       2.149us         0.00%       2.149us       2.149us       0.000us         0.00%       0.000us       0.000us             1  
                                              hipMalloc         0.01%      14.952ms         0.01%      14.952ms      91.168us       0.000us         0.00%       0.000us       0.000us           164  
                            hipStreamCreateWithPriority         0.00%     561.288us         0.00%     561.288us      93.548us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.013s      60.132us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      11.104ms         0.01%      11.104ms       1.101us       0.000us         0.00%       0.000us       0.000us         10083  
                                    aten::empty_strided         0.17%     289.925ms         0.18%     296.912ms       3.349us       0.000us         0.00%       0.000us       0.000us         88647  
                                           aten::detach         0.04%      59.666ms         0.11%     178.309ms       5.026us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.06%      94.767ms         0.07%     113.398ms       3.352us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.00%       7.181ms         0.01%      12.745ms     102.780us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.04%      60.791ms         0.05%      80.845ms       2.232us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     229.495us         0.00%     300.431us      37.554us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.13%     216.285ms         0.13%     216.526ms       0.643us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%     915.145us         0.00%       1.329ms      69.956us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     413.293us         0.00%     839.801us      19.995us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     658.897us         0.00%     889.133us      63.510us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%      87.404us         0.00%     119.495us      59.748us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       2.662ms         0.00%       5.525ms     145.402us       0.000us         0.00%       0.000us       0.000us            38  
                                         prims::view_of         0.00%     421.631us         0.00%     549.766us      22.907us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       5.228ms         0.00%       5.310ms       5.537us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       7.333ms         0.00%       8.277ms      10.257us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%     944.091us         0.00%     944.091us       1.170us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     303.069us         0.00%     303.069us       9.776us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%      81.700us         0.00%      81.700us       7.427us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      10.061ms         0.01%      21.431ms      83.713us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     709.436us         0.00%     709.436us       2.771us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     200.834us         0.00%     277.584us      92.528us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%      89.413us         0.00%      89.413us      44.706us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     109.639us         0.00%     117.525us      58.762us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      27.816us         0.00%      27.816us       1.987us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%     950.411us         0.00%       1.866ms     373.107us       0.000us         0.00%       0.000us       0.000us             5  
                                            aten::slice         0.05%      83.229ms         0.06%      98.611ms       3.776us       0.000us         0.00%       0.000us       0.000us         26118  
                                        aten::index_add         0.00%     181.069us         0.00%       1.061ms       1.061ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     385.053us         0.00%     435.640us     217.820us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     187.692us         0.00%     187.692us     187.692us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.10%     172.633ms         0.11%     175.195ms      15.927ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.09%     142.183ms         0.09%     142.209ms      12.928ms       0.000us         0.00%       0.000us       0.000us            11  
                       Scheduler.codegen (dynamo_timed)         0.07%     115.781ms         0.07%     115.826ms      10.530ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.00%       7.581ms         0.00%       7.581ms     689.154us       0.000us         0.00%       0.000us       0.000us            11  
                                 hipPointerGetAttribute         0.02%      41.430ms         0.02%      41.430ms       0.650us       0.000us         0.00%       0.000us       0.000us         63690  
                                        aten::expand_as         0.00%     932.758us         0.00%       3.249ms       5.984us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.254ms         0.00%       4.437ms     403.398us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     102.595us         0.00%     116.787us      58.393us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     114.536us         0.00%     114.536us      57.268us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      63.121us         0.00%      80.432us      80.432us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     262.059us         0.00%       2.322ms     773.853us       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     253.264us         0.00%     283.708us      94.569us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.003ms         0.00%       3.011ms     501.821us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%     672.424us         0.00%       3.310ms     367.743us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%     971.174us         0.00%       2.194ms     365.736us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     249.935us         0.00%     646.449us     215.483us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     169.279us         0.00%     835.151us     278.384us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     354.455us         0.00%     665.872us     221.957us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     302.612us         0.00%     316.510us      79.127us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.06%      96.428ms         0.06%      96.680ms       2.790us       0.000us         0.00%       0.000us       0.000us         34655  
                aten::_has_compatible_shallow_copy_type         0.00%       3.117ms         0.00%       3.117ms       0.127us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     882.650us      63.046us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.379ms         0.01%      13.171ms       5.867us       0.000us         0.00%       0.000us       0.000us          2245  
                                         nccl:broadcast         0.00%       0.000us             0      65.831ms     136.864us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.01%       9.469ms         0.01%      20.505ms       5.026us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.00%       8.131ms         0.02%      27.616ms      10.461us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.02%      28.365ms         0.02%      34.646ms       4.707us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.184ms         0.00%       2.572ms       3.572us       0.000us         0.00%       0.000us       0.000us           720  
                              hipDevicePrimaryCtxRetain         0.00%       1.986us         0.00%       1.986us       0.331us       0.000us         0.00%       0.000us       0.000us             6  
                             hipDevicePrimaryCtxRelease         0.00%       0.970us         0.00%       0.970us       0.162us       0.000us         0.00%       0.000us       0.000us             6  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.02%      38.565ms         0.02%      38.565ms       2.071us       0.000us         0.00%       0.000us       0.000us         18620  
                                              hipMemset         0.00%      23.104us         0.00%      23.104us      11.552us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.21%     340.949ms         0.21%     340.949ms     113.650ms       0.000us         0.00%       0.000us       0.000us             3  
                                         _SplitAlongDim         0.07%     124.389ms         0.11%     182.656ms      31.711us       0.000us         0.00%       0.000us       0.000us          5760  
                                 aten::split_with_sizes         0.03%      45.161ms         0.04%      58.207ms      10.105us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      27.776ms         0.02%      27.779ms       1.809us       0.000us         0.00%       0.000us       0.000us         15360  
                                      hipModuleLoadData         0.24%     389.877ms         0.24%     389.877ms      97.469ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     678.802us         0.00%       1.561ms     390.372us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       5.544ms         0.00%       6.607ms      27.529us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     815.230us         0.00%     815.230us       2.548us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      32.611ms         0.06%      94.692ms       6.039us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      15.744ms         0.04%      62.080ms       3.959us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     503.035us         0.00%       2.947ms      36.837us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.012ms         0.00%       2.444ms      30.549us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      45.102ms         0.07%     108.041ms       5.077us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      16.250ms         0.04%      62.939ms       2.958us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      33.423ms         0.05%      75.891ms       3.141us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.136ms         0.00%       3.036ms      12.649us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     417.676us         0.00%       1.900ms       7.918us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     308.304us         0.00%     870.266us      10.878us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     561.962us         0.00%     561.962us       7.025us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     898.833us         0.21%     353.435ms     353.435ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      15.396ms         0.01%      17.398ms       2.265us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.002ms         0.00%       2.002ms       0.261us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       4.206ms         0.01%      15.957ms       7.979us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       3.474ms         0.01%      11.751ms       5.875us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       3.689ms         0.01%      10.120ms       5.271us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       1.715ms         0.00%       6.431ms       3.350us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     284.623us         0.00%     284.623us       0.148us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%     975.713us         0.00%       2.633ms      32.909us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.657ms         0.00%       1.657ms      20.713us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.985ms         0.00%       2.738ms      34.219us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.394ms     239.446us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      13.914us         0.00%      28.473us       7.118us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 165.882s
Self CUDA time total: 154.049s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       76.627s        49.51%       76.627s       76.627s             1  
                                             bert_train        35.83%       58.721s        70.18%      115.007s      115.007s       0.000us         0.00%       41.118s       41.118s             1  
                                            aten::copy_        15.64%       25.630s        19.44%       31.859s     404.222us       16.891s        10.91%       16.938s     214.904us         78815  
                                     record_param_comms         3.20%        5.236s         4.57%        7.489s     215.742us        8.613s         5.56%       13.264s     382.098us         34714  
                                               aten::to         0.03%      50.579ms        19.42%       31.828s     606.380us       0.000us         0.00%       12.343s     235.150us         52489  
                                         aten::_to_copy         0.09%     148.970ms        19.39%       31.778s     733.134us       0.000us         0.00%       12.343s     284.757us         43345  
                                      aten::masked_fill         0.04%      58.764ms         0.22%     362.712ms      37.783us       0.000us         0.00%       11.874s       1.237ms          9600  
                                     aten::masked_fill_         0.09%     149.467ms         0.24%     385.343ms      23.497us       11.105s         7.17%       11.105s     677.115us         16400  
                                       c10d::allreduce_         0.21%     340.789ms         2.35%        3.846s     228.801us       0.000us         0.00%        8.809s     523.977us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        8.597s         5.55%        8.597s     881.404us          9754  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        8.478s         5.48%        8.478s     860.812us          9849  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      13.811ms         0.09%     155.351ms      40.456us       0.000us         0.00%        7.773s       2.024ms          3840  
                                    MaskedFillBackward0         0.00%       5.833ms         0.09%     141.541ms      36.860us       0.000us         0.00%        7.773s       2.024ms          3840  
                                              aten::bmm         0.23%     371.976ms         0.28%     453.263ms      33.725us        7.255s         4.69%        7.255s     539.803us         13440  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.529s         4.22%        6.529s       1.432ms          4560  
autograd::engine::evaluate_function: _LayerNormLinea...         0.04%      73.501ms         1.74%        2.852s     742.769us       0.000us         0.00%        6.479s       1.687ms          3840  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       6.362ms         0.04%      59.992ms      31.246us       0.000us         0.00%        6.470s       3.370ms          1920  
                                       SoftmaxBackward0         0.00%       5.598ms         0.03%      53.630ms      27.932us       0.000us         0.00%        6.470s       3.370ms          1920  
                           aten::_softmax_backward_data         0.01%      15.551ms         0.03%      48.032ms      25.017us        3.341s         2.16%        6.470s       3.370ms          1920  
                               _LayerNormLinearBackward         0.93%        1.522s         1.66%        2.728s     710.319us     312.288ms         0.20%        6.340s       1.651ms          3840  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.290s         4.06%        6.290s     757.507us          8303  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.900s         3.81%        5.900s       1.247ms          4730  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      10.631ms         0.04%      72.836ms      18.581us       0.000us         0.00%        5.062s       1.291ms          3920  
                                        ToCopyBackward0         0.00%       5.166ms         0.04%      62.205ms      15.869us       0.000us         0.00%        5.062s       1.291ms          3920  
                                            aten::clone         0.06%      93.686ms         0.37%     599.260ms      17.347us       0.000us         0.00%        4.591s     132.892us         34546  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.574s         2.96%        4.574s     962.726us          4751  
                                          aten::softmax         0.01%      10.029ms         0.07%     117.976ms      20.482us       0.000us         0.00%        4.535s     787.247us          5760  
                                         aten::_softmax         0.04%      65.215ms         0.07%     107.946ms      18.741us        4.535s         2.93%        4.535s     787.247us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.535s         2.93%        4.535s       1.718ms          2640  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.491s         2.90%        4.491s     552.240us          8133  
                                     tex_ts::te_gemm_ts         1.05%        1.726s         1.56%        2.551s      66.424us        4.276s         2.76%        4.277s     111.376us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.951s         2.55%        3.951s     866.410us          4560  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.705s         2.39%        3.705s     321.652us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.341s         2.16%        3.341s       1.740ms          1920  
                                              aten::mul         0.07%     122.811ms         0.11%     182.254ms      22.865us        3.156s         2.04%        3.156s     395.990us          7971  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.130s         2.02%        3.130s       1.423ms          2199  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      13.854ms         0.10%     162.188ms      84.473us       0.000us         0.00%        3.127s       1.629ms          1920  
                                       BaddbmmBackward0         0.01%      14.774ms         0.09%     148.334ms      77.257us       0.000us         0.00%        3.127s       1.629ms          1920  
                                                _Linear         0.79%        1.292s         1.35%        2.216s     577.003us      66.291ms         0.04%        2.957s     770.166us          3840  
                                          c10d::barrier         0.00%     689.653us         1.32%        2.156s      56.740ms       0.000us         0.00%        2.844s      74.844ms            38  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.879s         1.21%        1.879s     402.267us          4670  
                                       aten::logical_or         0.06%      92.803ms         0.17%     276.911ms      24.037us     913.591ms         0.59%        1.829s     158.765us         11520  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      16.293ms         0.10%     166.190ms      86.557us       0.000us         0.00%        1.771s     922.617us          1920  
                                           BmmBackward0         0.01%      10.743ms         0.09%     149.897ms      78.071us       0.000us         0.00%        1.771s     922.617us          1920  
                                              aten::sub         0.05%      86.222ms         0.07%     118.167ms      17.986us        1.605s         1.04%        1.606s     244.409us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.603s         1.04%        1.603s     607.173us          2640  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      30.008ms         0.84%        1.379s     359.136us       0.000us         0.00%        1.602s     417.070us          3840  
                                        _LinearBackward         0.56%     912.981ms         0.82%        1.349s     351.321us      76.404ms         0.05%        1.602s     417.070us          3840  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.532s         0.99%        1.532s     798.105us          1920  
                                       c10d::broadcast_         0.02%      34.502ms         0.50%     818.685ms       1.702ms       0.000us         0.00%        1.495s       3.108ms           481  
                                   hipDeviceGetPCIBusId         0.01%       9.661ms         0.01%       9.661ms       0.727us        1.474s         0.95%        1.474s     110.968us         13287  
                                          aten::dropout         0.01%       8.814ms         0.06%      98.280ms      16.339us       0.000us         0.00%        1.441s     239.505us          6015  
                                   aten::native_dropout         0.02%      35.967ms         0.05%      86.516ms      43.064us        1.441s         0.93%        1.441s     717.084us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.441s         0.93%        1.441s     720.299us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%       8.842ms         0.03%      54.258ms      27.088us       0.000us         0.00%        1.382s     689.794us          2003  
                                 NativeDropoutBackward0         0.00%       5.255ms         0.03%      45.416ms      22.674us       0.000us         0.00%        1.382s     689.794us          2003  
                          aten::native_dropout_backward         0.01%      15.093ms         0.02%      40.161ms      20.050us        1.382s         0.89%        1.382s     689.794us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.382s         0.89%        1.382s     690.828us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.358s         0.88%        1.358s      77.398us         17540  
                                   hipStreamIsCapturing         0.03%      44.567ms         0.03%      44.567ms       0.856us        1.306s         0.84%        1.306s      25.078us         52080  
                                          aten::baddbmm         0.19%     306.897ms         0.38%     625.579ms     108.607us        1.190s         0.77%        1.190s     206.555us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.121s         0.72%        1.121s     583.680us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      18.069ms         0.54%     889.905ms     231.746us       0.000us         0.00%     980.608ms     255.367us          3840  
                               CompiledFunctionBackward         0.24%     395.260ms         0.53%     871.836ms     227.041us       0.000us         0.00%     980.608ms     255.367us          3840  
                                  hipExtMallocWithFlags         0.02%      35.552ms         0.02%      35.552ms       8.279us     922.761ms         0.60%     922.761ms     214.895us          4294  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     913.591ms         0.59%     913.591ms     345.926us          2641  
                                 triton_red_fused_sum_1         0.02%      27.972ms         0.03%      48.303ms      12.579us     886.705ms         0.57%     886.705ms     230.913us          3840  
                                      aten::logical_not         0.07%     122.385ms         0.22%     363.369ms      15.771us     320.854ms         0.21%     642.429ms      27.883us         23040  
                                     hipIpcGetMemHandle         0.01%       8.515ms         0.01%       8.515ms       4.749us     521.992ms         0.34%     521.992ms     291.128us          1793  
                     hipThreadExchangeStreamCaptureMode         0.00%       1.999ms         0.00%       1.999ms       0.140us     515.438ms         0.33%     515.438ms      36.075us         14288  
                                  hipMemGetAddressRange         0.00%     104.443us         0.00%     104.443us       0.233us     463.305ms         0.30%     463.305ms       1.032ms           449  
                                        hipEventDestroy         0.03%      41.206ms         0.03%      41.626ms       2.040us     451.111ms         0.29%     452.515ms      22.175us         20407  
                                  Torch-Compiled Region         0.44%     727.507ms         1.35%        2.208s     114.869us       0.000us         0.00%     402.229ms      20.928us         19220  
                                      hipGetProcAddress         0.04%      57.817ms         0.04%      57.817ms       0.839us     398.236ms         0.26%     398.236ms       5.781us         68890  
                                       hipCtxGetCurrent         0.00%       7.496ms         0.00%       7.496ms       0.149us     395.155ms         0.26%     395.155ms       7.867us         50230  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     320.854ms         0.21%     320.854ms      60.745us          5282  
                                             aten::add_         0.08%     129.128ms         0.15%     249.836ms       7.952us     303.151ms         0.20%     303.151ms       9.648us         31420  
                                       _LayerNormLinear         0.35%     572.147ms         0.92%        1.509s     392.894us     168.917ms         0.11%     289.645ms      75.429us          3840  
                                         hipMemsetAsync         0.07%     110.080ms         0.07%     110.089ms       9.100us     286.698ms         0.19%     286.991ms      23.722us         12098  
                                       CompiledFunction         0.53%     873.003ms         0.79%        1.292s     111.984us       0.000us         0.00%     276.440ms      23.955us         11540  
                                              aten::sum         0.18%     298.396ms         0.40%     649.918ms      31.931us     209.814ms         0.14%     274.492ms      13.486us         20354  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     256.310ms         0.17%     256.310ms      66.747us          3840  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     221.805ms         0.14%     221.805ms     221.805ms             1  
                  triton_poi_fused_add_native_dropout_0         0.05%      76.541ms         0.07%     116.089ms      30.153us     212.855ms         0.14%     212.861ms      55.289us          3850  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     197.766ms         0.13%     197.766ms      37.449us          5281  
autograd::engine::evaluate_function: torch::autograd...         0.16%     256.359ms         0.31%     513.572ms      21.257us       0.000us         0.00%     163.647ms       6.773us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     162.125ms         0.10%     162.125ms       6.778us         23920  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     155.317ms         0.10%     155.317ms      29.416us          5280  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.01%      20.786ms         0.34%     560.578ms     291.968us       0.000us         0.00%     149.657ms      77.946us          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     148.504ms         0.10%     148.504ms      33.282us          4462  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     131.968ms         0.09%     131.968ms     591.783us           223  
                                              aten::cat         0.08%     126.510ms         0.10%     169.107ms      20.929us     131.248ms         0.08%     131.284ms      16.248us          8080  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.008ms        25.19%       41.276s     171.982ms       0.000us         0.00%     127.288ms     530.367us           240  
                                     EmbeddingBackward0         0.00%       2.770ms        25.18%       41.268s     171.951ms       0.000us         0.00%     126.442ms     526.843us           240  
                               aten::embedding_backward         0.00%       2.455ms        25.18%       41.266s     171.940ms       0.000us         0.00%     126.442ms     526.843us           240  
                         aten::embedding_dense_backward         0.65%        1.066s        25.18%       41.263s     171.930ms     121.128ms         0.08%     126.442ms     526.843us           240  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     125.845ms         0.08%     125.845ms      32.103us          3920  
                             _VocabParallelCrossEntropy         0.03%      56.237ms         0.14%     234.075ms     975.311us       0.000us         0.00%     119.791ms     499.129us           240  
                             c10d::allreduce_coalesced_         0.00%       1.485ms         0.06%      91.815ms       9.181ms       0.000us         0.00%     115.250ms      11.525ms            10  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      12.292ms         0.11%     183.518ms      95.582us       0.000us         0.00%     113.611ms      59.172us          1920  
                                 _SplitAlongDimBackward         0.08%     128.595ms         0.10%     171.226ms      89.180us       0.000us         0.00%     113.611ms      59.172us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     113.611ms         0.07%     113.611ms      59.172us          1920  
                         _ReduceFromModelParallelRegion         0.01%      19.814ms         0.04%      58.776ms     244.898us       0.000us         0.00%     112.451ms     468.548us           240  
                                         hipMemcpyAsync         0.12%     199.934ms         0.12%     199.944ms      16.241us     111.438ms         0.07%     111.448ms       9.053us         12311  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     109.056ms         0.07%     109.056ms      50.489us          2160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     106.607ms         0.07%     106.607ms       9.988us         10673  
                                       aten::contiguous         0.01%      22.691ms         0.25%     417.380ms      18.115us       0.000us         0.00%     104.749ms       4.546us         23040  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     103.903ms         0.07%     103.903ms      18.039us          5760  
                                               aten::mm         0.03%      42.131ms         0.05%      82.863ms      94.162us      98.456ms         0.06%      98.456ms     111.882us           880  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.391ms         0.06%      92.298ms       1.154ms       0.000us         0.00%      96.507ms       1.206ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      16.750ms         0.06%      90.908ms       1.136ms       0.000us         0.00%      96.507ms       1.206ms            80  
             triton_poi_fused_native_dropout_backward_0         0.03%      52.377ms         0.05%      78.911ms      20.550us      93.903ms         0.06%      93.903ms      24.454us          3840  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      87.107ms         0.06%      87.107ms      32.995us          2640  
                                           aten::matmul         0.00%       2.485ms         0.04%      60.370ms     150.924us       0.000us         0.00%      82.130ms     205.324us           400  
                                           GeLUFunction         0.08%     134.096ms         0.49%     808.028ms     140.283us       0.000us         0.00%      81.432ms      14.137us          5760  
                        triton_poi_fused_add_mul_tanh_0         0.06%      99.123ms         0.07%     120.427ms      20.871us      81.048ms         0.05%      81.048ms      14.046us          5770  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us      80.156ms         0.05%      80.156ms      15.462us          5184  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      78.430ms         0.05%      78.430ms       9.899us          7923  
                                       hipStreamDestroy         0.03%      50.119ms         0.03%      50.119ms      18.576us      76.743ms         0.05%      76.743ms      28.445us          2698  
                                           aten::arange         0.07%     112.251ms         0.20%     333.750ms      13.545us      34.590ms         0.02%      74.038ms       3.005us         24640  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      72.276ms         0.05%      72.276ms      27.367us          2641  
                                   hipStreamSynchronize         0.44%     720.603ms         0.44%     720.659ms     221.537us      68.739ms         0.04%      69.552ms      21.381us          3253  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      65.986ms         0.04%      65.986ms      15.076us          4377  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      65.953ms         0.04%      65.953ms     274.802us           240  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.17%     270.851ms         0.29%     469.454ms      61.127us      62.923ms         0.04%      65.215ms       8.492us          7680  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      64.149ms         0.04%      64.149ms      16.365us          3920  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      63.416ms         0.04%      63.416ms       5.247us         12086  
                               hipStreamCreateWithFlags         0.17%     272.281ms         0.17%     272.281ms     100.177us      61.784ms         0.04%      61.784ms      22.731us          2718  
                                    hipIpcOpenMemHandle         0.05%      80.656ms         0.05%      80.656ms      44.834us      49.779ms         0.03%      49.779ms      27.670us          1799  
        LinearWithGradAccumulationAndAsyncCommunication         0.00%       6.280ms         0.01%      20.722ms      86.340us       0.000us         0.00%      49.537ms     206.402us           240  
                                  hipModuleLaunchKernel         0.13%     208.944ms         0.13%     208.967ms       6.099us      47.164ms         0.03%      47.164ms       1.376us         34265  
                                 hipDeviceCanAccessPeer         0.00%     395.261us         0.00%     395.261us       0.196us      47.151ms         0.03%      47.151ms      23.388us          2016  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      46.510ms         0.03%      46.510ms      12.112us          3840  
                                    hipMemcpyWithStream        29.03%       47.573s        29.03%       47.576s      59.248ms       0.000us         0.00%      46.035ms      57.329us           803  
                                   GeLUFunctionBackward         0.03%      44.514ms         0.29%     472.935ms     246.320us       0.000us         0.00%      42.333ms      22.048us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      25.298ms         0.02%      39.837ms      20.749us      42.333ms         0.03%      42.333ms      22.048us          1920  
                                 triton_poi_fused_add_0         0.10%     162.835ms         0.11%     175.427ms      22.842us      40.714ms         0.03%      40.714ms       5.301us          7680  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      36.913ms         0.02%      36.913ms      19.225us          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      32.572ms         0.02%      32.572ms       6.167us          5282  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      32.030ms         0.02%      32.030ms       6.066us          5280  
                                            aten::fill_         0.07%     110.702ms         0.09%     141.307ms       4.886us      29.355ms         0.02%      30.160ms       1.043us         28919  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      29.504ms         0.02%      29.504ms      11.171us          2641  
                                     hipStreamWaitEvent         0.18%     299.732ms         0.18%     299.774ms      14.217us      28.035ms         0.02%      29.403ms       1.394us         21086  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      27.269ms         0.02%      27.269ms     170.430us           160  
                                            aten::zero_         0.04%      60.134ms         0.12%     191.823ms       8.471us       0.000us         0.00%      26.499ms       1.170us         22646  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      25.815ms         0.02%      25.815ms       6.723us          3840  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       1.954ms         0.03%      41.535ms     519.185us       0.000us         0.00%      25.449ms     318.117us            80  
                                            aten::zeros         0.04%      62.457ms         0.17%     284.116ms      12.680us       0.000us         0.00%      25.144ms       1.122us         22406  
                                              aten::exp         0.00%       2.322ms         0.01%      24.485ms     102.022us      24.289ms         0.02%      24.289ms     101.203us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      24.289ms         0.02%      24.289ms     220.806us           110  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      24.069ms         0.02%      24.069ms      37.375us           644  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      23.156ms         0.01%      23.156ms     289.452us            80  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.205ms         0.03%      42.902ms     178.760us       0.000us         0.00%      22.995ms      95.811us           240  
                                          aten::randint         0.02%      32.609ms         0.08%     127.810ms      33.163us       0.000us         0.00%      21.536ms       5.588us          3854  
                                          aten::random_         0.03%      53.177ms         0.06%      93.081ms      24.177us      21.482ms         0.01%      21.536ms       5.594us          3850  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      21.482ms         0.01%      21.482ms       5.580us          3850  
                                              aten::add         0.04%      60.214ms         0.05%      86.744ms      48.569us      20.966ms         0.01%      20.966ms      11.739us          1786  
                                             aten::div_         0.00%       4.821ms         0.01%      13.082ms      27.255us      20.465ms         0.01%      20.465ms      42.636us           480  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.809ms         0.01%      19.809ms     180.081us           110  
                                           aten::linear         0.00%       2.717ms         0.03%      47.327ms      65.732us       0.000us         0.00%      19.549ms      27.151us           720  
                                            aten::addmm         0.02%      33.744ms         0.02%      40.393ms      56.101us      19.549ms         0.01%      19.549ms      27.151us           720  
                                             aten::sub_         0.00%       3.759ms         0.00%       5.054ms      15.795us      18.715ms         0.01%      18.715ms      58.483us           320  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      18.222ms         0.01%      18.222ms     165.652us           110  
                                 tex_ts::cast_to_fp8_ts         0.06%     104.841ms         0.09%     154.846ms      20.162us      17.879ms         0.01%      17.879ms       2.328us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      17.879ms         0.01%      17.879ms      12.416us          1440  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      17.637ms         0.01%      17.637ms       6.059us          2911  
                                        aten::embedding         0.00%       6.070ms         0.02%      26.532ms      36.851us       0.000us         0.00%      16.635ms      23.104us           720  
                                     aten::index_select         0.01%      11.224ms         0.01%      17.945ms      24.923us      16.635ms         0.01%      16.635ms      23.104us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.635ms         0.01%      16.635ms      49.954us           333  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      16.481ms         0.01%      16.481ms       6.208us          2655  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      16.412ms         0.01%      16.412ms       6.214us          2641  
                                           aten::cumsum         0.05%      88.463ms         0.07%     114.252ms      19.835us      16.361ms         0.01%      16.369ms       2.842us          5760  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      16.361ms         0.01%      16.361ms       6.195us          2641  
                                         AddmmBackward0         0.00%       2.566ms         0.02%      32.876ms     136.983us       0.000us         0.00%      16.326ms      68.027us           240  
                     _VocabParallelCrossEntropyBackward         0.01%      14.872ms         0.02%      36.922ms     461.525us       0.000us         0.00%      15.539ms     194.233us            80  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      12.795ms         0.01%      12.795ms       6.664us          1920  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.519ms         0.01%      12.519ms      78.244us           160  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.058ms         0.01%      12.058ms     109.616us           110  
                                             aten::mul_         0.00%       6.225ms         0.00%       6.974ms       5.448us      12.017ms         0.01%      12.017ms       9.388us          1280  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.465ms         0.01%      11.465ms     104.225us           110  
                                            aten::index         0.01%      11.247ms         0.04%      59.314ms     104.609us       1.944ms         0.00%      10.744ms      18.948us           567  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.585ms         0.01%       9.585ms      39.939us           240  
                                       aten::index_put_         0.00%       5.088ms         0.11%     183.807ms     164.113us       0.000us         0.00%       9.320ms       8.321us          1120  
                                 aten::_index_put_impl_         0.00%       6.750ms         0.11%     178.719ms     159.571us     752.774us         0.00%       9.320ms       8.321us          1120  
                                              aten::max         0.00%       5.154ms         0.02%      33.662ms     132.526us       9.036ms         0.01%       9.072ms      35.717us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.023ms         0.01%       9.023ms      82.023us           110  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       8.931ms         0.01%       8.931ms      37.213us           240  
                                          aten::nonzero         0.00%       5.128ms         0.02%      33.151ms     135.311us       8.799ms         0.01%       8.799ms      35.915us           245  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.568ms         0.01%       8.568ms      19.925us           430  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us       8.362ms         0.01%       8.362ms      76.017us           110  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.067ms         0.01%      11.633ms     145.408us       0.000us         0.00%       8.126ms     101.578us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       3.957ms         0.01%       9.566ms     119.574us       8.126ms         0.01%       8.126ms     101.578us            80  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.072ms         0.02%      27.005ms     337.558us       0.000us         0.00%       7.984ms      99.804us            80  
                            torch::autograd::CopySlices         0.00%       4.046ms         0.02%      24.933ms     311.661us       0.000us         0.00%       7.984ms      99.804us            80  
                           FusedLayerNormAffineFunction         0.01%      10.399ms         0.01%      18.815ms      78.396us       7.953ms         0.01%       7.953ms      33.137us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.953ms         0.01%       7.953ms      72.299us           110  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.575ms         0.00%       7.575ms      34.432us           220  
                                        hipLaunchKernel         0.80%        1.307s         0.80%        1.307s       8.355us       3.589ms         0.00%       7.537ms       0.048us        156407  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.296ms         0.00%       7.296ms      10.635us           686  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.526ms         0.00%       6.526ms      81.575us            80  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     458.994us         0.00%       2.128ms     212.840us       6.227ms         0.00%       6.227ms     622.677us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.227ms         0.00%       6.227ms      56.607us           110  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       5.963ms         0.00%       5.963ms      24.847us           240  
                                   hipDeviceSynchronize         0.00%     546.430us         0.00%     546.430us      16.071us       5.775ms         0.00%       5.775ms     169.850us            34  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.578ms         0.00%       5.578ms       6.177us           903  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       4.998ms         0.00%       4.998ms       5.206us           960  
         _compile.<locals>.compile_inner (dynamo_timed)         0.06%     100.646ms         1.59%        2.604s     260.373ms       0.000us         0.00%       4.745ms     474.519us            10  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       4.731ms         0.00%       4.731ms      29.570us           160  
                                        aten::index_put         0.00%       2.044ms         0.01%      11.668ms     140.575us       0.000us         0.00%       4.238ms      51.059us            83  
                                      IndexPutBackward0         0.00%       1.106ms         0.01%      11.287ms     141.091us       0.000us         0.00%       4.238ms      52.974us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       3.894ms         0.00%       3.894ms      48.680us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       3.729ms         0.00%       3.729ms      46.612us            80  
          OutputGraph.call_user_compiler (dynamo_timed)         0.01%      23.869ms         1.50%        2.466s     246.574ms       0.000us         0.00%       3.696ms     369.646us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.31%     511.146ms         1.49%        2.442s     244.187ms       0.000us         0.00%       3.696ms     369.646us            10  
                                  hipDeviceGetAttribute         0.00%     260.650us         0.00%     260.650us       3.890us       3.619ms         0.00%       3.619ms      54.020us            67  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     850.087us         0.01%      16.659ms     208.236us       0.000us         0.00%       3.558ms      44.473us            80  
                                     _LayerNormBackward         0.00%       4.812ms         0.01%      15.809ms     197.610us       3.558ms         0.00%       3.558ms      44.473us            80  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     636.412us         0.00%       3.137ms      39.211us       0.000us         0.00%       3.183ms      39.791us            80  
                                          GeluBackward0         0.00%     417.469us         0.00%       2.500ms      31.256us       0.000us         0.00%       3.183ms      39.791us            80  
                                    aten::gelu_backward         0.00%       1.372ms         0.00%       2.083ms      26.037us       3.183ms         0.00%       3.183ms      39.791us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.183ms         0.00%       3.183ms      39.791us            80  
                                 c10d::_allgather_base_         0.00%     210.257us         0.00%       1.338ms      95.565us       0.000us         0.00%       3.053ms     218.039us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       3.053ms         0.00%       3.053ms     254.379us            12  
                                             aten::ones         0.00%     851.284us         0.00%       5.513ms      11.486us       0.000us         0.00%       3.027ms       6.306us           480  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     600.178us         0.00%       4.111ms      51.384us       0.000us         0.00%       2.966ms      37.078us            80  
                                             aten::gelu         0.00%       3.042ms         0.01%       9.529ms      39.702us       2.616ms         0.00%       2.616ms      10.900us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.616ms         0.00%       2.616ms      23.783us           110  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.559ms         0.00%       2.559ms       4.731us           541  
                                               aten::lt         0.01%      16.103ms         0.01%      18.809ms      26.123us       1.742ms         0.00%       2.463ms       3.421us           720  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.318ms         0.00%       2.318ms       5.243us           442  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.175ms         0.00%       2.175ms      19.771us           110  
                            hipGetDevicePropertiesR0600         0.04%      69.390ms         0.04%      69.390ms       0.743us       2.168ms         0.00%       2.168ms       0.023us         93358  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.126ms         0.00%       2.126ms       5.396us           394  
                                              aten::div         0.01%       8.352ms         0.01%      11.472ms      17.278us       2.009ms         0.00%       2.014ms       3.034us           664  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.944ms         0.00%       1.944ms      10.075us           193  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     506.645us         0.00%       6.857ms      42.855us       0.000us         0.00%       1.906ms      11.912us           160  
                                         SliceBackward0         0.00%     427.119us         0.00%       6.350ms      39.688us       0.000us         0.00%       1.906ms      11.912us           160  
                                   aten::slice_backward         0.00%     858.326us         0.00%       5.923ms      37.019us       0.000us         0.00%       1.906ms      11.912us           160  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.656ms         0.00%       1.656ms      15.059us           110  
                                             _LayerNorm         0.00%       4.854ms         0.01%       8.830ms     110.373us       1.593ms         0.00%       1.593ms      19.915us            80  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.588ms         0.00%       1.588ms       6.617us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.501ms         0.00%       1.501ms       4.691us           320  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      11.412ms         0.99%        1.629s     162.903ms       0.000us         0.00%       1.479ms     147.881us            10  
                        compile_fx_inner (dynamo_timed)         0.03%      54.403ms         1.20%        1.966s     178.751ms       0.000us         0.00%       1.479ms     134.438us            11  
      autograd::engine::evaluate_function: MulBackward0         0.01%      11.781ms         0.03%      55.919ms     325.113us       0.000us         0.00%       1.470ms       8.545us           172  
                               aten::cross_entropy_loss         0.00%       1.187ms         0.01%      17.645ms      73.521us       0.000us         0.00%       1.438ms       5.992us           240  
                                    hipFuncSetAttribute         0.00%       9.422us         0.00%       9.422us       0.393us       1.425ms         0.00%       1.425ms      59.382us            24  
                                         _SplitAlongDim         0.07%     112.196ms         0.10%     162.809ms      28.266us       0.000us         0.00%       1.404ms       0.244us          5760  
                                        SelectBackward0         0.00%     216.411us         0.00%       2.597ms      32.463us       0.000us         0.00%       1.354ms      16.926us            80  
                                  aten::select_backward         0.00%     392.933us         0.00%       2.381ms      29.758us       0.000us         0.00%       1.354ms      16.926us            80  
                                       aten::is_nonzero         0.01%       8.803ms         0.01%      19.870ms       4.870us       0.000us         0.00%       1.352ms       0.331us          4080  
         GraphLowering.compile_to_module (dynamo_timed)         0.57%     934.507ms         1.07%        1.747s     158.817ms       0.000us         0.00%       1.346ms     122.403us            11  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.334ms         0.00%       1.334ms       2.762us           483  
                                              hipMemcpy         0.01%      11.102ms         0.01%      11.102ms     231.285us       1.191ms         0.00%       1.191ms      24.811us            48  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.164ms         0.00%       1.164ms       6.126us           190  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.150ms         0.00%       1.150ms       5.203us           221  
                                           aten::__or__         0.00%       1.119ms         0.01%      20.700ms      43.126us       0.000us         0.00%       1.125ms       2.345us           480  
                                       aten::bitwise_or         0.00%       6.918ms         0.01%      19.581ms      40.794us       1.125ms         0.00%       1.125ms       2.345us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.125ms         0.00%       1.125ms       5.092us           221  
                                               aten::ge         0.00%       5.837ms         0.00%       6.982ms      14.545us       1.114ms         0.00%       1.114ms       2.320us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.113ms         0.00%       1.113ms       5.034us           221  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.049ms         0.00%       1.049ms      13.110us            80  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.019ms         0.00%       1.019ms       6.367us           160  
                                           MulBackward0         0.01%       8.340ms         0.02%      32.853ms     191.006us       0.000us         0.00%     980.490us       5.701us           172  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.537ms         0.00%       7.152ms      44.698us       0.000us         0.00%     979.655us       6.123us           160  
                                           DivBackward0         0.00%       1.090ms         0.00%       5.615ms      35.092us       0.000us         0.00%     979.655us       6.123us           160  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.494ms         0.01%       8.802ms     110.023us       0.000us         0.00%     965.510us      12.069us            80  
                                       NllLossBackward0         0.00%     765.953us         0.00%       7.308ms      91.349us       0.000us         0.00%     965.510us      12.069us            80  
                                aten::nll_loss_backward         0.00%       2.670ms         0.00%       6.542ms      81.775us     484.077us         0.00%     965.510us      12.069us            80  
                                               aten::gt         0.02%      36.889ms         0.03%      43.424ms      10.003us     516.073us         0.00%     962.130us       0.222us          4341  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     844.464us         0.00%     844.464us       7.677us           110  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     841.424us         0.00%     841.424us       3.463us           243  
                                       aten::empty_like         0.09%     150.011ms         0.26%     422.449ms       4.750us       0.000us         0.00%     803.930us       0.009us         88930  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     774.220us         0.00%     774.220us       3.226us           240  
                                                hipFree         0.07%     109.924ms         0.07%     109.961ms       6.109ms      27.985us         0.00%     752.914us      41.829us            18  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     752.774us         0.00%     752.774us       9.410us            80  
                                             aten::tanh         0.01%      11.808ms         0.01%      23.042ms      85.027us     728.121us         0.00%     728.121us       2.687us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     728.121us         0.00%     728.121us       6.619us           110  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     724.984us         0.00%     724.984us       9.062us            80  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     724.111us         0.00%     724.111us       3.017us           240  
                                      aten::log_softmax         0.00%     896.393us         0.00%       5.164ms      21.516us       0.000us         0.00%     711.841us       2.966us           240  
                                     aten::_log_softmax         0.00%       3.068ms         0.00%       4.172ms      17.384us     669.985us         0.00%     711.841us       2.966us           240  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     690.787us         0.00%     690.787us       8.635us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     673.347us         0.00%     673.347us       6.121us           110  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     669.985us         0.00%     669.985us       6.091us           110  
                                      aten::nll_loss_nd         0.00%     636.309us         0.01%      11.288ms      47.034us       0.000us         0.00%     669.585us       2.790us           240  
                                         aten::nll_loss         0.00%     645.632us         0.01%      10.652ms      44.382us       0.000us         0.00%     669.585us       2.790us           240  
                                 aten::nll_loss_forward         0.00%       3.545ms         0.01%       9.980ms      41.583us     669.585us         0.00%     669.585us       2.790us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     669.585us         0.00%     669.585us       6.087us           110  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     669.142us         0.00%     669.142us       8.364us            80  
                                             aten::item         0.02%      24.938ms         0.32%     531.833ms      31.659us       0.000us         0.00%     657.261us       0.039us         16799  
                              aten::_local_scalar_dense         0.01%      11.863ms         0.31%     506.895ms      30.174us     657.261us         0.00%     657.261us       0.039us         16799  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     640.234us         0.00%     640.234us       5.820us           110  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     637.513us         0.00%     637.513us       2.624us           243  
                                          aten::normal_         0.64%        1.057s         0.65%        1.058s      10.177ms     619.062us         0.00%     619.062us       5.953us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     619.062us         0.00%     619.062us       6.382us            97  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       4.446ms         0.01%       8.690ms      54.313us     581.685us         0.00%     581.685us       3.636us           160  
                            hipGetDevicePropertiesR0000         0.00%      37.184us         0.00%      37.184us       3.718us     547.700us         0.00%     547.700us      54.770us            10  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     543.575us         0.00%     543.575us       2.237us           243  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     538.400us         0.00%     538.400us       4.850us           111  
                                   hipFuncGetAttributes         0.14%     224.599ms         0.14%     224.599ms       1.702ms     524.367us         0.00%     524.367us       3.972us           132  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     513.628us         0.00%     513.628us       2.122us           242  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     502.923us         0.00%     502.923us       6.287us            80  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     502.035us         0.00%     502.035us       2.092us           240  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     496.624us         0.00%     496.624us       6.208us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     493.694us         0.00%     493.694us       6.171us            80  
                                             aten::rsub         0.00%       2.334ms         0.00%       7.507ms      87.287us       0.000us         0.00%     492.775us       5.730us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     492.775us         0.00%     492.775us       6.160us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.154ms         0.01%      22.595ms     275.548us       0.000us         0.00%     486.997us       5.939us            82  
                                          TanhBackward0         0.00%       2.041ms         0.01%      21.441ms     261.476us       0.000us         0.00%     486.997us       5.939us            82  
                                    aten::tanh_backward         0.00%       2.885ms         0.01%      16.935ms     206.521us     486.997us         0.00%     486.997us       5.939us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     486.997us         0.00%     486.997us       6.087us            80  
                                        aten::ones_like         0.00%     484.095us         0.00%       2.065ms      25.815us       0.000us         0.00%     486.518us       6.081us            80  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     484.077us         0.00%     484.077us       6.051us            80  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     643.948us         0.00%       4.646ms      58.072us       0.000us         0.00%     480.420us       6.005us            80  
                                    LogSoftmaxBackward0         0.00%       1.055ms         0.00%       4.002ms      50.022us       0.000us         0.00%     480.420us       6.005us            80  
                       aten::_log_softmax_backward_data         0.00%       1.690ms         0.00%       2.946ms      36.831us     480.420us         0.00%     480.420us       6.005us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     480.420us         0.00%     480.420us       6.005us            80  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     431.262us         0.00%     431.262us       1.797us           240  
                                              aten::log         0.00%       2.798ms         0.01%       9.385ms      39.104us     397.994us         0.00%     397.994us       1.658us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     397.994us         0.00%     397.994us       3.618us           110  
                               TorchDynamo Cache Lookup         0.10%     167.452ms         0.10%     167.469ms       8.713us       0.000us         0.00%     306.746us       0.016us         19221  
                       Scheduler.codegen (dynamo_timed)         0.05%      87.046ms         0.05%      87.065ms       7.915ms       0.000us         0.00%     303.619us      27.602us            11  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     294.598us         0.00%     294.598us       1.841us           160  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     273.753us         0.00%     273.753us       3.422us            80  
                                        aten::transpose         0.13%     209.943ms         0.16%     257.759ms       2.705us       0.000us         0.00%     265.451us       0.003us         95285  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     224.116us         0.00%     224.116us       2.384us            94  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     213.973us         0.00%     213.973us       3.689us            58  
                                             aten::rand         0.00%       1.844ms         0.00%       5.020ms     358.567us       0.000us         0.00%     151.070us      10.791us            14  
                                         aten::uniform_         0.01%       9.006ms         0.01%      11.056ms     850.438us     151.070us         0.00%     151.070us      11.621us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     151.070us         0.00%     151.070us      30.214us             5  
                                           aten::select         0.18%     295.962ms         0.22%     361.620ms       3.694us       0.000us         0.00%     149.474us       0.002us         97887  
                                          hipHostMalloc         0.09%     146.674ms         0.09%     146.708ms       4.446ms      57.715us         0.00%      64.290us       1.948us            33  
                                       aten::lift_fresh         0.03%      41.165ms         0.03%      46.075ms      26.090us       0.000us         0.00%      57.412us       0.033us          1766  
                               hipExtModuleLaunchKernel         0.15%     253.774ms         0.15%     253.796ms       6.332us       0.000us         0.00%      52.761us       0.001us         40084  
                                            aten::empty         0.42%     690.662ms         0.42%     695.483ms       2.649us       0.000us         0.00%      51.157us       0.000us        262555  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      33.194us         0.00%      33.194us       3.319us            10  
                                          aten::maximum         0.00%     119.515us         0.01%      23.619ms       2.624ms      23.614us         0.00%      29.788us       3.310us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.614us         0.00%      23.614us       2.624us             9  
                                       aten::reciprocal         0.00%     120.796us         0.00%       8.081ms     808.094us      22.733us         0.00%      22.733us       2.273us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      22.733us         0.00%      22.733us       2.273us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      22.331us         0.00%      22.331us       2.233us            10  
                                    hipFuncGetAttribute         0.00%       3.414us         0.00%       3.414us       0.284us      20.608us         0.00%      20.608us       1.717us            12  
                                            aten::slice         0.05%      75.978ms         0.06%      91.229ms       3.493us       0.000us         0.00%      17.520us       0.001us         26118  
                                     hipExtLaunchKernel         0.06%      94.981ms         0.06%      95.006ms       9.408us       0.000us         0.00%      16.117us       0.002us         10098  
                                              aten::min         0.00%      91.644us         0.00%       3.476ms     695.240us      14.993us         0.00%      14.993us       2.999us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      14.993us         0.00%      14.993us       4.998us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.431us         0.00%      13.431us       4.477us             3  
                       GraphLowering.run (dynamo_timed)         0.08%     129.977ms         0.08%     131.867ms      11.988ms       0.000us         0.00%       6.576us       0.598us            11  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       3.247us         0.00%       3.247us       3.247us             1  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.445us         0.00%       2.445us       2.445us             1  
                        hipDeviceGetStreamPriorityRange         0.00%       1.624us         0.00%       1.624us       1.624us       0.000us         0.00%       0.000us       0.000us             1  
                                              hipMalloc         0.01%      14.979ms         0.01%      14.979ms      91.334us       0.000us         0.00%       0.000us       0.000us           164  
                            hipStreamCreateWithPriority         0.00%     558.510us         0.00%     558.510us      93.085us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0     916.977ms      54.423us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%       9.723ms         0.01%       9.723ms       0.963us       0.000us         0.00%       0.000us       0.000us         10100  
                                    aten::empty_strided         0.16%     263.037ms         0.16%     270.073ms       3.047us       0.000us         0.00%       0.000us       0.000us         88647  
                                           aten::detach         0.03%      53.541ms         0.10%     157.274ms       4.433us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.05%      80.812ms         0.06%      98.219ms       2.904us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.01%       8.475ms         0.01%      15.600ms     125.808us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.03%      55.175ms         0.04%      72.726ms       2.007us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     267.088us         0.00%     354.909us      44.364us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.12%     195.266ms         0.12%     195.487ms       0.581us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%       1.000ms         0.00%       1.454ms      76.550us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     484.333us         0.00%     980.749us      23.351us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     841.795us         0.00%       1.153ms      82.372us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     141.820us         0.00%     193.730us      96.865us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       3.707ms         0.00%       7.625ms     200.670us       0.000us         0.00%       0.000us       0.000us            38  
                                             aten::view         0.15%     245.136ms         0.15%     251.271ms       1.737us       0.000us         0.00%       0.000us       0.000us        144633  
                                         prims::view_of         0.00%     567.061us         0.00%     723.047us      30.127us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       4.588ms         0.00%       4.693ms       4.893us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       6.398ms         0.00%       7.320ms       9.070us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%     921.203us         0.00%     921.203us       1.142us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     374.881us         0.00%     374.881us      12.093us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     104.345us         0.00%     104.345us       9.486us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%       9.630ms         0.01%      21.489ms      83.941us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     667.480us         0.00%     667.480us       2.607us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     197.160us         0.00%     266.283us      88.761us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     121.146us         0.00%     121.146us      60.573us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     153.793us         0.00%     165.001us      82.501us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      27.279us         0.00%      27.279us       1.948us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.499ms         0.00%       2.922ms     584.332us       0.000us         0.00%       0.000us       0.000us             5  
                                        aten::index_add         0.00%     321.713us         0.00%       1.831ms       1.831ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     595.697us         0.00%     672.517us     336.258us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     191.646us         0.00%     191.646us     191.646us       0.000us         0.00%       0.000us       0.000us             1  
                      Scheduler.__init__ (dynamo_timed)         0.07%     106.955ms         0.07%     106.979ms       9.725ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.00%       5.642ms         0.00%       5.642ms     512.886us       0.000us         0.00%       0.000us       0.000us            11  
                                    hipModuleLoadDataEx         0.38%     620.173ms         0.38%     620.173ms      51.681ms       0.000us         0.00%       0.000us       0.000us            12  
                                 hipPointerGetAttribute         0.03%      42.339ms         0.03%      42.339ms       0.664us       0.000us         0.00%       0.000us       0.000us         63767  
                                        aten::expand_as         0.00%     924.208us         0.00%       3.202ms       5.898us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.253ms         0.00%       4.513ms     410.260us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     104.843us         0.00%     119.552us      59.776us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     110.208us         0.00%     110.208us      55.104us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      59.175us         0.00%      74.704us      74.704us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     266.813us         0.00%       2.372ms     790.519us       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     187.976us         0.00%     210.569us      70.190us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.017ms         0.00%       3.222ms     536.968us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%     705.294us         0.00%       3.385ms     376.111us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.011ms         0.00%       2.238ms     373.057us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     263.758us         0.00%     676.211us     225.404us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     176.897us         0.00%     887.623us     295.874us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     370.304us         0.00%     710.726us     236.909us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     277.154us         0.00%     290.027us      72.507us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.05%      85.013ms         0.05%      85.261ms       2.460us       0.000us         0.00%       0.000us       0.000us         34655  
                                               aten::eq         0.02%      33.221ms         0.02%      33.224ms       5.672us       0.000us         0.00%       0.000us       0.000us          5857  
                                              aten::all         0.04%      60.122ms         0.04%      69.245ms      11.823us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       3.315ms         0.00%       3.315ms       0.135us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     719.660us      51.404us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       4.518ms         0.01%      10.789ms       4.806us       0.000us         0.00%       0.000us       0.000us          2245  
                                          aten::reshape         0.05%      88.412ms         0.10%     156.316ms       3.618us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      63.507ms     132.030us       0.000us         0.00%       0.000us       0.000us           481  
                                           aten::narrow         0.00%       7.925ms         0.02%      27.533ms      10.429us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.02%      25.045ms         0.02%      30.512ms       4.146us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.089ms         0.00%       2.376ms       3.300us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      28.455ms         0.02%      33.833ms       4.229us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.227us         0.00%       1.227us       0.205us       0.000us         0.00%       0.000us       0.000us             6  
                              hipDevicePrimaryCtxRetain         0.00%       1.149us         0.00%       1.149us       0.192us       0.000us         0.00%       0.000us       0.000us             6  
                             hipDevicePrimaryCtxRelease         0.00%       0.980us         0.00%       0.980us       0.163us       0.000us         0.00%       0.000us       0.000us             6  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.02%      33.562ms         0.02%      33.562ms       1.800us       0.000us         0.00%       0.000us       0.000us         18650  
                                              hipMemset         0.00%      39.606us         0.00%      39.606us      19.803us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.21%     343.917ms         0.21%     343.917ms     114.639ms       0.000us         0.00%       0.000us       0.000us             3  
                                 aten::split_with_sizes         0.02%      38.904ms         0.03%      50.602ms       8.785us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      25.722ms         0.02%      25.722ms       1.675us       0.000us         0.00%       0.000us       0.000us         15360  
                                          aten::squeeze         0.03%      56.260ms         0.04%      67.018ms       2.909us       0.000us         0.00%       0.000us       0.000us         23040  
                                      hipModuleLoadData         0.22%     361.195ms         0.22%     361.195ms      90.299ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     515.488us         0.00%       1.190ms     297.511us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       4.948ms         0.00%       5.830ms      24.291us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     686.664us         0.00%     686.664us       2.146us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      32.162ms         0.06%      93.482ms       5.962us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      15.099ms         0.04%      61.320ms       3.911us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     374.609us         0.00%       2.302ms      28.773us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%     651.634us         0.00%       1.927ms      24.091us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      44.713ms         0.06%     106.269ms       4.994us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      16.220ms         0.04%      61.556ms       2.893us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      33.628ms         0.05%      75.077ms       3.107us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%     901.948us         0.00%       2.410ms      10.040us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     338.132us         0.00%       1.508ms       6.282us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     274.283us         0.00%     817.394us      10.217us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     543.111us         0.00%     543.111us       6.789us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     720.574us         0.21%     349.362ms     349.362ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      15.029ms         0.01%      17.062ms       2.221us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.033ms         0.00%       2.033ms       0.265us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       4.188ms         0.01%      15.926ms       7.963us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       3.093ms         0.01%      11.738ms       5.869us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       3.754ms         0.01%      10.054ms       5.237us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       1.673ms         0.00%       6.300ms       3.281us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     345.452us         0.00%     345.452us       0.180us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.018ms         0.00%       2.720ms      34.002us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.703ms         0.00%       1.703ms      21.281us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.367ms         0.00%       2.140ms      26.755us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.442ms     244.190us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      11.091us         0.00%      22.375us       5.594us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 163.867s
Self CUDA time total: 154.780s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       76.372s        49.10%       76.372s       76.372s             1  
                                             bert_train        35.69%       58.497s        70.03%      114.777s      114.777s       0.000us         0.00%       42.187s       42.187s             1  
                                            aten::copy_        15.75%       25.816s        19.42%       31.838s     403.961us       16.623s        10.69%       16.649s     211.239us         78815  
                                     record_param_comms         3.15%        5.170s         4.53%        7.425s     213.883us        9.302s         5.98%       14.708s     423.697us         34714  
                                               aten::to         0.03%      51.774ms        19.41%       31.814s     606.114us       0.000us         0.00%       12.074s     230.036us         52489  
                                         aten::_to_copy         0.09%     150.926ms        19.38%       31.762s     732.783us       0.000us         0.00%       12.074s     278.565us         43345  
                                      aten::masked_fill         0.04%      64.606ms         0.24%     394.457ms      41.089us       0.000us         0.00%       11.798s       1.229ms          9600  
                                     aten::masked_fill_         0.09%     153.580ms         0.20%     334.354ms      20.387us       11.267s         7.24%       11.267s     687.038us         16400  
                                       c10d::allreduce_         0.22%     359.404ms         2.45%        4.016s     238.921us       0.000us         0.00%        9.538s     567.348us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        9.270s         5.96%        9.270s     955.188us          9705  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        9.152s         5.88%        9.152s     934.007us          9799  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      18.463ms         0.12%     198.275ms      51.634us       0.000us         0.00%        7.777s       2.025ms          3840  
                                    MaskedFillBackward0         0.00%       7.634ms         0.11%     179.812ms      46.826us       0.000us         0.00%        7.777s       2.025ms          3840  
                                              aten::bmm         0.26%     421.486ms         0.31%     508.074ms      37.803us        7.151s         4.60%        7.151s     532.067us         13440  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.676s         4.29%        6.676s       1.471ms          4538  
autograd::engine::evaluate_function: _LayerNormLinea...         0.06%      94.142ms         2.15%        3.529s     918.926us       0.000us         0.00%        6.626s       1.725ms          3840  
                               _LayerNormLinearBackward         1.13%        1.856s         2.06%        3.373s     878.425us     319.208ms         0.21%        6.486s       1.689ms          3840  
autograd::engine::evaluate_function: SoftmaxBackward...         0.01%       8.297ms         0.05%      74.215ms      38.654us       0.000us         0.00%        6.471s       3.370ms          1920  
                                       SoftmaxBackward0         0.00%       7.170ms         0.04%      65.918ms      34.332us       0.000us         0.00%        6.471s       3.370ms          1920  
                           aten::_softmax_backward_data         0.01%      20.550ms         0.04%      58.748ms      30.598us        3.341s         2.15%        6.471s       3.370ms          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.214s         4.00%        6.214s     750.685us          8278  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.728s         3.68%        5.728s       1.217ms          4708  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      14.748ms         0.06%      94.497ms      24.106us       0.000us         0.00%        5.002s       1.276ms          3920  
                                        ToCopyBackward0         0.00%       6.996ms         0.05%      79.749ms      20.344us       0.000us         0.00%        5.002s       1.276ms          3920  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.589s         2.95%        4.589s     970.502us          4728  
                                            aten::clone         0.06%      95.136ms         0.37%     600.859ms      17.393us       0.000us         0.00%        4.572s     132.339us         34546  
                                          aten::softmax         0.01%      10.402ms         0.07%     116.848ms      20.286us       0.000us         0.00%        4.477s     777.289us          5760  
                                         aten::_softmax         0.04%      64.050ms         0.06%     106.441ms      18.479us        4.477s         2.88%        4.477s     777.289us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.477s         2.88%        4.477s       1.710ms          2618  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.473s         2.88%        4.473s     551.932us          8104  
                                     tex_ts::te_gemm_ts         1.15%        1.885s         1.68%        2.754s      71.713us        4.218s         2.71%        4.226s     110.045us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.852s         2.48%        3.852s     848.906us          4538  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.648s         2.35%        3.648s     316.666us         11520  
                                          c10d::barrier         0.00%     719.990us         1.17%        1.923s      50.602ms       0.000us         0.00%        3.362s      88.462ms            38  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.341s         2.15%        3.341s       1.740ms          1920  
                                                _Linear         0.77%        1.262s         1.31%        2.151s     560.125us      65.938ms         0.04%        3.181s     828.513us          3840  
                                              aten::mul         0.08%     129.789ms         0.11%     184.174ms      23.106us        3.158s         2.03%        3.158s     396.235us          7971  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.132s         2.01%        3.132s       1.425ms          2198  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      17.725ms         0.13%     211.427ms     110.118us       0.000us         0.00%        3.093s       1.611ms          1920  
                                       BaddbmmBackward0         0.01%      19.883ms         0.12%     193.703ms     100.887us       0.000us         0.00%        3.093s       1.611ms          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.905s         1.22%        1.905s     409.954us          4647  
                                       aten::logical_or         0.05%      90.068ms         0.17%     274.341ms      23.814us     903.973ms         0.58%        1.808s     156.941us         11520  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      21.235ms         0.13%     210.803ms     109.793us       0.000us         0.00%        1.783s     928.558us          1920  
                                           BmmBackward0         0.01%      13.781ms         0.12%     189.568ms      98.733us       0.000us         0.00%        1.783s     928.558us          1920  
                                   hipStreamSynchronize         0.44%     724.795ms         0.44%     724.864ms     227.873us        1.708s         1.10%        1.711s     537.901us          3181  
                                       c10d::broadcast_         0.02%      35.836ms         0.50%     821.542ms       1.708ms       0.000us         0.00%        1.690s       3.514ms           481  
                                   hipDeviceGetPCIBusId         0.01%      11.767ms         0.01%      11.767ms       0.683us        1.640s         1.05%        1.640s      95.191us         17227  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      39.137ms         1.03%        1.686s     439.128us       0.000us         0.00%        1.596s     415.715us          3840  
                                        _LinearBackward         0.66%        1.078s         1.00%        1.647s     428.936us      76.156ms         0.05%        1.596s     415.715us          3840  
                                              aten::sub         0.05%      84.506ms         0.07%     109.983ms      16.740us        1.577s         1.01%        1.577s     239.966us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.574s         1.01%        1.574s     601.327us          2618  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.516s         0.97%        1.516s     789.483us          1920  
                                          aten::dropout         0.01%       8.777ms         0.06%      92.151ms      15.320us       0.000us         0.00%        1.468s     244.029us          6015  
                                   aten::native_dropout         0.02%      34.718ms         0.05%      80.453ms      40.046us        1.468s         0.94%        1.468s     730.630us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.468s         0.94%        1.468s     733.918us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      11.508ms         0.04%      66.274ms      33.087us       0.000us         0.00%        1.381s     689.439us          2003  
                                 NativeDropoutBackward0         0.00%       6.565ms         0.03%      54.766ms      27.342us       0.000us         0.00%        1.381s     689.439us          2003  
                          aten::native_dropout_backward         0.01%      19.292ms         0.03%      48.201ms      24.064us        1.381s         0.89%        1.381s     689.439us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.381s         0.89%        1.381s     690.473us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.366s         0.88%        1.366s      78.193us         17471  
                                   hipStreamIsCapturing         0.03%      43.426ms         0.03%      43.426ms       0.838us        1.352s         0.87%        1.352s      26.078us         51845  
                                          aten::baddbmm         0.18%     291.595ms         0.38%     630.540ms     109.469us        1.204s         0.77%        1.204s     209.065us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.121s         0.72%        1.121s     583.657us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      24.097ms         0.63%        1.041s     271.013us       0.000us         0.00%     981.959ms     255.719us          3840  
                               CompiledFunctionBackward         0.31%     514.673ms         0.62%        1.017s     264.738us       0.000us         0.00%     981.959ms     255.719us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     903.973ms         0.58%     903.973ms     345.292us          2618  
                                 triton_red_fused_sum_1         0.02%      38.177ms         0.04%      60.519ms      15.760us     886.444ms         0.57%     886.444ms     230.845us          3840  
                                  hipExtMallocWithFlags         0.03%      42.012ms         0.03%      42.012ms       9.951us     773.710ms         0.50%     773.710ms     183.257us          4222  
                                      aten::logical_not         0.07%     120.005ms         0.22%     359.110ms      15.586us     319.693ms         0.21%     639.702ms      27.765us         23040  
                                        hipEventDestroy         0.03%      42.351ms         0.03%      42.678ms       2.100us     466.181ms         0.30%     466.202ms      22.938us         20324  
                                  Torch-Compiled Region         0.46%     749.979ms         1.35%        2.207s     114.825us       0.000us         0.00%     425.949ms      22.162us         19220  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.255ms         0.00%       2.255ms       0.159us     423.188ms         0.27%     423.188ms      29.920us         14144  
                                      hipGetProcAddress         0.04%      68.223ms         0.04%      68.223ms       0.991us     421.293ms         0.27%     421.293ms       6.119us         68854  
                                       hipCtxGetCurrent         0.01%      10.003ms         0.01%      10.003ms       0.199us     339.369ms         0.22%     339.369ms       6.761us         50194  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     319.693ms         0.21%     319.693ms      61.057us          5236  
                                             aten::add_         0.10%     163.142ms         0.18%     293.457ms       9.340us     301.436ms         0.19%     302.030ms       9.613us         31420  
                                       CompiledFunction         0.53%     863.755ms         0.77%        1.266s     109.703us       0.000us         0.00%     299.918ms      25.989us         11540  
                                       _LayerNormLinear         0.33%     536.436ms         0.89%        1.456s     379.119us     169.185ms         0.11%     290.041ms      75.531us          3840  
                                              aten::sum         0.19%     311.590ms         0.40%     657.070ms      32.284us     208.396ms         0.13%     274.303ms      13.477us         20353  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     257.148ms         0.17%     257.148ms      66.966us          3840  
                                       hipStreamDestroy         0.03%      46.477ms         0.03%      46.477ms      17.699us     233.460ms         0.15%     233.460ms      88.903us          2626  
                  triton_poi_fused_add_native_dropout_0         0.04%      69.752ms         0.07%     107.598ms      27.948us     224.278ms         0.14%     225.347ms      58.532us          3850  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     196.037ms         0.13%     196.037ms      37.447us          5235  
                                         hipMemcpyAsync         0.11%     182.887ms         0.11%     182.899ms      14.975us     186.390ms         0.12%     186.390ms      15.260us         12214  
                         _ReduceFromModelParallelRegion         0.01%      19.392ms         0.04%      57.554ms     239.808us       0.000us         0.00%     174.234ms     725.974us           240  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     163.842ms         0.11%     163.842ms     163.842ms             1  
autograd::engine::evaluate_function: torch::autograd...         0.20%     322.762ms         0.39%     636.751ms      26.356us       0.000us         0.00%     161.124ms       6.669us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     159.494ms         0.10%     159.494ms       6.668us         23920  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     152.801ms         0.10%     152.801ms      29.194us          5234  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.02%      27.244ms         0.39%     634.956ms     330.706us       0.000us         0.00%     150.487ms      78.379us          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     149.653ms         0.10%     149.653ms      33.554us          4460  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     145.731ms         0.09%     145.731ms     659.416us           221  
                             _VocabParallelCrossEntropy         0.03%      55.963ms         0.13%     216.206ms     900.859us       0.000us         0.00%     136.524ms     568.852us           240  
                                              aten::cat         0.08%     133.918ms         0.11%     178.225ms      22.058us     132.441ms         0.09%     135.347ms      16.751us          8080  
                               hipStreamCreateWithFlags         0.18%     298.081ms         0.18%     298.081ms     112.653us     132.102ms         0.08%     132.102ms      49.925us          2646  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     131.653ms         0.08%     131.653ms      33.585us          3920  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.716ms         0.07%     107.588ms       1.345ms       0.000us         0.00%     127.935ms       1.599ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      20.973ms         0.06%     105.872ms       1.323ms       0.000us         0.00%     127.935ms       1.599ms            80  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       5.946ms        24.30%       39.836s     165.981ms       0.000us         0.00%     126.162ms     525.676us           240  
                                     EmbeddingBackward0         0.00%       2.806ms        24.30%       39.828s     165.950ms       0.000us         0.00%     125.312ms     522.135us           240  
                               aten::embedding_backward         0.00%       2.485ms        24.30%       39.825s     165.939ms       0.000us         0.00%     125.312ms     522.135us           240  
                         aten::embedding_dense_backward         0.92%        1.502s        24.30%       39.823s     165.928ms     120.217ms         0.08%     125.312ms     522.135us           240  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      17.299ms         0.15%     241.551ms     125.808us       0.000us         0.00%     114.603ms      59.689us          1920  
                                 _SplitAlongDimBackward         0.10%     170.300ms         0.14%     224.252ms     116.798us       0.000us         0.00%     114.603ms      59.689us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     114.603ms         0.07%     114.603ms      59.689us          1920  
                             c10d::allreduce_coalesced_         0.00%       1.613ms         0.06%      92.368ms       9.237ms       0.000us         0.00%     112.916ms      11.292ms            10  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     109.105ms         0.07%     109.105ms      50.511us          2160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     104.888ms         0.07%     104.888ms       9.913us         10581  
                                       aten::contiguous         0.01%      22.032ms         0.25%     407.327ms      17.679us       0.000us         0.00%     104.346ms       4.529us         23040  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     103.409ms         0.07%     103.409ms      17.953us          5760  
                                               aten::mm         0.03%      48.074ms         0.06%      91.279ms     103.726us     101.724ms         0.07%     101.724ms     115.596us           880  
             triton_poi_fused_native_dropout_backward_0         0.04%      67.080ms         0.06%      98.529ms      25.659us      95.516ms         0.06%      95.516ms      24.874us          3840  
                                         hipMemsetAsync         0.07%     107.440ms         0.07%     107.457ms       8.961us      91.411ms         0.06%      92.163ms       7.685us         11992  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      86.787ms         0.06%      86.787ms      33.163us          2617  
                                           aten::matmul         0.00%       2.712ms         0.04%      65.224ms     163.059us       0.000us         0.00%      84.857ms     212.141us           400  
                                           GeLUFunction         0.08%     132.037ms         0.50%     814.979ms     141.489us       0.000us         0.00%      83.926ms      14.570us          5760  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us      79.892ms         0.05%      79.892ms      15.411us          5184  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      77.333ms         0.05%      77.333ms       9.846us          7854  
                        triton_poi_fused_add_mul_tanh_0         0.06%      93.022ms         0.07%     113.055ms      19.594us      74.846ms         0.05%      76.945ms      13.335us          5770  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      73.221ms         0.05%      73.221ms      27.968us          2618  
                                           aten::arange         0.07%     109.173ms         0.20%     320.728ms      13.017us      34.584ms         0.02%      69.185ms       2.808us         24640  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      66.295ms         0.04%      66.295ms     276.231us           240  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      63.954ms         0.04%      63.954ms      16.315us          3920  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      63.206ms         0.04%      63.206ms       5.281us         11968  
                                 hipDeviceCanAccessPeer         0.00%     279.318us         0.00%     279.318us       0.144us      63.069ms         0.04%      63.069ms      32.443us          1944  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      62.431ms         0.04%      62.431ms      14.505us          4304  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.16%     269.639ms         0.29%     472.560ms      61.531us      60.308ms         0.04%      62.199ms       8.099us          7680  
                                    hipIpcOpenMemHandle         0.05%      85.718ms         0.05%      85.718ms      49.634us      58.047ms         0.04%      58.047ms      33.612us          1727  
                                  hipModuleLaunchKernel         0.13%     219.000ms         0.13%     219.017ms       6.401us      53.653ms         0.03%      54.670ms       1.598us         34214  
        LinearWithGradAccumulationAndAsyncCommunication         0.00%       5.994ms         0.01%      19.973ms      83.223us       0.000us         0.00%      50.416ms     210.067us           240  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      47.777ms         0.03%      47.777ms      12.442us          3840  
                                     hipIpcGetMemHandle         0.01%      10.308ms         0.01%      10.308ms       5.989us      47.136ms         0.03%      47.136ms      27.389us          1721  
                                   GeLUFunctionBackward         0.03%      56.745ms         0.32%     525.389ms     273.640us       0.000us         0.00%      43.509ms      22.661us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      32.506ms         0.03%      49.024ms      25.533us      43.509ms         0.03%      43.509ms      22.661us          1920  
                                 triton_poi_fused_add_0         0.10%     158.037ms         0.10%     170.081ms      22.146us      41.512ms         0.03%      41.512ms       5.405us          7680  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      37.236ms         0.02%      37.236ms      19.394us          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      33.473ms         0.02%      33.473ms       6.393us          5236  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      32.197ms         0.02%      32.197ms       6.149us          5236  
                                    hipMemcpyWithStream        28.13%       46.112s        28.14%       46.117s      57.574ms       0.000us         0.00%      30.628ms      38.237us           801  
                                            aten::fill_         0.07%     114.405ms         0.09%     142.272ms       4.920us      29.917ms         0.02%      29.917ms       1.035us         28919  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      29.487ms         0.02%      29.487ms      11.263us          2618  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      28.333ms         0.02%      28.333ms     177.081us           160  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.490ms         0.03%      50.458ms     630.722us       0.000us         0.00%      26.496ms     331.201us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      26.244ms         0.02%      26.244ms       6.834us          3840  
                                            aten::zero_         0.04%      62.013ms         0.12%     195.080ms       8.614us       0.000us         0.00%      25.990ms       1.148us         22646  
                                            aten::zeros         0.04%      65.987ms         0.18%     292.188ms      13.041us       0.000us         0.00%      25.977ms       1.159us         22406  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.496ms         0.02%      24.496ms     306.206us            80  
                                              aten::exp         0.00%       2.268ms         0.01%      16.540ms      68.916us      23.837ms         0.02%      23.837ms      99.321us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.837ms         0.02%      23.837ms     218.688us           109  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.993ms         0.03%      50.367ms     209.862us       0.000us         0.00%      23.608ms      98.366us           240  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      23.495ms         0.02%      23.495ms      36.539us           643  
                                          aten::randint         0.02%      31.875ms         0.08%     124.561ms      32.320us       0.000us         0.00%      23.133ms       6.002us          3854  
                                     hipStreamWaitEvent         0.19%     308.044ms         0.19%     308.082ms      14.668us      20.643ms         0.01%      21.573ms       1.027us         21004  
                                              aten::add         0.03%      56.277ms         0.05%      79.550ms      44.541us      21.528ms         0.01%      21.528ms      12.054us          1786  
                                          aten::random_         0.03%      52.356ms         0.06%      90.299ms      23.454us      20.961ms         0.01%      21.147ms       5.493us          3850  
                                             aten::div_         0.00%       4.571ms         0.01%       9.899ms      20.624us      20.988ms         0.01%      20.988ms      43.724us           480  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      20.961ms         0.01%      20.961ms       5.444us          3850  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      20.646ms         0.01%      20.646ms      94.708us           218  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.326ms         0.01%      20.326ms     186.476us           109  
                                           aten::linear         0.00%       2.666ms         0.03%      44.948ms      62.428us       0.000us         0.00%      19.741ms      27.419us           720  
                                            aten::addmm         0.02%      31.865ms         0.02%      37.996ms      52.772us      19.741ms         0.01%      19.741ms      27.419us           720  
                                             aten::sub_         0.00%       3.860ms         0.00%       5.159ms      16.122us      19.428ms         0.01%      19.428ms      60.713us           320  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      18.882ms         0.01%      18.882ms     173.226us           109  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      17.839ms         0.01%      17.839ms       6.179us          2887  
                                 tex_ts::cast_to_fp8_ts         0.06%     103.946ms         0.09%     155.474ms      20.244us      17.207ms         0.01%      17.215ms       2.241us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      17.207ms         0.01%      17.207ms      12.343us          1394  
                                        aten::embedding         0.00%       6.054ms         0.02%      26.289ms      36.512us       0.000us         0.00%      16.948ms      23.539us           720  
                                     aten::index_select         0.01%      11.164ms         0.01%      17.773ms      24.685us      16.907ms         0.01%      16.948ms      23.539us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.907ms         0.01%      16.907ms      51.233us           330  
                                         AddmmBackward0         0.00%       3.192ms         0.02%      38.395ms     159.980us       0.000us         0.00%      16.868ms      70.283us           240  
                                           aten::cumsum         0.05%      86.728ms         0.07%     111.113ms      19.290us      16.663ms         0.01%      16.699ms       2.899us          5760  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      16.663ms         0.01%      16.663ms       6.365us          2618  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      16.535ms         0.01%      16.535ms       6.282us          2632  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      16.534ms         0.01%      16.534ms       6.316us          2618  
                     _VocabParallelCrossEntropyBackward         0.01%      18.496ms         0.03%      44.683ms     558.538us       0.000us         0.00%      16.431ms     205.390us            80  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.082ms         0.01%      13.082ms      81.762us           160  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      12.787ms         0.01%      12.787ms       6.660us          1920  
                                             aten::mul_         0.00%       6.507ms         0.00%       7.232ms       5.650us      12.526ms         0.01%      12.526ms       9.786us          1280  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.258ms         0.01%      12.258ms     112.463us           109  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.772ms         0.01%      11.772ms     108.003us           109  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      11.309ms         0.01%      11.309ms     103.757us           109  
                                            aten::index         0.01%      11.598ms         0.04%      58.501ms     103.176us       2.047ms         0.00%       9.904ms      17.468us           567  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.530ms         0.01%       9.530ms      39.710us           240  
                                       aten::index_put_         0.00%       4.923ms         0.08%     128.985ms     115.165us       0.000us         0.00%       9.422ms       8.412us          1120  
                                 aten::_index_put_impl_         0.00%       7.172ms         0.08%     124.062ms     110.770us     810.707us         0.00%       9.422ms       8.412us          1120  
                                              aten::max         0.00%       5.014ms         0.02%      32.441ms     127.721us       9.255ms         0.01%       9.276ms      36.520us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.241ms         0.01%       9.241ms      84.779us           109  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       8.962ms         0.01%       8.962ms      37.341us           240  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.543ms         0.01%       8.543ms      20.008us           427  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.682ms         0.01%      13.918ms     173.969us       0.000us         0.00%       8.396ms     104.947us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.807ms         0.01%      11.236ms     140.445us       8.396ms         0.01%       8.396ms     104.947us            80  
                           FusedLayerNormAffineFunction         0.01%       9.792ms         0.01%      16.487ms      68.697us       8.083ms         0.01%       8.083ms      33.678us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       8.083ms         0.01%       8.083ms      74.153us           109  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.121ms         0.02%      27.818ms     347.726us       0.000us         0.00%       7.983ms      99.791us            80  
                            torch::autograd::CopySlices         0.00%       4.286ms         0.02%      25.697ms     321.219us       0.000us         0.00%       7.983ms      99.791us            80  
                                          aten::nonzero         0.00%       5.299ms         0.02%      32.961ms     134.533us       7.857ms         0.01%       7.857ms      32.071us           245  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.195ms         0.00%       7.195ms      10.489us           686  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.640ms         0.00%       6.640ms      82.998us            80  
         _compile.<locals>.compile_inner (dynamo_timed)         0.06%      96.501ms         1.49%        2.442s     244.203ms       0.000us         0.00%       6.257ms     625.695us            10  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     491.049us         0.00%       2.122ms     212.222us       6.192ms         0.00%       6.192ms     619.250us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.192ms         0.00%       6.192ms      56.295us           110  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       6.187ms         0.00%       6.187ms       6.852us           903  
          OutputGraph.call_user_compiler (dynamo_timed)         0.01%      20.859ms         1.41%        2.313s     231.310ms       0.000us         0.00%       6.177ms     617.708us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.24%     399.982ms         1.40%        2.292s     229.224ms       0.000us         0.00%       6.177ms     617.708us            10  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       5.892ms         0.00%       5.892ms      24.551us           240  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       4.819ms         0.00%       4.819ms       5.020us           960  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       4.766ms         0.00%       4.766ms      29.790us           160  
                                                hipFree         0.07%     108.305ms         0.07%     108.344ms       6.019ms      59.437us         0.00%       4.466ms     248.126us            18  
                                        aten::index_put         0.00%       1.502ms         0.01%      10.969ms     132.162us       0.000us         0.00%       4.245ms      51.147us            83  
                                      IndexPutBackward0         0.00%       1.087ms         0.01%      11.688ms     146.098us       0.000us         0.00%       4.245ms      53.065us            80  
                                  hipMemGetAddressRange         0.00%     179.175us         0.00%     179.175us       0.399us       4.239ms         0.00%       4.239ms       9.441us           449  
                                 c10d::_allgather_base_         0.00%     218.831us         0.00%       1.319ms      94.210us       0.000us         0.00%       3.983ms     284.469us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       3.983ms         0.00%       3.983ms     331.880us            12  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       3.982ms         0.00%       3.982ms      49.775us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       3.861ms         0.00%       3.861ms      48.269us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%       1.027ms         0.01%      18.499ms     231.243us       0.000us         0.00%       3.600ms      44.995us            80  
                                     _LayerNormBackward         0.00%       5.632ms         0.01%      17.473ms     218.412us       3.600ms         0.00%       3.600ms      44.995us            80  
                                             aten::ones         0.00%     917.082us         0.00%       5.568ms      11.600us       0.000us         0.00%       3.365ms       7.010us           480  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     813.814us         0.00%       3.302ms      41.275us       0.000us         0.00%       3.229ms      40.363us            80  
                                          GeluBackward0         0.00%     486.373us         0.00%       2.488ms      31.103us       0.000us         0.00%       3.229ms      40.363us            80  
                                    aten::gelu_backward         0.00%       1.312ms         0.00%       2.002ms      25.023us       3.229ms         0.00%       3.229ms      40.363us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.229ms         0.00%       3.229ms      40.363us            80  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      12.082ms         1.00%        1.639s     163.898ms       0.000us         0.00%       3.150ms     315.007us            10  
                        compile_fx_inner (dynamo_timed)         0.03%      54.245ms         1.20%        1.969s     179.010ms       0.000us         0.00%       3.150ms     286.370us            11  
         GraphLowering.compile_to_module (dynamo_timed)         0.58%     949.341ms         1.07%        1.754s     159.491ms       0.000us         0.00%       3.100ms     281.789us            11  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     756.448us         0.00%       4.907ms      61.338us       0.000us         0.00%       3.016ms      37.696us            80  
                                             aten::gelu         0.00%       2.871ms         0.00%       7.266ms      30.276us       2.685ms         0.00%       2.685ms      11.187us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.685ms         0.00%       2.685ms      24.631us           109  
                            hipGetDevicePropertiesR0600         0.05%      82.057ms         0.05%      82.057ms       0.882us       2.627ms         0.00%       2.627ms       0.028us         93073  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.400ms         0.00%       2.400ms      22.019us           109  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.387ms         0.00%       2.387ms       4.429us           539  
                               TorchDynamo Cache Lookup         0.11%     176.814ms         0.11%     176.826ms       9.200us       0.000us         0.00%       2.311ms       0.120us         19221  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.183ms         0.00%       2.183ms       4.985us           438  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.178ms         0.00%       2.178ms       5.556us           392  
                                             _LayerNorm         0.00%       4.640ms         0.01%       8.457ms     105.711us       1.837ms         0.00%       2.172ms      27.150us            80  
                                              aten::div         0.01%       8.710ms         0.01%      11.754ms      17.702us       2.138ms         0.00%       2.138ms       3.220us           664  
                                              hipMemcpy         0.01%      11.211ms         0.01%      11.211ms     233.563us       2.109ms         0.00%       2.109ms      43.938us            48  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     621.153us         0.00%       7.981ms      49.882us       0.000us         0.00%       2.050ms      12.811us           160  
                                         SliceBackward0         0.00%     530.381us         0.00%       7.360ms      46.000us       0.000us         0.00%       2.050ms      12.811us           160  
                                   aten::slice_backward         0.00%       1.028ms         0.00%       6.830ms      42.685us       0.000us         0.00%       2.050ms      12.811us           160  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.047ms         0.00%       2.047ms      10.662us           192  
                                        hipLaunchKernel         0.74%        1.211s         0.74%        1.211s       7.771us       1.857ms         0.00%       2.046ms       0.013us        155842  
                                  hipDeviceGetAttribute         0.00%     197.361us         0.00%     197.361us       2.946us       1.836ms         0.00%       1.836ms      27.410us            67  
                                    hipFuncGetAttribute         0.00%       4.208us         0.00%       4.208us       0.351us       1.796ms         0.00%       1.796ms     149.696us            12  
                                   hipDeviceSynchronize         0.00%     547.222us         0.00%     547.222us      16.095us       1.777ms         0.00%       1.777ms      52.260us            34  
                                            aten::empty         0.45%     740.006ms         0.45%     744.305ms       2.835us       0.000us         0.00%       1.723ms       0.007us        262555  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.647ms         0.00%       1.647ms      15.106us           109  
      autograd::engine::evaluate_function: MulBackward0         0.01%       9.687ms         0.03%      48.211ms     280.294us       0.000us         0.00%       1.632ms       9.489us           172  
                                               aten::lt         0.01%      15.814ms         0.01%      18.482ms      25.670us       1.625ms         0.00%       1.625ms       2.257us           720  
                                           aten::select         0.19%     317.015ms         0.23%     384.529ms       3.928us       0.000us         0.00%       1.608ms       0.016us         97887  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.543ms         0.00%       1.543ms       4.852us           318  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.536ms         0.00%       1.536ms       6.398us           240  
                               aten::cross_entropy_loss         0.00%       1.137ms         0.01%      14.960ms      62.332us       0.000us         0.00%       1.413ms       5.888us           240  
                                        SelectBackward0         0.00%     249.619us         0.00%       3.071ms      38.387us       0.000us         0.00%       1.379ms      17.232us            80  
                                  aten::select_backward         0.00%     437.906us         0.00%       2.821ms      35.267us       0.000us         0.00%       1.379ms      17.232us            80  
                                    hipModuleLoadDataEx         0.37%     609.008ms         0.37%     609.008ms      50.751ms       1.280ms         0.00%       1.280ms     106.662us            12  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.257ms         0.00%       1.257ms       6.651us           189  
                                        aten::transpose         0.14%     226.210ms         0.17%     279.348ms       2.932us       0.000us         0.00%       1.228ms       0.013us         95285  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.094ms         0.00%       1.094ms       4.997us           219  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.873ms         0.01%       8.409ms      52.556us       0.000us         0.00%       1.089ms       6.804us           160  
                                           DivBackward0         0.00%       1.157ms         0.00%       6.536ms      40.851us       0.000us         0.00%       1.089ms       6.804us           160  
                                           MulBackward0         0.00%       6.713ms         0.02%      28.169ms     163.774us       0.000us         0.00%       1.083ms       6.296us           172  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.082ms         0.00%       1.082ms      13.522us            80  
                                           aten::__or__         0.00%       1.151ms         0.01%      16.947ms      35.306us       0.000us         0.00%       1.080ms       2.250us           480  
                                       aten::bitwise_or         0.00%       6.792ms         0.01%      15.796ms      32.908us       1.080ms         0.00%       1.080ms       2.250us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.080ms         0.00%       1.080ms       4.931us           219  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.778ms         0.01%      10.437ms     130.465us       0.000us         0.00%       1.076ms      13.448us            80  
                                       NllLossBackward0         0.00%     991.744us         0.01%       8.659ms     108.238us       0.000us         0.00%       1.076ms      13.448us            80  
                                aten::nll_loss_backward         0.00%       3.466ms         0.00%       7.667ms      95.841us     532.707us         0.00%       1.076ms      13.448us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.068ms         0.00%       1.068ms       4.876us           219  
                                               aten::ge         0.00%       5.602ms         0.00%       6.596ms      13.743us       1.051ms         0.00%       1.051ms       2.189us           480  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.035ms         0.00%       1.035ms       2.142us           483  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us     964.894us         0.00%     964.894us       6.031us           160  
                               hipExtModuleLaunchKernel         0.16%     264.976ms         0.16%     264.998ms       6.629us       0.000us         0.00%     913.784us       0.023us         39977  
                                   hipFuncGetAttributes         0.13%     214.200ms         0.13%     214.200ms       1.623ms     905.123us         0.00%     905.123us       6.857us           132  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     865.272us         0.00%     865.272us       7.938us           109  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     810.707us         0.00%     810.707us      10.134us            80  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     743.990us         0.00%     743.990us       9.300us            80  
                                             aten::tanh         0.01%      10.075ms         0.01%      18.446ms      68.065us     719.177us         0.00%     719.177us       2.654us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     719.177us         0.00%     719.177us       6.598us           109  
                                      aten::log_softmax         0.00%     845.242us         0.00%       4.894ms      20.393us       0.000us         0.00%     712.040us       2.967us           240  
                                     aten::_log_softmax         0.00%       2.964ms         0.00%       3.953ms      16.472us     712.040us         0.00%     712.040us       2.967us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     712.040us         0.00%     712.040us       6.532us           109  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     702.209us         0.00%     702.209us       2.890us           243  
                                      aten::nll_loss_nd         0.00%     648.729us         0.01%       8.929ms      37.203us       0.000us         0.00%     700.967us       2.921us           240  
                                         aten::nll_loss         0.00%     617.701us         0.01%       8.280ms      34.500us       0.000us         0.00%     700.967us       2.921us           240  
                                 aten::nll_loss_forward         0.00%       3.434ms         0.00%       7.662ms      31.926us     700.967us         0.00%     700.967us       2.921us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     700.967us         0.00%     700.967us       6.431us           109  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     699.649us         0.00%     699.649us       6.419us           109  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     688.022us         0.00%     688.022us       8.600us            80  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     678.758us         0.00%     678.758us       2.828us           240  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     666.812us         0.00%     666.812us       8.335us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     659.872us         0.00%     659.872us       6.054us           109  
                                            aten::slice         0.04%      73.442ms         0.05%      87.000ms       3.331us       0.000us         0.00%     619.947us       0.024us         26118  
                                             aten::item         0.02%      26.122ms         0.43%     712.810ms      42.432us       0.000us         0.00%     603.304us       0.036us         16799  
                              aten::_local_scalar_dense         0.01%      12.047ms         0.42%     686.691ms      40.877us     603.304us         0.00%     603.304us       0.036us         16799  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     575.314us         0.00%     575.314us       2.397us           240  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     567.023us         0.00%     567.023us       7.088us            80  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       4.407ms         0.01%       8.754ms      54.713us     563.025us         0.00%     563.025us       3.519us           160  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     555.367us         0.00%     555.367us       2.285us           243  
                                             aten::rsub         0.00%       2.554ms         0.00%       7.728ms      89.856us       0.000us         0.00%     552.795us       6.428us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     552.795us         0.00%     552.795us       6.910us            80  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     552.272us         0.00%     552.272us       6.903us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     551.827us         0.00%     551.827us       6.898us            80  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     549.943us         0.00%     549.943us       2.263us           243  
                                          aten::normal_         0.64%        1.055s         0.64%        1.056s      10.157ms     524.968us         0.00%     532.786us       5.123us           104  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     532.707us         0.00%     532.707us       6.659us            80  
                                        aten::ones_like         0.00%     478.239us         0.00%       2.009ms      25.112us       0.000us         0.00%     528.133us       6.602us            80  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     524.968us         0.00%     524.968us       5.412us            97  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     808.070us         0.00%       4.920ms      61.499us       0.000us         0.00%     524.522us       6.557us            80  
                                    LogSoftmaxBackward0         0.00%     884.037us         0.00%       4.112ms      51.399us       0.000us         0.00%     524.522us       6.557us            80  
                       aten::_log_softmax_backward_data         0.00%       1.911ms         0.00%       3.228ms      40.348us     524.522us         0.00%     524.522us       6.557us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     524.522us         0.00%     524.522us       6.557us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.108ms         0.01%      17.800ms     217.073us       0.000us         0.00%     524.204us       6.393us            82  
                                          TanhBackward0         0.00%       1.601ms         0.01%      16.692ms     203.559us       0.000us         0.00%     524.204us       6.393us            82  
                                    aten::tanh_backward         0.00%       2.457ms         0.01%      13.249ms     161.573us     524.204us         0.00%     524.204us       6.393us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     524.204us         0.00%     524.204us       6.553us            80  
                                          hipHostMalloc         0.07%     122.568ms         0.07%     122.568ms       3.714ms     522.402us         0.00%     522.402us      15.830us            33  
                                         _SplitAlongDim         0.07%     111.332ms         0.10%     161.766ms      28.084us       0.000us         0.00%     514.584us       0.089us          5760  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     492.816us         0.00%     492.816us       4.480us           110  
                                               aten::gt         0.02%      34.718ms         0.03%      41.114ms       9.471us     485.591us         0.00%     485.591us       0.112us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     483.266us         0.00%     483.266us       1.997us           242  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     388.568us         0.00%     388.568us       1.619us           240  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     370.492us         0.00%     370.492us       1.544us           240  
                                              aten::log         0.00%       2.776ms         0.00%       7.037ms      29.322us     352.369us         0.00%     352.369us       1.468us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     352.369us         0.00%     352.369us       3.233us           109  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     293.154us         0.00%     293.154us       1.832us           160  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     270.984us         0.00%     270.984us       3.387us            80  
                                             aten::view         0.16%     255.526ms         0.16%     260.617ms       1.802us       0.000us         0.00%     240.915us       0.002us        144633  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     201.824us         0.00%     201.824us       3.480us            58  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     200.026us         0.00%     200.026us       2.128us            94  
                                             aten::rand         0.00%       1.756ms         0.00%       4.804ms     343.158us       0.000us         0.00%     146.719us      10.480us            14  
                                         aten::uniform_         0.01%       8.983ms         0.01%      10.945ms     841.906us     146.719us         0.00%     146.719us      11.286us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     146.719us         0.00%     146.719us      29.344us             5  
                                       aten::lift_fresh         0.02%      37.382ms         0.03%      41.639ms      23.578us       0.000us         0.00%      47.106us       0.027us          1766  
                                        aten::unsqueeze         0.02%      24.683ms         0.02%      30.089ms       4.088us       0.000us         0.00%      41.656us       0.006us          7360  
                                       aten::empty_like         0.10%     161.176ms         0.28%     457.410ms       5.143us       0.000us         0.00%      34.179us       0.000us         88930  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      33.838us         0.00%      33.838us       3.384us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      22.414us         0.00%      22.414us       2.241us            10  
                                          aten::maximum         0.00%     116.548us         0.01%      22.670ms       2.519ms      21.531us         0.00%      21.531us       2.392us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      21.531us         0.00%      21.531us       2.392us             9  
                                       aten::reciprocal         0.00%     148.394us         0.00%       8.085ms     808.472us      19.483us         0.00%      19.483us       1.948us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      19.483us         0.00%      19.483us       1.948us            10  
                                              aten::min         0.00%      87.615us         0.00%       3.453ms     690.644us      15.876us         0.00%      15.876us       3.175us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.876us         0.00%      15.876us       5.292us             3  
                                    hipFuncSetAttribute         0.00%       8.026us         0.00%       8.026us       0.334us      13.913us         0.00%      13.913us       0.580us            24  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.591us         0.00%      13.591us       4.530us             3  
                            hipGetDevicePropertiesR0000         0.00%      42.053us         0.00%      42.053us       4.205us       9.942us         0.00%       9.942us       0.994us            10  
                                          aten::resize_         0.05%      86.236ms         0.05%      86.486ms       2.496us       0.000us         0.00%       8.900us       0.000us         34655  
                                              hipMalloc         0.01%      14.160ms         0.01%      14.160ms      86.339us       6.135us         0.00%       6.135us       0.037us           164  
                                    aten::empty_strided         0.17%     282.025ms         0.18%     288.621ms       3.256us       0.000us         0.00%       5.132us       0.000us         88647  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.325us         0.00%       2.325us       2.325us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.205us         0.00%       2.205us       2.205us             1  
                        hipDeviceGetStreamPriorityRange         0.00%       1.379us         0.00%       1.379us       1.379us       0.000us         0.00%       0.000us       0.000us             1  
                            hipStreamCreateWithPriority         0.00%     469.123us         0.00%     469.123us      78.187us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0     947.035ms      56.207us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      12.506ms         0.01%      12.506ms       1.243us       0.000us         0.00%       0.000us       0.000us         10060  
                                     hipExtLaunchKernel         0.06%      99.881ms         0.06%      99.904ms       9.933us       0.000us         0.00%       0.000us       0.000us         10058  
                                           aten::detach         0.03%      56.344ms         0.10%     164.443ms       4.635us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.05%      87.873ms         0.06%     103.449ms       3.058us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.00%       6.952ms         0.01%      12.340ms      99.518us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.04%      59.800ms         0.05%      79.420ms       2.192us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     222.591us         0.00%     293.930us      36.741us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.12%     203.738ms         0.12%     203.939ms       0.606us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%     849.735us         0.00%       1.230ms      64.749us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     389.500us         0.00%     785.919us      18.712us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     640.375us         0.00%     871.946us      62.282us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%      89.664us         0.00%     123.260us      61.630us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       2.730ms         0.00%       5.650ms     148.687us       0.000us         0.00%       0.000us       0.000us            38  
                                         prims::view_of         0.00%     422.287us         0.00%     536.210us      22.342us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       4.348ms         0.00%       4.427ms       4.616us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       6.163ms         0.00%       7.174ms       8.889us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%       1.011ms         0.00%       1.011ms       1.252us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     273.582us         0.00%     273.582us       8.825us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%      79.506us         0.00%      79.506us       7.228us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%       8.927ms         0.01%      18.799ms      73.432us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     686.462us         0.00%     686.462us       2.681us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     145.882us         0.00%     205.012us      68.337us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%      81.048us         0.00%      81.048us      40.524us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     109.843us         0.00%     118.663us      59.332us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      24.914us         0.00%      24.914us       1.780us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%     926.860us         0.00%       1.790ms     357.923us       0.000us         0.00%       0.000us       0.000us             5  
                                        aten::index_add         0.00%     181.578us         0.00%       1.051ms       1.051ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     373.813us         0.00%     423.209us     211.605us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     194.071us         0.00%     194.071us     194.071us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.08%     125.807ms         0.08%     127.637ms      11.603ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.07%     109.261ms         0.07%     109.285ms       9.935ms       0.000us         0.00%       0.000us       0.000us            11  
                       Scheduler.codegen (dynamo_timed)         0.05%      87.690ms         0.05%      87.710ms       7.974ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.00%       5.882ms         0.00%       5.882ms     534.705us       0.000us         0.00%       0.000us       0.000us            11  
                                 hipPointerGetAttribute         0.03%      46.799ms         0.03%      46.799ms       0.736us       0.000us         0.00%       0.000us       0.000us         63580  
                                        aten::expand_as         0.00%     887.754us         0.00%       3.109ms       5.726us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.215ms         0.00%       4.336ms     394.154us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     102.251us         0.00%     115.290us      57.645us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     106.421us         0.00%     106.421us      53.210us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      59.036us         0.00%      74.730us      74.730us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     252.161us         0.00%       2.297ms     765.620us       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     181.762us         0.00%     204.994us      68.331us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.005ms         0.00%       3.036ms     505.964us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%     644.144us         0.00%       3.174ms     352.640us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%     958.105us         0.00%       2.128ms     354.666us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     262.187us         0.00%     670.144us     223.381us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     163.117us         0.00%     820.564us     273.521us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     349.241us         0.00%     657.447us     219.149us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     264.609us         0.00%     277.468us      69.367us       0.000us         0.00%       0.000us       0.000us             4  
                                               aten::eq         0.02%      32.292ms         0.02%      32.292ms       5.513us       0.000us         0.00%       0.000us       0.000us          5857  
                                              aten::all         0.04%      59.247ms         0.04%      67.936ms      11.599us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       3.929ms         0.00%       3.929ms       0.160us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     720.016us      51.430us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.101ms         0.01%      12.326ms       5.490us       0.000us         0.00%       0.000us       0.000us          2245  
                                          aten::reshape         0.06%     100.047ms         0.11%     175.688ms       4.066us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      65.777ms     136.751us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.01%       8.605ms         0.01%      19.483ms       4.775us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.00%       7.867ms         0.02%      26.983ms      10.221us       0.000us         0.00%       0.000us       0.000us          2640  
                                          aten::view_as         0.00%       1.111ms         0.00%       2.429ms       3.373us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      29.986ms         0.02%      36.054ms       4.507us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.512us         0.00%       1.512us       0.252us       0.000us         0.00%       0.000us       0.000us             6  
                              hipDevicePrimaryCtxRetain         0.00%       1.168us         0.00%       1.168us       0.195us       0.000us         0.00%       0.000us       0.000us             6  
                             hipDevicePrimaryCtxRelease         0.00%       0.864us         0.00%       0.864us       0.144us       0.000us         0.00%       0.000us       0.000us             6  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.02%      36.186ms         0.02%      36.186ms       1.948us       0.000us         0.00%       0.000us       0.000us         18580  
                                              hipMemset         0.00%      23.925us         0.00%      23.925us      11.963us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.21%     345.164ms         0.21%     345.164ms     115.055ms       0.000us         0.00%       0.000us       0.000us             3  
                                 aten::split_with_sizes         0.02%      38.900ms         0.03%      50.407ms       8.751us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      29.624ms         0.02%      29.625ms       1.929us       0.000us         0.00%       0.000us       0.000us         15360  
                                          aten::squeeze         0.03%      56.375ms         0.04%      67.084ms       2.912us       0.000us         0.00%       0.000us       0.000us         23040  
                                      hipModuleLoadData         0.24%     386.380ms         0.24%     386.380ms      96.595ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     513.602us         0.00%       1.191ms     297.711us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       4.811ms         0.00%       5.713ms      23.806us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     712.327us         0.00%     712.327us       2.226us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.03%      42.616ms         0.08%     126.289ms       8.054us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      20.159ms         0.05%      83.673ms       5.336us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     482.010us         0.00%       2.787ms      34.836us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%     690.073us         0.00%       2.305ms      28.811us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.04%      59.598ms         0.09%     143.786ms       6.757us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      21.262ms         0.05%      84.189ms       3.956us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.03%      43.132ms         0.06%      98.034ms       4.058us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.128ms         0.00%       2.982ms      12.424us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     406.327us         0.00%       1.854ms       7.725us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     334.104us         0.00%     946.649us      11.833us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     612.545us         0.00%     612.545us       7.657us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     655.422us         0.21%     342.873ms     342.873ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      19.650ms         0.01%      22.282ms       2.901us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.632ms         0.00%       2.632ms       0.343us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       5.603ms         0.01%      21.493ms      10.746us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       4.427ms         0.01%      15.890ms       7.945us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       5.058ms         0.01%      13.956ms       7.269us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       2.301ms         0.01%       8.898ms       4.634us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     384.137us         0.00%     384.137us       0.200us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%     988.680us         0.00%       2.621ms      32.763us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.632ms         0.00%       1.632ms      20.405us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.509ms         0.00%       2.337ms      29.208us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       1.886ms     188.589us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      11.132us         0.00%      22.523us       5.631us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 163.904s
Self CUDA time total: 155.535s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       76.142s        50.13%       76.142s       76.142s             1  
                                             bert_train        35.44%       58.901s        70.17%      116.625s      116.625s       0.000us         0.00%       40.166s       40.166s             1  
                                            aten::copy_        15.46%       25.689s        18.95%       31.501s     399.479us       16.658s        10.97%       16.697s     211.742us         78855  
                                               aten::to         0.03%      52.567ms        18.93%       31.458s     598.411us       0.000us         0.00%       12.129s     230.723us         52569  
                                         aten::_to_copy         0.09%     147.556ms        18.89%       31.405s     723.875us       0.000us         0.00%       12.129s     279.564us         43385  
                                      aten::masked_fill         0.04%      58.265ms         0.21%     353.013ms      36.772us       0.000us         0.00%       11.860s       1.235ms          9600  
                                     record_param_comms         3.97%        6.596s         5.40%        8.978s     258.633us        7.496s         4.93%       11.629s     334.990us         34714  
                                     aten::masked_fill_         0.09%     145.876ms         0.22%     373.722ms      22.788us       11.327s         7.46%       11.331s     690.893us         16400  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      13.696ms         0.09%     151.172ms      39.368us       0.000us         0.00%        7.842s       2.042ms          3840  
                                    MaskedFillBackward0         0.00%       5.896ms         0.08%     137.476ms      35.801us       0.000us         0.00%        7.842s       2.042ms          3840  
                                       c10d::allreduce_         0.20%     338.486ms         2.28%        3.787s     225.280us       0.000us         0.00%        7.738s     460.302us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        7.463s         4.91%        7.463s     772.252us          9664  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        7.306s         4.81%        7.306s     748.784us          9757  
                                              aten::bmm         0.22%     360.070ms         0.26%     438.666ms      32.639us        7.200s         4.74%        7.200s     535.739us         13440  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.725s         4.43%        6.725s       1.488ms          4518  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       6.238ms         0.03%      56.928ms      29.650us       0.000us         0.00%        6.485s       3.378ms          1920  
                                       SoftmaxBackward0         0.00%       5.564ms         0.03%      50.689ms      26.401us       0.000us         0.00%        6.485s       3.378ms          1920  
                           aten::_softmax_backward_data         0.01%      15.066ms         0.03%      45.125ms      23.503us        3.345s         2.20%        6.485s       3.378ms          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.204s         4.08%        6.204s     751.510us          8255  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.780s         3.81%        5.780s       1.233ms          4688  
autograd::engine::evaluate_function: _LayerNormLinea...         0.04%      69.815ms         1.67%        2.773s     722.139us       0.000us         0.00%        5.595s       1.457ms          3840  
                               _LayerNormLinearBackward         0.89%        1.471s         1.60%        2.656s     691.572us     318.749ms         0.21%        5.455s       1.421ms          3840  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      11.164ms         0.04%      72.159ms      18.408us       0.000us         0.00%        5.031s       1.283ms          3920  
                                        ToCopyBackward0         0.00%       5.110ms         0.04%      60.996ms      15.560us       0.000us         0.00%        5.031s       1.283ms          3920  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.600s         3.03%        4.600s     977.372us          4707  
                                            aten::clone         0.06%      92.551ms         0.37%     610.678ms      17.677us       0.000us         0.00%        4.567s     132.188us         34546  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.469s         2.94%        4.469s     553.282us          8077  
                                          aten::softmax         0.01%      10.237ms         0.07%     115.303ms      20.018us       0.000us         0.00%        4.443s     771.282us          5760  
                                         aten::_softmax         0.04%      63.677ms         0.06%     105.063ms      18.240us        4.440s         2.92%        4.443s     771.282us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.440s         2.92%        4.440s       1.709ms          2598  
                                     tex_ts::te_gemm_ts         1.07%        1.787s         1.56%        2.591s      67.474us        4.329s         2.85%        4.333s     112.839us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.890s         2.56%        3.890s     860.901us          4518  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.755s         2.47%        3.755s     325.933us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.345s         2.20%        3.345s       1.742ms          1920  
                                              aten::mul         0.08%     129.538ms         0.11%     186.606ms      23.411us        3.170s         2.09%        3.170s     397.672us          7971  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.142s         2.07%        3.142s       1.430ms          2197  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      12.904ms         0.09%     155.442ms      80.959us       0.000us         0.00%        3.127s       1.629ms          1920  
                                       BaddbmmBackward0         0.01%      14.572ms         0.09%     142.538ms      74.239us       0.000us         0.00%        3.127s       1.629ms          1920  
                                          c10d::barrier         0.00%     830.726us         2.24%        3.726s      98.042ms       0.000us         0.00%        2.754s      72.480ms            38  
                                                _Linear         0.75%        1.253s         1.28%        2.124s     553.225us      66.426ms         0.04%        2.721s     708.490us          3840  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.881s         1.24%        1.881s     406.715us          4626  
                                       aten::logical_or         0.06%      93.104ms         0.17%     277.943ms      24.127us     917.610ms         0.60%        1.835s     159.307us         11520  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      15.710ms         0.09%     154.303ms      80.366us       0.000us         0.00%        1.779s     926.697us          1920  
                                           BmmBackward0         0.01%      10.095ms         0.08%     138.593ms      72.184us       0.000us         0.00%        1.779s     926.697us          1920  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      28.734ms         0.98%        1.635s     425.909us       0.000us         0.00%        1.603s     417.394us          3840  
                                        _LinearBackward         0.71%        1.176s         0.97%        1.607s     418.427us      76.396ms         0.05%        1.603s     417.394us          3840  
                                              aten::sub         0.05%      87.328ms         0.07%     118.232ms      17.996us        1.597s         1.05%        1.598s     243.186us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.595s         1.05%        1.595s     613.862us          2598  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.531s         1.01%        1.531s     797.477us          1920  
                                          aten::dropout         0.00%       8.234ms         0.05%      90.893ms      15.111us       0.000us         0.00%        1.476s     245.437us          6015  
                                   aten::native_dropout         0.02%      33.546ms         0.05%      79.661ms      39.652us        1.476s         0.97%        1.476s     734.845us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.476s         0.97%        1.476s     738.123us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%       8.760ms         0.03%      52.008ms      25.965us       0.000us         0.00%        1.380s     689.038us          2003  
                                 NativeDropoutBackward0         0.00%       5.206ms         0.03%      43.248ms      21.592us       0.000us         0.00%        1.380s     689.038us          2003  
                          aten::native_dropout_backward         0.01%      14.992ms         0.02%      38.042ms      18.993us        1.380s         0.91%        1.380s     689.038us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.380s         0.91%        1.380s     690.072us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.379s         0.91%        1.379s      79.167us         17414  
                                   hipStreamIsCapturing         0.02%      40.112ms         0.02%      40.112ms       0.776us        1.223s         0.81%        1.223s      23.678us         51659  
                                          aten::baddbmm         0.18%     295.956ms         0.38%     633.335ms     109.954us        1.186s         0.78%        1.187s     206.006us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.122s         0.74%        1.122s     584.209us          1920  
                                       c10d::broadcast_         0.02%      32.591ms         0.49%     815.676ms       1.696ms       0.000us         0.00%        1.022s       2.125ms           481  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      17.611ms         0.53%     876.292ms     228.201us       0.000us         0.00%     985.062ms     256.527us          3840  
                               CompiledFunctionBackward         0.23%     380.457ms         0.52%     858.680ms     223.615us       0.000us         0.00%     985.062ms     256.527us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     917.610ms         0.60%     917.610ms     353.198us          2598  
                                 triton_red_fused_sum_1         0.02%      27.425ms         0.03%      45.370ms      11.815us     889.893ms         0.59%     889.893ms     231.743us          3840  
                               hipStreamCreateWithFlags         0.25%     409.574ms         0.25%     409.574ms     154.323us     856.901ms         0.56%     856.901ms     322.871us          2654  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.163ms         0.00%       2.163ms       0.153us     847.669ms         0.56%     847.669ms      59.864us         14160  
                                   hipDeviceGetPCIBusId         0.01%      11.096ms         0.01%      11.096ms       0.569us     672.610ms         0.44%     672.610ms      34.466us         19515  
                                      aten::logical_not         0.07%     121.925ms         0.22%     360.463ms      15.645us     317.228ms         0.21%     634.709ms      27.548us         23040  
                                   hipStreamSynchronize         0.42%     700.826ms         0.42%     700.907ms     219.789us     523.383ms         0.34%     523.414ms     164.131us          3189  
                                        hipEventDestroy         0.03%      55.021ms         0.03%      55.647ms       2.748us     473.201ms         0.31%     473.347ms      23.377us         20248  
                                      hipGetProcAddress         0.03%      57.530ms         0.03%      57.534ms       0.836us     423.610ms         0.28%     423.610ms       6.155us         68826  
                                         hipMemsetAsync         0.06%     101.514ms         0.06%     101.520ms       8.480us     422.360ms         0.28%     422.360ms      35.282us         11971  
                                  Torch-Compiled Region         0.44%     734.315ms         1.32%        2.199s     114.400us       0.000us         0.00%     415.728ms      21.630us         19220  
                                       hipCtxGetCurrent         0.00%       7.444ms         0.00%       7.444ms       0.148us     357.456ms         0.24%     357.456ms       7.125us         50166  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     317.228ms         0.21%     317.228ms      61.041us          5197  
                                             aten::add_         0.08%     127.888ms         0.14%     239.261ms       7.615us     305.713ms         0.20%     305.713ms       9.730us         31420  
                                       _LayerNormLinear         0.31%     520.404ms         0.86%        1.429s     372.013us     169.915ms         0.11%     298.832ms      77.821us          3840  
                                  hipExtMallocWithFlags         0.03%      43.255ms         0.03%      43.255ms      10.226us     297.282ms         0.20%     297.282ms      70.279us          4230  
                                       CompiledFunction         0.53%     878.840ms         0.77%        1.283s     111.184us       0.000us         0.00%     297.114ms      25.746us         11540  
                                              aten::sum         0.18%     301.148ms         0.39%     642.369ms      31.561us     209.276ms         0.14%     273.594ms      13.442us         20353  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     256.476ms         0.17%     256.476ms      66.791us          3840  
                  triton_poi_fused_add_native_dropout_0         0.04%      67.515ms         0.06%     104.607ms      27.171us     232.496ms         0.15%     232.581ms      60.411us          3850  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     194.919ms         0.13%     194.919ms      37.506us          5197  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     186.674ms         0.12%     186.674ms     852.392us           219  
autograd::engine::evaluate_function: torch::autograd...         0.15%     245.493ms         0.30%     494.270ms      20.458us       0.000us         0.00%     165.313ms       6.842us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     163.701ms         0.11%     163.701ms       6.844us         23920  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     154.056ms         0.10%     154.056ms      29.649us          5196  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.01%      19.834ms         0.36%     595.495ms     310.154us       0.000us         0.00%     150.471ms      78.370us          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     149.901ms         0.10%     149.901ms      33.625us          4458  
                             _VocabParallelCrossEntropy         0.03%      56.167ms         0.13%     217.607ms     906.695us       0.000us         0.00%     136.141ms     567.254us           240  
                                       hipStreamDestroy         0.03%      46.874ms         0.03%      46.874ms      17.796us     134.658ms         0.09%     134.658ms      51.123us          2634  
                                              aten::cat         0.08%     125.031ms         0.10%     165.014ms      20.423us     131.213ms         0.09%     132.033ms      16.341us          8080  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     130.501ms         0.09%     130.501ms      33.291us          3920  
                         _ReduceFromModelParallelRegion         0.01%      18.393ms         0.03%      56.187ms     234.113us       0.000us         0.00%     130.065ms     541.938us           240  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       5.920ms        25.14%       41.791s     174.130ms       0.000us         0.00%     128.737ms     536.406us           240  
                                     EmbeddingBackward0         0.00%       2.761ms        25.14%       41.784s     174.098ms       0.000us         0.00%     127.888ms     532.866us           240  
                               aten::embedding_backward         0.00%       2.148ms        25.14%       41.781s     174.087ms       0.000us         0.00%     127.888ms     532.866us           240  
                         aten::embedding_dense_backward         0.95%        1.574s        25.14%       41.779s     174.078ms     122.753ms         0.08%     127.888ms     532.866us           240  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.706ms         0.07%     122.070ms       1.526ms       0.000us         0.00%     122.100ms       1.526ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      20.881ms         0.07%     120.364ms       1.505ms       0.000us         0.00%     122.100ms       1.526ms            80  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      12.232ms         0.11%     179.105ms      93.284us       0.000us         0.00%     113.222ms      58.970us          1920  
                                 _SplitAlongDimBackward         0.08%     125.560ms         0.10%     166.874ms      86.913us       0.000us         0.00%     113.222ms      58.970us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     113.222ms         0.07%     113.222ms      58.970us          1920  
                             c10d::allreduce_coalesced_         0.00%       1.431ms         0.05%      87.163ms       8.716ms       0.000us         0.00%     111.837ms      11.184ms            10  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     109.417ms         0.07%     109.417ms      50.656us          2160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     105.415ms         0.07%     105.415ms      10.037us         10503  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     103.687ms         0.07%     103.687ms      18.001us          5760  
                                       aten::contiguous         0.01%      22.213ms         0.25%     409.080ms      17.755us       0.000us         0.00%     102.446ms       4.446us         23040  
                                         hipMemcpyAsync         0.10%     171.303ms         0.10%     171.320ms      14.035us     101.777ms         0.07%     101.787ms       8.338us         12207  
                                               aten::mm         0.03%      51.682ms         0.06%     106.109ms     120.579us      99.969ms         0.07%      99.969ms     113.601us           880  
             triton_poi_fused_native_dropout_backward_0         0.03%      50.499ms         0.05%      75.383ms      19.631us      95.169ms         0.06%      95.169ms      24.784us          3840  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      89.492ms         0.06%      89.492ms      34.447us          2598  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us      85.702ms         0.06%      85.702ms      85.702ms             1  
                                           aten::matmul         0.00%       2.650ms         0.05%      79.694ms     199.236us       0.000us         0.00%      83.247ms     208.118us           400  
                                     hipStreamWaitEvent         0.18%     298.802ms         0.18%     298.867ms      14.271us      82.515ms         0.05%      83.119ms       3.969us         20942  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us      80.604ms         0.05%      80.604ms      15.549us          5184  
                                           GeLUFunction         0.08%     136.571ms         0.48%     805.584ms     139.858us       0.000us         0.00%      77.743ms      13.497us          5760  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      77.638ms         0.05%      77.638ms       9.961us          7794  
                        triton_poi_fused_add_mul_tanh_0         0.06%      96.179ms         0.07%     115.751ms      20.061us      75.947ms         0.05%      75.947ms      13.162us          5770  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      74.317ms         0.05%      74.317ms      28.594us          2599  
                                           aten::arange         0.07%     108.917ms         0.19%     320.025ms      12.988us      34.942ms         0.02%      69.913ms       2.837us         24640  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      66.011ms         0.04%      66.011ms     275.045us           240  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      64.728ms         0.04%      64.728ms      16.512us          3920  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      63.184ms         0.04%      63.184ms       5.293us         11938  
                                     hipIpcGetMemHandle         0.01%      10.875ms         0.01%      10.875ms       6.290us      60.259ms         0.04%      60.259ms      34.852us          1729  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      59.891ms         0.04%      59.891ms      13.893us          4311  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.17%     289.243ms         0.30%     499.942ms      65.097us      58.496ms         0.04%      58.572ms       7.627us          7680  
                                    hipIpcOpenMemHandle         0.05%      79.131ms         0.05%      79.131ms      45.608us      54.542ms         0.04%      54.542ms      31.436us          1735  
                                 hipDeviceCanAccessPeer         0.00%     292.747us         0.00%     292.747us       0.150us      54.120ms         0.04%      54.120ms      27.725us          1952  
                                  hipModuleLaunchKernel         0.12%     191.651ms         0.12%     191.665ms       5.609us      49.566ms         0.03%      50.309ms       1.472us         34172  
        LinearWithGradAccumulationAndAsyncCommunication         0.00%       6.161ms         0.01%      20.212ms      84.217us       0.000us         0.00%      49.532ms     206.383us           240  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      47.582ms         0.03%      47.582ms      12.391us          3840  
                                   GeLUFunctionBackward         0.03%      43.225ms         0.31%     511.567ms     266.441us       0.000us         0.00%      42.741ms      22.261us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.01%      23.702ms         0.02%      37.003ms      19.273us      42.741ms         0.03%      42.741ms      22.261us          1920  
                                 triton_poi_fused_add_0         0.10%     165.746ms         0.11%     178.090ms      23.189us      42.367ms         0.03%      42.367ms       5.517us          7680  
                                    hipMemcpyWithStream        28.67%       47.653s        28.67%       47.658s      56.803ms       0.000us         0.00%      39.767ms      47.399us           839  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      36.996ms         0.02%      36.996ms      19.269us          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      33.486ms         0.02%      33.486ms       6.445us          5196  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      32.423ms         0.02%      32.423ms       6.240us          5196  
                                            aten::fill_         0.07%     115.397ms         0.09%     144.673ms       5.003us      30.014ms         0.02%      30.014ms       1.038us         28919  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      29.385ms         0.02%      29.385ms      11.311us          2598  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      27.924ms         0.02%      27.924ms     174.528us           160  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      26.925ms         0.02%      26.925ms       7.012us          3840  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      26.761ms         0.02%      26.761ms      39.240us           682  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.468ms         0.03%      51.184ms     639.794us       0.000us         0.00%      26.643ms     333.034us            80  
                                            aten::zero_         0.04%      59.945ms         0.12%     195.361ms       8.627us       0.000us         0.00%      26.121ms       1.153us         22646  
                                            aten::zeros         0.04%      64.221ms         0.17%     287.908ms      12.850us       0.000us         0.00%      24.818ms       1.108us         22406  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      23.899ms         0.02%      23.899ms     298.737us            80  
                                              aten::exp         0.00%       2.258ms         0.01%      16.194ms      67.473us      23.841ms         0.02%      23.841ms      99.339us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.841ms         0.02%      23.841ms     220.753us           108  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       4.075ms         0.03%      50.905ms     212.103us       0.000us         0.00%      23.476ms      97.818us           240  
                                          aten::randint         0.02%      31.588ms         0.07%     121.667ms      31.569us       0.000us         0.00%      21.860ms       5.672us          3854  
                                          aten::random_         0.03%      51.507ms         0.05%      87.849ms      22.818us      21.745ms         0.01%      21.753ms       5.650us          3850  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      21.745ms         0.01%      21.745ms       5.648us          3850  
                                              aten::add         0.04%      63.613ms         0.06%      93.358ms      52.272us      21.465ms         0.01%      21.465ms      12.019us          1786  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      21.281ms         0.01%      21.281ms      98.524us           216  
                                             aten::div_         0.00%       4.557ms         0.01%       9.921ms      20.668us      20.787ms         0.01%      20.787ms      43.306us           480  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.117ms         0.01%      20.117ms     186.268us           108  
                                           aten::linear         0.00%       2.668ms         0.03%      44.852ms      62.294us       0.000us         0.00%      19.616ms      27.244us           720  
                                            aten::addmm         0.02%      31.828ms         0.02%      38.055ms      52.855us      19.616ms         0.01%      19.616ms      27.244us           720  
                                             aten::sub_         0.00%       4.028ms         0.00%       5.405ms      16.892us      18.873ms         0.01%      18.873ms      58.977us           320  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      18.359ms         0.01%      18.359ms     169.994us           108  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      17.991ms         0.01%      17.991ms       6.277us          2866  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      16.800ms         0.01%      16.800ms       6.466us          2598  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      16.785ms         0.01%      16.785ms       6.426us          2612  
                                 tex_ts::cast_to_fp8_ts         0.07%     110.026ms         0.10%     162.165ms      21.115us      16.760ms         0.01%      16.776ms       2.184us          7680  
                                           aten::cumsum         0.05%      87.413ms         0.07%     111.573ms      19.370us      16.698ms         0.01%      16.762ms       2.910us          5760  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      16.760ms         0.01%      16.760ms      12.360us          1356  
                                        aten::embedding         0.00%       5.634ms         0.01%      24.359ms      33.833us       0.000us         0.00%      16.730ms      23.236us           720  
                                     aten::index_select         0.01%      10.461ms         0.01%      16.636ms      23.106us      16.730ms         0.01%      16.730ms      23.236us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.730ms         0.01%      16.730ms      51.161us           327  
                                         AddmmBackward0         0.00%       3.212ms         0.02%      38.853ms     161.887us       0.000us         0.00%      16.722ms      69.674us           240  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      16.698ms         0.01%      16.698ms       6.427us          2598  
                     _VocabParallelCrossEntropyBackward         0.01%      18.761ms         0.03%      45.325ms     566.564us       0.000us         0.00%      16.313ms     203.911us            80  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      13.173ms         0.01%      13.173ms       6.861us          1920  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.124ms         0.01%      13.124ms      82.024us           160  
                                             aten::mul_         0.00%       5.874ms         0.00%       6.657ms       5.201us      12.574ms         0.01%      12.574ms       9.823us          1280  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.114ms         0.01%      12.114ms     112.165us           108  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.586ms         0.01%      11.586ms     107.274us           108  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      11.240ms         0.01%      11.240ms     104.078us           108  
                                            aten::index         0.01%      11.526ms         0.04%      65.832ms     116.106us       1.973ms         0.00%       9.632ms      16.988us           567  
                                  hipMemGetAddressRange         0.00%     184.017us         0.00%     184.017us       0.410us       9.582ms         0.01%       9.582ms      21.341us           449  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.516ms         0.01%       9.516ms      39.649us           240  
                                       aten::index_put_         0.00%       4.799ms         0.11%     181.161ms     161.751us       0.000us         0.00%       9.351ms       8.349us          1120  
                                 aten::_index_put_impl_         0.00%       7.099ms         0.11%     176.362ms     157.466us     780.638us         0.00%       9.351ms       8.349us          1120  
                                              aten::max         0.00%       5.063ms         0.02%      25.735ms     101.317us       9.216ms         0.01%       9.236ms      36.363us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.202ms         0.01%       9.202ms      85.202us           108  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       8.933ms         0.01%       8.933ms      37.222us           240  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.499ms         0.01%       8.499ms      20.045us           424  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.561ms         0.01%      13.870ms     173.375us       0.000us         0.00%       8.404ms     105.048us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.965ms         0.01%      11.309ms     141.358us       8.404ms         0.01%       8.404ms     105.048us            80  
                           FusedLayerNormAffineFunction         0.01%       9.216ms         0.01%      15.892ms      66.215us       8.128ms         0.01%       8.128ms      33.868us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       8.128ms         0.01%       8.128ms      75.263us           108  
         _compile.<locals>.compile_inner (dynamo_timed)         0.07%     109.895ms         1.59%        2.649s     264.934ms       0.000us         0.00%       7.925ms     792.468us            10  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.063ms         0.02%      27.161ms     339.513us       0.000us         0.00%       7.901ms      98.756us            80  
                            torch::autograd::CopySlices         0.00%       3.929ms         0.02%      25.098ms     313.730us       0.000us         0.00%       7.901ms      98.756us            80  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      28.960ms         1.50%        2.498s     249.844ms       0.000us         0.00%       7.832ms     783.241us            10  
                                          aten::nonzero         0.00%       7.521ms         0.02%      39.333ms     160.544us       7.626ms         0.01%       7.660ms      31.264us           245  
          create_aot_dispatcher_function (dynamo_timed)         0.33%     543.213ms         1.49%        2.469s     246.945ms       0.000us         0.00%       7.392ms     739.200us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.180ms         0.00%       7.180ms      10.466us           686  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.611ms         0.00%       6.611ms      82.635us            80  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     425.280us         0.00%       2.013ms     201.331us       6.200ms         0.00%       6.200ms     620.011us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.200ms         0.00%       6.200ms      56.365us           110  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       6.049ms         0.00%       6.049ms       6.699us           903  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       5.923ms         0.00%       5.923ms      24.679us           240  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       4.861ms         0.00%       4.861ms      30.381us           160  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       4.814ms         0.00%       4.814ms       5.014us           960  
                                        aten::index_put         0.00%       2.663ms         0.01%      13.313ms     160.392us       0.000us         0.00%       4.206ms      50.676us            83  
                                      IndexPutBackward0         0.00%       1.062ms         0.01%      11.517ms     143.966us       0.000us         0.00%       4.206ms      52.576us            80  
                                        hipLaunchKernel         0.73%        1.219s         0.73%        1.219s       7.843us       1.493ms         0.00%       4.167ms       0.027us        155421  
                                   hipDeviceSynchronize         0.00%     862.210us         0.00%     862.210us      25.359us       4.016ms         0.00%       4.016ms     118.129us            34  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.004ms         0.00%       4.004ms      50.055us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       3.814ms         0.00%       3.814ms      47.678us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     877.291us         0.01%      21.206ms     265.071us       0.000us         0.00%       3.655ms      45.693us            80  
                                     _LayerNormBackward         0.00%       4.921ms         0.01%      20.328ms     254.105us       3.655ms         0.00%       3.655ms      45.693us            80  
                                             aten::ones         0.00%     877.384us         0.00%       5.474ms      11.404us       0.000us         0.00%       3.292ms       6.859us           480  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     778.658us         0.00%       3.229ms      40.363us       0.000us         0.00%       3.247ms      40.593us            80  
                                          GeluBackward0         0.00%     458.252us         0.00%       2.450ms      30.630us       0.000us         0.00%       3.247ms      40.593us            80  
                                    aten::gelu_backward         0.00%       1.332ms         0.00%       1.992ms      24.902us       3.247ms         0.00%       3.247ms      40.593us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.247ms         0.00%       3.247ms      40.593us            80  
                            hipGetDevicePropertiesR0600         0.04%      67.320ms         0.04%      67.320ms       0.725us       3.230ms         0.00%       3.230ms       0.035us         92841  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      12.725ms         0.95%        1.576s     157.627ms       0.000us         0.00%       3.141ms     314.098us            10  
                        compile_fx_inner (dynamo_timed)         0.04%      64.549ms         1.16%        1.920s     174.553ms       0.000us         0.00%       3.141ms     285.543us            11  
         GraphLowering.compile_to_module (dynamo_timed)         0.51%     842.262ms         1.00%        1.665s     151.360ms       0.000us         0.00%       3.109ms     282.606us            11  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     657.462us         0.00%       4.330ms      54.123us       0.000us         0.00%       3.020ms      37.751us            80  
                                 c10d::_allgather_base_         0.00%     228.366us         0.00%       1.512ms     107.969us       0.000us         0.00%       3.001ms     214.391us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       3.001ms         0.00%       3.001ms     250.123us            12  
                                             aten::gelu         0.00%       2.854ms         0.00%       7.147ms      29.778us       2.661ms         0.00%       2.661ms      11.089us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.661ms         0.00%       2.661ms      24.642us           108  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.583ms         0.00%       2.583ms      23.917us           108  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.518ms         0.00%       2.518ms       4.690us           537  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.299ms         0.00%       2.299ms       5.297us           434  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.122ms         0.00%       2.122ms       5.440us           390  
                                              aten::div         0.01%       9.099ms         0.01%      12.210ms      18.388us       2.073ms         0.00%       2.073ms       3.122us           664  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     555.036us         0.00%       7.393ms      46.209us       0.000us         0.00%       2.045ms      12.782us           160  
                                         SliceBackward0         0.00%     460.879us         0.00%       6.838ms      42.740us       0.000us         0.00%       2.045ms      12.782us           160  
                                   aten::slice_backward         0.00%     958.321us         0.00%       6.378ms      39.860us       0.000us         0.00%       2.045ms      12.782us           160  
                                             _LayerNorm         0.00%       4.681ms         0.01%       8.352ms     104.396us       1.976ms         0.00%       1.976ms      24.697us            80  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.973ms         0.00%       1.973ms      10.328us           191  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.685ms         0.00%       1.685ms      15.605us           108  
                                               aten::lt         0.01%      14.059ms         0.01%      16.314ms      22.659us       1.684ms         0.00%       1.684ms       2.339us           720  
      autograd::engine::evaluate_function: MulBackward0         0.01%      12.943ms         0.04%      61.124ms     355.372us       0.000us         0.00%       1.588ms       9.234us           172  
                                              hipMemcpy         0.01%      10.752ms         0.01%      10.752ms     223.998us       1.583ms         0.00%       1.583ms      32.972us            48  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.541ms         0.00%       1.541ms       4.877us           316  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.523ms         0.00%       1.523ms       6.344us           240  
                                        SelectBackward0         0.00%     231.133us         0.00%       2.702ms      33.775us       0.000us         0.00%       1.385ms      17.307us            80  
                                  aten::select_backward         0.00%     399.066us         0.00%       2.471ms      30.886us       0.000us         0.00%       1.385ms      17.307us            80  
                               aten::cross_entropy_loss         0.00%       1.166ms         0.01%      15.303ms      63.763us       0.000us         0.00%       1.371ms       5.711us           240  
                                    hipFuncGetAttribute         0.00%       5.771us         0.00%       5.771us       0.481us       1.318ms         0.00%       1.318ms     109.793us            12  
                                              hipMalloc         0.01%      15.429ms         0.01%      15.429ms      94.080us       1.295ms         0.00%       1.295ms       7.899us           164  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.202ms         0.00%       1.202ms       6.393us           188  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.183ms         0.00%       1.183ms       5.452us           217  
                                           aten::__or__         0.00%       1.041ms         0.01%      20.090ms      41.855us       0.000us         0.00%       1.165ms       2.428us           480  
                                       aten::bitwise_or         0.00%       6.569ms         0.01%      19.049ms      39.686us       1.165ms         0.00%       1.165ms       2.428us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.165ms         0.00%       1.165ms       5.370us           217  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.138ms         0.00%       1.138ms       5.245us           217  
                                               aten::ge         0.00%       5.438ms         0.00%       6.396ms      13.325us       1.130ms         0.00%       1.130ms       2.354us           480  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.097ms         0.00%       1.097ms      13.714us            80  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.094ms         0.00%       1.094ms       2.265us           483  
                                           MulBackward0         0.01%       8.870ms         0.02%      35.661ms     207.333us       0.000us         0.00%       1.060ms       6.166us           172  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.943ms         0.01%      10.654ms     133.172us       0.000us         0.00%       1.032ms      12.903us            80  
                                       NllLossBackward0         0.00%     998.173us         0.01%       8.711ms     108.884us       0.000us         0.00%       1.032ms      12.903us            80  
                                aten::nll_loss_backward         0.00%       3.202ms         0.00%       7.713ms      96.407us     508.576us         0.00%       1.032ms      12.903us            80  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.974ms         0.01%       8.669ms      54.179us       0.000us         0.00%       1.014ms       6.339us           160  
                                           DivBackward0         0.00%       1.224ms         0.00%       6.695ms      41.841us       0.000us         0.00%       1.014ms       6.339us           160  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us     935.024us         0.00%     935.024us       5.844us           160  
                                              aten::all         0.04%      59.497ms         0.04%      68.311ms      11.663us       0.000us         0.00%     913.503us       0.156us          5857  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     855.006us         0.00%     855.006us       7.917us           108  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     780.638us         0.00%     780.638us       9.758us            80  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     738.213us         0.00%     738.213us       9.228us            80  
                                             aten::tanh         0.01%      12.571ms         0.01%      23.710ms      87.492us     723.353us         0.00%     723.353us       2.669us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     723.353us         0.00%     723.353us       6.698us           108  
                                  hipDeviceGetAttribute         0.00%     214.248us         0.00%     214.248us       3.198us     705.072us         0.00%     705.072us      10.523us            67  
                                      aten::log_softmax         0.00%     900.539us         0.00%       5.021ms      20.920us       0.000us         0.00%     697.970us       2.908us           240  
                                     aten::_log_softmax         0.00%       3.047ms         0.00%       4.028ms      16.782us     697.970us         0.00%     697.970us       2.908us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     697.970us         0.00%     697.970us       6.463us           108  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     688.781us         0.00%     688.781us       2.870us           240  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     682.778us         0.00%     682.778us       2.845us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     680.081us         0.00%     680.081us       6.297us           108  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     679.323us         0.00%     679.323us       8.492us            80  
                                      aten::nll_loss_nd         0.00%     673.956us         0.01%       9.116ms      37.985us       0.000us         0.00%     672.786us       2.803us           240  
                                         aten::nll_loss         0.00%     636.680us         0.01%       8.442ms      35.177us       0.000us         0.00%     672.786us       2.803us           240  
                                 aten::nll_loss_forward         0.00%       3.489ms         0.00%       7.806ms      32.524us     672.786us         0.00%     672.786us       2.803us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     672.786us         0.00%     672.786us       6.229us           108  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     669.376us         0.00%     669.376us       8.367us            80  
                                             aten::item         0.01%      22.832ms         0.30%     492.367ms      29.295us       0.000us         0.00%     655.964us       0.039us         16807  
                              aten::_local_scalar_dense         0.01%      12.003ms         0.28%     469.535ms      27.937us     655.964us         0.00%     655.964us       0.039us         16807  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     651.866us         0.00%     651.866us       6.036us           108  
                                          hipHostMalloc         0.07%     121.335ms         0.07%     121.335ms       3.677ms     633.789us         0.00%     633.789us      19.206us            33  
                                         _SplitAlongDim         0.07%     109.077ms         0.10%     158.141ms      27.455us       0.000us         0.00%     609.884us       0.106us          5760  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       4.635ms         0.01%       8.983ms      56.143us     607.354us         0.00%     607.354us       3.796us           160  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     585.146us         0.00%     585.146us       7.314us            80  
                                 aten::split_with_sizes         0.02%      37.915ms         0.03%      49.037ms       8.513us       0.000us         0.00%     582.581us       0.101us          5760  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     560.766us         0.00%     560.766us       2.308us           243  
                                             aten::rsub         0.00%       3.319ms         0.01%       9.939ms     115.565us       0.000us         0.00%     548.057us       6.373us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     548.057us         0.00%     548.057us       6.851us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     542.450us         0.00%     542.450us       6.781us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     541.406us         0.00%     541.406us       6.768us            80  
                                          aten::normal_         0.63%        1.052s         0.63%        1.054s      10.137ms     530.098us         0.00%     530.098us       5.097us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     530.098us         0.00%     530.098us       5.465us            97  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.272ms         0.02%      25.298ms     308.509us       0.000us         0.00%     515.266us       6.284us            82  
                                          TanhBackward0         0.00%       2.166ms         0.01%      24.025ms     292.991us       0.000us         0.00%     515.266us       6.284us            82  
                                    aten::tanh_backward         0.00%       3.081ms         0.01%      19.274ms     235.052us     515.266us         0.00%     515.266us       6.284us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     515.266us         0.00%     515.266us       6.441us            80  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     850.306us         0.00%       5.595ms      69.943us       0.000us         0.00%     515.063us       6.438us            80  
                                    LogSoftmaxBackward0         0.00%       1.129ms         0.00%       4.745ms      59.314us       0.000us         0.00%     515.063us       6.438us            80  
                       aten::_log_softmax_backward_data         0.00%       1.844ms         0.00%       3.617ms      45.207us     515.063us         0.00%     515.063us       6.438us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     515.063us         0.00%     515.063us       6.438us            80  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     514.985us         0.00%     514.985us       4.725us           109  
                                        aten::ones_like         0.00%     541.231us         0.00%       2.290ms      28.629us       0.000us         0.00%     514.829us       6.435us            80  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     508.576us         0.00%     508.576us       6.357us            80  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     472.974us         0.00%     472.974us       1.946us           243  
                                               aten::gt         0.02%      31.564ms         0.02%      37.744ms       8.695us     408.977us         0.00%     417.797us       0.096us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     406.611us         0.00%     406.611us       1.680us           242  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     358.906us         0.00%     358.906us       1.495us           240  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     358.194us         0.00%     358.194us       1.492us           240  
                                              aten::log         0.00%       2.767ms         0.00%       6.934ms      28.891us     326.715us         0.00%     326.715us       1.361us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     326.715us         0.00%     326.715us       3.025us           108  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     310.394us         0.00%     310.394us       1.277us           243  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     277.998us         0.00%     277.998us       3.475us            80  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     264.690us         0.00%     264.690us       1.654us           160  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     197.334us         0.00%     197.334us       3.402us            58  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     192.440us         0.00%     192.440us       2.047us            94  
                                             aten::rand         0.00%       1.542ms         0.00%       4.785ms     341.793us       0.000us         0.00%     149.292us      10.664us            14  
                                         aten::uniform_         0.01%       9.044ms         0.01%      11.185ms     860.378us     149.292us         0.00%     149.292us      11.484us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     149.292us         0.00%     149.292us      29.858us             5  
                            hipGetDevicePropertiesR0000         0.00%      40.831us         0.00%      40.831us       4.083us      88.032us         0.00%      88.032us       8.803us            10  
                                   hipFuncGetAttributes         0.17%     282.718ms         0.17%     282.718ms       2.142ms      83.192us         0.00%      83.192us       0.630us           132  
                       Scheduler.codegen (dynamo_timed)         0.05%      90.056ms         0.05%      90.077ms       8.189ms       0.000us         0.00%      81.537us       7.412us            11  
                                    hipFuncSetAttribute         0.00%       9.271us         0.00%       9.271us       0.386us      52.079us         0.00%      52.079us       2.170us            24  
                                       aten::lift_fresh         0.03%      45.365ms         0.03%      50.651ms      28.681us       0.000us         0.00%      44.144us       0.025us          1766  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      35.002us         0.00%      35.002us       3.500us            10  
                                                hipFree         0.07%     109.804ms         0.07%     109.848ms       6.103ms       8.219us         0.00%      34.800us       1.933us            18  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.415us         0.00%      23.415us       2.342us            10  
                               hipExtModuleLaunchKernel         0.14%     235.863ms         0.14%     235.875ms       5.913us       0.000us         0.00%      21.489us       0.001us         39892  
                                       aten::reciprocal         0.00%     159.692us         0.01%       9.557ms     955.709us      21.007us         0.00%      21.007us       2.101us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      21.007us         0.00%      21.007us       2.101us            10  
                                          aten::maximum         0.00%     150.879us         0.01%      15.906ms       1.767ms      20.727us         0.00%      20.727us       2.303us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      20.727us         0.00%      20.727us       2.303us             9  
                                              aten::min         0.00%     100.192us         0.00%       3.472ms     694.336us      14.834us         0.00%      14.834us       2.967us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      14.834us         0.00%      14.834us       4.945us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.711us         0.00%      13.711us       4.570us             3  
                                        aten::transpose         0.12%     206.283ms         0.15%     254.233ms       2.668us       0.000us         0.00%       9.823us       0.000us         95285  
                                     hipExtLaunchKernel         0.06%      95.780ms         0.06%      95.813ms       9.555us       0.000us         0.00%       9.222us       0.001us         10027  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.927us         0.00%       2.927us       2.927us             1  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.366us         0.00%       2.366us       2.366us             1  
                                            aten::empty         0.41%     675.311ms         0.41%     680.375ms       2.591us       0.000us         0.00%       0.000us       0.000us        262555  
                        hipDeviceGetStreamPriorityRange         0.00%       2.390us         0.00%       2.390us       2.390us       0.000us         0.00%       0.000us       0.000us             1  
                            hipStreamCreateWithPriority         0.00%     483.920us         0.00%     483.920us      80.653us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0     902.260ms      53.550us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      11.178ms         0.01%      11.178ms       1.115us       0.000us         0.00%       0.000us       0.000us         10029  
                               TorchDynamo Cache Lookup         0.10%     170.231ms         0.10%     170.234ms       8.857us       0.000us         0.00%       0.000us       0.000us         19221  
                                    aten::empty_strided         0.16%     262.638ms         0.16%     270.036ms       3.045us       0.000us         0.00%       0.000us       0.000us         88687  
                                           aten::detach         0.03%      57.430ms         0.10%     170.367ms       4.792us       0.000us         0.00%       0.000us       0.000us         35556  
                                                 detach         0.05%      87.534ms         0.06%     107.048ms       3.157us       0.000us         0.00%       0.000us       0.000us         33905  
                            prims::convert_element_type         0.01%       9.491ms         0.01%      17.167ms     138.443us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.03%      53.804ms         0.04%      71.298ms       1.968us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     277.667us         0.00%     370.219us      46.277us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.11%     190.741ms         0.11%     190.993ms       0.568us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%       1.089ms         0.00%       1.557ms      81.924us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     514.782us         0.00%       1.025ms      24.414us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     781.060us         0.00%       1.100ms      78.540us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     139.954us         0.00%     195.667us      97.833us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       3.943ms         0.00%       8.103ms     213.248us       0.000us         0.00%       0.000us       0.000us            38  
                                             aten::view         0.15%     241.750ms         0.15%     247.664ms       1.712us       0.000us         0.00%       0.000us       0.000us        144633  
                                         prims::view_of         0.00%     562.162us         0.00%     717.305us      29.888us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       5.998ms         0.00%       6.103ms       6.364us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       6.894ms         0.00%       7.802ms       9.668us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%     908.449us         0.00%     908.449us       1.126us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     373.208us         0.00%     373.208us      12.039us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     105.390us         0.00%     105.390us       9.581us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%       9.907ms         0.01%      21.686ms      84.711us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     746.839us         0.00%     746.839us       2.917us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     252.378us         0.00%     342.165us     114.055us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     121.429us         0.00%     121.429us      60.715us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     143.379us         0.00%     154.517us      77.258us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      27.438us         0.00%      27.438us       1.960us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.542ms         0.00%       3.041ms     608.198us       0.000us         0.00%       0.000us       0.000us             5  
                                            aten::slice         0.04%      72.081ms         0.05%      86.601ms       3.316us       0.000us         0.00%       0.000us       0.000us         26118  
                                        aten::index_add         0.00%     321.102us         0.00%       2.531ms       2.531ms       0.000us         0.00%       0.000us       0.000us             1  
                                       aten::empty_like         0.09%     148.887ms         0.25%     420.216ms       4.725us       0.000us         0.00%       0.000us       0.000us         88930  
                                        aten::new_empty         0.00%     615.804us         0.00%     692.441us     346.220us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     309.512us         0.00%     309.512us     309.512us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.09%     146.216ms         0.09%     148.116ms      13.465ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.07%     116.621ms         0.07%     116.647ms      10.604ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.00%       6.444ms         0.00%       6.444ms     585.843us       0.000us         0.00%       0.000us       0.000us            11  
                                    hipModuleLoadDataEx         0.37%     617.208ms         0.37%     617.208ms      51.434ms       0.000us         0.00%       0.000us       0.000us            12  
                                 hipPointerGetAttribute         0.03%      42.260ms         0.03%      42.260ms       0.666us       0.000us         0.00%       0.000us       0.000us         63426  
                                        aten::expand_as         0.00%     858.449us         0.00%       2.916ms       5.371us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.266ms         0.00%       4.278ms     388.929us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     105.432us         0.00%     118.123us      59.062us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     102.386us         0.00%     102.386us      51.193us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      58.121us         0.00%      74.130us      74.130us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     269.874us         0.00%       2.281ms     760.383us       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     186.997us         0.00%     209.834us      69.945us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%     939.894us         0.00%       3.483ms     580.426us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%     712.336us         0.00%       3.468ms     385.346us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.019ms         0.00%       2.300ms     383.387us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     283.858us         0.00%     751.295us     250.432us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     184.692us         0.00%       1.067ms     355.628us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     395.031us         0.00%     882.193us     294.064us       0.000us         0.00%       0.000us       0.000us             3  
                                           aten::select         0.18%     291.128ms         0.21%     353.691ms       3.613us       0.000us         0.00%       0.000us       0.000us         97887  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     325.638us         0.00%     340.949us      85.237us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.05%      84.965ms         0.05%      85.232ms       2.459us       0.000us         0.00%       0.000us       0.000us         34655  
                                               aten::eq         0.02%      33.969ms         0.02%      33.969ms       5.800us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       3.242ms         0.00%       3.242ms       0.132us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     852.224us      60.873us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.276ms         0.01%      12.832ms       5.716us       0.000us         0.00%       0.000us       0.000us          2245  
                                          aten::reshape         0.05%      88.746ms         0.09%     154.835ms       3.584us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      61.515ms     127.890us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.00%       6.634ms         0.01%      15.917ms       3.901us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.00%       6.609ms         0.01%      22.523ms       8.532us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.01%      24.471ms         0.02%      29.705ms       4.036us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.100ms         0.00%       2.320ms       3.222us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      27.863ms         0.02%      33.053ms       4.132us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.270us         0.00%       1.270us       0.212us       0.000us         0.00%       0.000us       0.000us             6  
                              hipDevicePrimaryCtxRetain         0.00%       1.550us         0.00%       1.550us       0.258us       0.000us         0.00%       0.000us       0.000us             6  
                             hipDevicePrimaryCtxRelease         0.00%       0.851us         0.00%       0.851us       0.142us       0.000us         0.00%       0.000us       0.000us             6  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.02%      38.099ms         0.02%      38.099ms       2.057us       0.000us         0.00%       0.000us       0.000us         18522  
                                              hipMemset         0.00%      23.117us         0.00%      23.117us      11.558us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.20%     338.006ms         0.20%     338.006ms     112.669ms       0.000us         0.00%       0.000us       0.000us             3  
                                   aten::_reshape_alias         0.02%      25.142ms         0.02%      25.142ms       1.637us       0.000us         0.00%       0.000us       0.000us         15360  
                                          aten::squeeze         0.03%      55.679ms         0.04%      66.146ms       2.871us       0.000us         0.00%       0.000us       0.000us         23040  
                                      hipModuleLoadData         0.24%     396.523ms         0.24%     396.523ms      99.131ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     529.548us         0.00%       1.237ms     309.366us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       4.699ms         0.00%       5.624ms      23.432us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     740.654us         0.00%     740.654us       2.315us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      31.734ms         0.06%      92.716ms       5.913us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      15.268ms         0.04%      60.981ms       3.889us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     507.141us         0.00%       2.426ms      30.331us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%     835.528us         0.00%       1.919ms      23.992us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      43.909ms         0.06%     105.029ms       4.936us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      15.838ms         0.04%      61.119ms       2.872us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      32.795ms         0.04%      73.486ms       3.042us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.108ms         0.00%       2.924ms      12.182us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     424.538us         0.00%       1.816ms       7.566us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     286.685us         0.00%     854.721us      10.684us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     568.036us         0.00%     568.036us       7.100us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     931.893us         0.22%     357.469ms     357.469ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      14.637ms         0.01%      16.556ms       2.155us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       1.919ms         0.00%       1.919ms       0.250us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       4.102ms         0.01%      15.922ms       7.961us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       3.413ms         0.01%      11.820ms       5.910us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       3.595ms         0.01%       9.861ms       5.136us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       1.691ms         0.00%       6.266ms       3.263us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     280.976us         0.00%     280.976us       0.146us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%     999.759us         0.00%       2.766ms      34.575us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.766ms         0.00%       1.766ms      22.078us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.513ms         0.00%       2.266ms      28.326us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       1.981ms     198.082us       0.000us         0.00%       0.000us       0.000us            10  
                                     aten::resolve_conj         0.00%      11.725us         0.00%      11.725us       0.293us       0.000us         0.00%       0.000us       0.000us            40  
                                      aten::resolve_neg         0.00%       6.779us         0.00%       6.779us       0.169us       0.000us         0.00%       0.000us       0.000us            40  
                                           aten::unbind         0.00%      22.279us         0.00%      33.273us       8.318us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 166.212s
Self CUDA time total: 151.886s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       76.913s        52.53%       76.913s       76.913s             1  
                                             bert_train        35.02%       56.753s        71.05%      115.137s      115.137s       0.000us         0.00%       36.403s       36.403s             1  
                                            aten::copy_        15.66%       25.382s        19.38%       31.408s     397.288us       17.195s        11.74%       17.248s     218.172us         79055  
                                               aten::to         0.03%      56.686ms        19.36%       31.373s     594.979us       0.000us         0.00%       12.625s     239.441us         52729  
                                         aten::_to_copy         0.10%     164.651ms        19.32%       31.316s     718.503us       0.000us         0.00%       12.624s     289.647us         43585  
                                      aten::masked_fill         0.04%      61.921ms         0.24%     385.146ms      40.119us       0.000us         0.00%       12.025s       1.253ms          9600  
                                     aten::masked_fill_         0.10%     163.732ms         0.25%     402.737ms      24.557us       11.329s         7.74%       11.330s     690.881us         16400  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      13.603ms         0.09%     153.004ms      39.845us       0.000us         0.00%        7.831s       2.039ms          3840  
                                    MaskedFillBackward0         0.00%       5.709ms         0.09%     139.401ms      36.302us       0.000us         0.00%        7.831s       2.039ms          3840  
                                              aten::bmm         0.23%     376.804ms         0.29%     464.579ms      34.567us        7.389s         5.05%        7.391s     549.954us         13440  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.683s         4.56%        6.683s       1.458ms          4585  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       6.232ms         0.04%      58.421ms      30.428us       0.000us         0.00%        6.492s       3.381ms          1920  
                                       SoftmaxBackward0         0.00%       5.537ms         0.03%      52.189ms      27.182us       0.000us         0.00%        6.492s       3.381ms          1920  
                           aten::_softmax_backward_data         0.01%      15.091ms         0.03%      46.652ms      24.298us        3.346s         2.29%        6.492s       3.381ms          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.431s         4.39%        6.431s     771.920us          8331  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.029s         4.12%        6.029s       1.268ms          4755  
                                     record_param_comms         3.00%        4.860s         4.18%        6.767s     194.935us        3.688s         2.52%        5.729s     165.039us         34714  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      11.270ms         0.05%      74.785ms      19.078us       0.000us         0.00%        5.117s       1.305ms          3920  
                                        ToCopyBackward0         0.00%       5.205ms         0.04%      63.515ms      16.203us       0.000us         0.00%        5.117s       1.305ms          3920  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.644s         3.17%        4.644s     972.141us          4777  
                                            aten::clone         0.06%     103.574ms         0.43%     689.154ms      19.949us       0.000us         0.00%        4.624s     133.843us         34546  
                                          aten::softmax         0.01%      11.197ms         0.08%     129.493ms      22.481us       0.000us         0.00%        4.595s     797.669us          5760  
                                         aten::_softmax         0.04%      72.354ms         0.07%     118.296ms      20.537us        4.592s         3.14%        4.595s     797.669us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.592s         3.14%        4.592s       1.723ms          2665  
                                       c10d::allreduce_         0.22%     357.842ms         2.20%        3.570s     212.346us       0.000us         0.00%        4.515s     268.582us         16811  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.514s         3.08%        4.514s     552.814us          8165  
                                     tex_ts::te_gemm_ts         1.17%        1.903s         1.77%        2.876s      74.893us        4.478s         3.06%        4.481s     116.696us         38400  
autograd::engine::evaluate_function: _LayerNormLinea...         0.04%      70.983ms         1.76%        2.847s     741.425us       0.000us         0.00%        4.455s       1.160ms          3840  
                               _LayerNormLinearBackward         0.94%        1.525s         1.68%        2.725s     709.718us     312.477ms         0.21%        4.316s       1.124ms          3840  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        4.056s         2.77%        4.056s     884.657us          4585  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.892s         2.66%        3.892s     337.876us         11520  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        3.683s         2.52%        3.683s     371.977us          9901  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        3.655s         2.50%        3.655s     372.775us          9805  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.346s         2.29%        3.346s       1.743ms          1920  
                                              aten::mul         0.09%     146.635ms         0.13%     211.900ms      26.584us        3.174s         2.17%        3.174s     398.176us          7971  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      13.539ms         0.10%     158.520ms      82.562us       0.000us         0.00%        3.173s       1.653ms          1920  
                                       BaddbmmBackward0         0.01%      14.532ms         0.09%     144.981ms      75.511us       0.000us         0.00%        3.173s       1.653ms          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.148s         2.15%        3.148s       1.431ms          2200  
                                       aten::logical_or         0.06%      98.470ms         0.19%     304.017ms      26.390us     995.255ms         0.68%        1.991s     172.792us         11520  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.875s         1.28%        1.875s     399.222us          4696  
                                                _Linear         0.93%        1.505s         1.60%        2.598s     676.650us      67.919ms         0.05%        1.803s     469.568us          3840  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      15.881ms         0.10%     156.673ms      81.600us       0.000us         0.00%        1.776s     925.048us          1920  
                                           BmmBackward0         0.01%      10.281ms         0.09%     140.792ms      73.329us       0.000us         0.00%        1.776s     925.048us          1920  
                                              aten::sub         0.06%      92.998ms         0.08%     127.454ms      19.399us        1.741s         1.19%        1.742s     265.143us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.739s         1.19%        1.739s     652.591us          2665  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      30.044ms         1.01%        1.640s     427.120us       0.000us         0.00%        1.626s     423.328us          3840  
                                        _LinearBackward         0.72%        1.170s         0.99%        1.610s     419.296us      77.024ms         0.05%        1.626s     423.328us          3840  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.557s         1.06%        1.557s     810.891us          1920  
                                          aten::dropout         0.01%      10.541ms         0.07%     120.599ms      20.050us       0.000us         0.00%        1.456s     242.071us          6015  
                                   aten::native_dropout         0.03%      42.087ms         0.06%     105.133ms      52.331us        1.454s         0.99%        1.456s     724.767us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.454s         0.99%        1.454s     726.905us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%       9.104ms         0.04%      58.764ms      29.338us       0.000us         0.00%        1.383s     690.254us          2003  
                                 NativeDropoutBackward0         0.00%       5.600ms         0.03%      49.660ms      24.793us       0.000us         0.00%        1.383s     690.254us          2003  
                          aten::native_dropout_backward         0.01%      15.612ms         0.03%      44.060ms      21.997us        1.383s         0.94%        1.383s     690.254us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.383s         0.94%        1.383s     691.289us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.367s         0.93%        1.367s      77.645us         17612  
                                   hipStreamIsCapturing         0.03%      56.368ms         0.03%      56.368ms       1.075us        1.217s         0.83%        1.217s      23.214us         52432  
                                          aten::baddbmm         0.19%     312.460ms         0.40%     643.846ms     111.779us        1.183s         0.81%        1.183s     205.370us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.121s         0.77%        1.121s     583.835us          1920  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     995.255ms         0.68%     995.255ms     373.454us          2665  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      18.074ms         0.55%     895.124ms     233.105us       0.000us         0.00%     984.300ms     256.328us          3840  
                               CompiledFunctionBackward         0.24%     390.619ms         0.54%     877.050ms     228.398us       0.000us         0.00%     984.300ms     256.328us          3840  
                                 triton_red_fused_sum_1         0.02%      27.447ms         0.03%      47.008ms      12.242us     890.380ms         0.61%     890.380ms     231.870us          3840  
                                       c10d::broadcast_         0.03%      41.156ms         0.51%     826.118ms       1.718ms       0.000us         0.00%     675.408ms       1.404ms           481  
                                      aten::logical_not         0.08%     134.047ms         0.25%     408.706ms      17.739us     326.286ms         0.22%     655.587ms      28.454us         23040  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.106ms         0.00%       2.106ms       0.151us     509.186ms         0.35%     509.186ms      36.600us         13912  
                                  hipExtMallocWithFlags         0.03%      41.118ms         0.03%      41.118ms      10.014us     507.840ms         0.35%     507.840ms     123.682us          4106  
                                        hipEventDestroy         0.02%      39.383ms         0.02%      39.780ms       1.938us     454.102ms         0.31%     455.404ms      22.185us         20528  
                                          c10d::barrier         0.00%     844.494us         1.33%        2.160s      56.830ms       0.000us         0.00%     416.844ms      10.970ms            38  
                                  Torch-Compiled Region         0.49%     798.120ms         1.51%        2.450s     127.486us       0.000us         0.00%     407.129ms      21.183us         19220  
                                      hipGetProcAddress         0.04%      65.169ms         0.04%      65.175ms       0.945us     386.355ms         0.26%     386.355ms       5.604us         68944  
                                   hipDeviceGetPCIBusId         0.00%       7.111ms         0.00%       7.111ms       0.666us     384.039ms         0.26%     384.039ms      35.949us         10683  
                                       hipCtxGetCurrent         0.01%       8.814ms         0.01%       8.814ms       0.175us     338.982ms         0.23%     338.982ms       6.741us         50284  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     326.286ms         0.22%     326.286ms      61.217us          5330  
                                       CompiledFunction         0.61%     984.609ms         0.90%        1.453s     125.905us       0.000us         0.00%     309.703ms      26.837us         11540  
                                             aten::add_         0.08%     128.362ms         0.15%     250.732ms       7.980us     303.779ms         0.21%     303.779ms       9.668us         31420  
                                       _LayerNormLinear         0.45%     726.846ms         1.21%        1.957s     509.740us     171.729ms         0.12%     299.243ms      77.928us          3840  
                                              aten::sum         0.20%     328.044ms         0.44%     717.101ms      35.231us     215.889ms         0.15%     284.108ms      13.958us         20354  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     255.646ms         0.17%     255.646ms      66.574us          3840  
                  triton_poi_fused_add_native_dropout_0         0.06%      89.222ms         0.08%     136.116ms      35.355us     240.068ms         0.16%     240.068ms      62.355us          3850  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     214.463ms         0.15%     214.463ms     214.463ms             1  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     202.271ms         0.14%     202.271ms      37.957us          5329  
autograd::engine::evaluate_function: torch::autograd...         0.16%     255.480ms         0.32%     512.657ms      21.219us       0.000us         0.00%     164.966ms       6.828us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     163.436ms         0.11%     163.436ms       6.833us         23920  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     161.495ms         0.11%     161.495ms      30.311us          5328  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.692ms         0.07%     119.267ms       1.491ms       0.000us         0.00%     161.279ms       2.016ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      20.311ms         0.07%     117.575ms       1.470ms       0.000us         0.00%     161.279ms       2.016ms            80  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.01%      20.047ms         0.41%     668.137ms     347.988us       0.000us         0.00%     150.834ms      78.560us          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     148.112ms         0.10%     148.112ms      33.179us          4464  
                                         hipMemcpyAsync         0.12%     196.056ms         0.12%     196.079ms      16.130us     141.371ms         0.10%     144.120ms      11.856us         12156  
                             _VocabParallelCrossEntropy         0.04%      61.972ms         0.14%     234.968ms     979.032us       0.000us         0.00%     138.526ms     577.193us           240  
                                              aten::cat         0.13%     212.162ms         0.16%     257.159ms      30.909us     133.134ms         0.09%     133.293ms      16.021us          8320  
                                   hipStreamSynchronize         0.09%     152.223ms         0.17%     276.931ms      90.353us     127.087ms         0.09%     127.894ms      41.727us          3065  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       5.689ms        24.01%       38.918s     162.159ms       0.000us         0.00%     127.136ms     529.735us           240  
                                     EmbeddingBackward0         0.00%       3.137ms        24.01%       38.911s     162.129ms       0.000us         0.00%     126.294ms     526.224us           240  
                               aten::embedding_backward         0.00%       2.991ms        24.01%       38.908s     162.116ms       0.000us         0.00%     126.294ms     526.224us           240  
                         aten::embedding_dense_backward         1.50%        2.439s        24.01%       38.905s     162.104ms     120.997ms         0.08%     126.294ms     526.224us           240  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     123.209ms         0.08%     123.209ms      31.431us          3920  
                             c10d::allreduce_coalesced_         0.00%       1.541ms         0.06%      92.970ms       9.297ms       0.000us         0.00%     121.712ms      12.171ms            10  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      12.746ms         0.11%     185.037ms      96.374us       0.000us         0.00%     114.674ms      59.726us          1920  
                                 _SplitAlongDimBackward         0.08%     130.004ms         0.11%     172.291ms      89.735us       0.000us         0.00%     114.674ms      59.726us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     114.674ms         0.08%     114.674ms      59.726us          1920  
                                       aten::contiguous         0.02%      24.406ms         0.29%     468.180ms      20.320us       0.000us         0.00%     112.908ms       4.901us         23040  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     111.214ms         0.08%     111.214ms      10.325us         10771  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     110.367ms         0.08%     110.367ms      51.096us          2160  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     104.745ms         0.07%     104.745ms      18.185us          5760  
                                               aten::mm         0.03%      50.370ms         0.06%     105.054ms     119.380us      96.614ms         0.07%      96.614ms     109.788us           880  
             triton_poi_fused_native_dropout_backward_0         0.03%      50.009ms         0.05%      76.816ms      20.004us      93.920ms         0.06%      93.920ms      24.458us          3840  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      91.215ms         0.06%      91.215ms      34.240us          2664  
                                         hipMemsetAsync         0.07%     119.118ms         0.07%     119.141ms       9.958us      87.982ms         0.06%      87.982ms       7.354us         11964  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      82.992ms         0.06%      82.992ms      10.380us          7995  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us      82.174ms         0.06%      82.174ms      15.852us          5184  
                                           aten::matmul         0.00%       2.739ms         0.05%      80.024ms     200.061us       0.000us         0.00%      80.277ms     200.692us           400  
                         _ReduceFromModelParallelRegion         0.01%      18.600ms         0.03%      56.630ms     235.960us       0.000us         0.00%      78.664ms     327.768us           240  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      76.859ms         0.05%      76.859ms      28.840us          2665  
                                           aten::arange         0.07%     118.512ms         0.22%     361.083ms      14.654us      35.737ms         0.02%      72.330ms       2.935us         24640  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      67.303ms         0.05%      67.303ms      15.644us          4302  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.17%     283.052ms         0.31%     494.672ms      64.410us      66.046ms         0.05%      66.940ms       8.716us          7680  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      66.340ms         0.05%      66.340ms     276.417us           240  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      64.745ms         0.04%      64.745ms      16.516us          3920  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      64.483ms         0.04%      64.483ms       5.398us         11946  
                               hipStreamCreateWithFlags         0.20%     316.977ms         0.20%     316.977ms     125.287us      59.293ms         0.04%      59.293ms      23.436us          2530  
                                           GeLUFunction         0.09%     144.988ms         0.56%     908.422ms     157.712us       0.000us         0.00%      56.326ms       9.779us          5760  
                                    hipMemcpyWithStream        27.46%       44.499s        27.46%       44.504s      48.532ms       0.000us         0.00%      56.197ms      61.284us           917  
                        triton_poi_fused_add_mul_tanh_0         0.07%     105.340ms         0.08%     130.711ms      22.653us      54.935ms         0.04%      54.935ms       9.521us          5770  
                                  hipModuleLaunchKernel         0.14%     227.944ms         0.14%     227.968ms       6.637us      52.953ms         0.04%      52.958ms       1.542us         34346  
                                 hipDeviceCanAccessPeer         0.00%     392.430us         0.00%     392.430us       0.215us      50.984ms         0.03%      50.984ms      27.891us          1828  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      48.607ms         0.03%      48.607ms      12.658us          3840  
        LinearWithGradAccumulationAndAsyncCommunication         0.00%       6.782ms         0.01%      22.297ms      92.905us       0.000us         0.00%      48.281ms     201.172us           240  
                                 triton_poi_fused_add_0         0.10%     163.548ms         0.11%     177.806ms      23.152us      45.738ms         0.03%      46.131ms       6.007us          7680  
                                   GeLUFunctionBackward         0.03%      43.193ms         0.36%     581.929ms     303.088us       0.000us         0.00%      42.434ms      22.101us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.01%      23.930ms         0.02%      38.142ms      19.866us      42.434ms         0.03%      42.434ms      22.101us          1920  
                                    hipIpcOpenMemHandle         0.05%      73.041ms         0.05%      73.041ms      45.339us      41.869ms         0.03%      41.869ms      25.989us          1611  
                                     hipIpcGetMemHandle         0.01%       9.519ms         0.01%       9.519ms       5.931us      38.133ms         0.03%      38.133ms      23.759us          1605  
                                       hipStreamDestroy         0.03%      50.597ms         0.03%      50.597ms      20.158us      37.208ms         0.03%      37.208ms      14.824us          2510  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      36.681ms         0.03%      36.681ms      19.105us          1920  
                                hipPointerGetAttributes         0.00%       2.688ms         0.00%       2.762ms       3.182us      35.714ms         0.02%      35.714ms      41.145us           868  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      33.843ms         0.02%      33.843ms       6.350us          5330  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      33.367ms         0.02%      33.367ms       6.260us          5330  
                                            aten::fill_         0.07%     117.303ms         0.09%     151.305ms       5.232us      29.824ms         0.02%      31.371ms       1.085us         28919  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      30.790ms         0.02%      30.790ms      11.553us          2665  
                                            aten::zero_         0.04%      63.964ms         0.13%     206.004ms       9.097us       0.000us         0.00%      27.747ms       1.225us         22646  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      27.248ms         0.02%      27.248ms     170.300us           160  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.528ms         0.03%      52.370ms     654.624us       0.000us         0.00%      26.785ms     334.806us            80  
                                            aten::zeros         0.04%      67.656ms         0.19%     306.934ms      13.699us       0.000us         0.00%      26.399ms       1.178us         22406  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      25.822ms         0.02%      25.822ms       6.725us          3840  
                                              aten::exp         0.00%       2.363ms         0.01%      16.932ms      70.548us      24.514ms         0.02%      24.514ms     102.143us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      24.514ms         0.02%      24.514ms     220.851us           111  
                                     hipStreamWaitEvent         0.19%     310.865ms         0.19%     310.894ms      14.659us      21.613ms         0.01%      23.402ms       1.103us         21208  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.956ms         0.03%      48.823ms     203.428us       0.000us         0.00%      23.125ms      96.355us           240  
                                          aten::randint         0.02%      39.113ms         0.10%     154.790ms      40.163us       0.000us         0.00%      22.976ms       5.962us          3854  
                                          aten::random_         0.04%      62.868ms         0.07%     112.836ms      29.285us      22.182ms         0.02%      22.959ms       5.959us          3853  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      22.753ms         0.02%      22.753ms     284.415us            80  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      22.733ms         0.02%      22.733ms      35.245us           645  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      22.182ms         0.02%      22.182ms       5.762us          3850  
                                              aten::add         0.05%      81.102ms         0.07%     116.859ms      65.394us      21.419ms         0.01%      21.419ms      11.986us          1787  
                                             aten::div_         0.00%       4.933ms         0.01%      10.584ms      22.050us      20.920ms         0.01%      20.920ms      43.584us           480  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.230ms         0.01%      20.230ms     182.251us           111  
                                           aten::linear         0.00%       2.931ms         0.03%      49.092ms      68.184us       0.000us         0.00%      20.096ms      27.911us           720  
                                            aten::addmm         0.02%      34.287ms         0.03%      41.465ms      57.590us      20.096ms         0.01%      20.096ms      27.911us           720  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      19.600ms         0.01%      19.600ms      88.290us           222  
                                             aten::sub_         0.00%       4.275ms         0.00%       5.761ms      18.003us      19.290ms         0.01%      19.290ms      60.281us           320  
                                 tex_ts::cast_to_fp8_ts         0.07%     108.711ms         0.10%     167.021ms      21.747us      18.741ms         0.01%      19.159ms       2.495us          7680  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      18.785ms         0.01%      18.785ms     169.233us           111  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      18.741ms         0.01%      18.741ms      12.586us          1489  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      18.460ms         0.01%      18.460ms       6.287us          2936  
                                        aten::embedding         0.00%       5.778ms         0.02%      25.175ms      34.965us       0.000us         0.00%      17.305ms      24.034us           720  
                                     aten::index_select         0.01%      10.384ms         0.01%      17.115ms      23.771us      17.305ms         0.01%      17.305ms      24.034us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      17.305ms         0.01%      17.305ms      51.502us           336  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      17.175ms         0.01%      17.175ms       6.445us          2665  
                                           aten::cumsum         0.06%      95.511ms         0.08%     125.120ms      21.722us      16.978ms         0.01%      16.994ms       2.950us          5760  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      16.978ms         0.01%      16.978ms       6.371us          2665  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      16.967ms         0.01%      16.967ms       6.333us          2679  
                                         AddmmBackward0         0.00%       3.038ms         0.02%      37.064ms     154.432us       0.000us         0.00%      16.337ms      68.071us           240  
                     _VocabParallelCrossEntropyBackward         0.01%      19.589ms         0.03%      46.833ms     585.410us       0.000us         0.00%      16.219ms     202.739us            80  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.096ms         0.01%      13.096ms      81.851us           160  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      12.924ms         0.01%      12.924ms     116.437us           111  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      12.881ms         0.01%      12.881ms       6.709us          1920  
                                             aten::mul_         0.00%       6.383ms         0.00%       7.157ms       5.591us      12.589ms         0.01%      12.589ms       9.835us          1280  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.198ms         0.01%      12.198ms     109.888us           111  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.595ms         0.01%      11.595ms     104.457us           111  
                                            aten::index         0.01%      13.038ms         0.04%      64.341ms     113.476us       2.004ms         0.00%       9.891ms      17.444us           567  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.777ms         0.01%       9.777ms      40.738us           240  
                                       aten::index_put_         0.00%       4.833ms         0.11%     181.002ms     161.609us       0.000us         0.00%       9.659ms       8.624us          1120  
                                 aten::_index_put_impl_         0.00%       6.867ms         0.11%     176.169ms     157.294us     799.439us         0.00%       9.659ms       8.624us          1120  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       9.051ms         0.01%       9.051ms      37.713us           240  
                                              aten::max         0.00%       5.388ms         0.02%      33.294ms     131.079us       8.906ms         0.01%       8.929ms      35.155us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.892ms         0.01%       8.892ms      80.109us           111  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.831ms         0.01%       8.831ms      20.395us           433  
                           FusedLayerNormAffineFunction         0.01%      10.337ms         0.01%      17.630ms      73.460us       8.452ms         0.01%       8.493ms      35.389us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       8.452ms         0.01%       8.452ms      76.141us           111  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.074ms         0.02%      27.890ms     348.629us       0.000us         0.00%       8.341ms     104.265us            80  
                            torch::autograd::CopySlices         0.00%       3.773ms         0.02%      25.817ms     322.708us       0.000us         0.00%       8.341ms     104.265us            80  
         _compile.<locals>.compile_inner (dynamo_timed)         0.08%     135.845ms         2.04%        3.301s     330.136ms       0.000us         0.00%       8.247ms     824.693us            10  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.391ms         0.01%      13.409ms     167.616us       0.000us         0.00%       8.221ms     102.767us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.486ms         0.01%      11.018ms     137.730us       8.221ms         0.01%       8.221ms     102.767us            80  
                                          aten::nonzero         0.00%       6.574ms         0.02%      35.650ms     145.511us       7.852ms         0.01%       7.887ms      32.193us           245  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.298ms         0.00%       7.298ms      10.639us           686  
                                        hipLaunchKernel         0.85%        1.372s         0.85%        1.372s       8.728us     579.202us         0.00%       7.258ms       0.046us        157229  
                            hipGetDevicePropertiesR0600         0.05%      80.448ms         0.05%      80.452ms       0.858us       6.746ms         0.00%       6.746ms       0.072us         93799  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.462ms         0.00%       6.462ms      80.780us            80  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     572.893us         0.00%       2.339ms     233.897us       6.246ms         0.00%       6.246ms     624.574us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.246ms         0.00%       6.246ms      56.779us           110  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       6.156ms         0.00%       6.156ms      25.648us           240  
                                       aten::empty_like         0.10%     163.868ms         0.29%     474.799ms       5.339us       0.000us         0.00%       5.830ms       0.066us         88930  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.558ms         0.00%       5.558ms       6.155us           903  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      31.503ms         1.92%        3.115s     311.459ms       0.000us         0.00%       5.431ms     543.083us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.37%     596.751ms         1.90%        3.083s     308.309ms       0.000us         0.00%       5.431ms     543.083us            10  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       5.183ms         0.00%       5.183ms       5.399us           960  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       4.984ms         0.00%       4.984ms      31.152us           160  
                                        aten::index_put         0.00%       1.832ms         0.01%      11.550ms     139.160us       0.000us         0.00%       4.335ms      52.226us            83  
                                      IndexPutBackward0         0.00%       1.071ms         0.01%      11.452ms     143.148us       0.000us         0.00%       4.335ms      54.184us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       3.868ms         0.00%       3.868ms      48.350us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       3.855ms         0.00%       3.855ms      48.185us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     994.564us         0.01%      21.909ms     273.867us       0.000us         0.00%       3.589ms      44.859us            80  
                                     _LayerNormBackward         0.00%       5.018ms         0.01%      20.915ms     261.435us       3.589ms         0.00%       3.589ms      44.859us            80  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us       3.418ms         0.00%       3.418ms      15.193us           225  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     750.989us         0.00%       3.084ms      38.555us       0.000us         0.00%       3.197ms      39.957us            80  
                                          GeluBackward0         0.00%     469.504us         0.00%       2.333ms      29.168us       0.000us         0.00%       3.197ms      39.957us            80  
                                    aten::gelu_backward         0.00%       1.180ms         0.00%       1.864ms      23.299us       3.197ms         0.00%       3.197ms      39.957us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.197ms         0.00%       3.197ms      39.957us            80  
                                  hipMemGetAddressRange         0.00%     106.552us         0.00%     106.552us       0.237us       3.144ms         0.00%       3.144ms       7.001us           449  
                                  hipDeviceGetAttribute         0.00%     242.623us         0.00%     242.623us       3.621us       3.112ms         0.00%       3.112ms      46.444us            67  
                                    aten::empty_strided         0.19%     311.277ms         0.20%     317.723ms       3.574us       0.000us         0.00%       3.045ms       0.034us         88887  
                                             aten::ones         0.00%     823.176us         0.00%       5.353ms      11.151us       0.000us         0.00%       3.004ms       6.257us           480  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     636.067us         0.00%       4.286ms      53.574us       0.000us         0.00%       2.951ms      36.886us            80  
                                             aten::gelu         0.00%       3.181ms         0.00%       7.711ms      32.129us       2.792ms         0.00%       2.792ms      11.632us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.792ms         0.00%       2.792ms      25.151us           111  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.370ms         0.00%       2.370ms       4.364us           543  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.358ms         0.00%       2.358ms      21.239us           111  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      15.859ms         1.27%        2.053s     205.331ms       0.000us         0.00%       2.304ms     230.367us            10  
                        compile_fx_inner (dynamo_timed)         0.05%      81.651ms         1.48%        2.399s     218.100ms       0.000us         0.00%       2.304ms     209.425us            11  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.204ms         0.00%       2.204ms       5.567us           396  
                                           aten::select         0.20%     319.102ms         0.24%     387.302ms       3.957us       0.000us         0.00%       2.180ms       0.022us         97887  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.171ms         0.00%       2.171ms       4.867us           446  
                                              aten::div         0.01%       9.698ms         0.01%      13.126ms      19.768us       2.084ms         0.00%       2.084ms       3.138us           664  
                                              hipMemcpy         0.01%      10.691ms         0.01%      10.691ms     222.729us       2.076ms         0.00%       2.076ms      43.256us            48  
                                            aten::empty         0.46%     751.239ms         0.47%     756.084ms       2.882us       0.000us         0.00%       2.035ms       0.008us        262318  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.004ms         0.00%       2.004ms      10.329us           194  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     583.410us         0.00%       7.339ms      45.868us       0.000us         0.00%       1.969ms      12.304us           160  
                                         SliceBackward0         0.00%     427.212us         0.00%       6.755ms      42.221us       0.000us         0.00%       1.969ms      12.304us           160  
                                   aten::slice_backward         0.00%     893.279us         0.00%       6.328ms      39.551us       0.000us         0.00%       1.969ms      12.304us           160  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.724ms         0.00%       1.724ms      15.533us           111  
                                             _LayerNorm         0.00%       6.115ms         0.01%      10.783ms     134.790us       1.704ms         0.00%       1.704ms      21.301us            80  
                                               aten::lt         0.01%      14.765ms         0.01%      17.566ms      24.397us       1.698ms         0.00%       1.698ms       2.358us           720  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.605ms         0.00%       1.605ms       6.686us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.589ms         0.00%       1.589ms       4.936us           322  
      autograd::engine::evaluate_function: MulBackward0         0.01%      15.148ms         0.04%      71.296ms     414.510us       0.000us         0.00%       1.500ms       8.720us           172  
                                          aten::squeeze         0.04%      63.291ms         0.05%      75.537ms       3.279us       0.000us         0.00%       1.481ms       0.064us         23040  
                               aten::cross_entropy_loss         0.00%       1.212ms         0.01%      15.854ms      66.058us       0.000us         0.00%       1.383ms       5.763us           240  
                                        aten::transpose         0.14%     233.191ms         0.18%     286.243ms       3.004us       0.000us         0.00%       1.362ms       0.014us         95285  
                                        SelectBackward0         0.00%     204.681us         0.00%       2.704ms      33.805us       0.000us         0.00%       1.359ms      16.982us            80  
                                  aten::select_backward         0.00%     388.363us         0.00%       2.500ms      31.247us       0.000us         0.00%       1.359ms      16.982us            80  
                                 c10d::_allgather_base_         0.00%     254.487us         0.00%       1.808ms     129.175us       0.000us         0.00%       1.223ms      87.344us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       1.223ms         0.00%       1.223ms     101.901us            12  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.185ms         0.00%       1.185ms       6.205us           191  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.120ms         0.00%       1.120ms       2.319us           483  
                                          hipHostMalloc         0.16%     259.848ms         0.17%     268.527ms       2.166ms     283.051us         0.00%       1.096ms       8.840us           124  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.082ms         0.00%       1.082ms       4.854us           223  
                                   hipFuncGetAttributes         0.17%     281.130ms         0.17%     281.130ms       2.130ms       1.079ms         0.00%       1.079ms       8.177us           132  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.073ms         0.00%       1.073ms      13.415us            80  
                                           aten::__or__         0.00%       1.062ms         0.01%      20.450ms      42.604us       0.000us         0.00%       1.041ms       2.169us           480  
                                       aten::bitwise_or         0.00%       6.603ms         0.01%      19.388ms      40.391us       1.041ms         0.00%       1.041ms       2.169us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.041ms         0.00%       1.041ms       4.669us           223  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.035ms         0.00%       1.035ms       4.643us           223  
                                               aten::ge         0.00%       5.411ms         0.00%       6.574ms      13.697us       1.020ms         0.00%       1.020ms       2.126us           480  
                                           MulBackward0         0.01%      10.888ms         0.03%      42.029ms     244.353us       0.000us         0.00%       1.000ms       5.817us           172  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       2.009ms         0.01%      10.781ms     134.757us       0.000us         0.00%     996.810us      12.460us            80  
                                       NllLossBackward0         0.00%       1.024ms         0.01%       8.772ms     109.648us       0.000us         0.00%     996.810us      12.460us            80  
                                aten::nll_loss_backward         0.00%       3.255ms         0.00%       7.748ms      96.854us     497.380us         0.00%     996.810us      12.460us            80  
      autograd::engine::evaluate_function: DivBackward0         0.00%       2.029ms         0.01%       8.763ms      54.770us       0.000us         0.00%     980.700us       6.129us           160  
                                           DivBackward0         0.00%     871.818us         0.00%       6.734ms      42.089us       0.000us         0.00%     980.700us       6.129us           160  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us     970.477us         0.00%     970.477us       6.065us           160  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     883.234us         0.00%     883.234us       7.957us           111  
                                   hipDeviceSynchronize         0.00%     696.508us         0.00%     696.508us      20.486us     830.231us         0.00%     830.231us      24.419us            34  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     819.925us         0.00%     819.925us       3.416us           240  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     799.439us         0.00%     799.439us       9.993us            80  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     750.765us         0.00%     750.765us       9.385us            80  
                               TorchDynamo Cache Lookup         0.11%     178.289ms         0.11%     178.318ms       9.277us       0.000us         0.00%     748.393us       0.039us         19221  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     742.705us         0.00%     742.705us       3.095us           240  
                                             aten::tanh         0.01%      14.716ms         0.02%      27.459ms     101.325us     727.963us         0.00%     727.963us       2.686us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     727.963us         0.00%     727.963us       6.558us           111  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     707.585us         0.00%     707.585us       6.375us           111  
                                      aten::log_softmax         0.00%     896.532us         0.00%       5.222ms      21.757us       0.000us         0.00%     705.986us       2.942us           240  
                                     aten::_log_softmax         0.00%       3.131ms         0.00%       4.228ms      17.616us     705.986us         0.00%     705.986us       2.942us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     705.986us         0.00%     705.986us       6.360us           111  
                                             aten::item         0.02%      24.581ms         0.03%      50.027ms       3.021us       0.000us         0.00%     696.744us       0.042us         16562  
                              aten::_local_scalar_dense         0.01%      11.864ms         0.02%      25.446ms       1.536us     696.744us         0.00%     696.744us       0.042us         16562  
                                      aten::nll_loss_nd         0.00%     619.126us         0.01%       9.420ms      39.250us       0.000us         0.00%     677.123us       2.821us           240  
                                         aten::nll_loss         0.00%     649.700us         0.01%       8.801ms      36.670us       0.000us         0.00%     677.123us       2.821us           240  
                                 aten::nll_loss_forward         0.00%       3.623ms         0.01%       8.151ms      33.963us     677.123us         0.00%     677.123us       2.821us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     677.123us         0.00%     677.123us       6.100us           111  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     670.620us         0.00%     670.620us       8.383us            80  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       4.501ms         0.01%       8.844ms      55.273us     653.483us         0.00%     653.483us       4.084us           160  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     652.899us         0.00%     652.899us       8.161us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     647.893us         0.00%     647.893us       5.837us           111  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     606.956us         0.00%     606.956us       2.498us           243  
                                          aten::normal_         0.77%        1.240s         0.77%        1.242s      11.947ms     580.981us         0.00%     586.955us       5.644us           104  
                                       aten::is_nonzero         0.01%       8.413ms         0.01%      19.616ms       4.808us       0.000us         0.00%     582.701us       0.143us          4080  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     580.981us         0.00%     580.981us       5.989us            97  
                                                hipFree         0.07%     109.268ms         0.07%     109.302ms       6.072ms       6.174us         0.00%     567.786us      31.544us            18  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     547.586us         0.00%     547.586us       4.889us           112  
                                             aten::rsub         0.00%       3.618ms         0.01%      10.687ms     124.267us       0.000us         0.00%     513.937us       5.976us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     513.937us         0.00%     513.937us       6.424us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     500.950us         0.00%     500.950us       6.262us            80  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     498.591us         0.00%     498.591us       6.232us            80  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     497.380us         0.00%     497.380us       6.217us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.462ms         0.02%      29.236ms     356.543us       0.000us         0.00%     496.942us       6.060us            82  
                                          TanhBackward0         0.00%       2.613ms         0.02%      27.774ms     338.712us       0.000us         0.00%     496.942us       6.060us            82  
                                    aten::tanh_backward         0.00%       3.551ms         0.01%      21.866ms     266.654us     496.942us         0.00%     496.942us       6.060us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     496.942us         0.00%     496.942us       6.212us            80  
                                        aten::ones_like         0.00%     392.836us         0.00%       2.244ms      28.052us       0.000us         0.00%     489.570us       6.120us            80  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     892.769us         0.00%       5.573ms      69.663us       0.000us         0.00%     488.690us       6.109us            80  
                                    LogSoftmaxBackward0         0.00%       1.427ms         0.00%       4.680ms      58.504us       0.000us         0.00%     488.690us       6.109us            80  
                       aten::_log_softmax_backward_data         0.00%       1.705ms         0.00%       3.253ms      40.665us     488.690us         0.00%     488.690us       6.109us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     488.690us         0.00%     488.690us       6.109us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     485.762us         0.00%     485.762us       6.072us            80  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     481.556us         0.00%     481.556us       1.982us           243  
                                               aten::gt         0.02%      36.119ms         0.03%      43.408ms       9.999us     481.431us         0.00%     481.431us       0.111us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     478.825us         0.00%     478.825us       1.979us           242  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     449.188us         0.00%     449.188us       1.872us           240  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     440.529us         0.00%     440.529us       1.836us           240  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     408.580us         0.00%     408.580us       1.681us           243  
                                              aten::log         0.00%       2.831ms         0.00%       7.200ms      30.002us     376.634us         0.00%     376.634us       1.569us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     376.634us         0.00%     376.634us       3.393us           111  
                                         _SplitAlongDim         0.08%     131.287ms         0.12%     186.865ms      32.442us       0.000us         0.00%     368.197us       0.064us          5760  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     299.770us         0.00%     299.770us       1.874us           160  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     292.155us         0.00%     292.155us       3.652us            80  
                               hipExtModuleLaunchKernel         0.17%     277.398ms         0.17%     277.458ms       6.894us       0.000us         0.00%     250.176us       0.006us         40249  
                                             aten::view         0.17%     280.648ms         0.18%     288.145ms       1.973us       0.000us         0.00%     238.509us       0.002us        146073  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     217.142us         0.00%     217.142us       2.310us            94  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     212.162us         0.00%     212.162us       3.658us            58  
                                             aten::rand         0.00%       2.624ms         0.00%       6.213ms     443.800us       0.000us         0.00%     153.864us      10.990us            14  
                                         aten::uniform_         0.01%       8.976ms         0.01%      11.200ms     861.525us     153.864us         0.00%     153.864us      11.836us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     153.864us         0.00%     153.864us      30.773us             5  
                                     hipExtLaunchKernel         0.06%      99.935ms         0.06%      99.954ms       9.840us       0.000us         0.00%      69.600us       0.007us         10158  
                                    hipFuncSetAttribute         0.00%       9.256us         0.00%       9.256us       0.386us      63.826us         0.00%      63.826us       2.659us            24  
                                       aten::lift_fresh         0.03%      53.624ms         0.04%      59.717ms      33.815us       0.000us         0.00%      56.453us       0.032us          1766  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      36.005us         0.00%      36.005us       3.600us            10  
         GraphLowering.compile_to_module (dynamo_timed)         0.70%        1.131s         1.27%        2.053s     186.619ms       0.000us         0.00%      23.854us       2.169us            11  
                             hipDevicePrimaryCtxRelease         0.00%       1.284us         0.00%       1.284us       0.214us      23.735us         0.00%      23.735us       3.956us             6  
                                          aten::maximum         0.00%     120.776us         0.01%      23.006ms       2.556ms      23.093us         0.00%      23.093us       2.566us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.093us         0.00%      23.093us       2.566us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      22.532us         0.00%      22.532us       2.253us            10  
                                       aten::reciprocal         0.00%     163.778us         0.01%       8.236ms     823.573us      21.691us         0.00%      21.691us       2.169us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      21.691us         0.00%      21.691us       2.169us            10  
                                    hipModuleLoadDataEx         0.38%     608.753ms         0.38%     608.753ms      50.729ms      21.449us         0.00%      21.449us       1.787us            12  
                                              aten::min         0.00%      81.246us         0.00%       3.459ms     691.804us      15.315us         0.00%      15.315us       3.063us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.315us         0.00%      15.315us       5.105us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      14.232us         0.00%      14.232us       4.744us             3  
                                 aten::split_with_sizes         0.03%      42.883ms         0.03%      55.555ms       9.645us       0.000us         0.00%      13.551us       0.002us          5760  
                                    hipFuncGetAttribute         0.00%       5.903us         0.00%       5.903us       0.492us      11.947us         0.00%      11.947us       0.996us            12  
                            hipGetDevicePropertiesR0000         0.00%      51.250us         0.00%      51.250us       5.125us      11.907us         0.00%      11.907us       1.191us            10  
                              hipDevicePrimaryCtxRetain         0.00%       1.585us         0.00%       1.585us       0.264us       6.976us         0.00%       6.976us       1.163us             6  
                                       aten::as_strided         0.13%     211.968ms         0.13%     212.255ms       0.631us       0.000us         0.00%       6.696us       0.000us        336543  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.606us         0.00%       2.606us       2.606us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.366us         0.00%       2.366us       2.366us             1  
                        hipDeviceGetStreamPriorityRange         0.00%       4.224us         0.00%       4.224us       4.224us       0.000us         0.00%       0.000us       0.000us             1  
                                              hipMalloc         0.01%      14.000ms         0.01%      14.000ms      85.364us       0.000us         0.00%       0.000us       0.000us           164  
                            hipStreamCreateWithPriority         0.00%     533.346us         0.00%     533.346us      88.891us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0     969.488ms      57.540us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      11.105ms         0.01%      11.105ms       1.093us       0.000us         0.00%       0.000us       0.000us         10160  
                                           aten::detach         0.04%      69.093ms         0.13%     204.259ms       5.758us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.06%     102.147ms         0.08%     127.766ms       3.777us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.01%      11.192ms         0.01%      20.417ms     164.654us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.04%      58.536ms         0.05%      78.022ms       2.154us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     317.516us         0.00%     423.740us      52.967us       0.000us         0.00%       0.000us       0.000us             8  
                                             prims::add         0.00%       1.324ms         0.00%       1.880ms      98.922us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     576.808us         0.00%       1.172ms      27.912us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     892.139us         0.00%       1.248ms      89.139us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     141.111us         0.00%     192.312us      96.156us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       4.716ms         0.01%       9.606ms     252.793us       0.000us         0.00%       0.000us       0.000us            38  
                                         prims::view_of         0.00%     674.114us         0.00%     855.564us      35.649us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       6.654ms         0.00%       6.778ms       7.068us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       5.860ms         0.00%       6.776ms       8.397us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%     915.859us         0.00%     915.859us       1.135us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     451.060us         0.00%     451.060us      14.550us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     124.251us         0.00%     124.251us      11.296us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      13.320ms         0.02%      28.123ms     109.855us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     695.198us         0.00%     695.198us       2.716us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     261.609us         0.00%     352.069us     117.356us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     145.408us         0.00%     145.408us      72.704us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     168.271us         0.00%     179.120us      89.560us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      36.901us         0.00%      36.901us       2.636us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.518ms         0.00%       2.993ms     598.564us       0.000us         0.00%       0.000us       0.000us             5  
                                            aten::slice         0.05%      82.349ms         0.06%      98.580ms       3.774us       0.000us         0.00%       0.000us       0.000us         26118  
                                        aten::index_add         0.00%     315.826us         0.00%       1.656ms       1.656ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     614.642us         0.00%     692.303us     346.152us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     299.091us         0.00%     299.091us     299.091us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.13%     208.365ms         0.13%     211.249ms      19.204ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.11%     175.970ms         0.11%     176.005ms      16.000ms       0.000us         0.00%       0.000us       0.000us            11  
                       Scheduler.codegen (dynamo_timed)         0.09%     139.033ms         0.09%     139.062ms      12.642ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.01%       9.162ms         0.01%       9.162ms     832.949us       0.000us         0.00%       0.000us       0.000us            11  
                                 hipPointerGetAttribute         0.03%      46.811ms         0.03%      46.811ms       0.731us       0.000us         0.00%       0.000us       0.000us         64064  
                                        aten::expand_as         0.00%     795.048us         0.00%       2.740ms       5.046us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.948ms         0.00%       6.739ms     612.653us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     161.660us         0.00%     180.771us      90.386us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     168.236us         0.00%     168.236us      84.118us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      95.414us         0.00%     119.307us     119.307us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     398.859us         0.00%       3.611ms       1.204ms       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     309.070us         0.00%     344.637us     114.879us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.335ms         0.00%       4.761ms     793.501us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%       1.034ms         0.00%       5.174ms     574.846us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.441ms         0.00%       3.419ms     569.818us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     444.550us         0.00%       1.185ms     395.111us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     263.979us         0.00%       1.413ms     471.105us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     579.848us         0.00%       1.149ms     383.112us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     420.996us         0.00%     443.063us     110.766us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.06%      97.716ms         0.06%      97.976ms       2.827us       0.000us         0.00%       0.000us       0.000us         34655  
                                               aten::eq         0.02%      34.555ms         0.02%      34.559ms       5.900us       0.000us         0.00%       0.000us       0.000us          5857  
                                              aten::all         0.04%      65.194ms         0.05%      74.196ms      12.668us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       2.820ms         0.00%       2.820ms       0.115us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0       1.015ms      72.509us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.163ms         0.01%      12.446ms       5.544us       0.000us         0.00%       0.000us       0.000us          2245  
                                          aten::reshape         0.06%      91.745ms         0.10%     167.111ms       3.868us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      66.809ms     138.896us       0.000us         0.00%       0.000us       0.000us           481  
enumerate(DataLoader)#_MultiProcessingDataLoaderIter...         0.03%      43.412ms         0.03%      43.412ms     180.885us       0.000us         0.00%       0.000us       0.000us           240  
                                           aten::narrow         0.00%       6.209ms         0.01%      22.324ms       8.456us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.02%      26.504ms         0.02%      32.126ms       4.365us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.116ms         0.00%       2.461ms       3.418us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      30.341ms         0.02%      36.091ms       4.511us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.615us         0.00%       1.615us       0.269us       0.000us         0.00%       0.000us       0.000us             6  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      45.945ms         0.03%      45.945ms       2.449us       0.000us         0.00%       0.000us       0.000us         18760  
                                              hipMemset         0.00%      30.811us         0.00%      30.811us      15.406us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.28%     452.146ms         0.28%     452.146ms     150.715ms       0.000us         0.00%       0.000us       0.000us             3  
                                   aten::_reshape_alias         0.02%      27.780ms         0.02%      27.780ms       1.809us       0.000us         0.00%       0.000us       0.000us         15360  
                                      hipModuleLoadData         0.24%     387.717ms         0.24%     387.717ms      96.929ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     734.497us         0.00%       1.698ms     424.615us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       5.199ms         0.00%       6.203ms      25.846us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     747.972us         0.00%     747.972us       2.337us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      32.171ms         0.06%      93.204ms       5.944us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      15.133ms         0.04%      61.033ms       3.892us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     511.217us         0.00%       3.813ms      47.660us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.366ms         0.00%       3.302ms      41.269us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      44.419ms         0.07%     106.042ms       4.983us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      16.026ms         0.04%      61.623ms       2.896us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      32.097ms         0.05%      74.308ms       3.076us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.116ms         0.00%       2.868ms      11.952us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     431.351us         0.00%       1.752ms       7.302us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     310.874us         0.00%     897.820us      11.223us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     586.946us         0.00%     586.946us       7.337us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     951.189us         0.22%     362.607ms     362.607ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      15.113ms         0.01%      17.047ms       2.219us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       1.934ms         0.00%       1.934ms       0.252us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       4.125ms         0.01%      15.551ms       7.775us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       3.177ms         0.01%      11.426ms       5.713us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       3.662ms         0.01%       9.865ms       5.138us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       1.631ms         0.00%       6.203ms       3.231us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     277.123us         0.00%     277.123us       0.144us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.001ms         0.00%       2.649ms      33.116us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.648ms         0.00%       1.648ms      20.602us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.940ms         0.00%       2.755ms      34.442us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.321ms     232.112us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      11.723us         0.00%      22.409us       5.602us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 162.059s
Self CUDA time total: 146.411s

[rank4]:[W124 07:34:13.075582053 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       76.429s        50.95%       76.429s       76.429s             1  
                                             bert_train        36.76%       59.037s        71.08%      114.138s      114.138s       0.000us         0.00%       38.525s       38.525s             1  
                                            aten::copy_        13.17%       21.144s        16.20%       26.015s     330.079us       16.877s        11.25%       16.914s     214.600us         78815  
                                               aten::to         0.04%      65.946ms        16.19%       25.991s     495.168us       0.000us         0.00%       12.330s     234.915us         52489  
                                         aten::_to_copy         0.12%     199.081ms        16.14%       25.925s     598.107us       0.000us         0.00%       12.330s     284.472us         43345  
                                      aten::masked_fill         0.05%      79.863ms         0.30%     483.215ms      50.335us       0.000us         0.00%       11.886s       1.238ms          9600  
                                     aten::masked_fill_         0.12%     200.196ms         0.29%     461.802ms      28.159us       11.118s         7.41%       11.118s     677.926us         16400  
                                     record_param_comms         2.67%        4.296s         4.14%        6.648s     191.512us        6.347s         4.23%        9.573s     275.754us         34714  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      18.017ms         0.12%     196.600ms      51.198us       0.000us         0.00%        7.792s       2.029ms          3840  
                                    MaskedFillBackward0         0.00%       7.463ms         0.11%     178.584ms      46.506us       0.000us         0.00%        7.792s       2.029ms          3840  
                                              aten::bmm         0.32%     512.749ms         0.38%     607.294ms      45.186us        7.273s         4.85%        7.273s     541.127us         13440  
                                       c10d::allreduce_         0.28%     453.171ms         2.46%        3.945s     234.684us       0.000us         0.00%        6.582s     391.531us         16811  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.530s         4.35%        6.530s       1.437ms          4543  
autograd::engine::evaluate_function: SoftmaxBackward...         0.01%       8.241ms         0.05%      73.696ms      38.383us       0.000us         0.00%        6.477s       3.373ms          1920  
                                       SoftmaxBackward0         0.00%       7.050ms         0.04%      65.456ms      34.091us       0.000us         0.00%        6.477s       3.373ms          1920  
                           aten::_softmax_backward_data         0.01%      20.111ms         0.04%      58.406ms      30.420us        3.345s         2.23%        6.477s       3.373ms          1920  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        6.313s         4.21%        6.313s     649.654us          9717  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.268s         4.18%        6.268s     756.708us          8283  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        6.202s         4.13%        6.202s     632.159us          9811  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.921s         3.95%        5.921s       1.256ms          4713  
autograd::engine::evaluate_function: _LayerNormLinea...         0.06%     103.064ms         2.32%        3.724s     969.789us       0.000us         0.00%        5.278s       1.374ms          3840  
                               _LayerNormLinearBackward         1.24%        1.988s         2.21%        3.555s     925.723us     311.183ms         0.21%        5.139s       1.338ms          3840  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      14.083ms         0.06%      92.165ms      23.512us       0.000us         0.00%        5.076s       1.295ms          3920  
                                        ToCopyBackward0         0.00%       6.662ms         0.05%      78.082ms      19.919us       0.000us         0.00%        5.076s       1.295ms          3920  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.586s         3.06%        4.586s     968.863us          4733  
                                            aten::clone         0.08%     128.316ms         0.50%     803.722ms      23.265us       0.000us         0.00%        4.580s     132.577us         34546  
                                          aten::softmax         0.01%      14.600ms         0.09%     151.516ms      26.305us       0.000us         0.00%        4.485s     778.611us          5760  
                                         aten::_softmax         0.06%      88.947ms         0.09%     136.913ms      23.770us        4.484s         2.99%        4.485s     778.611us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.484s         2.99%        4.484s       1.710ms          2623  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.480s         2.99%        4.480s     552.516us          8109  
                                     tex_ts::te_gemm_ts         1.50%        2.408s         2.22%        3.570s      92.967us        4.306s         2.87%        4.311s     112.265us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.959s         2.64%        3.959s     871.380us          4543  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.736s         2.49%        3.736s     324.303us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.345s         2.23%        3.345s       1.742ms          1920  
                                              aten::mul         0.09%     137.211ms         0.12%     193.404ms      24.264us        3.159s         2.11%        3.159s     396.356us          7971  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      17.821ms         0.13%     212.286ms     110.566us       0.000us         0.00%        3.140s       1.635ms          1920  
                                       BaddbmmBackward0         0.01%      19.503ms         0.12%     194.466ms     101.284us       0.000us         0.00%        3.140s       1.635ms          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.133s         2.09%        3.133s       1.426ms          2198  
                                          c10d::barrier         0.00%     775.454us         0.80%        1.286s      33.837ms       0.000us         0.00%        2.189s      57.618ms            38  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.862s         1.24%        1.862s     400.208us          4652  
                                       aten::logical_or         0.08%     125.659ms         0.24%     380.525ms      33.032us     919.406ms         0.61%        1.839s     159.619us         11520  
                                                _Linear         0.94%        1.508s         1.65%        2.648s     689.557us      66.614ms         0.04%        1.807s     470.475us          3840  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      21.169ms         0.13%     213.499ms     111.198us       0.000us         0.00%        1.775s     924.364us          1920  
                                           BmmBackward0         0.01%      13.328ms         0.12%     192.331ms     100.172us       0.000us         0.00%        1.775s     924.364us          1920  
                                              aten::sub         0.07%     116.483ms         0.09%     150.738ms      22.943us        1.612s         1.07%        1.612s     245.400us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.610s         1.07%        1.610s     613.785us          2623  
autograd::engine::evaluate_function: _LinearBackward...         0.03%      41.458ms         1.24%        1.990s     518.213us       0.000us         0.00%        1.600s     416.558us          3840  
                                        _LinearBackward         0.85%        1.367s         1.21%        1.948s     507.417us      75.930ms         0.05%        1.600s     416.558us          3840  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.539s         1.03%        1.539s     801.691us          1920  
                                          aten::dropout         0.01%      11.387ms         0.07%     117.911ms      19.603us       0.000us         0.00%        1.449s     240.933us          6015  
                                   aten::native_dropout         0.03%      43.548ms         0.06%     101.689ms      50.617us        1.449s         0.97%        1.449s     721.348us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.449s         0.97%        1.449s     724.461us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      11.078ms         0.04%      64.729ms      32.316us       0.000us         0.00%        1.382s     690.168us          2003  
                                 NativeDropoutBackward0         0.00%       6.482ms         0.03%      53.651ms      26.785us       0.000us         0.00%        1.382s     690.168us          2003  
                          aten::native_dropout_backward         0.01%      18.790ms         0.03%      47.169ms      23.549us        1.382s         0.92%        1.382s     690.168us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.382s         0.92%        1.382s     691.203us          2000  
                                   hipDeviceGetPCIBusId         0.01%      11.144ms         0.01%      11.144ms       0.717us        1.373s         0.92%        1.373s      88.354us         15539  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.372s         0.91%        1.372s      78.477us         17489  
                                   hipStreamIsCapturing         0.04%      58.735ms         0.04%      58.737ms       1.131us        1.215s         0.81%        1.215s      23.396us         51919  
                                          aten::baddbmm         0.26%     424.128ms         0.48%     777.660ms     135.010us        1.173s         0.78%        1.173s     203.651us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.124s         0.75%        1.124s     585.264us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.02%      25.775ms         0.68%        1.098s     285.963us       0.000us         0.00%     981.846ms     255.689us          3840  
                               CompiledFunctionBackward         0.33%     536.458ms         0.67%        1.072s     279.251us       0.000us         0.00%     981.846ms     255.689us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     919.406ms         0.61%     919.406ms     350.517us          2623  
                                 triton_red_fused_sum_1         0.02%      38.338ms         0.04%      62.717ms      16.333us     888.342ms         0.59%     888.342ms     231.339us          3840  
                                       c10d::broadcast_         0.02%      36.444ms         0.51%     820.434ms       1.706ms       0.000us         0.00%     681.770ms       1.417ms           481  
                                      aten::logical_not         0.10%     166.473ms         0.31%     495.946ms      21.525us     318.856ms         0.21%     637.720ms      27.679us         23040  
                                        hipEventDestroy         0.03%      49.977ms         0.03%      50.424ms       2.479us     563.103ms         0.38%     563.647ms      27.713us         20339  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.473ms         0.00%       2.473ms       0.173us     536.446ms         0.36%     536.446ms      37.566us         14280  
                                  hipExtMallocWithFlags         0.03%      48.550ms         0.03%      48.550ms      11.317us     481.197ms         0.32%     481.197ms     112.167us          4290  
                                  Torch-Compiled Region         0.64%        1.035s         1.91%        3.060s     159.217us       0.000us         0.00%     431.652ms      22.458us         19220  
                                      hipGetProcAddress         0.05%      79.078ms         0.05%      79.080ms       1.148us     393.992ms         0.26%     393.992ms       5.721us         68866  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     318.856ms         0.21%     318.856ms      60.781us          5246  
                                       hipCtxGetCurrent         0.01%      10.753ms         0.01%      10.753ms       0.214us     315.093ms         0.21%     315.093ms       6.276us         50206  
                                             aten::add_         0.11%     173.956ms         0.20%     318.448ms      10.135us     301.811ms         0.20%     301.811ms       9.606us         31420  
                                       _LayerNormLinear         0.45%     721.685ms         1.27%        2.032s     529.041us     171.039ms         0.11%     296.324ms      77.168us          3840  
                                         hipMemsetAsync         0.08%     124.421ms         0.08%     124.449ms      10.311us     293.955ms         0.20%     294.701ms      24.416us         12070  
                                       CompiledFunction         0.76%        1.215s         1.10%        1.769s     153.251us       0.000us         0.00%     290.078ms      25.137us         11540  
                                              aten::sum         0.26%     415.536ms         0.55%     880.757ms      43.274us     209.287ms         0.14%     272.124ms      13.370us         20353  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     255.380ms         0.17%     255.380ms      66.505us          3840  
                  triton_poi_fused_add_native_dropout_0         0.06%      96.939ms         0.09%     144.304ms      37.482us     216.779ms         0.14%     216.779ms      56.306us          3850  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     198.736ms         0.13%     198.736ms      37.876us          5247  
autograd::engine::evaluate_function: torch::autograd...         0.22%     358.633ms         0.43%     694.280ms      28.737us       0.000us         0.00%     162.392ms       6.722us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     160.879ms         0.11%     160.879ms       6.726us         23920  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     160.867ms         0.11%     160.867ms     160.867ms             1  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     155.618ms         0.10%     155.618ms      29.664us          5246  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.02%      27.605ms         0.46%     743.418ms     387.197us       0.000us         0.00%     148.683ms      77.439us          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     148.492ms         0.10%     148.492ms      33.294us          4460  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     142.472ms         0.09%     142.472ms     644.669us           221  
                             _VocabParallelCrossEntropy         0.05%      78.994ms         0.18%     287.044ms       1.196ms       0.000us         0.00%     137.722ms     573.842us           240  
                                              aten::cat         0.11%     169.096ms         0.14%     221.956ms      27.470us     130.946ms         0.09%     132.567ms      16.407us          8080  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     125.633ms         0.08%     125.633ms      32.049us          3920  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.397ms        22.71%       36.464s     151.935ms       0.000us         0.00%     121.622ms     506.757us           240  
                                     EmbeddingBackward0         0.00%       2.740ms        22.70%       36.457s     151.903ms       0.000us         0.00%     120.769ms     503.205us           240  
                               aten::embedding_backward         0.00%       2.579ms        22.70%       36.454s     151.891ms       0.000us         0.00%     120.769ms     503.205us           240  
                         aten::embedding_dense_backward         1.47%        2.362s        22.70%       36.451s     151.881ms     115.404ms         0.08%     120.769ms     503.205us           240  
                             c10d::allreduce_coalesced_         0.00%       1.547ms         0.06%     101.897ms      10.190ms       0.000us         0.00%     116.460ms      11.646ms            10  
                                         hipMemcpyAsync         0.13%     208.578ms         0.13%     208.585ms      16.975us     115.344ms         0.08%     115.361ms       9.388us         12288  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      17.191ms         0.15%     237.742ms     123.824us       0.000us         0.00%     113.578ms      59.155us          1920  
                                 _SplitAlongDimBackward         0.10%     166.674ms         0.14%     220.551ms     114.871us       0.000us         0.00%     113.578ms      59.155us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     113.578ms         0.08%     113.578ms      59.155us          1920  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     108.829ms         0.07%     108.829ms      50.384us          2160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     106.036ms         0.07%     106.036ms      10.001us         10603  
                                       aten::contiguous         0.02%      31.725ms         0.36%     571.009ms      24.783us       0.000us         0.00%     105.439ms       4.576us         23040  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     103.268ms         0.07%     103.268ms      17.928us          5760  
                         _ReduceFromModelParallelRegion         0.01%      22.085ms         0.04%      65.617ms     273.406us       0.000us         0.00%     100.320ms     417.999us           240  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.465ms         0.07%     111.090ms       1.389ms       0.000us         0.00%      99.453ms       1.243ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      17.784ms         0.07%     109.625ms       1.370ms       0.000us         0.00%      99.453ms       1.243ms            80  
                                               aten::mm         0.03%      51.032ms         0.06%     104.152ms     118.355us      98.130ms         0.07%      98.130ms     111.512us           880  
                                           GeLUFunction         0.12%     185.654ms         0.67%        1.070s     185.848us       0.000us         0.00%      96.892ms      16.821us          5760  
             triton_poi_fused_native_dropout_backward_0         0.04%      69.742ms         0.06%     104.222ms      27.141us      93.504ms         0.06%      93.504ms      24.350us          3840  
                        triton_poi_fused_add_mul_tanh_0         0.09%     138.777ms         0.10%     164.388ms      28.490us      91.454ms         0.06%      91.454ms      15.850us          5770  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      86.908ms         0.06%      86.908ms      33.133us          2623  
                                           aten::matmul         0.00%       3.166ms         0.05%      80.658ms     201.645us       0.000us         0.00%      81.821ms     204.553us           400  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us      80.575ms         0.05%      80.575ms      15.543us          5184  
                                   hipStreamSynchronize         0.45%     723.627ms         0.45%     723.722ms     222.752us      80.134ms         0.05%      80.153ms      24.670us          3249  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      78.337ms         0.05%      78.337ms       9.955us          7869  
                                           aten::arange         0.09%     147.882ms         0.27%     431.865ms      17.527us      34.233ms         0.02%      75.976ms       3.083us         24640  
                                    hipIpcOpenMemHandle         0.05%      87.422ms         0.05%      87.422ms      48.703us      74.741ms         0.05%      74.741ms      41.638us          1795  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      72.273ms         0.05%      72.273ms      27.543us          2624  
                               hipStreamCreateWithFlags         0.19%     298.573ms         0.19%     298.573ms     110.012us      71.004ms         0.05%      71.004ms      26.162us          2714  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      65.974ms         0.04%      65.974ms     274.890us           240  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      63.883ms         0.04%      63.883ms      16.297us          3920  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      63.752ms         0.04%      63.752ms      14.582us          4372  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      63.292ms         0.04%      63.292ms       5.253us         12048  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.24%     383.936ms         0.42%     674.462ms      87.821us      61.634ms         0.04%      63.186ms       8.227us          7680  
                                 hipDeviceCanAccessPeer         0.00%     376.589us         0.00%     376.589us       0.187us      58.251ms         0.04%      58.251ms      28.952us          2012  
                                  hipModuleLaunchKernel         0.16%     252.162ms         0.16%     252.184ms       7.368us      52.035ms         0.03%      52.035ms       1.520us         34229  
                                       hipStreamDestroy         0.04%      63.599ms         0.04%      63.599ms      23.608us      49.835ms         0.03%      49.835ms      18.498us          2694  
        LinearWithGradAccumulationAndAsyncCommunication         0.01%       8.608ms         0.02%      28.821ms     120.089us       0.000us         0.00%      49.337ms     205.569us           240  
                                     hipIpcGetMemHandle         0.01%      11.869ms         0.01%      11.869ms       6.635us      49.328ms         0.03%      49.328ms      27.573us          1789  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      46.514ms         0.03%      46.514ms      12.113us          3840  
                                 triton_poi_fused_add_0         0.15%     237.486ms         0.16%     254.060ms      33.081us      40.784ms         0.03%      42.908ms       5.587us          7680  
                                   GeLUFunctionBackward         0.04%      56.514ms         0.39%     632.353ms     329.351us       0.000us         0.00%      41.628ms      21.681us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      32.889ms         0.03%      50.429ms      26.265us      41.628ms         0.03%      41.628ms      21.681us          1920  
                                    hipMemcpyWithStream        25.92%       41.622s        25.92%       41.626s      51.967ms       0.000us         0.00%      40.074ms      50.030us           801  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      36.574ms         0.02%      36.574ms      19.049us          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      32.277ms         0.02%      32.277ms       6.153us          5246  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      31.692ms         0.02%      31.692ms       6.041us          5246  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      29.393ms         0.02%      29.393ms      11.206us          2623  
                                            aten::fill_         0.09%     145.415ms         0.11%     176.461ms       6.102us      29.035ms         0.02%      29.035ms       1.004us         28919  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      27.291ms         0.02%      27.291ms     170.571us           160  
                                            aten::zero_         0.05%      79.461ms         0.15%     245.502ms      10.841us       0.000us         0.00%      27.163ms       1.199us         22646  
                                            aten::zeros         0.05%      85.540ms         0.23%     376.052ms      16.784us       0.000us         0.00%      26.406ms       1.179us         22406  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.087ms         0.03%      42.910ms     536.378us       0.000us         0.00%      26.011ms     325.133us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      25.570ms         0.02%      25.570ms       6.659us          3840  
                                              aten::exp         0.00%       2.884ms         0.01%      16.856ms      70.232us      23.721ms         0.02%      23.721ms      98.838us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.721ms         0.02%      23.721ms     217.625us           109  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      23.134ms         0.02%      23.134ms     289.177us            80  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.533ms         0.03%      46.243ms     192.681us       0.000us         0.00%      22.976ms      95.732us           240  
                                          aten::randint         0.03%      41.257ms         0.10%     154.392ms      40.060us       0.000us         0.00%      22.559ms       5.853us          3854  
                                          aten::random_         0.04%      65.838ms         0.07%     110.209ms      28.626us      21.324ms         0.01%      22.559ms       5.859us          3850  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      21.638ms         0.01%      21.638ms      99.259us           218  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      21.324ms         0.01%      21.324ms       5.539us          3850  
                                              aten::add         0.04%      66.667ms         0.06%      92.408ms      51.740us      21.039ms         0.01%      21.039ms      11.780us          1786  
                                             aten::div_         0.00%       6.360ms         0.01%      12.020ms      25.041us      20.460ms         0.01%      20.460ms      42.624us           480  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.810ms         0.01%      19.810ms     181.742us           109  
                                           aten::linear         0.00%       3.845ms         0.04%      63.715ms      88.493us       0.000us         0.00%      19.491ms      27.071us           720  
                                            aten::addmm         0.03%      45.663ms         0.03%      53.651ms      74.515us      19.491ms         0.01%      19.491ms      27.071us           720  
                                             aten::sub_         0.00%       4.747ms         0.00%       6.148ms      19.214us      18.629ms         0.01%      18.629ms      58.217us           320  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      18.368ms         0.01%      18.368ms      28.566us           643  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      18.133ms         0.01%      18.133ms     166.356us           109  
                                 tex_ts::cast_to_fp8_ts         0.09%     145.833ms         0.14%     222.214ms      28.934us      17.566ms         0.01%      17.572ms       2.288us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      17.566ms         0.01%      17.566ms      12.493us          1406  
                                     hipStreamWaitEvent         0.20%     327.163ms         0.20%     327.202ms      15.562us      17.466ms         0.01%      17.466ms       0.831us         21026  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      17.368ms         0.01%      17.368ms       6.005us          2892  
                                           aten::cumsum         0.08%     125.199ms         0.10%     157.926ms      27.418us      16.247ms         0.01%      16.768ms       2.911us          5760  
                                        aten::embedding         0.00%       6.949ms         0.02%      30.392ms      42.211us       0.000us         0.00%      16.483ms      22.893us           720  
                                     aten::index_select         0.01%      12.911ms         0.01%      20.515ms      28.494us      16.483ms         0.01%      16.483ms      22.893us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.483ms         0.01%      16.483ms      49.948us           330  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      16.325ms         0.01%      16.325ms       6.191us          2637  
                                         AddmmBackward0         0.00%       2.734ms         0.02%      35.488ms     147.867us       0.000us         0.00%      16.309ms      67.954us           240  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      16.301ms         0.01%      16.301ms       6.215us          2623  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      16.247ms         0.01%      16.247ms       6.194us          2623  
                     _VocabParallelCrossEntropyBackward         0.01%      15.011ms         0.02%      37.662ms     470.771us       0.000us         0.00%      15.797ms     197.458us            80  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      13.040ms         0.01%      13.040ms     119.631us           109  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.768ms         0.01%      12.768ms      79.800us           160  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      12.689ms         0.01%      12.689ms       6.609us          1920  
                                             aten::mul_         0.00%       6.346ms         0.00%       7.141ms       5.579us      12.280ms         0.01%      12.280ms       9.594us          1280  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      11.997ms         0.01%      11.997ms     110.067us           109  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.508ms         0.01%      11.508ms     105.575us           109  
                                              aten::max         0.00%       7.175ms         0.02%      35.294ms     138.951us       8.877ms         0.01%      10.685ms      42.066us           254  
                                            aten::index         0.01%      13.041ms         0.04%      61.490ms     108.448us       1.986ms         0.00%      10.136ms      17.877us           567  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.606ms         0.01%       9.606ms      40.025us           240  
                                       aten::index_put_         0.00%       5.687ms         0.12%     194.515ms     173.674us       0.000us         0.00%       9.255ms       8.264us          1120  
                                 aten::_index_put_impl_         0.00%       7.836ms         0.12%     188.808ms     168.579us     762.516us         0.00%       9.255ms       8.264us          1120  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       9.025ms         0.01%       9.025ms      37.603us           240  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.863ms         0.01%       8.863ms      81.311us           109  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.541ms         0.01%       8.541ms      20.003us           427  
                                        hipLaunchKernel         0.89%        1.433s         0.89%        1.434s       9.189us     355.988us         0.00%       8.327ms       0.053us        156013  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.185ms         0.01%      12.379ms     154.741us       0.000us         0.00%       8.208ms     102.601us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.257ms         0.01%      10.194ms     127.422us       8.208ms         0.01%       8.208ms     102.601us            80  
                                          aten::nonzero         0.00%       6.102ms         0.02%      34.509ms     140.851us       8.150ms         0.01%       8.150ms      33.267us           245  
                           FusedLayerNormAffineFunction         0.01%      12.217ms         0.01%      20.530ms      85.541us       7.987ms         0.01%       7.987ms      33.278us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.987ms         0.01%       7.987ms      73.273us           109  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.242ms         0.02%      26.927ms     336.591us       0.000us         0.00%       7.963ms      99.537us            80  
                            torch::autograd::CopySlices         0.00%       4.087ms         0.02%      24.686ms     308.569us       0.000us         0.00%       7.963ms      99.537us            80  
                                  hipMemGetAddressRange         0.00%     211.096us         0.00%     211.096us       0.470us       7.513ms         0.01%       7.513ms      16.733us           449  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.204ms         0.00%       7.204ms      10.501us           686  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.481ms         0.00%       6.481ms      81.009us            80  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     609.373us         0.00%       2.807ms     280.720us       6.195ms         0.00%       6.195ms     619.466us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.195ms         0.00%       6.195ms      56.315us           110  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       5.979ms         0.00%       5.979ms      24.913us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.507ms         0.00%       5.507ms       6.099us           903  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       5.009ms         0.00%       5.009ms       5.218us           960  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       4.789ms         0.00%       4.789ms      29.932us           160  
                            hipGetDevicePropertiesR0600         0.07%     105.061ms         0.07%     105.061ms       1.128us       4.264ms         0.00%       4.264ms       0.046us         93161  
                                        aten::index_put         0.00%       1.495ms         0.01%      10.172ms     122.555us       0.000us         0.00%       4.199ms      50.592us            83  
                                      IndexPutBackward0         0.00%       1.042ms         0.01%      10.671ms     133.394us       0.000us         0.00%       4.199ms      52.489us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       3.929ms         0.00%       3.929ms      49.109us            80  
                                     hipExtLaunchKernel         0.07%     114.134ms         0.07%     114.158ms      11.338us       0.000us         0.00%       3.778ms       0.375us         10069  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       3.771ms         0.00%       3.771ms      47.138us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     961.356us         0.01%      21.461ms     268.266us       0.000us         0.00%       3.580ms      44.754us            80  
                                     _LayerNormBackward         0.00%       5.095ms         0.01%      20.500ms     256.249us       3.580ms         0.00%       3.580ms      44.754us            80  
                                              hipMemcpy         0.01%      11.936ms         0.01%      11.936ms     248.662us       3.282ms         0.00%       3.282ms      68.382us            48  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     653.097us         0.00%       2.890ms      36.128us       0.000us         0.00%       3.190ms      39.879us            80  
                                          GeluBackward0         0.00%     435.791us         0.00%       2.237ms      27.965us       0.000us         0.00%       3.190ms      39.879us            80  
                                    aten::gelu_backward         0.00%       1.149ms         0.00%       1.801ms      22.517us       3.190ms         0.00%       3.190ms      39.879us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.190ms         0.00%       3.190ms      39.879us            80  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     672.631us         0.00%       4.386ms      54.820us       0.000us         0.00%       3.016ms      37.704us            80  
                                             aten::ones         0.00%     921.589us         0.00%       5.908ms      12.309us       0.000us         0.00%       2.954ms       6.154us           480  
                                 c10d::_allgather_base_         0.00%     234.546us         0.00%       1.539ms     109.894us       0.000us         0.00%       2.784ms     198.829us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       2.784ms         0.00%       2.784ms     231.967us            12  
                                             aten::gelu         0.00%       3.882ms         0.01%       8.544ms      35.598us       2.619ms         0.00%       2.619ms      10.912us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.619ms         0.00%       2.619ms      24.026us           109  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.541ms         0.00%       2.541ms       4.715us           539  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.315ms         0.00%       2.315ms       5.285us           438  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.296ms         0.00%       2.296ms      21.067us           109  
         _compile.<locals>.compile_inner (dynamo_timed)         0.07%     111.718ms         1.62%        2.607s     260.741ms       0.000us         0.00%       2.267ms     226.700us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.129ms         0.00%       2.129ms       5.431us           392  
                                              aten::div         0.01%       9.877ms         0.01%      13.012ms      19.597us       2.002ms         0.00%       2.118ms       3.189us           664  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.986ms         0.00%       1.986ms      10.344us           192  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     536.309us         0.00%       6.977ms      43.605us       0.000us         0.00%       1.920ms      12.003us           160  
                                         SliceBackward0         0.00%     429.938us         0.00%       6.440ms      40.253us       0.000us         0.00%       1.920ms      12.003us           160  
                                   aten::slice_backward         0.00%     867.811us         0.00%       6.010ms      37.566us       0.000us         0.00%       1.920ms      12.003us           160  
                               hipExtModuleLaunchKernel         0.19%     304.866ms         0.19%     304.910ms       7.621us       0.000us         0.00%       1.824ms       0.046us         40010  
                                          aten::maximum         0.00%     203.878us         0.01%      23.247ms       2.583ms      24.898us         0.00%       1.808ms     200.895us             9  
                               aten::cross_entropy_loss         0.00%       1.628ms         0.01%      19.189ms      79.956us       0.000us         0.00%       1.764ms       7.348us           240  
                                               aten::lt         0.01%      18.821ms         0.01%      21.914ms      30.436us       1.748ms         0.00%       1.748ms       2.427us           720  
                                             _LayerNorm         0.00%       6.232ms         0.01%      11.028ms     137.855us       1.725ms         0.00%       1.725ms      21.559us            80  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      26.640ms         1.53%        2.459s     245.926ms       0.000us         0.00%       1.652ms     165.238us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.27%     435.510ms         1.51%        2.433s     243.262ms       0.000us         0.00%       1.652ms     165.238us            10  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.647ms         0.00%       1.647ms      15.113us           109  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.607ms         0.00%       1.607ms       6.696us           240  
                                  hipDeviceGetAttribute         0.00%     289.749us         0.00%     289.749us       4.325us       1.595ms         0.00%       1.595ms      23.803us            67  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.523ms         0.00%       1.523ms       4.788us           318  
      autograd::engine::evaluate_function: MulBackward0         0.01%       8.754ms         0.03%      42.056ms     244.509us       0.000us         0.00%       1.463ms       8.505us           172  
                                          aten::reshape         0.08%     121.374ms         0.13%     214.455ms       4.964us       0.000us         0.00%       1.413ms       0.033us         43206  
                                              aten::all         0.05%      85.811ms         0.06%      97.196ms      16.595us       0.000us         0.00%       1.397ms       0.238us          5857  
                                        SelectBackward0         0.00%     215.938us         0.00%       2.795ms      34.932us       0.000us         0.00%       1.378ms      17.227us            80  
                                  aten::select_backward         0.00%     417.193us         0.00%       2.579ms      32.233us       0.000us         0.00%       1.378ms      17.227us            80  
                                               aten::eq         0.03%      44.522ms         0.03%      44.527ms       7.602us       0.000us         0.00%       1.367ms       0.233us          5857  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.129ms         0.00%       1.129ms       5.975us           189  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.126ms         0.00%       1.126ms       5.143us           219  
                                      aten::log_softmax         0.00%       1.231ms         0.00%       6.608ms      27.533us       0.000us         0.00%       1.125ms       4.688us           240  
                                     aten::_log_softmax         0.00%       4.041ms         0.00%       5.235ms      21.811us     662.883us         0.00%       1.125ms       4.688us           240  
                                               aten::ge         0.00%       7.175ms         0.01%       8.391ms      17.482us       1.121ms         0.00%       1.121ms       2.335us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.096ms         0.00%       1.096ms       5.004us           219  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.094ms         0.00%       1.094ms       2.265us           483  
                                           aten::__or__         0.00%       1.334ms         0.01%      22.352ms      46.567us       0.000us         0.00%       1.094ms       2.279us           480  
                                       aten::bitwise_or         0.01%       8.454ms         0.01%      21.018ms      43.788us       1.094ms         0.00%       1.094ms       2.279us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.094ms         0.00%       1.094ms       4.995us           219  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.066ms         0.00%       1.066ms      13.324us            80  
                                            aten::slice         0.06%     102.597ms         0.08%     120.950ms       4.631us       0.000us         0.00%       1.022ms       0.039us         26118  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us     980.664us         0.00%     980.664us       6.129us           160  
                                           MulBackward0         0.00%       6.187ms         0.02%      24.579ms     142.903us       0.000us         0.00%     970.475us       5.642us           172  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.286ms         0.00%       7.470ms      93.381us       0.000us         0.00%     968.593us      12.107us            80  
                                       NllLossBackward0         0.00%     774.976us         0.00%       6.184ms      77.304us       0.000us         0.00%     968.593us      12.107us            80  
                                aten::nll_loss_backward         0.00%       2.024ms         0.00%       5.409ms      67.617us     479.503us         0.00%     968.593us      12.107us            80  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.536ms         0.00%       6.935ms      43.347us       0.000us         0.00%     960.005us       6.000us           160  
                                           DivBackward0         0.00%       1.171ms         0.00%       5.400ms      33.747us       0.000us         0.00%     960.005us       6.000us           160  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     867.596us         0.00%     867.596us       7.960us           109  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     762.516us         0.00%     762.516us       9.531us            80  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     740.909us         0.00%     740.909us       3.087us           240  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     735.941us         0.00%     735.941us       3.066us           240  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     708.226us         0.00%     708.226us       8.853us            80  
                                             aten::tanh         0.01%      12.307ms         0.01%      20.734ms      76.509us     697.000us         0.00%     697.000us       2.572us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     697.000us         0.00%     697.000us       6.394us           109  
                                              hipMalloc         0.01%      15.885ms         0.01%      15.907ms      96.993us     605.594us         0.00%     679.885us       4.146us           164  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     678.040us         0.00%     678.040us       6.221us           109  
                                             aten::item         0.02%      28.421ms         0.49%     789.991ms      47.026us       0.000us         0.00%     668.128us       0.040us         16799  
                              aten::_local_scalar_dense         0.01%      13.969ms         0.47%     761.571ms      45.334us     668.128us         0.00%     668.128us       0.040us         16799  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     662.883us         0.00%     662.883us       6.081us           109  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     661.722us         0.00%     661.722us       8.272us            80  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     645.649us         0.00%     645.649us       8.071us            80  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     642.238us         0.00%     642.238us       2.643us           243  
                                      aten::nll_loss_nd         0.00%     882.493us         0.01%      10.954ms      45.641us       0.000us         0.00%     638.511us       2.660us           240  
                                         aten::nll_loss         0.00%     871.004us         0.01%      10.071ms      41.964us       0.000us         0.00%     638.511us       2.660us           240  
                                 aten::nll_loss_forward         0.00%       4.832ms         0.01%       9.200ms      38.335us     638.511us         0.00%     638.511us       2.660us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     638.511us         0.00%     638.511us       5.858us           109  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     627.887us         0.00%     627.887us       5.760us           109  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       6.433ms         0.01%      12.607ms      78.793us     571.565us         0.00%     571.565us       3.572us           160  
                                          aten::normal_         0.67%        1.077s         0.67%        1.078s      10.369ms     568.307us         0.00%     568.307us       5.464us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     568.307us         0.00%     568.307us       5.859us            97  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      14.018ms         1.06%        1.704s     170.416ms       0.000us         0.00%     566.002us      56.600us            10  
                        compile_fx_inner (dynamo_timed)         0.04%      63.733ms         1.28%        2.058s     187.105ms       0.000us         0.00%     566.002us      51.455us            11  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     553.798us         0.00%     553.798us       5.035us           110  
                                               aten::gt         0.02%      35.746ms         0.03%      41.824ms       9.635us     551.346us         0.00%     551.346us       0.127us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     548.820us         0.00%     548.820us       2.268us           242  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     508.371us         0.00%     508.371us       6.355us            80  
                                             aten::rsub         0.00%       2.956ms         0.01%       8.852ms     102.931us       0.000us         0.00%     499.351us       5.806us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     499.351us         0.00%     499.351us       6.242us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     489.370us         0.00%     489.370us       6.117us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     485.961us         0.00%     485.961us       6.075us            80  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     484.805us         0.00%     484.805us       1.995us           243  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     479.503us         0.00%     479.503us       5.994us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%     985.616us         0.01%      19.728ms     240.583us       0.000us         0.00%     478.866us       5.840us            82  
                                          TanhBackward0         0.00%       1.630ms         0.01%      18.742ms     228.563us       0.000us         0.00%     478.866us       5.840us            82  
                                    aten::tanh_backward         0.00%       2.363ms         0.01%      15.177ms     185.085us     478.866us         0.00%     478.866us       5.840us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     478.866us         0.00%     478.866us       5.986us            80  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     647.903us         0.00%       4.346ms      54.325us       0.000us         0.00%     478.179us       5.977us            80  
                                    LogSoftmaxBackward0         0.00%       1.182ms         0.00%       3.698ms      46.226us       0.000us         0.00%     478.179us       5.977us            80  
                       aten::_log_softmax_backward_data         0.00%       1.436ms         0.00%       2.516ms      31.445us     478.179us         0.00%     478.179us       5.977us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     478.179us         0.00%     478.179us       5.977us            80  
                                        aten::ones_like         0.00%     637.323us         0.00%       2.562ms      32.025us       0.000us         0.00%     471.522us       5.894us            80  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     464.831us         0.00%     464.831us       1.913us           243  
                                             aten::view         0.21%     337.765ms         0.21%     343.673ms       2.376us       0.000us         0.00%     462.084us       0.003us        144633  
                                       aten::empty_like         0.13%     210.583ms         0.38%     608.553ms       6.843us       0.000us         0.00%     429.469us       0.005us         88930  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     417.685us         0.00%     417.685us       1.740us           240  
                                            aten::empty         0.60%     964.554ms         0.60%     969.003ms       3.691us       0.000us         0.00%     410.906us       0.002us        262555  
                                   hipDeviceSynchronize         0.00%     569.528us         0.00%     569.528us      16.751us     408.872us         0.00%     408.872us      12.026us            34  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     407.305us         0.00%     407.305us       1.697us           240  
                                              aten::log         0.00%       3.728ms         0.01%       8.068ms      33.617us     390.530us         0.00%     390.530us       1.627us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     390.530us         0.00%     390.530us       3.583us           109  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     294.751us         0.00%     294.751us       3.684us            80  
                                         _SplitAlongDim         0.10%     161.371ms         0.15%     234.366ms      40.689us       0.000us         0.00%     293.676us       0.051us          5760  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     292.871us         0.00%     292.871us       1.830us           160  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     208.720us         0.00%     208.720us       2.220us            94  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     202.952us         0.00%     202.952us       3.499us            58  
         GraphLowering.compile_to_module (dynamo_timed)         0.58%     924.100ms         1.11%        1.788s     162.505ms       0.000us         0.00%     184.244us      16.749us            11  
                                                hipFree         0.07%     108.189ms         0.07%     108.234ms       6.013ms      28.624us         0.00%     167.995us       9.333us            18  
                                             aten::rand         0.00%       1.730ms         0.00%       4.267ms     304.769us       0.000us         0.00%     148.773us      10.627us            14  
                                         aten::uniform_         0.01%       8.938ms         0.01%      10.487ms     806.709us     148.773us         0.00%     148.773us      11.444us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     148.773us         0.00%     148.773us      29.755us             5  
                            hipGetDevicePropertiesR0000         0.00%      46.594us         0.00%      46.594us       4.659us     118.492us         0.00%     118.492us      11.849us            10  
                                       aten::lift_fresh         0.03%      45.749ms         0.03%      50.994ms      28.876us       0.000us         0.00%      47.553us       0.027us          1766  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      35.841us         0.00%      35.841us       3.584us            10  
                       Scheduler.codegen (dynamo_timed)         0.07%     113.282ms         0.07%     113.303ms      10.300ms       0.000us         0.00%      34.639us       3.149us            11  
                                          hipHostMalloc         0.08%     134.498ms         0.08%     134.512ms       4.076ms      34.359us         0.00%      34.359us       1.041us            33  
                                        aten::transpose         0.18%     292.846ms         0.23%     362.227ms       3.802us       0.000us         0.00%      34.279us       0.000us         95285  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      24.898us         0.00%      24.898us       2.766us             9  
                                       aten::reciprocal         0.00%     153.909us         0.01%      11.928ms       1.193ms      21.609us         0.00%      21.609us       2.161us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      21.609us         0.00%      21.609us       2.161us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      21.250us         0.00%      21.250us       2.125us            10  
                                              aten::min         0.00%     100.145us         0.00%       3.378ms     675.526us      15.996us         0.00%      15.996us       3.199us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.996us         0.00%      15.996us       5.332us             3  
                                           aten::select         0.25%     394.001ms         0.30%     478.688ms       4.890us       0.000us         0.00%      14.434us       0.000us         97887  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.673us         0.00%      13.673us       4.558us             3  
                                    hipFuncSetAttribute         0.00%      10.065us         0.00%      10.065us       0.419us       9.382us         0.00%       9.382us       0.391us            24  
                                        aten::unsqueeze         0.02%      33.923ms         0.03%      41.367ms       5.620us       0.000us         0.00%       7.217us       0.001us          7360  
                                    hipModuleLoadDataEx         0.38%     611.649ms         0.38%     611.649ms      50.971ms       7.137us         0.00%       7.137us       0.595us            12  
                                   hipFuncGetAttributes         0.13%     209.453ms         0.13%     209.453ms       1.587ms       6.775us         0.00%       6.775us       0.051us           132  
                               TorchDynamo Cache Lookup         0.13%     209.885ms         0.13%     209.904ms      10.921us       0.000us         0.00%       6.294us       0.000us         19221  
                                          aten::permute         0.02%      39.434ms         0.03%      47.182ms       5.898us       0.000us         0.00%       6.174us       0.001us          8000  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.526us         0.00%       2.526us       2.526us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.125us         0.00%       2.125us       2.125us             1  
                        hipDeviceGetStreamPriorityRange         0.00%       1.628us         0.00%       1.628us       1.628us       0.000us         0.00%       0.000us       0.000us             1  
                            hipStreamCreateWithPriority         0.00%     557.356us         0.00%     557.356us      92.893us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.232s      73.127us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      14.246ms         0.01%      14.246ms       1.415us       0.000us         0.00%       0.000us       0.000us         10071  
                                    aten::empty_strided         0.23%     369.155ms         0.23%     376.366ms       4.246us       0.000us         0.00%       0.000us       0.000us         88647  
                                           aten::detach         0.04%      65.643ms         0.12%     195.082ms       5.499us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.07%     106.343ms         0.08%     124.396ms       3.678us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.00%       6.983ms         0.01%      12.575ms     101.411us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.05%      75.288ms         0.06%     100.377ms       2.771us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     242.869us         0.00%     324.580us      40.573us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.17%     267.541ms         0.17%     267.793ms       0.796us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%     897.097us         0.00%       1.306ms      68.730us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     413.443us         0.00%     831.918us      19.808us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     623.958us         0.00%     860.535us      61.467us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%      84.588us         0.00%     116.772us      58.386us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       2.715ms         0.00%       5.577ms     146.769us       0.000us         0.00%       0.000us       0.000us            38  
                                         prims::view_of         0.00%     408.887us         0.00%     521.142us      21.714us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       5.090ms         0.00%       5.187ms       5.408us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       6.631ms         0.00%       7.633ms       9.459us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%     999.956us         0.00%     999.956us       1.239us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     298.202us         0.00%     298.202us       9.619us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%      96.867us         0.00%      96.867us       8.806us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%       9.840ms         0.01%      21.539ms      84.138us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     626.447us         0.00%     626.447us       2.447us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     200.016us         0.00%     275.598us      91.866us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%      88.521us         0.00%      88.521us      44.260us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     112.591us         0.00%     121.409us      60.704us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      28.483us         0.00%      28.483us       2.035us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%     994.292us         0.00%       1.977ms     395.377us       0.000us         0.00%       0.000us       0.000us             5  
                                        aten::index_add         0.00%     197.898us         0.00%       1.130ms       1.130ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     361.183us         0.00%     407.561us     203.780us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     180.016us         0.00%     180.016us     180.016us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.10%     164.676ms         0.10%     166.987ms      15.181ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.09%     139.540ms         0.09%     139.565ms      12.688ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.00%       7.512ms         0.00%       7.512ms     682.933us       0.000us         0.00%       0.000us       0.000us            11  
                                    hipFuncGetAttribute         0.00%       3.849us         0.00%       3.849us       0.321us       0.000us         0.00%       0.000us       0.000us            12  
                                 hipPointerGetAttribute         0.03%      53.993ms         0.03%      53.993ms       0.848us       0.000us         0.00%       0.000us       0.000us         63635  
                                        aten::expand_as         0.00%     999.674us         0.00%       3.326ms       6.126us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.198ms         0.00%       4.318ms     392.568us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     102.014us         0.00%     113.462us      56.731us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     124.255us         0.00%     124.255us      62.128us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      60.818us         0.00%      74.783us      74.783us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     251.837us         0.00%       2.214ms     738.161us       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     259.441us         0.00%     288.314us      96.105us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%     940.004us         0.00%       2.994ms     498.970us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%     627.403us         0.00%       3.098ms     344.259us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%     925.797us         0.00%       2.063ms     343.757us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     251.500us         0.00%     662.077us     220.692us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     172.027us         0.00%     848.497us     282.832us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     361.172us         0.00%     676.470us     225.490us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     301.917us         0.00%     315.621us      78.905us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.08%     120.583ms         0.08%     120.898ms       3.489us       0.000us         0.00%       0.000us       0.000us         34655  
                aten::_has_compatible_shallow_copy_type         0.00%       4.071ms         0.00%       4.071ms       0.166us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     805.936us      57.567us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.692ms         0.01%      13.516ms       6.020us       0.000us         0.00%       0.000us       0.000us          2245  
                                         nccl:broadcast         0.00%       0.000us             0      64.340ms     133.764us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.01%       8.280ms         0.01%      18.696ms       4.582us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.01%       8.119ms         0.02%      28.436ms      10.771us       0.000us         0.00%       0.000us       0.000us          2640  
                                          aten::view_as         0.00%       1.473ms         0.00%       3.154ms       4.381us       0.000us         0.00%       0.000us       0.000us           720  
                                           hipDeviceGet         0.00%       1.440us         0.00%       1.440us       0.240us       0.000us         0.00%       0.000us       0.000us             6  
                              hipDevicePrimaryCtxRetain         0.00%       1.130us         0.00%       1.130us       0.188us       0.000us         0.00%       0.000us       0.000us             6  
                             hipDevicePrimaryCtxRelease         0.00%       0.962us         0.00%       0.962us       0.160us       0.000us         0.00%       0.000us       0.000us             6  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      47.863ms         0.03%      47.863ms       2.573us       0.000us         0.00%       0.000us       0.000us         18600  
                                              hipMemset         0.00%      28.502us         0.00%      28.502us      14.251us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.33%     521.970ms         0.33%     521.970ms     173.990ms       0.000us         0.00%       0.000us       0.000us             3  
                                 aten::split_with_sizes         0.04%      56.272ms         0.05%      72.942ms      12.664us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      35.626ms         0.02%      35.626ms       2.319us       0.000us         0.00%       0.000us       0.000us         15360  
                                          aten::squeeze         0.05%      82.803ms         0.06%      98.342ms       4.268us       0.000us         0.00%       0.000us       0.000us         23040  
                                      hipModuleLoadData         0.25%     406.227ms         0.25%     406.227ms     101.557ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     681.318us         0.00%       1.603ms     400.748us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       6.940ms         0.01%       8.296ms      34.565us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     817.143us         0.00%     817.143us       2.554us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.03%      41.938ms         0.08%     123.605ms       7.883us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      19.668ms         0.05%      81.667ms       5.208us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     401.404us         0.00%       2.869ms      35.863us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.156ms         0.00%       2.468ms      30.845us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.04%      58.140ms         0.09%     140.715ms       6.613us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      20.967ms         0.05%      82.574ms       3.880us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.03%      45.453ms         0.06%     102.517ms       4.243us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.029ms         0.00%       2.718ms      11.325us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     404.082us         0.00%       1.689ms       7.037us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     291.421us         0.00%     887.872us      11.098us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     596.451us         0.00%     596.451us       7.456us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     913.841us         0.23%     368.925ms     368.925ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      19.793ms         0.01%      22.360ms       2.911us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.568ms         0.00%       2.568ms       0.334us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       5.492ms         0.01%      21.299ms      10.649us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       4.205ms         0.01%      15.807ms       7.903us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       5.094ms         0.01%      13.733ms       7.153us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       2.251ms         0.01%       8.639ms       4.499us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     400.105us         0.00%     400.105us       0.208us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.062ms         0.00%       2.787ms      34.838us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.726ms         0.00%       1.726ms      21.569us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.469ms         0.00%       2.232ms      27.906us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.100ms     209.983us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      29.088us         0.00%      46.665us      11.666us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 160.584s
Self CUDA time total: 149.999s

[rank6]:[W124 07:34:20.704142069 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank2]:[W124 07:34:20.557651976 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank1]:[W124 07:34:21.768033512 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank5]:[W124 07:34:21.578314864 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank7]:[W124 07:34:22.186053544 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank0]:[W124 07:34:27.721955461 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank3]:[W124 07:34:42.283823216 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
============================================================================================================
throughput per GPU: 19.650000000000002
elapsed time per iteration: 5701.266666666666
samples_per_sec: 1.4031969503852946
============================================================================================================
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3440: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
mem usages: nan
