starting training

    torchrun --nproc_per_node 8 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 6000 pretrain_bert.py         --num-layers 24 --hidden-size 1024 --num-attention-heads 16 --seq-length 16384 --max-position-embeddings 131072         --micro-batch-size 1 --global-batch-size 8 --train-iters 10 --weight-decay 1e-2 --clip-grad 1.0 --fp16 --lr 0.0001 --lr-decay-iters 990000 --lr-decay-style linear --min-lr 1.0e-5 --weight-decay 1e-2 --lr-warmup-fraction .01 --clip-grad 1.0 --fp8-format hybrid --fp8-amax-compute-algo max --fp8-amax-history-len 1024         --tensor-model-parallel-size 8 --pipeline-model-parallel-size 1 --context-parallel-size 1         --data-path /workspace/datasets//bookcorpus_bert_text_sentence --vocab-file /workspace/datasets//vocab.txt --split 949,50,1         --no-gradient-accumulation-fusion --seed 1234         --log-interval 1 --log-throughput --save-interval 10000 --eval-interval 1000 --load /workspace/te_sw/Megatron-LM/experiments/ckpts-bert --eval-iters 10 --tensorboard-dir ./tb_tmp |& tee /workspace/te_sw/Megatron-LM/experiments/train_bert.log
W0124 08:33:49.475000 139872273606464 torch/distributed/run.py:779] 
W0124 08:33:49.475000 139872273606464 torch/distributed/run.py:779] *****************************************
W0124 08:33:49.475000 139872273606464 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0124 08:33:49.475000 139872273606464 torch/distributed/run.py:779] *****************************************
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
using world size: 8, data-parallel size: 1, context-parallel size: 1, tensor-model-parallel size: 8, encoder-tensor-model-parallel size: 0, pipeline-model-parallel size: 1, encoder-pipeline-model-parallel size: 0
WARNING: Setting args.check_for_nan_in_loss_and_grad to False since dynamic loss scaling is being used
using torch.float16 for parameters ...
------------------------ arguments ------------------------
  accumulate_allreduce_grads_in_fp32 .............. False
  adam_beta1 ...................................... 0.9
  adam_beta2 ...................................... 0.999
  adam_eps ........................................ 1e-08
  add_bias_linear ................................. True
  add_position_embedding .......................... True
  add_qkv_bias .................................... False
  adlr_autoresume ................................. False
  adlr_autoresume_interval ........................ 1000
  align_grad_reduce ............................... True
  align_param_gather .............................. False
  app_tag_run_name ................................ None
  app_tag_run_version ............................. 0.0.0
  apply_layernorm_1p .............................. False
  apply_query_key_layer_scaling ................... False
  apply_residual_connection_post_layernorm ........ False
  apply_rope_fusion ............................... True
  async_save ...................................... None
  async_tensor_model_parallel_allreduce ........... True
  attention_dropout ............................... 0.1
  attention_softmax_in_fp32 ....................... False
  auto_detect_ckpt_format ......................... False
  barrier_with_L1_time ............................ True
  bert_binary_head ................................ True
  bert_embedder_type .............................. megatron
  bert_load ....................................... None
  bf16 ............................................ False
  bias_dropout_fusion ............................. True
  bias_gelu_fusion ................................ True
  bias_swiglu_fusion .............................. True
  biencoder_projection_dim ........................ 0
  biencoder_shared_query_context_model ............ False
  block_data_path ................................. None
  calculate_per_token_loss ........................ False
  check_for_nan_in_loss_and_grad .................. False
  check_weight_hash_across_dp_replicas_interval ... None
  ckpt_assume_constant_structure .................. False
  ckpt_convert_format ............................. None
  ckpt_convert_save ............................... None
  ckpt_convert_update_legacy_dist_opt_format ...... False
  ckpt_format ..................................... torch_dist
  ckpt_fully_parallel_load ........................ False
  ckpt_fully_parallel_save ........................ True
  ckpt_fully_parallel_save_deprecated ............. False
  ckpt_step ....................................... None
  classes_fraction ................................ 1.0
  clip_grad ....................................... 1.0
  clone_scatter_output_in_embedding ............... True
  config_logger_dir ............................... 
  consumed_train_samples .......................... 0
  consumed_valid_samples .......................... 0
  context_parallel_size ........................... 1
  create_attention_mask_in_dataloader ............. True
  cross_entropy_loss_fusion ....................... False
  data_cache_path ................................. None
  data_parallel_random_init ....................... False
  data_parallel_size .............................. 1
  data_path ....................................... ['/workspace/datasets//bookcorpus_bert_text_sentence']
  data_per_class_fraction ......................... 1.0
  data_sharding ................................... True
  dataloader_type ................................. single
  ddp_average_in_collective ....................... False
  ddp_bucket_size ................................. None
  decoder_first_pipeline_num_layers ............... None
  decoder_last_pipeline_num_layers ................ None
  decoder_num_layers .............................. None
  decoder_seq_length .............................. None
  decoupled_lr .................................... None
  decoupled_min_lr ................................ None
  decrease_batch_size_if_needed ................... False
  defer_embedding_wgrad_compute ................... False
  deprecated_use_mcore_models ..................... False
  deterministic_mode .............................. False
  dino_bottleneck_size ............................ 256
  dino_freeze_last_layer .......................... 1
  dino_head_hidden_size ........................... 2048
  dino_local_crops_number ......................... 10
  dino_local_img_size ............................. 96
  dino_norm_last_layer ............................ False
  dino_teacher_temp ............................... 0.07
  dino_warmup_teacher_temp ........................ 0.04
  dino_warmup_teacher_temp_epochs ................. 30
  disable_straggler_on_startup .................... False
  disable_te_fused_rope ........................... False
  dist_ckpt_format_deprecated ..................... None
  dist_ckpt_strictness ............................ assume_ok_unexpected
  distribute_saved_activations .................... False
  distributed_backend ............................. nccl
  distributed_timeout_minutes ..................... 10
  embedding_path .................................. None
  empty_unused_memory_level ....................... 0
  enable_ft_package ............................... False
  enable_one_logger ............................... True
  encoder_num_layers .............................. 24
  encoder_pipeline_model_parallel_size ............ 0
  encoder_seq_length .............................. 16384
  encoder_tensor_model_parallel_size .............. 0
  end_weight_decay ................................ 0.01
  eod_mask_loss ................................... False
  eval_interval ................................... 1000
  eval_iters ...................................... 10
  evidence_data_path .............................. None
  exit_duration_in_mins ........................... None
  exit_interval ................................... None
  exit_on_missing_checkpoint ...................... False
  exit_signal_handler ............................. False
  expert_model_parallel_size ...................... 1
  ffn_hidden_size ................................. 4096
  finetune ........................................ False
  fp16 ............................................ True
  fp16_lm_cross_entropy ........................... False
  fp32_residual_connection ........................ False
  fp8 ............................................. hybrid
  fp8_amax_compute_algo ........................... max
  fp8_amax_history_len ............................ 1024
  fp8_interval .................................... 1
  fp8_margin ...................................... 0
  fp8_param_gather ................................ False
  fp8_wgrad ....................................... True
  global_batch_size ............................... 8
  gradient_accumulation_fusion .................... False
  group_query_attention ........................... False
  head_lr_mult .................................... 1.0
  hidden_dropout .................................. 0.1
  hidden_size ..................................... 1024
  hybrid_attention_ratio .......................... 0.0
  hybrid_mlp_ratio ................................ 0.0
  hybrid_override_pattern ......................... None
  hysteresis ...................................... 2
  ict_head_size ................................... None
  ict_load ........................................ None
  img_h ........................................... 224
  img_w ........................................... 224
  indexer_batch_size .............................. 128
  indexer_log_interval ............................ 1000
  inference_batch_times_seqlen_threshold .......... 512
  init_method_std ................................. 0.02
  init_method_xavier_uniform ...................... False
  initial_loss_scale .............................. 4294967296
  iter_per_epoch .................................. 1250
  kv_channels ..................................... 64
  kv_lora_rank .................................... 32
  lazy_mpu_init ................................... None
  load ............................................ /workspace/te_sw/Megatron-LM/experiments/ckpts-bert
  local_rank ...................................... 0
  log_interval .................................... 1
  log_loss_scale_to_tensorboard ................... True
  log_memory_to_tensorboard ....................... False
  log_num_zeros_in_grad ........................... False
  log_params_norm ................................. False
  log_progress .................................... False
  log_straggler ................................... False
  log_throughput .................................. True
  log_timers_to_tensorboard ....................... False
  log_validation_ppl_to_tensorboard ............... False
  log_world_size_to_tensorboard ................... False
  logging_level ................................... None
  loss_scale ...................................... None
  loss_scale_window ............................... 1000
  lr .............................................. 0.0001
  lr_decay_iters .................................. 990000
  lr_decay_samples ................................ None
  lr_decay_style .................................. linear
  lr_warmup_fraction .............................. 0.01
  lr_warmup_init .................................. 0.0
  lr_warmup_iters ................................. 0
  lr_warmup_samples ............................... 0
  lr_wsd_decay_iters .............................. None
  lr_wsd_decay_samples ............................ None
  lr_wsd_decay_style .............................. exponential
  make_vocab_size_divisible_by .................... 128
  manual_gc ....................................... False
  manual_gc_eval .................................. True
  manual_gc_interval .............................. 0
  mask_factor ..................................... 1.0
  mask_prob ....................................... 0.15
  mask_type ....................................... random
  masked_softmax_fusion ........................... True
  max_position_embeddings ......................... 131072
  max_tokens_to_oom ............................... 12000
  merge_file ...................................... None
  micro_batch_size ................................ 1
  min_loss_scale .................................. 1.0
  min_lr .......................................... 1e-05
  mmap_bin_files .................................. True
  mock_data ....................................... False
  moe_aux_loss_coeff .............................. 0.0
  moe_expert_capacity_factor ...................... None
  moe_extended_tp ................................. False
  moe_grouped_gemm ................................ False
  moe_input_jitter_eps ............................ None
  moe_layer_recompute ............................. False
  moe_pad_expert_input_to_capacity ................ False
  moe_per_layer_logging ........................... False
  moe_router_load_balancing_type .................. aux_loss
  moe_router_pre_softmax .......................... False
  moe_router_topk ................................. 2
  moe_shared_expert_intermediate_size ............. None
  moe_shared_expert_overlap ....................... False
  moe_token_dispatcher_type ....................... allgather
  moe_token_drop_policy ........................... probs
  moe_use_upcycling ............................... False
  moe_z_loss_coeff ................................ None
  multi_latent_attention .......................... False
  nccl_communicator_config_path ................... None
  no_load_optim ................................... None
  no_load_rng ..................................... None
  no_persist_layer_norm ........................... False
  no_save_optim ................................... None
  no_save_rng ..................................... None
  non_persistent_ckpt_type ........................ None
  non_persistent_global_ckpt_dir .................. None
  non_persistent_local_ckpt_algo .................. fully_parallel
  non_persistent_local_ckpt_dir ................... None
  non_persistent_save_interval .................... None
  norm_epsilon .................................... 1e-05
  normalization ................................... LayerNorm
  num_attention_heads ............................. 16
  num_channels .................................... 3
  num_classes ..................................... 1000
  num_dataset_builder_threads ..................... 1
  num_experts ..................................... None
  num_layers ...................................... 24
  num_layers_per_virtual_pipeline_stage ........... None
  num_query_groups ................................ 1
  num_workers ..................................... 2
  one_logger_async ................................ False
  one_logger_project .............................. megatron-lm
  one_logger_run_name ............................. None
  onnx_safe ....................................... None
  openai_gelu ..................................... False
  optimizer ....................................... adam
  output_bert_embeddings .......................... False
  overlap_grad_reduce ............................. False
  overlap_p2p_comm ................................ False
  overlap_param_gather ............................ False
  overlap_param_gather_with_optimizer_step ........ False
  override_opt_param_scheduler .................... False
  params_dtype .................................... torch.float16
  patch_dim ....................................... 16
  perform_initialization .......................... True
  pipeline_model_parallel_size .................... 1
  pipeline_model_parallel_split_rank .............. None
  position_embedding_type ......................... learned_absolute
  pretrained_checkpoint ........................... None
  profile ......................................... False
  profile_ranks ................................... [0]
  profile_step_end ................................ 12
  profile_step_start .............................. 10
  q_lora_rank ..................................... None
  qk_head_dim ..................................... 128
  qk_layernorm .................................... False
  qk_pos_emb_head_dim ............................. 64
  query_in_block_prob ............................. 0.1
  rampup_batch_size ............................... None
  rank ............................................ 0
  recompute_granularity ........................... None
  recompute_method ................................ None
  recompute_num_layers ............................ None
  renormalize_blend_weights ....................... False
  reset_attention_mask ............................ False
  reset_position_ids .............................. False
  retriever_report_topk_accuracies ................ []
  retriever_score_scaling ......................... False
  retriever_seq_length ............................ 256
  retro_add_retriever ............................. False
  retro_attention_gate ............................ 1
  retro_cyclic_train_iters ........................ None
  retro_encoder_attention_dropout ................. 0.1
  retro_encoder_hidden_dropout .................... 0.1
  retro_encoder_layers ............................ 2
  retro_num_neighbors ............................. 2
  retro_num_retrieved_chunks ...................... 2
  retro_project_dir ............................... None
  retro_verify_neighbor_count ..................... True
  rotary_base ..................................... 10000
  rotary_interleaved .............................. False
  rotary_percent .................................. 1.0
  rotary_scaling_factor ........................... 1.0
  rotary_seq_len_interpolation_factor ............. None
  s3_cache_path ................................... None
  sample_rate ..................................... 1.0
  save ............................................ None
  save_interval ................................... 10000
  scatter_gather_tensors_in_pipeline .............. True
  seed ............................................ 1234
  seq_length ...................................... 16384
  sequence_parallel ............................... False
  sgd_momentum .................................... 0.9
  short_seq_prob .................................. 0.1
  skip_train ...................................... False
  skipped_train_samples ........................... 0
  spec ............................................ None
  split ........................................... 949,50,1
  squared_relu .................................... False
  standalone_embedding_stage ...................... False
  start_weight_decay .............................. 0.01
  straggler_ctrlr_port ............................ 65535
  straggler_minmax_count .......................... 1
  swiglu .......................................... False
  swin_backbone_type .............................. tiny
  tensor_model_parallel_size ...................... 8
  tensorboard_dir ................................. ./tb_tmp
  tensorboard_log_interval ........................ 1
  tensorboard_queue_size .......................... 1000
  test_data_path .................................. None
  test_mode ....................................... False
  tiktoken_num_special_tokens ..................... 1000
  tiktoken_pattern ................................ None
  tiktoken_special_tokens ......................... None
  timing_log_level ................................ 0
  timing_log_option ............................... minmax
  titles_data_path ................................ None
  tokenizer_model ................................. None
  tokenizer_type .................................. BertWordPieceLowerCase
  tp_comm_bootstrap_backend ....................... nccl
  tp_comm_bulk_dgrad .............................. True
  tp_comm_bulk_wgrad .............................. True
  tp_comm_overlap ................................. False
  tp_comm_overlap_ag .............................. True
  tp_comm_overlap_cfg ............................. None
  tp_comm_overlap_rs .............................. True
  tp_comm_overlap_rs_dgrad ........................ False
  tp_comm_split_ag ................................ True
  tp_comm_split_rs ................................ True
  train_data_path ................................. None
  train_iters ..................................... 10
  train_samples ................................... None
  train_sync_interval ............................. None
  transformer_impl ................................ transformer_engine
  transformer_pipeline_model_parallel_size ........ 1
  untie_embeddings_and_output_weights ............. False
  use_checkpoint_args ............................. False
  use_checkpoint_opt_param_scheduler .............. False
  use_cpu_initialization .......................... None
  use_dist_ckpt ................................... True
  use_dist_ckpt_deprecated ........................ False
  use_distributed_optimizer ....................... False
  use_flash_attn .................................. False
  use_legacy_models ............................... False
  use_one_sent_docs ............................... False
  use_pytorch_profiler ............................ False
  use_ring_exchange_p2p ........................... False
  use_rope_scaling ................................ False
  use_rotary_position_embeddings .................. False
  use_tp_pp_dp_mapping ............................ False
  v_head_dim ...................................... 128
  valid_data_path ................................. None
  variable_seq_lengths ............................ False
  virtual_pipeline_model_parallel_size ............ None
  vision_backbone_type ............................ vit
  vision_pretraining .............................. False
  vision_pretraining_type ......................... classify
  vocab_extra_ids ................................. 0
  vocab_file ...................................... /workspace/datasets//vocab.txt
  vocab_size ...................................... None
  wandb_exp_name .................................. 
  wandb_project ................................... 
  wandb_save_dir .................................. 
  weight_decay .................................... 0.01
  weight_decay_incr_style ......................... constant
  wgrad_deferral_limit ............................ 0
  world_size ...................................... 8
  yaml_cfg ........................................ None
-------------------- end of arguments ---------------------
INFO:megatron.core.num_microbatches_calculator:setting number of microbatches to constant 8
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 30524) with 196 dummy tokens (new size: 30720)
> initializing torch distributed ...
> initialized tensor model parallel with size 8
> initialized pipeline model parallel with size 1
> setting random seeds to 1234 ...
> compiling dataset index builder ...
make: Entering directory '/workspace/te_sw/Megatron-LM/megatron/core/datasets'
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
make: Nothing to be done for 'default'.
make: Leaving directory '/workspace/te_sw/Megatron-LM/megatron/core/datasets'
>>> done with dataset index builder. Compilation time: 0.068 seconds
WARNING: constraints for invoking optimized fused softmax kernel are not met. We default back to unfused kernel invocations.
> compiling and loading fused kernels ...
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:290: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias, allreduce_dgrad):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:301: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:393: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:433: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
>>> done with compiling and loading fused kernels. Compilation time: 2.367 seconds
[rank1]:[W124 08:34:06.093108867 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank5]:[W124 08:34:06.093112795 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank6]:[W124 08:34:06.093119445 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank7]:[W124 08:34:06.093123851 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank3]:[W124 08:34:06.093125498 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank4]:[W124 08:34:06.093131844 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank2]:[W124 08:34:06.093146946 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank0]:[W124 08:34:06.093155746 init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
time to initialize megatron (seconds): 6.904
[after megatron is initialized] datetime: 2025-01-24 08:34:08 
building BERT model ...
 > number of parameters on (tensor, pipeline) model parallel rank (1, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (6, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (5, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (7, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (4, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (2, 0): 178178818
 > number of parameters on (tensor, pipeline) model parallel rank (3, 0): 178178818
INFO:megatron.core.distributed.distributed_data_parallel:Setting up DistributedDataParallel with config DistributedDataParallelConfig(grad_reduce_in_fp32=False, overlap_grad_reduce=False, overlap_param_gather=False, align_param_gather=False, use_distributed_optimizer=False, check_for_nan_in_grad=False, bucket_size=None, average_in_collective=False, fp8_param_gather=False)
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (178178818 elements):
	module.pooler.dense.bias
	module.encoder.layers.23.self_attention.linear_proj.weight
	module.encoder.layers.22.self_attention.linear_proj.weight
	module.encoder.layers.21.self_attention.linear_proj.bias
	module.encoder.layers.18.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.16.mlp.linear_fc2.bias
	module.encoder.layers.12.self_attention.linear_proj.weight
	module.encoder.layers.5.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.4.self_attention.linear_proj.bias
	module.encoder.layers.3.mlp.linear_fc2.weight
	module.encoder.layers.11.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.7.self_attention.linear_proj.bias
	module.encoder.layers.6.mlp.linear_fc1.weight
	module.encoder.layers.5.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.1.mlp.linear_fc1.weight
	module.encoder.layers.1.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.0.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.7.mlp.linear_fc1.weight
	module.encoder.layers.0.mlp.linear_fc1.bias
	module.encoder.layers.5.mlp.linear_fc1.bias
	module.encoder.layers.17.mlp.linear_fc2.weight
	module.encoder.layers.16.self_attention.linear_qkv.weight
	module.encoder.layers.15.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.14.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.13.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.9.self_attention.linear_qkv.weight
	module.encoder.layers.6.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.2.self_attention.linear_proj.bias
	module.encoder.layers.23.self_attention.linear_qkv.bias
	module.encoder.layers.22.self_attention.linear_qkv.bias
	module.encoder.layers.21.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.15.mlp.linear_fc1.bias
	module.encoder.layers.14.mlp.linear_fc1.bias
	module.encoder.layers.13.mlp.linear_fc1.bias
	module.encoder.layers.12.self_attention.linear_qkv.bias
	module.encoder.layers.11.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.10.self_attention.linear_proj.bias
	module.encoder.layers.8.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.4.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.23.mlp.linear_fc1.weight
	module.encoder.layers.22.mlp.linear_fc1.weight
	module.encoder.layers.21.mlp.linear_fc1.bias
	module.encoder.layers.20.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.19.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.19.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.18.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.15.self_attention.linear_proj.weight
	module.encoder.layers.14.self_attention.linear_proj.weight
	module.encoder.layers.13.self_attention.linear_proj.bias
	module.encoder.layers.3.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.2.mlp.linear_fc1.bias
	module.encoder.layers.21.self_attention.linear_proj.weight
	module.encoder.layers.18.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.11.mlp.linear_fc2.bias
	module.encoder.layers.6.self_attention.linear_qkv.weight
	module.encoder.layers.0.mlp.linear_fc2.weight
	module.encoder.layers.23.mlp.linear_fc2.bias
	module.encoder.layers.22.mlp.linear_fc2.bias
	module.encoder.layers.19.self_attention.linear_proj.bias
	module.encoder.layers.18.self_attention.linear_proj.bias
	module.encoder.layers.12.mlp.linear_fc2.bias
	module.encoder.layers.1.self_attention.linear_qkv.bias
	module.encoder.layers.0.mlp.linear_fc1.weight
	module.encoder.layers.7.self_attention.linear_proj.weight
	module.encoder.layers.5.self_attention.linear_proj.weight
	module.encoder.layers.16.mlp.linear_fc2.weight
	module.encoder.layers.15.self_attention.linear_qkv.bias
	module.encoder.layers.14.self_attention.linear_qkv.bias
	module.encoder.layers.13.self_attention.linear_qkv.bias
	module.encoder.layers.9.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.8.self_attention.linear_proj.weight
	module.encoder.layers.6.mlp.linear_fc2.weight
	module.encoder.layers.4.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.2.mlp.linear_fc1.weight
	module.encoder.layers.2.self_attention.linear_qkv.weight
	module.encoder.layers.0.self_attention.linear_qkv.bias
	module.encoder.layers.23.self_attention.linear_qkv.weight
	module.encoder.layers.22.self_attention.linear_qkv.weight
	module.encoder.layers.21.self_attention.linear_qkv.bias
	module.encoder.layers.20.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.15.mlp.linear_fc1.weight
	module.encoder.layers.14.mlp.linear_fc1.weight
	module.encoder.layers.13.mlp.linear_fc1.weight
	module.encoder.layers.12.self_attention.linear_qkv.weight
	module.encoder.layers.10.mlp.linear_fc2.weight
	module.encoder.layers.9.self_attention.linear_proj.bias
	module.encoder.layers.1.self_attention.linear_proj.weight
	module.encoder.final_layernorm.bias
	module.encoder.layers.21.mlp.linear_fc1.weight
	module.encoder.layers.20.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.19.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.19.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.18.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.11.mlp.linear_fc1.weight
	module.encoder.layers.11.self_attention.linear_qkv.weight
	module.encoder.layers.6.mlp.linear_fc2.bias
	module.encoder.layers.5.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.20.self_attention.linear_proj.bias
	module.encoder.layers.18.mlp.linear_fc1.bias
	module.encoder.layers.17.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.15.mlp.linear_fc2.bias
	module.encoder.layers.14.mlp.linear_fc2.bias
	module.encoder.layers.13.mlp.linear_fc2.bias
	module.encoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.6.mlp.linear_fc1.layer_norm_weight
	module.lm_head.dense.weight
	module.encoder.layers.21.mlp.linear_fc2.bias
	module.encoder.layers.19.self_attention.linear_proj.weight
	module.encoder.layers.18.self_attention.linear_proj.weight
	module.encoder.layers.9.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.1.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.0.self_attention.linear_proj.weight
	module.embedding.position_embeddings.weight
	module.binary_head.weight
	module.encoder.layers.15.self_attention.linear_qkv.weight
	module.encoder.layers.14.self_attention.linear_qkv.weight
	module.encoder.layers.13.self_attention.linear_qkv.weight
	module.encoder.layers.10.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.10.self_attention.linear_proj.weight
	module.encoder.layers.8.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.8.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.4.self_attention.linear_proj.weight
	module.encoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	module.embedding.tokentype_embeddings.weight
	module.encoder.layers.23.mlp.linear_fc2.weight
	module.encoder.layers.22.mlp.linear_fc2.weight
	module.encoder.layers.21.self_attention.linear_qkv.weight
	module.encoder.layers.20.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.12.mlp.linear_fc2.weight
	module.encoder.layers.3.mlp.linear_fc2.bias
	module.encoder.layers.2.mlp.linear_fc2.bias
	module.encoder.layers.1.self_attention.linear_proj.bias
	module.encoder.layers.0.self_attention.linear_qkv.weight
	module.encoder.layers.5.self_attention.linear_proj.bias
	module.encoder.layers.20.mlp.linear_fc1.bias
	module.encoder.layers.19.mlp.linear_fc2.bias
	module.encoder.layers.19.self_attention.linear_qkv.bias
	module.encoder.layers.18.self_attention.linear_qkv.bias
	module.encoder.layers.17.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.11.self_attention.linear_proj.bias
	module.encoder.layers.9.mlp.linear_fc1.bias
	module.encoder.layers.6.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.3.mlp.linear_fc1.weight
	module.encoder.layers.3.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.3.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.2.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.20.self_attention.linear_proj.weight
	module.encoder.layers.18.mlp.linear_fc1.weight
	module.encoder.layers.17.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.16.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.9.mlp.linear_fc2.weight
	module.encoder.layers.3.self_attention.linear_qkv.weight
	module.encoder.layers.1.mlp.linear_fc2.bias
	module.encoder.layers.17.self_attention.linear_proj.bias
	module.encoder.layers.0.mlp.linear_fc2.bias
	module.encoder.layers.7.self_attention.linear_qkv.bias
	module.binary_head.bias
	module.encoder.layers.19.mlp.linear_fc2.weight
	module.encoder.layers.18.mlp.linear_fc2.bias
	module.encoder.layers.15.mlp.linear_fc2.weight
	module.encoder.layers.14.mlp.linear_fc2.weight
	module.encoder.layers.13.mlp.linear_fc2.weight
	module.encoder.layers.10.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.9.self_attention.linear_qkv.bias
	module.encoder.layers.5.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.2.mlp.linear_fc2.weight
	module.encoder.layers.0.self_attention.linear_proj.bias
	module.encoder.final_layernorm.weight
	module.encoder.layers.21.mlp.linear_fc2.weight
	module.encoder.layers.20.self_attention.linear_qkv.bias
	module.encoder.layers.12.mlp.linear_fc1.weight
	module.encoder.layers.6.self_attention.linear_proj.bias
	module.encoder.layers.5.self_attention.linear_qkv.bias
	module.encoder.layers.1.self_attention.linear_qkv.weight
	module.encoder.layers.5.mlp.linear_fc2.weight
	module.encoder.layers.2.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.4.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.2.self_attention.linear_qkv.bias
	module.lm_head.layer_norm.weight
	module.encoder.layers.20.mlp.linear_fc1.weight
	module.encoder.layers.19.self_attention.linear_qkv.weight
	module.encoder.layers.19.mlp.linear_fc1.bias
	module.encoder.layers.18.self_attention.linear_qkv.weight
	module.encoder.layers.17.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.16.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.9.self_attention.linear_proj.weight
	module.encoder.layers.7.mlp.linear_fc1.bias
	module.encoder.layers.6.self_attention.linear_qkv.bias
	module.encoder.layers.17.mlp.linear_fc1.bias
	module.encoder.layers.16.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.11.self_attention.linear_qkv.bias
	module.encoder.layers.8.mlp.linear_fc2.bias
	module.encoder.layers.8.self_attention.linear_qkv.bias
	module.encoder.layers.6.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.5.mlp.linear_fc2.bias
	module.encoder.layers.5.mlp.linear_fc1.weight
	module.encoder.layers.4.mlp.linear_fc2.bias
	module.encoder.layers.4.mlp.linear_fc2.weight
	module.encoder.layers.23.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.22.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.20.mlp.linear_fc2.bias
	module.encoder.layers.17.self_attention.linear_proj.weight
	module.encoder.layers.16.self_attention.linear_proj.bias
	module.encoder.layers.12.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.11.mlp.linear_fc1.bias
	module.encoder.layers.10.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.8.self_attention.linear_proj.bias
	module.encoder.layers.7.mlp.linear_fc2.weight
	module.encoder.layers.2.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.2.self_attention.linear_proj.weight
	module.encoder.layers.0.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.10.mlp.linear_fc1.bias
	module.encoder.layers.6.self_attention.linear_proj.weight
	module.encoder.layers.3.self_attention.linear_proj.bias
	module.embedding.word_embeddings.weight
	module.encoder.layers.20.self_attention.linear_qkv.weight
	module.encoder.layers.11.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.10.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.7.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.7.self_attention.linear_qkv.weight
	module.encoder.layers.6.mlp.linear_fc1.bias
	module.encoder.layers.5.self_attention.linear_qkv.weight
	module.lm_head.dense.bias
	module.encoder.layers.19.mlp.linear_fc1.weight
	module.encoder.layers.18.mlp.linear_fc2.weight
	module.encoder.layers.17.self_attention.linear_qkv.bias
	module.encoder.layers.16.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.3.mlp.linear_fc1.bias
	module.encoder.layers.3.self_attention.linear_qkv.bias
	module.encoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.1.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.0.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.23.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.22.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.17.mlp.linear_fc1.weight
	module.encoder.layers.16.mlp.linear_fc1.bias
	module.encoder.layers.15.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.14.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.13.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.12.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.11.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.4.self_attention.linear_qkv.weight
	module.output_layer.bias
	module.encoder.layers.23.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.22.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.21.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.16.self_attention.linear_proj.weight
	module.encoder.layers.12.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.10.self_attention.linear_qkv.bias
	module.encoder.layers.9.mlp.linear_fc1.weight
	module.encoder.layers.9.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.8.self_attention.linear_qkv.weight
	module.encoder.layers.1.mlp.linear_fc1.bias
	module.encoder.layers.7.mlp.linear_fc2.bias
	module.pooler.dense.weight
	module.encoder.layers.23.self_attention.linear_proj.bias
	module.encoder.layers.22.self_attention.linear_proj.bias
	module.encoder.layers.17.mlp.linear_fc2.bias
	module.encoder.layers.13.self_attention.linear_proj.weight
	module.encoder.layers.12.self_attention.linear_proj.bias
	module.encoder.layers.10.mlp.linear_fc1.weight
	module.encoder.layers.8.mlp.linear_fc2.weight
	module.encoder.layers.8.mlp.linear_fc1.bias
	module.encoder.layers.7.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.20.mlp.linear_fc2.weight
	module.encoder.layers.9.mlp.linear_fc2.bias
	module.encoder.layers.4.self_attention.linear_qkv.bias
	module.encoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	module.lm_head.layer_norm.bias
	module.encoder.layers.17.self_attention.linear_qkv.weight
	module.encoder.layers.16.self_attention.linear_qkv.bias
	module.encoder.layers.15.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.14.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.13.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.10.mlp.linear_fc2.bias
	module.encoder.layers.9.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.7.mlp.linear_fc1.layer_norm_weight
	module.encoder.layers.7.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.3.self_attention.linear_proj.weight
	module.encoder.layers.23.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.22.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.21.self_attention.linear_qkv.layer_norm_weight
	module.encoder.layers.16.mlp.linear_fc1.weight
	module.encoder.layers.15.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.14.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.13.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.12.self_attention.linear_qkv.layer_norm_bias
	module.encoder.layers.8.mlp.linear_fc1.weight
	module.encoder.layers.8.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.23.mlp.linear_fc1.bias
	module.encoder.layers.22.mlp.linear_fc1.bias
	module.encoder.layers.21.mlp.linear_fc1.layer_norm_bias
	module.encoder.layers.15.self_attention.linear_proj.bias
	module.encoder.layers.14.self_attention.linear_proj.bias
	module.encoder.layers.12.mlp.linear_fc1.bias
	module.encoder.layers.11.mlp.linear_fc2.weight
	module.encoder.layers.11.self_attention.linear_proj.weight
	module.encoder.layers.10.self_attention.linear_qkv.weight
	module.encoder.layers.4.mlp.linear_fc1.weight
	module.encoder.layers.4.mlp.linear_fc1.bias
	module.encoder.layers.1.mlp.linear_fc2.weight
INFO:megatron.core.optimizer:Setting up optimizer with config OptimizerConfig(optimizer='adam', lr=0.0001, min_lr=1e-05, decoupled_lr=None, decoupled_min_lr=None, weight_decay=0.01, fp16=True, bf16=False, params_dtype=torch.float16, loss_scale=None, initial_loss_scale=4294967296, min_loss_scale=1.0, loss_scale_window=1000, hysteresis=2, adam_beta1=0.9, adam_beta2=0.999, adam_eps=1e-08, sgd_momentum=0.9, use_distributed_optimizer=False, overlap_param_gather_with_optimizer_step=False, clip_grad=1.0, log_num_zeros_in_grad=False, barrier_with_L1_time=True, timers=<megatron.core.timers.Timers object at 0x7f3f016328c0>, config_logger_dir='')
INFO:megatron.core.optimizer_param_scheduler:> learning rate decay style: linear
WARNING: could not find the metadata file /workspace/te_sw/Megatron-LM/experiments/ckpts-bert/latest_checkpointed_iteration.txt
    will not load any checkpoints and will start from random
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
(min, max) time across ranks (ms):
    load-checkpoint ................................: (0.90, 4.83)
[after model, optimizer, and learning rate scheduler are built] datetime: 2025-01-24 08:34:11 
> building train, validation, and test datasets ...
 > datasets target sizes (minimum size):
    train:      80
    validation: 80
    test:       80
INFO:megatron.core.datasets.blended_megatron_dataset_config:Let split_matrix = [(0, 0.949), (0.949, 0.999), (0.999, 1.0)]
> building train, validation, and test datasets for BERT ...
INFO:megatron.core.datasets.blended_megatron_dataset_builder:Building dataset splits with cls=BERTMaskedWordPieceDataset, sizes=(80, 80, 80), and config=BERTMaskedWordPieceDatasetConfig(random_seed=1234, sequence_length=16384, blend=(['/workspace/datasets//bookcorpus_bert_text_sentence'], None), blend_per_split=[None, None, None], renormalize_blend_weights=False, split='949,50,1', split_matrix=[(0, 0.949), (0.949, 0.999), (0.999, 1.0)], num_dataset_builder_threads=1, path_to_cache=None, mmap_bin_files=True, mock=False, tokenizer=<megatron.training.tokenizer.tokenizer._BertWordPieceTokenizer object at 0x7f3f016165c0>, masking_probability=0.15, short_sequence_probability=0.1, masking_max_ngram=3, masking_do_full_word=True, masking_do_permutation=False, masking_use_longer_ngrams=False, masking_use_geometric_distribution=False, classification_head=True)
INFO:megatron.core.datasets.indexed_dataset:Load the _IndexReader from /workspace/datasets//bookcorpus_bert_text_sentence.idx
INFO:megatron.core.datasets.indexed_dataset:	Extract the sequence lengths
INFO:megatron.core.datasets.indexed_dataset:	Extract the sequence pointers
INFO:megatron.core.datasets.indexed_dataset:	Extract the document indices
INFO:megatron.core.datasets.indexed_dataset:> total number of sequences: 74157091
INFO:megatron.core.datasets.indexed_dataset:> total number of documents: 74004228
INFO:megatron.core.datasets.masked_dataset:Load the BERTMaskedWordPieceDataset train indices
INFO:megatron.core.datasets.masked_dataset:	Load the sample index from ec05163be455a8ac28060961cf9b1fd6-BERTMaskedWordPieceDataset-sample_index.npy
INFO:megatron.core.datasets.masked_dataset:Load the BERTMaskedWordPieceDataset valid indices
INFO:megatron.core.datasets.masked_dataset:	Load the sample index from c215a53154c6e396365106d43b4f252a-BERTMaskedWordPieceDataset-sample_index.npy
INFO:megatron.core.datasets.masked_dataset:Load the BERTMaskedWordPieceDataset test indices
INFO:megatron.core.datasets.masked_dataset:	Load the sample index from 5a48370cfc4bb4cae37f7c9e366f15f2-BERTMaskedWordPieceDataset-sample_index.npy
> finished creating BERT datasets ...
[after dataloaders are built] datetime: 2025-01-24 08:34:11 
done with setup ...
(min, max) time across ranks (ms):
    model-and-optimizer-setup ......................: (2079.48, 2089.99)
    train/valid/test-data-iterators-setup ..........: (96.64, 370.51)
training ...
[before the start of training step] datetime: 2025-01-24 08:34:11 
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
 [2025-01-24 08:34:27] iteration        1/      10 | consumed samples:            8 | elapsed time per iteration (ms): 15886.6 | throughput per GPU (TFLOP/s/GPU): 7.0 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 4294967296.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
 [2025-01-24 08:34:33] iteration        2/      10 | consumed samples:           16 | elapsed time per iteration (ms): 5850.3 | throughput per GPU (TFLOP/s/GPU): 19.1 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 2147483648.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 08:34:39] iteration        3/      10 | consumed samples:           24 | elapsed time per iteration (ms): 5677.9 | throughput per GPU (TFLOP/s/GPU): 19.7 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 1073741824.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 08:34:45] iteration        4/      10 | consumed samples:           32 | elapsed time per iteration (ms): 6254.8 | throughput per GPU (TFLOP/s/GPU): 17.9 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 536870912.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 08:34:51] iteration        5/      10 | consumed samples:           40 | elapsed time per iteration (ms): 5765.0 | throughput per GPU (TFLOP/s/GPU): 19.4 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 268435456.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 08:34:56] iteration        6/      10 | consumed samples:           48 | elapsed time per iteration (ms): 5887.2 | throughput per GPU (TFLOP/s/GPU): 19.0 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 134217728.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 08:35:02] iteration        7/      10 | consumed samples:           56 | elapsed time per iteration (ms): 5954.7 | throughput per GPU (TFLOP/s/GPU): 18.8 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 67108864.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 08:35:09] iteration        8/      10 | consumed samples:           64 | elapsed time per iteration (ms): 6210.1 | throughput per GPU (TFLOP/s/GPU): 18.0 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 33554432.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 08:35:14] iteration        9/      10 | consumed samples:           72 | elapsed time per iteration (ms): 5799.5 | throughput per GPU (TFLOP/s/GPU): 19.3 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 16777216.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
 [2025-01-24 08:35:20] iteration       10/      10 | consumed samples:           80 | elapsed time per iteration (ms): 5769.3 | throughput per GPU (TFLOP/s/GPU): 19.4 | learning rate: 0.000000E+00 | global batch size:     8 | loss scale: 8388608.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
[after training is done] datetime: 2025-01-24 08:35:20 
Evaluating on 80 samples
Evaluating iter 1/10
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
/workspace/te_sw/Megatron-LM/megatron/core/tensor_parallel/layers.py:623: UserWarning: async_grad_allreduce is deprecated, not in use anymore and will be fully removed with 0.10.0. Please use allreduce_dgrad instead.
  warnings.warn(
Evaluating iter 2/10
Evaluating iter 3/10
Evaluating iter 4/10
Evaluating iter 5/10
Evaluating iter 6/10
Evaluating iter 7/10
Evaluating iter 8/10
Evaluating iter 9/10
Evaluating iter 10/10
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/distributed/c10d_logger.py:79: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
(min, max) time across ranks (ms):
    evaluate .......................................: (24043.06, 24043.10)
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 10 on validation set | lm loss value: 1.048669E+01 | lm loss PPL: 3.583533E+04 | sop loss value: 7.752233E-01 | sop loss PPL: 2.171077E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Evaluating on 80 samples
Evaluating iter 1/10
Evaluating iter 2/10
Evaluating iter 3/10
Evaluating iter 4/10
Evaluating iter 5/10
Evaluating iter 6/10
Evaluating iter 7/10
Evaluating iter 8/10
Evaluating iter 9/10
Evaluating iter 10/10
(min, max) time across ranks (ms):
    evaluate .......................................: (23152.63, 23152.80)
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 10 on test set | lm loss value: 1.055455E+01 | lm loss PPL: 3.835166E+04 | sop loss value: 8.063790E-01 | sop loss PPL: 2.239783E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
[rank6]:[W124 08:36:19.827960968 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank3]:[W124 08:36:19.846276088 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank5]:[W124 08:36:19.950013826 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank4]:[W124 08:36:19.207323945 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank2]:[W124 08:36:19.410422261 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank1]:[W124 08:36:19.487146398 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank7]:[W124 08:36:19.630813796 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
[rank0]:[W124 08:36:20.726434313 collection.cpp:1046] Warning: ROCTracer produced duplicate flow start: 3 (function operator())
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       81.644s        51.41%       81.644s       81.644s             1  
                                             bert_train        36.88%       64.386s        71.26%      124.394s      124.394s       0.000us         0.00%       39.017s       39.017s             1  
                                            aten::copy_        14.03%       24.497s        16.39%       28.615s     363.062us       16.219s        10.21%       16.262s     206.335us         78815  
                                     record_param_comms         3.31%        5.780s         5.13%        8.950s     257.822us        8.759s         5.52%       12.334s     355.317us         34714  
                                               aten::to         0.04%      68.646ms        16.36%       28.566s     544.223us       0.000us         0.00%       11.691s     222.735us         52489  
                                         aten::_to_copy         0.12%     201.189ms        16.32%       28.497s     657.448us       0.000us         0.00%       11.691s     269.723us         43345  
                                      aten::masked_fill         0.05%      86.840ms         0.30%     520.042ms      54.171us       0.000us         0.00%       11.589s       1.207ms          9600  
                                     aten::masked_fill_         0.12%     209.172ms         0.27%     475.423ms      28.989us       10.843s         6.83%       10.844s     661.192us         16400  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        8.734s         5.50%        8.734s     923.938us          9453  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        8.660s         5.45%        8.660s     907.580us          9542  
                                       c10d::allreduce_         0.28%     484.069ms         2.39%        4.168s     247.938us       0.000us         0.00%        8.561s     509.274us         16811  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      25.319ms         0.14%     249.950ms      65.091us       0.000us         0.00%        7.740s       2.016ms          3840  
                                    MaskedFillBackward0         0.01%      10.279ms         0.13%     224.631ms      58.498us       0.000us         0.00%        7.740s       2.016ms          3840  
                                              aten::bmm         0.32%     560.139ms         0.39%     676.860ms      50.362us        6.926s         4.36%        6.926s     515.329us         13440  
autograd::engine::evaluate_function: SoftmaxBackward...         0.01%      11.857ms         0.06%      97.613ms      50.840us       0.000us         0.00%        6.487s       3.379ms          1920  
                                       SoftmaxBackward0         0.01%       9.889ms         0.05%      85.755ms      44.664us       0.000us         0.00%        6.487s       3.379ms          1920  
                           aten::_softmax_backward_data         0.02%      26.552ms         0.04%      75.867ms      39.514us        3.350s         2.11%        6.487s       3.379ms          1920  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.412s         4.04%        6.412s       1.451ms          4419  
autograd::engine::evaluate_function: _LayerNormLinea...         0.07%     129.457ms         3.30%        5.768s       1.502ms       0.000us         0.00%        6.279s       1.635ms          3840  
                               _LayerNormLinearBackward         2.12%        3.693s         3.19%        5.566s       1.449ms     481.535ms         0.30%        6.120s       1.594ms          3840  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.009s         3.78%        6.009s     737.858us          8144  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.521s         3.48%        5.521s       1.203ms          4589  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      19.376ms         0.07%     117.292ms      29.921us       0.000us         0.00%        4.997s       1.275ms          3920  
                                        ToCopyBackward0         0.01%       8.809ms         0.06%      97.916ms      24.978us       0.000us         0.00%        4.997s       1.275ms          3920  
                                            aten::clone         0.08%     131.629ms         0.48%     846.003ms      24.489us       0.000us         0.00%        4.567s     132.205us         34546  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.461s         2.81%        4.461s     561.072us          7950  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.430s         2.79%        4.430s     962.139us          4604  
                                          aten::softmax         0.01%      14.962ms         0.10%     166.249ms      28.863us       0.000us         0.00%        4.221s     732.816us          5760  
                                         aten::_softmax         0.05%      90.518ms         0.09%     151.287ms      26.265us        4.221s         2.66%        4.221s     732.816us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.221s         2.66%        4.221s       1.689ms          2499  
                                     tex_ts::te_gemm_ts         1.49%        2.604s         2.17%        3.784s      98.548us        4.151s         2.61%        4.158s     108.289us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.653s         2.30%        3.653s     826.677us          4419  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.555s         2.24%        3.555s     308.584us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.350s         2.11%        3.350s       1.745ms          1920  
                                              aten::mul         0.10%     171.270ms         0.14%     244.064ms      30.619us        3.171s         2.00%        3.171s     397.864us          7971  
                                          c10d::barrier         0.00%     888.862us         1.64%        2.864s      75.379ms       0.000us         0.00%        3.142s      82.679ms            38  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.139s         1.98%        3.139s       1.432ms          2193  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      25.532ms         0.15%     266.141ms     138.615us       0.000us         0.00%        3.052s       1.589ms          1920  
                                       BaddbmmBackward0         0.01%      25.642ms         0.14%     240.608ms     125.317us       0.000us         0.00%        3.052s       1.589ms          1920  
                                                _Linear         1.27%        2.225s         1.96%        3.414s     889.090us     146.242ms         0.09%        2.965s     772.159us          3840  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.875s         1.18%        1.875s     414.629us          4523  
      autograd::engine::evaluate_function: BmmBackward0         0.02%      30.997ms         0.16%     271.611ms     141.464us       0.000us         0.00%        1.785s     929.599us          1920  
                                           BmmBackward0         0.01%      18.203ms         0.14%     240.615ms     125.320us       0.000us         0.00%        1.785s     929.599us          1920  
autograd::engine::evaluate_function: _LinearBackward...         0.03%      57.279ms         1.77%        3.087s     804.014us       0.000us         0.00%        1.701s     443.075us          3840  
                                        _LinearBackward         1.33%        2.317s         1.74%        3.030s     789.098us     206.290ms         0.13%        1.701s     443.075us          3840  
                                       aten::logical_or         0.07%     126.557ms         0.22%     381.455ms      33.112us     805.956ms         0.51%        1.612s     139.948us         11520  
                                          aten::dropout         0.01%      12.632ms         0.07%     125.738ms      20.904us       0.000us         0.00%        1.493s     248.254us          6015  
                                   aten::native_dropout         0.03%      44.987ms         0.06%     108.145ms      53.830us        1.493s         0.94%        1.493s     743.279us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.493s         0.94%        1.493s     746.623us          2000  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.488s         0.94%        1.488s     775.056us          1920  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      15.560ms         0.05%      87.542ms      43.706us       0.000us         0.00%        1.398s     698.122us          2003  
                                 NativeDropoutBackward0         0.01%       9.318ms         0.04%      71.982ms      35.937us       0.000us         0.00%        1.398s     698.122us          2003  
                          aten::native_dropout_backward         0.01%      25.145ms         0.04%      62.665ms      31.285us        1.398s         0.88%        1.398s     698.122us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.398s         0.88%        1.398s     699.169us          2000  
                                              aten::sub         0.07%     117.951ms         0.09%     152.908ms      23.274us        1.395s         0.88%        1.396s     212.527us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.392s         0.88%        1.392s     557.124us          2499  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.387s         0.87%        1.387s      81.060us         17116  
                                   hipStreamIsCapturing         0.03%      58.910ms         0.03%      58.910ms       1.173us        1.214s         0.76%        1.214s      24.176us         50223  
                                   hipDeviceGetPCIBusId         0.01%      17.514ms         0.01%      17.514ms       0.950us        1.187s         0.75%        1.187s      64.410us         18435  
                                          aten::baddbmm         0.24%     413.042ms         0.51%     887.685ms     154.112us        1.182s         0.74%        1.182s     205.134us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.131s         0.71%        1.131s     589.264us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.02%      35.330ms         0.71%        1.246s     324.427us       0.000us         0.00%        1.001s     260.635us          3840  
                               CompiledFunctionBackward         0.36%     627.598ms         0.69%        1.210s     315.226us       0.000us         0.00%        1.001s     260.635us          3840  
                                 triton_red_fused_sum_1         0.03%      46.762ms         0.04%      73.075ms      19.030us     894.248ms         0.56%     894.248ms     232.877us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     805.956ms         0.51%     805.956ms     322.511us          2499  
                                      aten::logical_not         0.10%     168.526ms         0.28%     496.619ms      21.555us     320.512ms         0.20%     641.569ms      27.846us         23040  
                                     hipIpcGetMemHandle         0.01%      10.465ms         0.01%      10.465ms       6.039us     627.963ms         0.40%     627.963ms     362.356us          1733  
                                        hipEventDestroy         0.04%      61.943ms         0.04%      62.323ms       3.151us     534.094ms         0.34%     534.693ms      27.036us         19777  
                                       c10d::broadcast_         0.02%      38.467ms         0.47%     813.649ms       1.692ms       0.000us         0.00%     525.692ms       1.093ms           481  
                                  hipMemGetAddressRange         0.00%     179.736us         0.00%     179.736us       0.400us     479.534ms         0.30%     479.534ms       1.068ms           449  
                                      hipGetProcAddress         0.05%      93.277ms         0.05%      93.285ms       1.204us     445.808ms         0.28%     446.597ms       5.766us         77449  
                                  Torch-Compiled Region         0.60%        1.049s         1.76%        3.081s     160.306us       0.000us         0.00%     432.991ms      22.528us         19220  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.711ms         0.00%       2.711ms       0.191us     415.433ms         0.26%     415.433ms      29.322us         14168  
                                       _LayerNormLinear         0.43%     757.782ms         1.20%        2.097s     546.079us     258.450ms         0.16%     406.352ms     105.821us          3840  
                                             aten::add_         0.11%     195.774ms         0.20%     350.814ms      11.165us     357.091ms         0.22%     357.091ms      11.365us         31420  
                                       hipCtxGetCurrent         0.01%      13.497ms         0.01%      13.497ms       0.229us     355.993ms         0.22%     355.993ms       6.051us         58831  
                                       CompiledFunction         0.69%        1.210s         1.01%        1.764s     152.825us       0.000us         0.00%     321.294ms      27.842us         11540  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     320.512ms         0.20%     320.512ms      64.128us          4998  
                                              aten::sum         0.24%     426.593ms         0.52%     899.448ms      44.192us     211.977ms         0.13%     287.756ms      14.138us         20353  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     287.283ms         0.18%     287.283ms      57.480us          4998  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     271.338ms         0.17%     271.338ms      47.107us          5760  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     259.784ms         0.16%     259.784ms      67.652us          3840  
                  triton_poi_fused_add_native_dropout_0         0.06%      99.557ms         0.09%     148.646ms      38.609us     244.425ms         0.15%     245.239ms      63.698us          3850  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     236.478ms         0.15%     236.478ms     236.478ms             1  
                                  hipExtMallocWithFlags         0.03%      48.467ms         0.03%      48.467ms      11.447us     207.050ms         0.13%     207.050ms      48.902us          4234  
autograd::engine::evaluate_function: torch::autograd...         0.22%     385.857ms         0.44%     763.084ms      31.585us       0.000us         0.00%     197.404ms       8.171us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     195.574ms         0.12%     195.574ms       8.176us         23920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     169.450ms         0.11%     169.450ms      38.079us          4450  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     167.346ms         0.11%     167.346ms      33.489us          4997  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     166.573ms         0.10%     166.573ms      32.668us          5099  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.02%      36.477ms         0.49%     860.150ms     447.995us       0.000us         0.00%     163.304ms      85.054us          1920  
                                         hipMemsetAsync         0.07%     125.586ms         0.07%     125.607ms      10.682us     150.758ms         0.09%     150.758ms      12.821us         11759  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     149.341ms         0.09%     149.341ms      38.097us          3920  
                                              aten::cat         0.10%     182.944ms         0.14%     242.638ms      30.029us     137.229ms         0.09%     137.229ms      16.984us          8080  
                             _VocabParallelCrossEntropy         0.05%      83.395ms         0.18%     307.414ms       1.281ms       0.000us         0.00%     131.187ms     546.615us           240  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       7.027ms        20.76%       36.244s     151.017ms       0.000us         0.00%     130.225ms     542.604us           240  
                                     EmbeddingBackward0         0.00%       3.690ms        20.76%       36.236s     150.982ms       0.000us         0.00%     129.149ms     538.120us           240  
                               aten::embedding_backward         0.00%       3.304ms        20.76%       36.232s     150.967ms       0.000us         0.00%     129.149ms     538.120us           240  
                         aten::embedding_dense_backward         0.52%     903.366ms        20.75%       36.229s     150.953ms     122.586ms         0.08%     129.149ms     538.120us           240  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.730ms         0.07%     126.987ms       1.587ms       0.000us         0.00%     116.869ms       1.461ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      22.696ms         0.07%     125.257ms       1.566ms       0.000us         0.00%     116.869ms       1.461ms            80  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      22.126ms         0.18%     308.590ms     160.724us       0.000us         0.00%     116.730ms      60.797us          1920  
                                 _SplitAlongDimBackward         0.12%     215.150ms         0.16%     286.464ms     149.200us       0.000us         0.00%     116.730ms      60.797us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     116.730ms         0.07%     116.730ms      60.797us          1920  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     115.801ms         0.07%     115.801ms      11.465us         10100  
                                       aten::contiguous         0.02%      30.669ms         0.33%     571.805ms      24.818us       0.000us         0.00%     112.520ms       4.884us         23040  
                                         hipMemcpyAsync         0.14%     243.511ms         0.14%     243.540ms      20.179us     111.861ms         0.07%     112.326ms       9.307us         12069  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     111.981ms         0.07%     111.981ms      51.843us          2160  
             triton_poi_fused_native_dropout_backward_0         0.05%      84.240ms         0.07%     123.191ms      32.081us     106.590ms         0.07%     106.590ms      27.758us          3840  
                                               aten::mm         0.03%      55.544ms         0.06%     112.433ms     127.765us     104.305ms         0.07%     104.305ms     118.528us           880  
                             c10d::allreduce_coalesced_         0.00%       1.809ms         0.05%      93.695ms       9.370ms       0.000us         0.00%     104.263ms      10.426ms            10  
                                   hipStreamSynchronize         0.73%        1.272s         0.73%        1.272s     398.429us      98.881ms         0.06%      98.905ms      30.975us          3193  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us      98.080ms         0.06%      98.080ms     464.834us           211  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      92.972ms         0.06%      92.972ms      37.204us          2499  
                                           aten::matmul         0.00%       3.335ms         0.05%      85.086ms     212.716us       0.000us         0.00%      87.272ms     218.179us           400  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      87.161ms         0.05%      87.161ms       7.422us         11743  
                                           aten::arange         0.09%     151.536ms         0.25%     439.540ms      17.838us      41.428ms         0.03%      82.966ms       3.367us         24640  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      80.336ms         0.05%      80.336ms      41.842us          1920  
                                       hipStreamDestroy         0.03%      59.625ms         0.03%      59.625ms      22.602us      77.881ms         0.05%      77.881ms      29.523us          2638  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      77.625ms         0.05%      77.625ms      10.354us          7497  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      76.363ms         0.05%      76.363ms      30.557us          2499  
                         _ReduceFromModelParallelRegion         0.01%      26.047ms         0.04%      71.403ms     297.513us       0.000us         0.00%      74.438ms     310.158us           240  
                                 hipDeviceCanAccessPeer         0.00%     461.754us         0.00%     461.754us       0.236us      73.228ms         0.05%      73.228ms      37.437us          1956  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      71.734ms         0.05%      71.734ms      18.299us          3920  
                               hipStreamCreateWithFlags         0.24%     411.260ms         0.24%     411.260ms     154.725us      69.115ms         0.04%      69.115ms      26.003us          2658  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.22%     381.351ms         0.38%     659.169ms      85.829us      67.864ms         0.04%      67.909ms       8.842us          7680  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      67.507ms         0.04%      67.507ms     281.281us           240  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      62.514ms         0.04%      62.514ms      14.501us          4311  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      61.928ms         0.04%      61.928ms      16.127us          3840  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      54.695ms         0.03%      54.695ms      28.487us          1920  
                                           GeLUFunction         0.11%     190.221ms         0.65%        1.134s     196.855us       0.000us         0.00%      54.603ms       9.480us          5760  
                        triton_poi_fused_add_mul_tanh_0         0.08%     138.405ms         0.09%     163.850ms      28.397us      54.433ms         0.03%      54.439ms       9.435us          5770  
                                    hipMemcpyWithStream        23.15%       40.412s        23.15%       40.415s      51.094ms       0.000us         0.00%      53.777ms      67.986us           791  
                                   GeLUFunctionBackward         0.04%      77.975ms         0.41%     720.427ms     375.222us       0.000us         0.00%      52.838ms      27.520us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      41.789ms         0.04%      63.367ms      33.004us      52.838ms         0.03%      52.838ms      27.520us          1920  
        LinearWithGradAccumulationAndAsyncCommunication         0.01%       9.246ms         0.02%      29.516ms     122.984us       0.000us         0.00%      52.753ms     219.805us           240  
                                  hipModuleLaunchKernel         0.16%     271.805ms         0.16%     271.843ms       8.043us      48.672ms         0.03%      48.708ms       1.441us         33799  
                                    hipIpcOpenMemHandle         0.06%      96.130ms         0.06%      96.130ms      55.279us      45.262ms         0.03%      45.262ms      26.028us          1739  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      42.672ms         0.03%      42.672ms       8.538us          4998  
                                            aten::fill_         0.09%     152.021ms         0.11%     186.934ms       6.464us      42.288ms         0.03%      42.328ms       1.464us         28919  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      38.412ms         0.02%      38.412ms       7.686us          4998  
                                 triton_poi_fused_add_0         0.13%     228.926ms         0.14%     242.894ms      31.627us      34.885ms         0.02%      36.058ms       4.695us          7680  
                                            aten::zeros         0.05%      87.547ms         0.22%     389.710ms      17.393us       0.000us         0.00%      32.293ms       1.441us         22406  
                                            aten::zero_         0.05%      84.004ms         0.15%     258.870ms      11.431us       0.000us         0.00%      32.152ms       1.420us         22646  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      31.184ms         0.02%      31.184ms       8.121us          3840  
                                          aten::randint         0.02%      42.174ms         0.09%     161.895ms      42.007us       0.000us         0.00%      30.869ms       8.009us          3854  
                                          aten::random_         0.04%      68.230ms         0.07%     116.869ms      30.356us      30.869ms         0.02%      30.869ms       8.018us          3850  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      30.869ms         0.02%      30.869ms       8.018us          3850  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      30.378ms         0.02%      30.378ms      12.156us          2499  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      28.775ms         0.02%      28.775ms     179.841us           160  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.522ms         0.03%      56.015ms     700.193us       0.000us         0.00%      27.351ms     341.891us            80  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.682ms         0.02%      24.682ms     308.527us            80  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       4.179ms         0.03%      52.155ms     217.314us       0.000us         0.00%      23.612ms      98.383us           240  
                                              aten::exp         0.00%       3.061ms         0.01%      21.908ms      91.281us      23.291ms         0.01%      23.291ms      97.048us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.291ms         0.01%      23.291ms     223.956us           104  
                                              aten::add         0.05%      79.555ms         0.06%     112.354ms      62.908us      23.122ms         0.01%      23.122ms      12.946us          1786  
                                             aten::div_         0.00%       6.425ms         0.01%      14.755ms      30.740us      22.110ms         0.01%      22.110ms      46.063us           480  
                                 tex_ts::cast_to_fp8_ts         0.08%     148.082ms         0.13%     219.508ms      28.582us      21.965ms         0.01%      21.965ms       2.860us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      21.965ms         0.01%      21.965ms      18.985us          1157  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      21.322ms         0.01%      21.322ms     205.022us           104  
                                           aten::linear         0.00%       3.817ms         0.04%      62.321ms      86.557us       0.000us         0.00%      20.772ms      28.850us           720  
                                            aten::addmm         0.03%      44.806ms         0.03%      52.463ms      72.865us      20.307ms         0.01%      20.772ms      28.850us           720  
                                             aten::sub_         0.00%       5.226ms         0.00%       6.800ms      21.250us      20.757ms         0.01%      20.757ms      64.867us           320  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      20.499ms         0.01%      20.499ms       7.419us          2763  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.198ms         0.01%      20.198ms     194.212us           104  
                                            aten::index         0.01%      14.972ms         0.04%      75.439ms     133.049us       2.305ms         0.00%      19.268ms      33.983us           567  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.142ms         0.01%      19.142ms       7.660us          2499  
                                           aten::cumsum         0.07%     124.725ms         0.09%     157.832ms      27.401us      19.039ms         0.01%      19.069ms       3.311us          5760  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      19.039ms         0.01%      19.039ms       7.619us          2499  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      18.472ms         0.01%      18.472ms       7.350us          2513  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      17.566ms         0.01%      17.566ms      27.533us           638  
                                         AddmmBackward0         0.00%       3.168ms         0.02%      40.430ms     168.457us       0.000us         0.00%      17.033ms      70.972us           240  
                                          aten::nonzero         0.00%       5.610ms         0.02%      42.319ms     172.731us      16.963ms         0.01%      16.963ms      69.238us           245  
                     _VocabParallelCrossEntropyBackward         0.01%      21.799ms         0.03%      50.244ms     628.045us       0.000us         0.00%      16.956ms     211.946us            80  
                                        aten::embedding         0.00%       7.136ms         0.02%      30.371ms      42.181us       0.000us         0.00%      16.804ms      23.338us           720  
                                     aten::index_select         0.01%      12.930ms         0.01%      20.462ms      28.420us      16.804ms         0.01%      16.804ms      23.338us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.804ms         0.01%      16.804ms      53.345us           315  
                                     hipStreamWaitEvent         0.19%     336.620ms         0.19%     336.671ms      16.466us      15.888ms         0.01%      16.359ms       0.800us         20446  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      15.551ms         0.01%      15.551ms      74.766us           208  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      15.152ms         0.01%      15.152ms      16.779us           903  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.342ms         0.01%      13.342ms      83.390us           160  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.857ms         0.01%      12.857ms     123.620us           104  
                                             aten::mul_         0.00%       6.602ms         0.00%       7.444ms       5.816us      12.637ms         0.01%      12.637ms       9.873us          1280  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.390ms         0.01%      12.390ms     119.136us           104  
                                       aten::index_put_         0.00%       6.223ms         0.11%     196.292ms     175.261us       0.000us         0.00%      10.200ms       9.107us          1120  
                                 aten::_index_put_impl_         0.00%       8.321ms         0.11%     190.069ms     169.705us       1.031ms         0.00%      10.200ms       9.107us          1120  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us      10.017ms         0.01%      10.017ms      41.738us           240  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us       9.958ms         0.01%       9.958ms      95.748us           104  
                                             aten::ones         0.00%       1.391ms         0.00%       8.415ms      17.531us       0.000us         0.00%       9.654ms      20.112us           480  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.614ms         0.01%       9.614ms      40.058us           240  
                                              aten::max         0.00%       7.448ms         0.02%      36.953ms     145.486us       9.142ms         0.01%       9.244ms      36.394us           254  
autograd::engine::evaluate_function: torch::autograd...         0.00%       1.941ms         0.02%      28.675ms     358.431us       0.000us         0.00%       9.237ms     115.466us            80  
                            torch::autograd::CopySlices         0.00%       4.398ms         0.02%      26.733ms     334.167us       0.000us         0.00%       9.237ms     115.466us            80  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.129ms         0.01%       9.129ms      87.778us           104  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.688ms         0.01%      14.076ms     175.950us       0.000us         0.00%       9.116ms     113.955us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.960ms         0.01%      11.388ms     142.347us       9.116ms         0.01%       9.116ms     113.955us            80  
         _compile.<locals>.compile_inner (dynamo_timed)         0.08%     135.974ms         1.85%        3.231s     323.075ms       0.000us         0.00%       8.914ms     891.435us            10  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.751ms         0.01%       8.751ms      21.240us           412  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       8.664ms         0.01%       8.664ms      12.630us           686  
                           FusedLayerNormAffineFunction         0.01%      13.212ms         0.01%      22.989ms      95.787us       7.586ms         0.00%       7.586ms      31.606us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.586ms         0.00%       7.586ms      72.938us           104  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       7.028ms         0.00%       7.028ms      29.284us           240  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       6.808ms         0.00%       6.808ms       7.092us           960  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     526.690us         0.00%       2.720ms     272.026us       6.735ms         0.00%       6.735ms     673.546us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.735ms         0.00%       6.735ms      61.231us           110  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.703ms         0.00%       6.703ms      83.787us            80  
                                        hipLaunchKernel         0.91%        1.583s         0.91%        1.583s      10.411us       5.194ms         0.00%       6.441ms       0.042us        152063  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      32.430ms         1.75%        3.050s     305.032ms       0.000us         0.00%       5.872ms     587.199us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.35%     610.144ms         1.73%        3.018s     301.789ms       0.000us         0.00%       5.872ms     587.199us            10  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       5.236ms         0.00%       5.236ms      32.722us           160  
                            hipGetDevicePropertiesR0600         0.06%     105.027ms         0.06%     105.029ms       1.153us       5.212ms         0.00%       5.212ms       0.057us         91070  
                                  hipDeviceGetAttribute         0.00%     311.715us         0.00%     311.715us       4.652us       4.874ms         0.00%       4.874ms      72.746us            67  
                                        aten::index_put         0.00%       2.056ms         0.01%      12.495ms     150.540us       0.000us         0.00%       4.857ms      58.517us            83  
                                      IndexPutBackward0         0.00%       1.065ms         0.01%      12.173ms     152.166us       0.000us         0.00%       4.857ms      60.711us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.352ms         0.00%       4.352ms      54.406us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       4.272ms         0.00%       4.272ms      53.400us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%       1.503ms         0.02%      26.783ms     334.787us       0.000us         0.00%       4.051ms      50.633us            80  
                                     _LayerNormBackward         0.00%       7.653ms         0.01%      25.280ms     315.994us       4.051ms         0.00%       4.051ms      50.633us            80  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     833.090us         0.00%       5.548ms      69.353us       0.000us         0.00%       3.656ms      45.696us            80  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     725.073us         0.00%       3.405ms      42.561us       0.000us         0.00%       3.622ms      45.280us            80  
                                          GeluBackward0         0.00%     558.405us         0.00%       2.680ms      33.498us       0.000us         0.00%       3.622ms      45.280us            80  
                                    aten::gelu_backward         0.00%       1.373ms         0.00%       2.121ms      26.518us       3.622ms         0.00%       3.622ms      45.280us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.622ms         0.00%       3.622ms      45.280us            80  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      17.246ms         1.15%        1.999s     199.887ms       0.000us         0.00%       3.553ms     355.309us            10  
                        compile_fx_inner (dynamo_timed)         0.05%      83.824ms         1.36%        2.367s     215.201ms       0.000us         0.00%       3.553ms     323.008us            11  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       3.016ms         0.00%       3.016ms       5.702us           529  
                                             aten::gelu         0.00%       4.239ms         0.01%      10.555ms      43.980us       2.705ms         0.00%       2.705ms      11.270us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.705ms         0.00%       2.705ms      26.008us           104  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       2.650ms         0.00%       2.650ms       5.487us           483  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       2.642ms         0.00%       2.642ms      11.007us           240  
                                              aten::div         0.01%      12.208ms         0.01%      15.757ms      23.730us       2.545ms         0.00%       2.545ms       3.833us           664  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.535ms         0.00%       2.535ms       6.635us           382  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.423ms         0.00%       2.423ms       5.796us           418  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     747.752us         0.01%       9.242ms      57.761us       0.000us         0.00%       2.325ms      14.532us           160  
                                         SliceBackward0         0.00%     653.008us         0.00%       8.494ms      53.088us       0.000us         0.00%       2.325ms      14.532us           160  
                                   aten::slice_backward         0.00%       1.250ms         0.00%       7.841ms      49.007us       0.000us         0.00%       2.325ms      14.532us           160  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.305ms         0.00%       2.305ms      12.327us           187  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.281ms         0.00%       2.281ms      21.930us           104  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.003ms         0.00%       2.003ms       6.504us           308  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.916ms         0.00%       1.916ms       7.885us           243  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.884ms         0.00%       1.884ms      18.112us           104  
      autograd::engine::evaluate_function: MulBackward0         0.01%      14.069ms         0.04%      65.990ms     383.664us       0.000us         0.00%       1.883ms      10.948us           172  
                                             _LayerNorm         0.00%       6.804ms         0.01%      11.864ms     148.297us       1.804ms         0.00%       1.804ms      22.547us            80  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.798ms         0.00%       1.798ms       7.400us           243  
                                               aten::lt         0.01%      20.445ms         0.01%      23.671ms      32.876us       1.793ms         0.00%       1.793ms       2.490us           720  
                               aten::cross_entropy_loss         0.00%       1.610ms         0.01%      21.445ms      89.354us       0.000us         0.00%       1.739ms       7.244us           240  
                                        SelectBackward0         0.00%     322.283us         0.00%       3.521ms      44.017us       0.000us         0.00%       1.690ms      21.128us            80  
                                  aten::select_backward         0.00%     599.088us         0.00%       3.199ms      39.988us       0.000us         0.00%       1.690ms      21.128us            80  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.688ms         0.00%       1.688ms      10.553us           160  
                                               aten::gt         0.02%      37.120ms         0.03%      44.813ms      10.323us       1.669ms         0.00%       1.669ms       0.385us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.667ms         0.00%       1.667ms       6.888us           242  
         GraphLowering.compile_to_module (dynamo_timed)         0.60%        1.048s         1.15%        2.016s     183.257ms       0.000us         0.00%       1.635ms     148.618us            11  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us       1.627ms         0.00%       1.627ms       6.694us           243  
                                          hipHostMalloc         0.09%     155.890ms         0.09%     155.923ms       4.725ms       1.603ms         0.00%       1.603ms      48.572us            33  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.427ms         0.00%       1.427ms       6.826us           209  
                                        aten::transpose         0.18%     306.180ms         0.22%     378.217ms       3.969us       0.000us         0.00%       1.419ms       0.015us         95285  
                                           MulBackward0         0.01%       9.667ms         0.02%      38.063ms     221.297us       0.000us         0.00%       1.395ms       8.111us           172  
      autograd::engine::evaluate_function: DivBackward0         0.00%       2.126ms         0.01%      10.510ms      65.688us       0.000us         0.00%       1.372ms       8.578us           160  
                                           DivBackward0         0.00%       1.511ms         0.00%       8.384ms      52.400us       0.000us         0.00%       1.372ms       8.578us           160  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.330ms         0.00%       1.330ms       7.230us           184  
                                           aten::__or__         0.00%       1.549ms         0.01%      23.842ms      49.671us       0.000us         0.00%       1.321ms       2.752us           480  
                                       aten::bitwise_or         0.01%       9.386ms         0.01%      22.293ms      46.444us       1.321ms         0.00%       1.321ms       2.752us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.321ms         0.00%       1.321ms       6.321us           209  
                                 c10d::_allgather_base_         0.00%     273.851us         0.00%       1.663ms     118.785us       0.000us         0.00%       1.285ms      91.811us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       1.285ms         0.00%       1.285ms     107.113us            12  
                                   hipDeviceSynchronize         0.00%     724.261us         0.00%     724.261us      21.302us       1.213ms         0.00%       1.213ms      35.685us            34  
      autograd::engine::evaluate_function: AddBackward0         0.01%      13.508ms         0.02%      29.884ms     116.736us       0.000us         0.00%       1.210ms       4.725us           256  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       2.121ms         0.01%      11.998ms     149.970us       0.000us         0.00%       1.207ms      15.091us            80  
                                       NllLossBackward0         0.00%       1.224ms         0.01%       9.877ms     123.459us       0.000us         0.00%       1.207ms      15.091us            80  
                                aten::nll_loss_backward         0.00%       3.509ms         0.00%       8.653ms     108.165us     619.586us         0.00%       1.207ms      15.091us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.154ms         0.00%       1.154ms       5.520us           209  
                            hipGetDevicePropertiesR0000         0.00%      64.703us         0.00%      64.703us       6.470us       1.105ms         0.00%       1.105ms     110.530us            10  
                                               aten::ge         0.00%       7.227ms         0.00%       8.402ms      17.504us       1.102ms         0.00%       1.102ms       2.296us           480  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.071ms         0.00%       1.071ms      13.388us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.040ms         0.00%       1.040ms      12.996us            80  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.031ms         0.00%       1.031ms      12.887us            80  
                                      aten::log_softmax         0.00%       1.232ms         0.00%       6.597ms      27.487us       0.000us         0.00%     917.746us       3.824us           240  
                                     aten::_log_softmax         0.00%       4.073ms         0.00%       5.219ms      21.744us     917.746us         0.00%     917.746us       3.824us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     917.746us         0.00%     917.746us       8.824us           104  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     889.184us         0.00%     889.184us       3.705us           240  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     864.549us         0.00%     864.549us       3.602us           240  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     853.612us         0.00%     853.612us       8.208us           104  
                                      aten::nll_loss_nd         0.00%     866.235us         0.01%      13.239ms      55.161us       0.000us         0.00%     820.857us       3.420us           240  
                                         aten::nll_loss         0.00%     950.247us         0.01%      12.372ms      51.551us       0.000us         0.00%     820.857us       3.420us           240  
                                 aten::nll_loss_forward         0.00%       4.814ms         0.01%      11.422ms      47.592us     763.084us         0.00%     820.857us       3.420us           240  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.490ms         0.02%      27.273ms     332.602us       0.000us         0.00%     773.820us       9.437us            82  
                                          TanhBackward0         0.00%       2.421ms         0.01%      25.783ms     314.427us       0.000us         0.00%     773.820us       9.437us            82  
                                    aten::tanh_backward         0.00%       3.349ms         0.01%      20.534ms     250.412us     773.820us         0.00%     773.820us       9.437us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     773.820us         0.00%     773.820us       9.673us            80  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     763.084us         0.00%     763.084us       7.337us           104  
                                             aten::item         0.02%      28.654ms         0.34%     597.397ms      35.561us       0.000us         0.00%     762.953us       0.045us         16799  
                              aten::_local_scalar_dense         0.01%      15.007ms         0.33%     568.744ms      33.856us     762.953us         0.00%     762.953us       0.045us         16799  
                                             aten::rsub         0.00%       3.657ms         0.01%      10.672ms     124.089us       0.000us         0.00%     710.516us       8.262us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     710.516us         0.00%     710.516us       8.881us            80  
                                             aten::tanh         0.01%      14.206ms         0.01%      24.493ms      90.381us     710.043us         0.00%     710.043us       2.620us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     710.043us         0.00%     710.043us       6.827us           104  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     695.325us         0.00%     695.325us       7.397us            94  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     692.506us         0.00%     692.506us       8.656us            80  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     684.006us         0.00%     684.006us       4.275us           160  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     619.586us         0.00%     619.586us       7.745us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     612.927us         0.00%     612.927us       5.894us           104  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     611.729us         0.00%     611.729us       7.647us            80  
                                              aten::log         0.00%       3.833ms         0.01%      10.086ms      42.026us     606.357us         0.00%     606.357us       2.526us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     606.357us         0.00%     606.357us       5.830us           104  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     592.122us         0.00%     592.122us       2.467us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     578.174us         0.00%     578.174us       5.559us           104  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     565.866us         0.00%     565.866us       7.073us            80  
                                          aten::normal_         0.75%        1.317s         0.76%        1.320s      12.688ms     528.217us         0.00%     528.217us       5.079us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     528.217us         0.00%     528.217us       5.446us            97  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     511.151us         0.00%     511.151us       2.130us           240  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     494.064us         0.00%     494.064us       6.176us            80  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     491.930us         0.00%     491.930us       6.149us            80  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       6.639ms         0.01%      12.671ms      79.193us     476.895us         0.00%     476.895us       2.981us           160  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     472.402us         0.00%     472.402us       4.499us           105  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     906.521us         0.00%       5.388ms      67.347us       0.000us         0.00%     470.442us       5.881us            80  
                                    LogSoftmaxBackward0         0.00%       1.109ms         0.00%       4.481ms      56.016us       0.000us         0.00%     470.442us       5.881us            80  
                       aten::_log_softmax_backward_data         0.00%       1.931ms         0.00%       3.373ms      42.157us     470.442us         0.00%     470.442us       5.881us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     470.442us         0.00%     470.442us       5.881us            80  
                                        aten::ones_like         0.00%     701.370us         0.00%       2.918ms      36.478us       0.000us         0.00%     418.720us       5.234us            80  
                                                hipFree         0.06%     106.406ms         0.06%     106.447ms       5.914ms     106.646us         0.00%     331.584us      18.421us            18  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     291.309us         0.00%     291.309us       3.641us            80  
                                       aten::is_nonzero         0.00%       8.444ms         0.01%      18.979ms       4.652us       0.000us         0.00%     265.732us       0.065us          4080  
                                   hipFuncGetAttributes         0.16%     284.764ms         0.16%     284.764ms       2.157ms     213.291us         0.00%     213.291us       1.616us           132  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     213.131us         0.00%     213.131us       3.675us            58  
                                              hipMemcpy         0.01%      15.164ms         0.01%      15.164ms     315.921us     180.214us         0.00%     180.214us       3.754us            48  
                                             aten::rand         0.00%       2.380ms         0.00%       5.841ms     417.181us       0.000us         0.00%     148.222us      10.587us            14  
                                         aten::uniform_         0.01%      11.392ms         0.01%      13.391ms       1.030ms     148.222us         0.00%     148.222us      11.402us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     148.222us         0.00%     148.222us      29.644us             5  
                                         _SplitAlongDim         0.09%     162.176ms         0.13%     232.480ms      40.361us       0.000us         0.00%     120.277us       0.021us          5760  
                               hipExtModuleLaunchKernel         0.19%     330.426ms         0.19%     330.478ms       8.425us       0.000us         0.00%     115.065us       0.003us         39224  
                                          aten::maximum         0.00%     120.599us         0.01%      23.173ms       2.575ms     102.277us         0.00%     102.277us      11.364us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     102.277us         0.00%     102.277us      11.364us             9  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      74.853us         0.00%      74.853us       7.485us            10  
                       Scheduler.codegen (dynamo_timed)         0.08%     142.544ms         0.08%     142.571ms      12.961ms       0.000us         0.00%      64.628us       5.875us            11  
                                       aten::lift_fresh         0.03%      53.978ms         0.03%      60.410ms      34.207us       0.000us         0.00%      45.786us       0.026us          1766  
                                    hipFuncSetAttribute         0.00%      10.894us         0.00%      10.894us       0.454us      40.093us         0.00%      40.093us       1.671us            24  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      31.591us         0.00%      31.591us       3.159us            10  
                                       aten::reciprocal         0.00%     163.835us         0.01%      11.808ms       1.181ms      29.987us         0.00%      29.987us       2.999us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      29.987us         0.00%      29.987us       2.999us            10  
                                              aten::min         0.00%     165.633us         0.00%       4.821ms     964.238us      14.273us         0.00%      14.273us       2.855us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      14.273us         0.00%      14.273us       4.758us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      12.830us         0.00%      12.830us       4.277us             3  
                                     hipExtLaunchKernel         0.07%     128.221ms         0.07%     128.239ms      13.107us       0.000us         0.00%      11.266us       0.001us          9784  
                                              aten::all         0.05%      84.028ms         0.05%      95.426ms      16.293us       0.000us         0.00%       9.582us       0.002us          5857  
                                    aten::empty_strided         0.22%     384.640ms         0.23%     393.240ms       4.436us       0.000us         0.00%       3.688us       0.000us         88647  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.406us         0.00%       2.406us       2.406us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       1.764us         0.00%       1.764us       1.764us             1  
                                            aten::empty         0.58%        1.007s         0.58%        1.013s       3.860us       0.000us         0.00%       0.000us       0.000us        262555  
                        hipDeviceGetStreamPriorityRange         0.00%       2.249us         0.00%       2.249us       2.249us       0.000us         0.00%       0.000us       0.000us             1  
                                              hipMalloc         0.01%      19.323ms         0.01%      19.323ms     117.824us       0.000us         0.00%       0.000us       0.000us           164  
                            hipStreamCreateWithPriority         0.00%     605.358us         0.00%     605.358us     100.893us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.262s      74.926us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      16.667ms         0.01%      16.667ms       1.703us       0.000us         0.00%       0.000us       0.000us          9786  
                               TorchDynamo Cache Lookup         0.13%     230.109ms         0.13%     230.134ms      11.973us       0.000us         0.00%       0.000us       0.000us         19221  
                                           aten::detach         0.04%      77.270ms         0.13%     231.879ms       6.536us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.07%     124.402ms         0.08%     147.599ms       4.364us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.01%       9.853ms         0.01%      18.017ms     145.300us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.04%      77.930ms         0.06%     103.587ms       2.859us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     325.817us         0.00%     437.432us      54.679us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.16%     275.249ms         0.16%     275.593ms       0.819us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%       1.172ms         0.00%       1.697ms      89.307us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     544.021us         0.00%       1.075ms      25.604us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     797.287us         0.00%       1.089ms      77.770us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     101.606us         0.00%     144.670us      72.335us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       3.737ms         0.00%       7.724ms     203.261us       0.000us         0.00%       0.000us       0.000us            38  
                                             aten::view         0.20%     352.528ms         0.21%     360.851ms       2.495us       0.000us         0.00%       0.000us       0.000us        144633  
                                         prims::view_of         0.00%     581.269us         0.00%     750.969us      31.290us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       6.369ms         0.00%       6.486ms       6.763us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       7.381ms         0.00%       8.649ms      10.718us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%       1.268ms         0.00%       1.268ms       1.571us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     411.575us         0.00%     411.575us      13.277us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     116.687us         0.00%     116.687us      10.608us       0.000us         0.00%       0.000us       0.000us            11  
                                           AddBackward0         0.00%     986.276us         0.00%     986.276us       3.853us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     245.572us         0.00%     343.549us     114.516us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     133.606us         0.00%     133.606us      66.803us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     181.978us         0.00%     196.318us      98.159us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      37.925us         0.00%      37.925us       2.709us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.631ms         0.00%       3.195ms     639.025us       0.000us         0.00%       0.000us       0.000us             5  
                                            aten::slice         0.06%     100.552ms         0.07%     119.951ms       4.593us       0.000us         0.00%       0.000us       0.000us         26118  
                                        aten::index_add         0.00%     332.879us         0.00%       1.892ms       1.892ms       0.000us         0.00%       0.000us       0.000us             1  
                                       aten::empty_like         0.12%     214.305ms         0.35%     619.636ms       6.968us       0.000us         0.00%       0.000us       0.000us         88930  
                                        aten::new_empty         0.00%     675.518us         0.00%     760.585us     380.292us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     331.588us         0.00%     331.588us     331.588us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.12%     212.192ms         0.12%     215.230ms      19.566ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.10%     175.539ms         0.10%     175.605ms      15.964ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.01%       9.378ms         0.01%       9.378ms     852.558us       0.000us         0.00%       0.000us       0.000us            11  
                                    hipModuleLoadDataEx         0.38%     654.657ms         0.38%     654.657ms      50.358ms       0.000us         0.00%       0.000us       0.000us            13  
                                    hipFuncGetAttribute         0.00%       6.881us         0.00%       6.881us       0.573us       0.000us         0.00%       0.000us       0.000us            12  
                                 hipPointerGetAttribute         0.03%      60.780ms         0.03%      60.780ms       0.977us       0.000us         0.00%       0.000us       0.000us         62234  
                                        aten::expand_as         0.00%       1.133ms         0.00%       3.895ms       7.172us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.675ms         0.00%       5.901ms     536.434us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     124.277us         0.00%     141.977us      70.989us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     137.037us         0.00%     137.037us      68.518us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      69.007us         0.00%      97.253us      97.253us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     377.443us         0.00%       3.196ms       1.065ms       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     272.027us         0.00%     307.182us     102.394us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.382ms         0.00%       4.024ms     670.663us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%     932.425us         0.00%       4.417ms     490.798us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.373ms         0.00%       2.944ms     490.651us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     341.510us         0.00%     872.980us     290.993us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     249.288us         0.00%       1.182ms     394.115us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     511.595us         0.00%     933.057us     311.019us       0.000us         0.00%       0.000us       0.000us             3  
                                           aten::select         0.23%     404.525ms         0.28%     492.883ms       5.035us       0.000us         0.00%       0.000us       0.000us         97887  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     402.948us         0.00%     423.276us     105.819us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.07%     120.906ms         0.07%     121.254ms       3.499us       0.000us         0.00%       0.000us       0.000us         34655  
                                               aten::eq         0.03%      44.239ms         0.03%      44.239ms       7.553us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       4.372ms         0.00%       4.372ms       0.179us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     894.763us      63.912us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.756ms         0.01%      13.499ms       6.013us       0.000us         0.00%       0.000us       0.000us          2245  
                                          aten::reshape         0.07%     127.980ms         0.13%     228.708ms       5.293us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      72.980ms     151.726us       0.000us         0.00%       0.000us       0.000us           481  
                                           aten::narrow         0.00%       8.370ms         0.02%      29.101ms      11.023us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.02%      34.030ms         0.02%      41.273ms       5.608us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.458ms         0.00%       3.115ms       4.327us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      41.049ms         0.03%      49.307ms       6.163us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       2.429us         0.00%       2.429us       0.347us       0.000us         0.00%       0.000us       0.000us             7  
                              hipDevicePrimaryCtxRetain         0.00%       3.056us         0.00%       3.056us       0.437us       0.000us         0.00%       0.000us       0.000us             7  
                             hipDevicePrimaryCtxRelease         0.00%       1.985us         0.00%       1.985us       0.284us       0.000us         0.00%       0.000us       0.000us             7  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      57.289ms         0.03%      57.289ms       3.169us       0.000us         0.00%       0.000us       0.000us         18080  
                                              hipMemset         0.00%      29.769us         0.00%      29.769us      14.884us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.29%     506.243ms         0.29%     506.243ms     168.748ms       0.000us         0.00%       0.000us       0.000us             3  
                                 aten::split_with_sizes         0.03%      54.242ms         0.04%      70.256ms      12.197us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      39.394ms         0.02%      39.394ms       2.565us       0.000us         0.00%       0.000us       0.000us         15360  
                                          aten::squeeze         0.05%      79.966ms         0.05%      95.460ms       4.143us       0.000us         0.00%       0.000us       0.000us         23040  
                                      hipModuleLoadData         0.31%     543.774ms         0.31%     543.774ms     135.943ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     898.012us         0.00%       2.082ms     520.441us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       7.214ms         0.00%       8.522ms      35.510us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     982.671us         0.00%     982.671us       3.071us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.03%      59.445ms         0.09%     163.516ms      10.428us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      25.855ms         0.06%     104.071ms       6.637us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     534.791us         0.00%       3.740ms      46.748us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.456ms         0.00%       3.205ms      40.063us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.05%      80.501ms         0.10%     181.646ms       8.536us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.02%      27.491ms         0.06%     101.145ms       4.753us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.03%      51.798ms         0.07%     118.169ms       4.891us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.127ms         0.00%       2.786ms      11.608us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     405.136us         0.00%       1.659ms       6.912us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     411.616us         0.00%       1.204ms      15.056us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     792.849us         0.00%     792.849us       9.911us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%       1.020ms         0.22%     386.606ms     386.606ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.02%      27.828ms         0.02%      31.527ms       4.104us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       3.698ms         0.00%       3.698ms       0.481us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       7.767ms         0.02%      27.835ms      13.918us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       5.556ms         0.01%      20.068ms      10.034us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       6.330ms         0.01%      16.943ms       8.825us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       2.936ms         0.01%      10.614ms       5.528us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     494.695us         0.00%     494.695us       0.258us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.250ms         0.00%       3.333ms      41.657us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       2.083ms         0.00%       2.083ms      26.032us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       2.098ms         0.00%       2.894ms      36.180us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       1.870ms     187.037us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      15.837us         0.00%      30.649us       7.662us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 174.569s
Self CUDA time total: 158.822s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       81.761s        51.10%       81.761s       81.761s             1  
                                             bert_train        37.08%       65.156s        70.08%      123.149s      123.149s       0.000us         0.00%       39.366s       39.366s             1  
                                            aten::copy_        13.52%       23.750s        15.87%       27.894s     353.921us       16.657s        10.41%       16.696s     211.841us         78815  
                                     record_param_comms         2.51%        4.402s         3.92%        6.879s     198.169us        8.664s         5.42%       13.162s     379.144us         34714  
                                               aten::to         0.04%      66.743ms        15.86%       27.860s     530.772us       0.000us         0.00%       12.126s     231.025us         52489  
                                         aten::_to_copy         0.11%     190.560ms        15.82%       27.793s     641.203us       0.000us         0.00%       12.126s     279.762us         43345  
                                      aten::masked_fill         0.05%      79.146ms         0.27%     472.290ms      49.197us       0.000us         0.00%       11.817s       1.231ms          9600  
                                     aten::masked_fill_         0.11%     193.726ms         0.25%     444.842ms      27.125us       10.949s         6.84%       10.949s     667.643us         16400  
                                       c10d::allreduce_         0.25%     441.198ms         2.22%        3.901s     232.034us       0.000us         0.00%        8.981s     534.217us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        8.628s         5.39%        8.628s     910.843us          9472  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        8.517s         5.32%        8.517s     890.831us          9561  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      19.788ms         0.12%     206.621ms      53.807us       0.000us         0.00%        7.866s       2.048ms          3840  
                                    MaskedFillBackward0         0.00%       8.028ms         0.11%     186.832ms      48.654us       0.000us         0.00%        7.866s       2.048ms          3840  
autograd::engine::evaluate_function: _LayerNormLinea...         0.06%      98.833ms         2.60%        4.570s       1.190ms       0.000us         0.00%        7.643s       1.990ms          3840  
                               _LayerNormLinearBackward         1.62%        2.839s         2.51%        4.408s       1.148ms     466.457ms         0.29%        7.493s       1.951ms          3840  
                                              aten::bmm         0.29%     514.797ms         0.35%     616.407ms      45.864us        7.207s         4.50%        7.207s     536.238us         13440  
autograd::engine::evaluate_function: SoftmaxBackward...         0.01%       8.892ms         0.04%      76.947ms      40.077us       0.000us         0.00%        6.483s       3.377ms          1920  
                                       SoftmaxBackward0         0.00%       7.538ms         0.04%      68.055ms      35.446us       0.000us         0.00%        6.483s       3.377ms          1920  
                           aten::_softmax_backward_data         0.01%      21.547ms         0.03%      60.518ms      31.520us        3.351s         2.09%        6.483s       3.377ms          1920  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.443s         4.03%        6.443s       1.455ms          4428  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.156s         3.85%        6.156s     755.082us          8153  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.817s         3.64%        5.817s       1.265ms          4598  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      14.962ms         0.05%      96.493ms      24.616us       0.000us         0.00%        5.150s       1.314ms          3920  
                                        ToCopyBackward0         0.00%       7.269ms         0.05%      81.530ms      20.799us       0.000us         0.00%        5.150s       1.314ms          3920  
                                            aten::clone         0.07%     124.646ms         0.45%     792.340ms      22.936us       0.000us         0.00%        4.566s     132.162us         34546  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.503s         2.81%        4.503s     976.198us          4613  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.455s         2.78%        4.455s     559.744us          7959  
                                     tex_ts::te_gemm_ts         1.34%        2.359s         1.97%        3.459s      90.076us        4.326s         2.70%        4.334s     112.854us         38400  
                                          aten::softmax         0.01%      14.052ms         0.09%     156.900ms      27.240us       0.000us         0.00%        4.319s     749.882us          5760  
                                         aten::_softmax         0.05%      85.865ms         0.08%     142.838ms      24.798us        4.319s         2.70%        4.319s     749.882us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.319s         2.70%        4.319s       1.722ms          2508  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.870s         2.42%        3.870s     873.894us          4428  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.732s         2.33%        3.732s     323.939us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.351s         2.09%        3.351s       1.745ms          1920  
                                              aten::mul         0.09%     164.521ms         0.13%     233.969ms      29.352us        3.172s         1.98%        3.172s     397.948us          7971  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      19.210ms         0.13%     223.890ms     116.609us       0.000us         0.00%        3.169s       1.651ms          1920  
                                       BaddbmmBackward0         0.01%      20.769ms         0.12%     204.680ms     106.604us       0.000us         0.00%        3.169s       1.651ms          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.135s         1.96%        3.135s       1.429ms          2193  
                                                _Linear         1.15%        2.028s         1.70%        2.984s     777.005us     145.835ms         0.09%        2.727s     710.238us          3840  
                                       c10d::broadcast_         0.02%      37.853ms         0.46%     806.059ms       1.676ms       0.000us         0.00%        2.519s       5.238ms           481  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.848s         1.15%        1.848s     407.704us          4532  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      22.657ms         0.13%     220.816ms     115.008us       0.000us         0.00%        1.794s     934.237us          1920  
                                           BmmBackward0         0.01%      14.228ms         0.11%     198.159ms     103.208us       0.000us         0.00%        1.794s     934.237us          1920  
                                   hipDeviceGetPCIBusId         0.01%      13.404ms         0.01%      13.404ms       0.863us        1.771s         1.11%        1.771s     113.980us         15539  
                                       aten::logical_or         0.07%     121.935ms         0.21%     363.539ms      31.557us     874.933ms         0.55%        1.751s     151.964us         11520  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      41.984ms         1.35%        2.367s     616.403us       0.000us         0.00%        1.726s     449.489us          3840  
                                        _LinearBackward         0.98%        1.728s         1.32%        2.325s     605.470us     203.072ms         0.13%        1.726s     449.489us          3840  
                                          c10d::barrier         0.00%     819.717us         0.92%        1.614s      42.476ms       0.000us         0.00%        1.550s      40.796ms            38  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.544s         0.96%        1.544s     804.013us          1920  
                                              aten::sub         0.06%     113.094ms         0.08%     144.413ms      21.981us        1.520s         0.95%        1.520s     231.378us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.518s         0.95%        1.518s     605.166us          2508  
                                          aten::dropout         0.01%      11.460ms         0.06%     113.975ms      18.948us       0.000us         0.00%        1.483s     246.626us          6015  
                                   aten::native_dropout         0.02%      38.522ms         0.06%      97.599ms      48.581us        1.483s         0.93%        1.483s     738.404us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.483s         0.93%        1.483s     741.574us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      12.499ms         0.04%      76.157ms      38.022us       0.000us         0.00%        1.402s     699.848us          2003  
                                 NativeDropoutBackward0         0.00%       7.589ms         0.04%      63.658ms      31.781us       0.000us         0.00%        1.402s     699.848us          2003  
                          aten::native_dropout_backward         0.01%      22.348ms         0.03%      56.069ms      27.993us        1.402s         0.88%        1.402s     699.848us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.402s         0.88%        1.402s     700.898us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.376s         0.86%        1.376s      80.248us         17143  
                                   hipStreamIsCapturing         0.03%      50.356ms         0.03%      50.361ms       1.000us        1.257s         0.79%        1.257s      24.941us         50383  
                                          aten::baddbmm         0.23%     408.434ms         0.50%     874.239ms     151.778us        1.149s         0.72%        1.149s     199.565us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.133s         0.71%        1.133s     589.889us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      25.237ms         0.64%        1.121s     291.964us       0.000us         0.00%     998.033ms     259.904us          3840  
                               CompiledFunctionBackward         0.31%     540.139ms         0.62%        1.096s     285.392us       0.000us         0.00%     998.033ms     259.904us          3840  
                                 triton_red_fused_sum_1         0.02%      39.575ms         0.04%      63.649ms      16.575us     893.243ms         0.56%     893.243ms     232.615us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     874.933ms         0.55%     874.933ms     348.857us          2508  
                                     hipIpcGetMemHandle         0.01%      11.770ms         0.01%      11.770ms       6.579us     851.455ms         0.53%     851.455ms     475.939us          1789  
                                      aten::logical_not         0.09%     161.344ms         0.27%     471.721ms      20.474us     318.820ms         0.20%     637.661ms      27.676us         23040  
                                        hipEventDestroy         0.03%      56.457ms         0.03%      57.098ms       2.881us     597.455ms         0.37%     602.438ms      30.395us         19820  
                                  hipExtMallocWithFlags         0.03%      51.037ms         0.03%      51.037ms      11.897us     597.034ms         0.37%     597.034ms     139.169us          4290  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.849ms         0.00%       2.849ms       0.199us     564.992ms         0.35%     564.992ms      39.565us         14280  
                                      hipGetProcAddress         0.05%      80.872ms         0.05%      80.878ms       1.041us     450.121ms         0.28%     450.121ms       5.796us         77665  
                                  Torch-Compiled Region         0.57%     997.345ms         1.65%        2.901s     150.951us       0.000us         0.00%     421.685ms      21.940us         19220  
                                       _LayerNormLinear         0.34%     598.817ms         1.02%        1.796s     467.757us     262.658ms         0.16%     400.551ms     104.310us          3840  
                                       hipCtxGetCurrent         0.01%      11.807ms         0.01%      11.807ms       0.200us     381.600ms         0.24%     381.600ms       6.468us         58999  
                                             aten::add_         0.10%     170.301ms         0.17%     305.034ms       9.708us     348.296ms         0.22%     348.296ms      11.085us         31420  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     318.820ms         0.20%     318.820ms      63.561us          5016  
                                       CompiledFunction         0.65%        1.144s         0.94%        1.652s     143.166us       0.000us         0.00%     314.376ms      27.242us         11540  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     293.145ms         0.18%     293.145ms      58.442us          5016  
                                              aten::sum         0.23%     403.399ms         0.48%     838.493ms      41.198us     220.273ms         0.14%     291.730ms      14.334us         20353  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     285.317ms         0.18%     285.317ms     285.317ms             1  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     264.184ms         0.17%     264.184ms      45.865us          5760  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     259.891ms         0.16%     259.891ms      67.680us          3840  
                  triton_poi_fused_add_native_dropout_0         0.04%      77.584ms         0.07%     118.594ms      30.804us     238.170ms         0.15%     238.170ms      61.862us          3850  
autograd::engine::evaluate_function: torch::autograd...         0.19%     335.598ms         0.38%     660.541ms      27.340us       0.000us         0.00%     197.166ms       8.161us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     195.416ms         0.12%     195.416ms       8.170us         23920  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     167.999ms         0.11%     167.999ms      32.710us          5136  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     166.844ms         0.10%     166.844ms      33.262us          5016  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.02%      28.496ms         0.40%     704.734ms     367.049us       0.000us         0.00%     160.475ms      83.581us          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     160.396ms         0.10%     160.396ms      36.044us          4450  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     145.321ms         0.09%     145.321ms     688.725us           211  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.565ms         0.07%     117.001ms       1.463ms       0.000us         0.00%     139.577ms       1.745ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      20.155ms         0.07%     115.436ms       1.443ms       0.000us         0.00%     139.577ms       1.745ms            80  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     138.332ms         0.09%     138.332ms      35.289us          3920  
                             _VocabParallelCrossEntropy         0.05%      81.743ms         0.17%     295.280ms       1.230ms       0.000us         0.00%     138.039ms     575.164us           240  
                                              aten::cat         0.09%     165.216ms         0.12%     214.255ms      26.517us     137.450ms         0.09%     137.527ms      17.021us          8080  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.191ms        23.50%       41.299s     172.081ms       0.000us         0.00%     130.338ms     543.074us           240  
                                     EmbeddingBackward0         0.00%       2.672ms        23.50%       41.292s     172.050ms       0.000us         0.00%     129.310ms     538.792us           240  
                               aten::embedding_backward         0.00%       3.129ms        23.50%       41.289s     172.038ms       0.000us         0.00%     129.310ms     538.792us           240  
                         aten::embedding_dense_backward         1.16%        2.032s        23.50%       41.286s     172.025ms     122.774ms         0.08%     129.310ms     538.792us           240  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     119.725ms         0.07%     119.725ms      11.812us         10136  
                                         hipMemsetAsync         0.06%     111.263ms         0.06%     111.292ms       9.400us     117.948ms         0.07%     117.948ms       9.963us         11839  
                                       aten::contiguous         0.02%      29.298ms         0.31%     536.950ms      23.305us       0.000us         0.00%     116.757ms       5.068us         23040  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      18.049ms         0.14%     250.504ms     130.471us       0.000us         0.00%     116.358ms      60.603us          1920  
                                 _SplitAlongDimBackward         0.10%     178.063ms         0.13%     232.455ms     121.070us       0.000us         0.00%     116.358ms      60.603us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     116.358ms         0.07%     116.358ms      60.603us          1920  
                         _ReduceFromModelParallelRegion         0.01%      25.834ms         0.04%      68.430ms     285.124us       0.000us         0.00%     115.517ms     481.323us           240  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     113.995ms         0.07%     113.995ms      52.776us          2160  
                             c10d::allreduce_coalesced_         0.00%       1.847ms         0.06%     106.169ms      10.617ms       0.000us         0.00%     110.212ms      11.021ms            10  
                                         hipMemcpyAsync         0.11%     196.242ms         0.11%     196.274ms      16.164us     109.601ms         0.07%     109.616ms       9.027us         12143  
             triton_poi_fused_native_dropout_backward_0         0.04%      72.299ms         0.06%     106.192ms      27.654us     104.789ms         0.07%     104.789ms      27.289us          3840  
                                   hipStreamSynchronize         0.39%     678.284ms         0.39%     678.311ms     208.775us     101.697ms         0.06%     101.709ms      31.305us          3249  
                                               aten::mm         0.03%      54.342ms         0.06%     107.566ms     122.235us      99.651ms         0.06%      99.651ms     113.240us           880  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      92.723ms         0.06%      92.723ms      36.971us          2508  
                                    hipIpcOpenMemHandle         0.06%     106.416ms         0.06%     106.416ms      59.285us      83.516ms         0.05%      83.516ms      46.527us          1795  
                                           aten::matmul         0.00%       3.332ms         0.05%      82.206ms     205.515us       0.000us         0.00%      82.832ms     207.081us           400  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      82.484ms         0.05%      82.484ms      10.963us          7524  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      79.320ms         0.05%      79.320ms      41.312us          1920  
                                           aten::arange         0.08%     145.999ms         0.24%     415.610ms      16.867us      39.359ms         0.02%      78.718ms       3.195us         24640  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      76.236ms         0.05%      76.236ms       6.451us         11817  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      74.528ms         0.05%      74.528ms      29.716us          2508  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.22%     388.811ms         0.39%     678.276ms      88.317us      72.982ms         0.05%      74.489ms       9.699us          7680  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      73.693ms         0.05%      73.693ms      18.799us          3920  
                               hipStreamCreateWithFlags         0.24%     424.182ms         0.24%     424.182ms     156.294us      70.556ms         0.04%      70.556ms      25.997us          2714  
                                       hipStreamDestroy         0.04%      66.654ms         0.04%      66.654ms      24.742us      69.895ms         0.04%      69.895ms      25.945us          2694  
                                  hipModuleLaunchKernel         0.13%     228.588ms         0.13%     228.609ms       6.747us      67.869ms         0.04%      67.869ms       2.003us         33884  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      66.979ms         0.04%      66.979ms     279.079us           240  
                                 hipDeviceCanAccessPeer         0.00%     363.814us         0.00%     363.814us       0.181us      65.704ms         0.04%      65.704ms      32.656us          2012  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      60.918ms         0.04%      60.918ms      15.864us          3840  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      60.432ms         0.04%      60.432ms      13.838us          4367  
                                    hipMemcpyWithStream        25.70%       45.162s        25.70%       45.166s      57.099ms       0.000us         0.00%      58.136ms      73.497us           791  
                        triton_poi_fused_add_mul_tanh_0         0.08%     135.546ms         0.09%     158.024ms      27.387us      57.724ms         0.04%      57.781ms      10.014us          5770  
                                           GeLUFunction         0.10%     180.710ms         0.63%        1.109s     192.503us       0.000us         0.00%      57.678ms      10.014us          5760  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      54.526ms         0.03%      54.526ms      28.399us          1920  
        LinearWithGradAccumulationAndAsyncCommunication         0.01%       9.482ms         0.02%      29.236ms     121.815us       0.000us         0.00%      48.577ms     202.405us           240  
                                   GeLUFunctionBackward         0.03%      58.839ms         0.34%     590.571ms     307.589us       0.000us         0.00%      47.031ms      24.495us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      34.644ms         0.03%      52.984ms      27.596us      47.031ms         0.03%      47.031ms      24.495us          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      38.990ms         0.02%      38.990ms       7.773us          5016  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      36.714ms         0.02%      36.714ms       9.561us          3840  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      36.399ms         0.02%      36.399ms       7.257us          5016  
                                          aten::randint         0.02%      35.701ms         0.08%     137.612ms      35.706us       0.000us         0.00%      34.789ms       9.027us          3854  
                                 triton_poi_fused_add_0         0.14%     237.875ms         0.14%     251.734ms      32.778us      34.727ms         0.02%      34.727ms       4.522us          7680  
                                          aten::random_         0.03%      55.218ms         0.06%      99.238ms      25.776us      31.698ms         0.02%      33.036ms       8.581us          3850  
                                            aten::fill_         0.08%     143.238ms         0.10%     175.093ms       6.055us      32.163ms         0.02%      32.163ms       1.112us         28919  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      31.698ms         0.02%      31.698ms       8.233us          3850  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      30.775ms         0.02%      30.775ms      12.271us          2508  
                                            aten::zero_         0.04%      78.647ms         0.14%     242.480ms      10.707us       0.000us         0.00%      28.949ms       1.278us         22646  
                                     hipStreamWaitEvent         0.17%     304.269ms         0.17%     304.334ms      14.844us      27.137ms         0.02%      28.741ms       1.402us         20502  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      28.021ms         0.02%      28.021ms     175.134us           160  
                                            aten::zeros         0.05%      82.777ms         0.21%     367.264ms      16.391us       0.000us         0.00%      27.621ms       1.233us         22406  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.333ms         0.03%      49.521ms     619.011us       0.000us         0.00%      27.219ms     340.241us            80  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.126ms         0.02%      24.126ms     301.577us            80  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.837ms         0.03%      49.686ms     207.024us       0.000us         0.00%      23.669ms      98.621us           240  
                                 tex_ts::cast_to_fp8_ts         0.08%     148.476ms         0.13%     224.045ms      29.172us      23.090ms         0.01%      23.190ms       3.020us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      23.090ms         0.01%      23.090ms      19.634us          1176  
                                              aten::exp         0.00%       3.350ms         0.01%      21.571ms      89.879us      22.902ms         0.01%      22.902ms      95.424us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      22.902ms         0.01%      22.902ms     220.209us           104  
                                              aten::add         0.05%      83.298ms         0.07%     119.586ms      66.920us      21.338ms         0.01%      22.168ms      12.405us          1787  
                                  hipMemGetAddressRange         0.00%     183.177us         0.00%     183.177us       0.408us      21.285ms         0.01%      21.285ms      47.405us           449  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      21.092ms         0.01%      21.092ms       7.609us          2772  
                                             aten::div_         0.00%       6.436ms         0.01%      14.424ms      30.050us      20.324ms         0.01%      20.324ms      42.341us           480  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      20.208ms         0.01%      20.208ms      97.151us           208  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.572ms         0.01%      19.572ms     188.193us           104  
                                           aten::linear         0.00%       3.794ms         0.03%      60.997ms      84.718us       0.000us         0.00%      19.558ms      27.165us           720  
                                            aten::addmm         0.03%      44.481ms         0.03%      51.479ms      71.498us      19.558ms         0.01%      19.558ms      27.165us           720  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.445ms         0.01%      19.445ms       7.753us          2508  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      18.713ms         0.01%      18.713ms      29.330us           638  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      18.694ms         0.01%      18.694ms       7.412us          2522  
                                           aten::cumsum         0.07%     120.322ms         0.08%     149.139ms      25.892us      18.364ms         0.01%      18.651ms       3.238us          5760  
                                             aten::sub_         0.00%       4.962ms         0.00%       6.353ms      19.852us      18.560ms         0.01%      18.560ms      58.000us           320  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      18.364ms         0.01%      18.364ms       7.322us          2508  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      18.047ms         0.01%      18.047ms     173.530us           104  
                     _VocabParallelCrossEntropyBackward         0.01%      18.344ms         0.03%      44.029ms     550.359us       0.000us         0.00%      16.837ms     210.458us            80  
                                         AddmmBackward0         0.00%       3.046ms         0.02%      38.175ms     159.064us       0.000us         0.00%      16.819ms      70.078us           240  
                                            aten::index         0.01%      13.766ms         0.04%      71.720ms     126.490us       2.198ms         0.00%      16.693ms      29.441us           567  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      16.685ms         0.01%      16.685ms     160.437us           104  
                                        aten::embedding         0.00%       7.058ms         0.02%      30.014ms      41.686us       0.000us         0.00%      16.479ms      22.888us           720  
                                     aten::index_select         0.01%      13.033ms         0.01%      20.118ms      27.941us      16.399ms         0.01%      16.479ms      22.888us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.399ms         0.01%      16.399ms      52.060us           315  
                                          aten::nonzero         0.00%       4.725ms         0.02%      38.896ms     158.758us      14.494ms         0.01%      14.494ms      59.161us           245  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.225ms         0.01%      13.225ms      82.654us           160  
                                             aten::mul_         0.00%       6.650ms         0.00%       7.386ms       5.771us      12.654ms         0.01%      12.654ms       9.886us          1280  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      11.963ms         0.01%      11.963ms     115.028us           104  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.423ms         0.01%      11.423ms     109.841us           104  
                                       aten::index_put_         0.00%       6.038ms         0.11%     193.404ms     172.683us       0.000us         0.00%      10.965ms       9.790us          1120  
                                 aten::_index_put_impl_         0.00%       8.347ms         0.11%     187.366ms     167.291us     996.094us         0.00%      10.965ms       9.790us          1120  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       9.907ms         0.01%       9.907ms      41.281us           240  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.646ms         0.01%       9.646ms      40.192us           240  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.234ms         0.01%      12.874ms     160.922us       0.000us         0.00%       8.909ms     111.359us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.672ms         0.01%      10.640ms     133.003us       8.909ms         0.01%       8.909ms     111.359us            80  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.051ms         0.02%      28.263ms     353.291us       0.000us         0.00%       8.784ms     109.805us            80  
                            torch::autograd::CopySlices         0.00%       4.224ms         0.01%      26.213ms     327.659us       0.000us         0.00%       8.784ms     109.805us            80  
                                              aten::max         0.00%       7.444ms         0.02%      32.687ms     128.688us       8.665ms         0.01%       8.764ms      34.502us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.652ms         0.01%       8.652ms      83.191us           104  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.590ms         0.01%       8.590ms      20.850us           412  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       8.437ms         0.01%       8.437ms      12.299us           686  
                           FusedLayerNormAffineFunction         0.01%      13.671ms         0.01%      23.111ms      96.297us       7.707ms         0.00%       7.707ms      32.112us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.707ms         0.00%       7.707ms      74.106us           104  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     441.232us         0.00%       2.077ms     207.683us       6.909ms         0.00%       6.909ms     690.943us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.909ms         0.00%       6.909ms      62.813us           110  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       6.821ms         0.00%       6.821ms       7.105us           960  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       6.727ms         0.00%       6.727ms      28.031us           240  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.713ms         0.00%       6.713ms      83.913us            80  
         _compile.<locals>.compile_inner (dynamo_timed)         0.08%     148.467ms         2.04%        3.577s     357.741ms       0.000us         0.00%       6.217ms     621.710us            10  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      33.999ms         1.92%        3.378s     337.840ms       0.000us         0.00%       6.204ms     620.399us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.39%     684.759ms         1.90%        3.344s     334.440ms       0.000us         0.00%       6.204ms     620.399us            10  
                            hipGetDevicePropertiesR0600         0.05%      91.264ms         0.05%      91.264ms       1.000us       5.350ms         0.00%       5.350ms       0.059us         91266  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       5.227ms         0.00%       5.227ms      32.670us           160  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.031ms         0.00%       5.031ms       5.572us           903  
                                        aten::index_put         0.00%       1.986ms         0.01%      12.185ms     146.807us       0.000us         0.00%       4.662ms      56.174us            83  
                                      IndexPutBackward0         0.00%       1.129ms         0.01%      11.843ms     148.039us       0.000us         0.00%       4.662ms      58.281us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.214ms         0.00%       4.214ms      52.671us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       4.163ms         0.00%       4.163ms      52.031us            80  
                                    hipFuncSetAttribute         0.00%       9.824us         0.00%       9.824us       0.409us       4.005ms         0.00%       4.005ms     166.884us            24  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%       1.043ms         0.01%      22.876ms     285.951us       0.000us         0.00%       3.857ms      48.215us            80  
                                     _LayerNormBackward         0.00%       5.873ms         0.01%      21.833ms     272.912us       3.857ms         0.00%       3.857ms      48.215us            80  
                                         _SplitAlongDim         0.09%     154.693ms         0.13%     223.267ms      38.762us       0.000us         0.00%       3.551ms       0.616us          5760  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     690.552us         0.00%       3.020ms      37.748us       0.000us         0.00%       3.451ms      43.139us            80  
                                          GeluBackward0         0.00%     459.682us         0.00%       2.329ms      29.116us       0.000us         0.00%       3.451ms      43.139us            80  
                                    aten::gelu_backward         0.00%       1.231ms         0.00%       1.870ms      23.370us       3.451ms         0.00%       3.451ms      43.139us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.451ms         0.00%       3.451ms      43.139us            80  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     749.289us         0.00%       4.846ms      60.570us       0.000us         0.00%       3.324ms      41.551us            80  
                                  hipDeviceGetAttribute         0.00%     263.702us         0.00%     263.702us       3.936us       3.304ms         0.00%       3.304ms      49.306us            67  
                                   hipDeviceSynchronize         0.00%     573.187us         0.00%     573.187us      16.858us       3.282ms         0.00%       3.282ms      96.539us            34  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       3.056ms         0.00%       3.056ms       6.326us           483  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.960ms         0.00%       2.960ms       5.595us           529  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      17.630ms         1.27%        2.223s     222.349ms       0.000us         0.00%       2.912ms     291.247us            10  
                        compile_fx_inner (dynamo_timed)         0.05%      84.539ms         1.47%        2.591s     235.526ms       0.000us         0.00%       2.912ms     264.770us            11  
                                        hipLaunchKernel         0.79%        1.387s         0.79%        1.387s       9.100us       2.067ms         0.00%       2.831ms       0.019us        152445  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       2.597ms         0.00%       2.597ms      10.821us           240  
                                             aten::gelu         0.00%       4.272ms         0.01%      10.211ms      42.545us       2.584ms         0.00%       2.584ms      10.767us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.584ms         0.00%       2.584ms      24.847us           104  
                                             aten::ones         0.00%       1.356ms         0.00%       7.934ms      16.529us       0.000us         0.00%       2.566ms       5.346us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.448ms         0.00%       2.448ms       5.857us           418  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.425ms         0.00%       2.425ms      23.314us           104  
                                              aten::div         0.01%      11.400ms         0.01%      14.506ms      21.846us       2.400ms         0.00%       2.400ms       3.615us           664  
                                   hipFuncGetAttributes         0.16%     278.074ms         0.16%     278.074ms       2.107ms       2.279ms         0.00%       2.279ms      17.265us           132  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.198ms         0.00%       2.198ms      11.757us           187  
                                          hipHostMalloc         0.08%     138.458ms         0.08%     138.512ms       4.197ms       8.340us         0.00%       2.181ms      66.085us            33  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.174ms         0.00%       2.174ms       5.690us           382  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     618.246us         0.00%       8.099ms      50.616us       0.000us         0.00%       2.156ms      13.476us           160  
                                         SliceBackward0         0.00%     582.878us         0.00%       7.480ms      46.752us       0.000us         0.00%       2.156ms      13.476us           160  
                                   aten::slice_backward         0.00%       1.108ms         0.00%       6.897ms      43.109us       0.000us         0.00%       2.156ms      13.476us           160  
                                             aten::item         0.02%      27.799ms         0.11%     194.182ms      11.559us       0.000us         0.00%       2.036ms       0.121us         16799  
                              aten::_local_scalar_dense         0.01%      13.631ms         0.09%     166.383ms       9.904us     707.847us         0.00%       2.036ms       0.121us         16799  
                                             _LayerNorm         0.00%       5.560ms         0.01%       9.716ms     121.450us       1.953ms         0.00%       1.953ms      24.419us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.879ms         0.00%       1.879ms       6.102us           308  
                                 c10d::_allgather_base_         0.00%     238.551us         0.00%       1.561ms     111.470us       0.000us         0.00%       1.847ms     131.932us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       1.842ms         0.00%       1.842ms     153.500us            12  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.812ms         0.00%       1.812ms      17.426us           104  
                                               aten::lt         0.01%      19.532ms         0.01%      22.082ms      30.669us       1.779ms         0.00%       1.779ms       2.471us           720  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.673ms         0.00%       1.673ms       6.884us           243  
      autograd::engine::evaluate_function: MulBackward0         0.01%      14.200ms         0.04%      67.070ms     389.943us       0.000us         0.00%       1.656ms       9.630us           172  
                                        SelectBackward0         0.00%     269.382us         0.00%       3.027ms      37.831us       0.000us         0.00%       1.588ms      19.852us            80  
                                  aten::select_backward         0.00%     493.582us         0.00%       2.757ms      34.464us       0.000us         0.00%       1.588ms      19.852us            80  
                                 aten::split_with_sizes         0.03%      52.983ms         0.04%      68.538ms      11.899us       0.000us         0.00%       1.533ms       0.266us          5760  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.525ms         0.00%       1.525ms       6.275us           243  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us       1.466ms         0.00%       1.466ms       6.034us           243  
                               aten::cross_entropy_loss         0.00%       1.713ms         0.01%      21.294ms      88.726us       0.000us         0.00%       1.412ms       5.884us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.395ms         0.00%       1.395ms       6.677us           209  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.903ms         0.01%       9.146ms      57.160us       0.000us         0.00%       1.322ms       8.264us           160  
                                           DivBackward0         0.00%       1.315ms         0.00%       7.243ms      45.268us       0.000us         0.00%       1.322ms       8.264us           160  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.303ms         0.00%       1.303ms       8.146us           160  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.272ms         0.00%       1.272ms       6.915us           184  
                                               aten::gt         0.02%      36.648ms         0.03%      45.582ms      10.500us       1.183ms         0.00%       1.183ms       0.273us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.180ms         0.00%       1.180ms       4.878us           242  
                                           MulBackward0         0.01%      10.365ms         0.02%      39.654ms     230.545us       0.000us         0.00%       1.164ms       6.769us           172  
                                               aten::ge         0.00%       7.412ms         0.00%       8.413ms      17.526us       1.164ms         0.00%       1.164ms       2.424us           480  
                                           aten::__or__         0.00%       1.600ms         0.01%      22.882ms      47.672us       0.000us         0.00%       1.163ms       2.422us           480  
                                       aten::bitwise_or         0.01%       9.233ms         0.01%      21.282ms      44.338us       1.163ms         0.00%       1.163ms       2.422us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.163ms         0.00%       1.163ms       5.563us           209  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.116ms         0.00%       1.116ms       5.339us           209  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.701ms         0.01%       9.740ms     121.751us       0.000us         0.00%       1.102ms      13.773us            80  
                                       NllLossBackward0         0.00%     986.648us         0.00%       8.039ms     100.490us       0.000us         0.00%       1.102ms      13.773us            80  
                                aten::nll_loss_backward         0.00%       2.955ms         0.00%       7.053ms      88.157us     592.926us         0.00%       1.102ms      13.773us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.086ms         0.00%       1.086ms      13.578us            80  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     996.094us         0.00%     996.094us      12.451us            80  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     970.755us         0.00%     970.755us       4.045us           240  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     929.297us         0.00%     929.297us      11.616us            80  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     883.952us         0.00%     883.952us       8.500us           104  
                                       aten::empty_like         0.12%     204.818ms         0.33%     585.544ms       6.584us       0.000us         0.00%     883.483us       0.010us         88930  
                                            aten::empty         0.53%     938.799ms         0.54%     945.128ms       3.600us       0.000us         0.00%     815.568us       0.003us        262555  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     753.377us         0.00%     753.377us       7.244us           104  
                                      aten::log_softmax         0.00%       1.263ms         0.00%       6.515ms      27.147us       0.000us         0.00%     738.064us       3.075us           240  
                                     aten::_log_softmax         0.00%       4.053ms         0.00%       5.074ms      21.142us     738.064us         0.00%     738.064us       3.075us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     738.064us         0.00%     738.064us       7.097us           104  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     723.591us         0.00%     723.591us       9.045us            80  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     702.533us         0.00%     702.533us       2.927us           240  
                                             aten::tanh         0.01%      15.682ms         0.02%      28.529ms     105.271us     701.582us         0.00%     701.582us       2.589us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     701.582us         0.00%     701.582us       6.746us           104  
                                      aten::nll_loss_nd         0.00%     873.366us         0.01%      13.066ms      54.441us       0.000us         0.00%     673.986us       2.808us           240  
                                         aten::nll_loss         0.00%     970.465us         0.01%      12.193ms      50.802us       0.000us         0.00%     673.986us       2.808us           240  
                                 aten::nll_loss_forward         0.00%       4.906ms         0.01%      11.222ms      46.759us     673.986us         0.00%     673.986us       2.808us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     673.986us         0.00%     673.986us       6.481us           104  
                                        aten::transpose         0.16%     281.724ms         0.20%     349.260ms       3.665us       0.000us         0.00%     640.595us       0.007us         95285  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     627.126us         0.00%     627.126us       7.839us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     602.059us         0.00%     602.059us       5.789us           104  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     595.320us         0.00%     595.320us       2.480us           240  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     594.324us         0.00%     594.324us       2.476us           240  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     592.926us         0.00%     592.926us       7.412us            80  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     582.943us         0.00%     582.943us       6.202us            94  
                                             aten::rsub         0.00%       3.042ms         0.01%       9.432ms     109.674us       0.000us         0.00%     562.814us       6.544us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     562.814us         0.00%     562.814us       7.035us            80  
                                              aten::log         0.00%       4.035ms         0.01%      10.060ms      41.919us     534.505us         0.00%     534.505us       2.227us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     534.505us         0.00%     534.505us       5.139us           104  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     532.589us         0.00%     532.589us       6.657us            80  
                                          aten::normal_         1.05%        1.843s         1.05%        1.846s      17.747ms     520.877us         0.00%     520.877us       5.008us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     520.877us         0.00%     520.877us       5.370us            97  
                                        aten::ones_like         0.00%     606.274us         0.00%       2.296ms      28.704us       0.000us         0.00%     520.398us       6.505us            80  
                                              hipMalloc         0.01%      18.463ms         0.01%      18.463ms     112.580us     519.475us         0.00%     519.475us       3.168us           164  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     517.065us         0.00%     517.065us       6.463us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.448ms         0.02%      28.910ms     352.559us       0.000us         0.00%     511.132us       6.233us            82  
                                          TanhBackward0         0.00%       2.584ms         0.02%      27.462ms     334.898us       0.000us         0.00%     511.132us       6.233us            82  
                                    aten::tanh_backward         0.00%       3.623ms         0.01%      21.660ms     264.149us     511.132us         0.00%     511.132us       6.233us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     511.132us         0.00%     511.132us       6.389us            80  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     494.260us         0.00%     494.260us       4.707us           105  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     799.956us         0.00%       5.863ms      73.285us       0.000us         0.00%     477.776us       5.972us            80  
                                    LogSoftmaxBackward0         0.00%       1.349ms         0.00%       5.063ms      63.285us       0.000us         0.00%     477.776us       5.972us            80  
                       aten::_log_softmax_backward_data         0.00%       2.431ms         0.00%       3.714ms      46.421us     477.776us         0.00%     477.776us       5.972us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     477.776us         0.00%     477.776us       5.972us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     477.219us         0.00%     477.219us       5.965us            80  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       6.799ms         0.01%      13.076ms      81.726us     471.129us         0.00%     471.129us       2.945us           160  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     416.091us         0.00%     416.091us       2.601us           160  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     283.453us         0.00%     283.453us       3.543us            80  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     200.537us         0.00%     200.537us       3.458us            58  
                                             aten::rand         0.00%       3.002ms         0.00%       6.827ms     487.650us       0.000us         0.00%     148.602us      10.614us            14  
                                         aten::uniform_         0.01%      15.335ms         0.01%      17.469ms       1.344ms     148.602us         0.00%     148.602us      11.431us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     148.602us         0.00%     148.602us      29.720us             5  
                                                hipFree         0.06%     103.722ms         0.06%     103.781ms       5.766ms      15.275us         0.00%     108.450us       6.025us            18  
                                          aten::maximum         0.00%     129.583us         0.01%      18.257ms       2.029ms      98.628us         0.00%      98.628us      10.959us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      98.628us         0.00%      98.628us      10.959us             9  
                                              hipMemcpy         0.01%      13.557ms         0.01%      13.557ms     282.444us      83.994us         0.00%      83.994us       1.750us            48  
                                     hipExtLaunchKernel         0.06%     101.139ms         0.06%     101.167ms      10.312us       0.000us         0.00%      83.553us       0.009us          9811  
                                       aten::reciprocal         0.00%     143.738us         0.00%       8.725ms     872.540us      72.287us         0.00%      72.287us       7.229us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      72.287us         0.00%      72.287us       7.229us            10  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      51.198us         0.00%      51.198us       5.120us            10  
                                       aten::lift_fresh         0.03%      56.615ms         0.04%      63.103ms      35.732us       0.000us         0.00%      48.872us       0.028us          1766  
                                          aten::squeeze         0.04%      76.856ms         0.05%      91.640ms       3.977us       0.000us         0.00%      38.168us       0.002us         23040  
         GraphLowering.compile_to_module (dynamo_timed)         0.72%        1.259s         1.27%        2.240s     203.598ms       0.000us         0.00%      34.399us       3.127us            11  
                       Scheduler.codegen (dynamo_timed)         0.08%     142.112ms         0.08%     142.144ms      12.922ms       0.000us         0.00%      29.388us       2.672us            11  
                            hipGetDevicePropertiesR0000         0.00%      63.377us         0.00%      63.377us       6.338us      29.388us         0.00%      29.388us       2.939us            10  
                                              aten::all         0.05%      81.772ms         0.05%      92.636ms      15.816us       0.000us         0.00%      27.102us       0.005us          5857  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      25.658us         0.00%      25.658us       2.566us            10  
                                              aten::min         0.00%     129.089us         0.00%       5.661ms       1.132ms      15.075us         0.00%      15.075us       3.015us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.075us         0.00%      15.075us       5.025us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.109us         0.00%      13.109us       4.370us             3  
                               hipExtModuleLaunchKernel         0.16%     278.412ms         0.16%     278.438ms       7.085us       0.000us         0.00%       5.733us       0.000us         39300  
                                    aten::empty_strided         0.20%     359.229ms         0.21%     367.489ms       4.146us       0.000us         0.00%       5.733us       0.000us         88647  
                                    hipModuleLoadDataEx         0.38%     659.088ms         0.38%     659.088ms      50.699ms       5.011us         0.00%       5.011us       0.385us            13  
                                           aten::select         0.22%     378.804ms         0.26%     460.228ms       4.702us       0.000us         0.00%       4.971us       0.000us         97887  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.566us         0.00%       2.566us       2.566us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       1.924us         0.00%       1.924us       1.924us             1  
                        hipDeviceGetStreamPriorityRange         0.00%       3.128us         0.00%       3.128us       3.128us       0.000us         0.00%       0.000us       0.000us             1  
                            hipStreamCreateWithPriority         0.00%     549.461us         0.00%     549.461us      91.577us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.113s      66.053us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      13.474ms         0.01%      13.474ms       1.373us       0.000us         0.00%       0.000us       0.000us          9813  
                               TorchDynamo Cache Lookup         0.12%     216.240ms         0.12%     216.257ms      11.251us       0.000us         0.00%       0.000us       0.000us         19221  
                                           aten::detach         0.05%      79.195ms         0.13%     231.938ms       6.538us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.07%     118.593ms         0.08%     144.883ms       4.283us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.01%      11.809ms         0.01%      21.072ms     169.935us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.04%      74.050ms         0.06%      98.438ms       2.717us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     397.145us         0.00%     519.600us      64.950us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.15%     259.031ms         0.15%     259.338ms       0.771us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%       1.427ms         0.00%       2.035ms     107.081us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     598.543us         0.00%       1.248ms      29.723us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%       1.053ms         0.00%       1.424ms     101.722us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     149.289us         0.00%     203.661us     101.830us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       4.707ms         0.01%       9.721ms     255.812us       0.000us         0.00%       0.000us       0.000us            38  
                                             aten::view         0.19%     328.341ms         0.19%     336.903ms       2.329us       0.000us         0.00%       0.000us       0.000us        144633  
                                         prims::view_of         0.00%     712.428us         0.00%     918.897us      38.287us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       6.981ms         0.00%       7.116ms       7.420us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       7.834ms         0.01%       9.086ms      11.259us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%       1.246ms         0.00%       1.246ms       1.543us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     457.955us         0.00%     457.955us      14.773us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     134.807us         0.00%     134.807us      12.255us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      13.736ms         0.02%      30.082ms     117.507us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     766.457us         0.00%     766.457us       2.994us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     223.047us         0.00%     305.347us     101.782us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     144.321us         0.00%     144.321us      72.160us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     183.472us         0.00%     198.622us      99.311us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      38.575us         0.00%      38.575us       2.755us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.589ms         0.00%       3.129ms     625.788us       0.000us         0.00%       0.000us       0.000us             5  
                                            aten::slice         0.06%      98.138ms         0.07%     116.882ms       4.475us       0.000us         0.00%       0.000us       0.000us         26118  
                                        aten::index_add         0.00%     341.990us         0.00%       1.873ms       1.873ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     617.602us         0.00%     694.781us     347.391us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     304.922us         0.00%     304.922us     304.922us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.12%     209.241ms         0.12%     212.166ms      19.288ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.10%     181.135ms         0.10%     181.172ms      16.470ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.01%       9.846ms         0.01%       9.846ms     895.118us       0.000us         0.00%       0.000us       0.000us            11  
                                    hipFuncGetAttribute         0.00%       4.778us         0.00%       4.778us       0.398us       0.000us         0.00%       0.000us       0.000us            12  
                                 hipPointerGetAttribute         0.03%      54.873ms         0.03%      54.873ms       0.880us       0.000us         0.00%       0.000us       0.000us         62370  
                                        aten::expand_as         0.00%       1.304ms         0.00%       4.109ms       7.568us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       2.103ms         0.00%       7.429ms     675.362us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     170.273us         0.00%     189.952us      94.976us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     179.550us         0.00%     179.550us      89.775us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      98.991us         0.00%     124.235us     124.235us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     439.256us         0.00%       3.851ms       1.284ms       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     293.513us         0.00%     329.569us     109.856us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.645ms         0.00%       5.205ms     867.530us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%       1.151ms         0.00%       5.624ms     624.836us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.667ms         0.00%       3.744ms     623.965us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     439.617us         0.00%       1.180ms     393.341us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     293.135us         0.00%       1.497ms     498.913us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     621.409us         0.00%       1.204ms     401.201us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     450.542us         0.00%     474.003us     118.501us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.07%     117.371ms         0.07%     117.698ms       3.396us       0.000us         0.00%       0.000us       0.000us         34655  
                                               aten::eq         0.02%      42.216ms         0.02%      42.220ms       7.208us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       3.895ms         0.00%       3.895ms       0.159us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     832.364us      59.455us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.580ms         0.01%      13.244ms       5.899us       0.000us         0.00%       0.000us       0.000us          2245  
                                          aten::reshape         0.07%     117.517ms         0.12%     207.243ms       4.797us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      68.203ms     141.795us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.00%       8.588ms         0.01%      18.565ms       4.550us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.00%       8.411ms         0.02%      28.213ms      10.687us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.02%      32.114ms         0.02%      39.193ms       5.325us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.467ms         0.00%       3.097ms       4.301us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      37.549ms         0.03%      44.907ms       5.613us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.958us         0.00%       1.958us       0.280us       0.000us         0.00%       0.000us       0.000us             7  
                              hipDevicePrimaryCtxRetain         0.00%       2.981us         0.00%       2.981us       0.426us       0.000us         0.00%       0.000us       0.000us             7  
                             hipDevicePrimaryCtxRelease         0.00%       1.605us         0.00%       1.605us       0.229us       0.000us         0.00%       0.000us       0.000us             7  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      52.309ms         0.03%      52.309ms       2.885us       0.000us         0.00%       0.000us       0.000us         18130  
                                              hipMemset         0.00%      26.130us         0.00%      26.130us      13.065us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.28%     499.704ms         0.28%     499.704ms     166.568ms       0.000us         0.00%       0.000us       0.000us             3  
                                   aten::_reshape_alias         0.02%      34.409ms         0.02%      34.413ms       2.240us       0.000us         0.00%       0.000us       0.000us         15360  
                                      hipModuleLoadData         0.30%     534.618ms         0.30%     534.618ms     133.655ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     859.488us         0.00%       1.999ms     499.839us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       7.255ms         0.00%       8.602ms      35.841us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     885.390us         0.00%     885.390us       2.767us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.03%      45.302ms         0.08%     131.862ms       8.410us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      21.284ms         0.05%      86.559ms       5.520us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     484.501us         0.00%       3.255ms      40.689us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.293ms         0.00%       2.771ms      34.633us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.04%      63.148ms         0.09%     150.471ms       7.071us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      22.149ms         0.05%      87.324ms       4.104us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.03%      45.354ms         0.06%     101.219ms       4.190us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.061ms         0.00%       2.854ms      11.890us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     401.422us         0.00%       1.792ms       7.468us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     327.195us         0.00%       1.004ms      12.551us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     676.853us         0.00%     676.853us       8.461us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     993.991us         0.22%     385.926ms     385.926ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      21.304ms         0.01%      24.015ms       3.126us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.711ms         0.00%       2.711ms       0.353us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       5.952ms         0.01%      22.601ms      11.300us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       4.702ms         0.01%      16.648ms       8.324us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       5.453ms         0.01%      14.942ms       7.782us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       2.460ms         0.01%       9.489ms       4.942us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     433.633us         0.00%     433.633us       0.226us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.094ms         0.00%       3.092ms      38.648us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.998ms         0.00%       1.998ms      24.979us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.730ms         0.00%       2.651ms      33.142us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.616ms     261.616us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      27.458us         0.00%      47.354us      11.838us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 175.714s
Self CUDA time total: 159.987s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       81.706s        50.79%       81.706s       81.706s             1  
                                             bert_train        35.96%       62.721s        70.92%      123.686s      123.686s       0.000us         0.00%       41.347s       41.347s             1  
                                            aten::copy_        13.44%       23.440s        15.83%       27.617s     350.404us       16.455s        10.23%       16.507s     209.437us         78815  
                                     record_param_comms         3.46%        6.037s         4.91%        8.571s     246.904us        9.197s         5.72%       14.094s     406.008us         34714  
                                               aten::to         0.04%      69.779ms        15.81%       27.574s     525.330us       0.000us         0.00%       11.937s     227.427us         52489  
                                         aten::_to_copy         0.12%     205.145ms        15.77%       27.504s     634.543us       0.000us         0.00%       11.937s     275.404us         43345  
                                      aten::masked_fill         0.05%      81.405ms         0.28%     489.535ms      50.993us       0.000us         0.00%       11.743s       1.223ms          9600  
                                     aten::masked_fill_         0.12%     207.501ms         0.24%     424.166ms      25.864us       11.074s         6.88%       11.076s     675.378us         16400  
                                       c10d::allreduce_         0.26%     456.692ms         2.90%        5.052s     300.516us       0.000us         0.00%        9.559s     568.628us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        9.155s         5.69%        9.155s     967.526us          9462  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        9.086s         5.65%        9.086s     951.359us          9551  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      18.307ms         0.11%     195.912ms      51.019us       0.000us         0.00%        7.854s       2.045ms          3840  
                                    MaskedFillBackward0         0.00%       7.587ms         0.10%     177.605ms      46.251us       0.000us         0.00%        7.854s       2.045ms          3840  
                                              aten::bmm         0.29%     498.572ms         0.34%     595.854ms      44.334us        7.115s         4.42%        7.116s     529.498us         13440  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.570s         4.08%        6.570s       1.485ms          4424  
autograd::engine::evaluate_function: _LayerNormLinea...         0.05%      92.675ms         2.63%        4.584s       1.194ms       0.000us         0.00%        6.563s       1.709ms          3840  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       8.279ms         0.04%      74.129ms      38.609us       0.000us         0.00%        6.491s       3.381ms          1920  
                                       SoftmaxBackward0         0.00%       6.962ms         0.04%      65.849ms      34.296us       0.000us         0.00%        6.491s       3.381ms          1920  
                           aten::_softmax_backward_data         0.01%      19.796ms         0.03%      58.887ms      30.670us        3.354s         2.09%        6.491s       3.381ms          1920  
                               _LayerNormLinearBackward         1.68%        2.923s         2.54%        4.430s       1.154ms     466.938ms         0.29%        6.403s       1.667ms          3840  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.114s         3.80%        6.114s     750.274us          8149  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.653s         3.51%        5.653s       1.230ms          4594  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      14.609ms         0.05%      93.953ms      23.968us       0.000us         0.00%        5.062s       1.291ms          3920  
                                        ToCopyBackward0         0.00%       6.649ms         0.05%      79.344ms      20.241us       0.000us         0.00%        5.062s       1.291ms          3920  
                                            aten::clone         0.08%     131.293ms         0.49%     848.025ms      24.548us       0.000us         0.00%        4.566s     132.163us         34546  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.501s         2.80%        4.501s     976.633us          4609  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.455s         2.77%        4.455s     560.033us          7955  
                                          aten::softmax         0.01%      14.327ms         0.09%     157.226ms      27.296us       0.000us         0.00%        4.314s     748.909us          5760  
                                         aten::_softmax         0.05%      92.403ms         0.08%     142.842ms      24.799us        4.314s         2.68%        4.314s     748.909us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.314s         2.68%        4.314s       1.723ms          2504  
                                     tex_ts::te_gemm_ts         1.37%        2.385s         1.94%        3.391s      88.305us        4.301s         2.67%        4.308s     112.184us         38400  
                                                _Linear         1.05%        1.830s         1.71%        2.988s     778.083us     139.972ms         0.09%        4.218s       1.099ms          3840  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.785s         2.35%        3.785s     855.828us          4423  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.711s         2.31%        3.711s     322.175us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.354s         2.09%        3.354s       1.747ms          1920  
                                          c10d::barrier         0.00%     947.380us         1.24%        2.154s      56.685ms       0.000us         0.00%        3.231s      85.023ms            38  
                                              aten::mul         0.09%     160.558ms         0.13%     228.618ms      28.681us        3.175s         1.97%        3.175s     398.344us          7971  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.139s         1.95%        3.139s       1.431ms          2193  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      17.841ms         0.12%     208.344ms     108.512us       0.000us         0.00%        3.135s       1.633ms          1920  
                                       BaddbmmBackward0         0.01%      19.418ms         0.11%     190.502ms      99.220us       0.000us         0.00%        3.135s       1.633ms          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.879s         1.17%        1.879s     415.076us          4528  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      21.314ms         0.12%     206.208ms     107.400us       0.000us         0.00%        1.800s     937.416us          1920  
                                           BmmBackward0         0.01%      13.370ms         0.11%     184.894ms      96.299us       0.000us         0.00%        1.800s     937.416us          1920  
                                       aten::logical_or         0.08%     132.329ms         0.22%     384.333ms      33.362us     875.730ms         0.54%        1.753s     152.152us         11520  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      39.115ms         1.54%        2.687s     699.775us       0.000us         0.00%        1.729s     450.230us          3840  
                                        _LinearBackward         1.20%        2.087s         1.52%        2.648s     689.589us     204.752ms         0.13%        1.729s     450.230us          3840  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.530s         0.95%        1.530s     796.631us          1920  
                                              aten::sub         0.07%     121.493ms         0.09%     152.771ms      23.253us        1.515s         0.94%        1.515s     230.557us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.512s         0.94%        1.512s     603.887us          2504  
                                          aten::dropout         0.01%      12.265ms         0.07%     124.616ms      20.718us       0.000us         0.00%        1.493s     248.171us          6015  
                                   aten::native_dropout         0.03%      44.497ms         0.06%     107.457ms      53.488us        1.493s         0.93%        1.493s     743.031us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.493s         0.93%        1.493s     746.366us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      11.648ms         0.04%      70.488ms      35.191us       0.000us         0.00%        1.393s     695.312us          2003  
                                 NativeDropoutBackward0         0.00%       6.865ms         0.03%      58.840ms      29.376us       0.000us         0.00%        1.393s     695.312us          2003  
                          aten::native_dropout_backward         0.01%      19.760ms         0.03%      51.975ms      25.949us        1.393s         0.87%        1.393s     695.312us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.393s         0.87%        1.393s     696.355us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.387s         0.86%        1.387s      80.978us         17129  
                                   hipStreamSynchronize         0.39%     686.928ms         0.39%     686.984ms     215.965us        1.358s         0.84%        1.360s     427.649us          3181  
                                   hipStreamIsCapturing         0.03%      57.563ms         0.03%      57.563ms       1.144us        1.283s         0.80%        1.283s      25.495us         50330  
                                   hipDeviceGetPCIBusId         0.01%      15.853ms         0.01%      15.853ms       0.920us        1.209s         0.75%        1.209s      70.184us         17227  
                                       c10d::broadcast_         0.02%      42.241ms         0.47%     817.418ms       1.699ms       0.000us         0.00%        1.189s       2.472ms           481  
                                          aten::baddbmm         0.23%     403.252ms         0.45%     783.398ms     136.007us        1.172s         0.73%        1.172s     203.462us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.130s         0.70%        1.130s     588.429us          1920  
                                  hipExtMallocWithFlags         0.03%      46.246ms         0.03%      46.246ms      10.954us        1.090s         0.68%        1.090s     258.058us          4222  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      23.745ms         0.61%        1.059s     275.827us       0.000us         0.00%     999.958ms     260.406us          3840  
                               CompiledFunctionBackward         0.29%     504.248ms         0.59%        1.035s     269.643us       0.000us         0.00%     999.958ms     260.406us          3840  
                                 triton_red_fused_sum_1         0.02%      35.749ms         0.03%      59.829ms      15.580us     892.691ms         0.55%     892.691ms     232.472us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     875.730ms         0.54%     875.730ms     349.732us          2504  
                                      aten::logical_not         0.10%     176.122ms         0.29%     510.129ms      22.141us     318.939ms         0.20%     637.998ms      27.691us         23040  
                                        hipEventDestroy         0.04%      61.653ms         0.04%      62.415ms       3.152us     545.710ms         0.34%     547.672ms      27.660us         19800  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.612ms         0.00%       2.612ms       0.185us     490.313ms         0.30%     490.313ms      34.666us         14144  
                                      hipGetProcAddress         0.05%      80.578ms         0.05%      80.578ms       1.038us     431.086ms         0.27%     431.086ms       5.555us         77599  
                                  Torch-Compiled Region         0.60%        1.039s         1.78%        3.101s     161.326us       0.000us         0.00%     424.059ms      22.063us         19220  
                                       hipCtxGetCurrent         0.01%      11.899ms         0.01%      11.899ms       0.202us     415.542ms         0.26%     415.542ms       7.049us         58948  
                                       _LayerNormLinear         0.42%     728.320ms         1.07%        1.859s     484.165us     257.543ms         0.16%     399.379ms     104.005us          3840  
                                             aten::add_         0.09%     164.909ms         0.18%     305.548ms       9.725us     377.742ms         0.23%     377.742ms      12.022us         31420  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     318.939ms         0.20%     318.939ms      63.686us          5008  
                                       CompiledFunction         0.71%        1.239s         1.03%        1.803s     156.203us       0.000us         0.00%     312.760ms      27.102us         11540  
                                              aten::sum         0.25%     428.779ms         0.52%     905.453ms      44.485us     221.477ms         0.14%     295.003ms      14.494us         20354  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     290.976ms         0.18%     290.976ms      58.114us          5007  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     282.292ms         0.18%     282.292ms     282.292ms             1  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     265.780ms         0.17%     265.780ms      46.142us          5760  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     261.971ms         0.16%     261.971ms      68.222us          3840  
                  triton_poi_fused_add_native_dropout_0         0.05%      95.222ms         0.08%     144.573ms      37.552us     244.935ms         0.15%     244.968ms      63.628us          3850  
autograd::engine::evaluate_function: torch::autograd...         0.18%     315.062ms         0.36%     634.352ms      26.256us       0.000us         0.00%     217.221ms       8.991us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     215.393ms         0.13%     215.393ms       9.005us         23920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     170.149ms         0.11%     170.149ms      38.236us          4450  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.02%      26.870ms         0.43%     750.070ms     390.661us       0.000us         0.00%     166.001ms      86.459us          1920  
                                         hipMemcpyAsync         0.12%     212.717ms         0.12%     212.721ms      17.630us     164.563ms         0.10%     164.575ms      13.640us         12066  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     159.735ms         0.10%     159.735ms      31.216us          5117  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     159.502ms         0.10%     159.502ms      31.862us          5006  
                               hipStreamCreateWithFlags         0.24%     417.790ms         0.24%     417.790ms     157.895us     158.224ms         0.10%     158.224ms      59.798us          2646  
                         _ReduceFromModelParallelRegion         0.02%      26.361ms         0.04%      73.436ms     305.982us       0.000us         0.00%     152.996ms     637.484us           240  
                             _VocabParallelCrossEntropy         0.05%      86.495ms         0.18%     307.681ms       1.282ms       0.000us         0.00%     146.648ms     611.033us           240  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     143.650ms         0.09%     143.650ms      36.645us          3920  
                                              aten::cat         0.10%     174.011ms         0.13%     224.683ms      27.807us     143.129ms         0.09%     143.129ms      17.714us          8080  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.641ms         0.07%     120.034ms       1.500ms       0.000us         0.00%     132.347ms       1.654ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      21.048ms         0.07%     118.393ms       1.480ms       0.000us         0.00%     132.347ms       1.654ms            80  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.083ms        22.50%       39.245s     163.520ms       0.000us         0.00%     130.453ms     543.555us           240  
                                     EmbeddingBackward0         0.00%       3.463ms        22.50%       39.237s     163.489ms       0.000us         0.00%     129.445ms     539.356us           240  
                               aten::embedding_backward         0.00%       3.568ms        22.50%       39.234s     163.474ms       0.000us         0.00%     129.445ms     539.356us           240  
                         aten::embedding_dense_backward         1.82%        3.171s        22.49%       39.230s     163.459ms     123.175ms         0.08%     129.445ms     539.356us           240  
                                         hipMemsetAsync         0.07%     120.531ms         0.07%     120.566ms      10.249us     126.477ms         0.08%     126.477ms      10.751us         11764  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      16.610ms         0.14%     235.616ms     122.717us       0.000us         0.00%     120.911ms      62.975us          1920  
                                 _SplitAlongDimBackward         0.10%     166.248ms         0.13%     219.006ms     114.066us       0.000us         0.00%     120.911ms      62.975us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     120.911ms         0.08%     120.911ms      62.975us          1920  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     119.644ms         0.07%     119.644ms      11.824us         10119  
                                       aten::contiguous         0.02%      32.046ms         0.34%     585.034ms      25.392us       0.000us         0.00%     116.867ms       5.072us         23040  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     115.467ms         0.07%     115.467ms      53.457us          2160  
                             c10d::allreduce_coalesced_         0.00%       1.929ms         0.05%      84.115ms       8.412ms       0.000us         0.00%     111.399ms      11.140ms            10  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     109.533ms         0.07%     109.533ms     519.113us           211  
             triton_poi_fused_native_dropout_backward_0         0.04%      66.182ms         0.06%      98.698ms      25.703us     107.267ms         0.07%     107.267ms      27.934us          3840  
                                               aten::mm         0.03%      55.265ms         0.06%     108.843ms     123.685us     102.719ms         0.06%     102.719ms     116.726us           880  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      91.880ms         0.06%      91.880ms      36.708us          2503  
                                           aten::arange         0.09%     158.317ms         0.26%     452.493ms      18.364us      42.977ms         0.03%      87.677ms       3.558us         24640  
                                           aten::matmul         0.00%       3.410ms         0.05%      83.038ms     207.594us       0.000us         0.00%      84.904ms     212.259us           400  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      79.948ms         0.05%      79.948ms      10.643us          7512  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      77.895ms         0.05%      77.895ms      40.571us          1920  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      76.744ms         0.05%      76.744ms       6.537us         11740  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      76.315ms         0.05%      76.315ms      30.477us          2504  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      75.467ms         0.05%      75.467ms      19.252us          3920  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.23%     405.337ms         0.40%     701.313ms      91.317us      73.878ms         0.05%      73.887ms       9.621us          7680  
                                       hipStreamDestroy         0.04%      62.239ms         0.04%      62.239ms      23.701us      69.638ms         0.04%      69.638ms      26.519us          2626  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      66.636ms         0.04%      66.636ms     277.650us           240  
                                 hipDeviceCanAccessPeer         0.00%     441.234us         0.00%     441.234us       0.227us      63.747ms         0.04%      63.747ms      32.792us          1944  
                                  hipModuleLaunchKernel         0.14%     248.109ms         0.14%     248.141ms       7.329us      63.163ms         0.04%      63.172ms       1.866us         33857  
                                           GeLUFunction         0.11%     193.893ms         0.64%        1.111s     192.854us       0.000us         0.00%      61.748ms      10.720us          5760  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      61.279ms         0.04%      61.279ms      14.254us          4299  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      59.073ms         0.04%      59.073ms      15.384us          3840  
                        triton_poi_fused_add_mul_tanh_0         0.08%     142.032ms         0.10%     167.374ms      29.008us      56.975ms         0.04%      56.992ms       9.877us          5770  
                                     hipIpcGetMemHandle         0.01%      10.015ms         0.01%      10.015ms       5.819us      56.867ms         0.04%      56.867ms      33.043us          1721  
                                    hipMemcpyWithStream        24.74%       43.153s        24.75%       43.158s      54.561ms       0.000us         0.00%      55.447ms      70.097us           791  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      51.372ms         0.03%      51.372ms      26.756us          1920  
                                    hipIpcOpenMemHandle         0.06%      97.603ms         0.06%      97.603ms      56.516us      50.426ms         0.03%      50.426ms      29.199us          1727  
                                   GeLUFunctionBackward         0.03%      55.426ms         0.37%     641.943ms     334.345us       0.000us         0.00%      49.542ms      25.803us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      32.266ms         0.03%      49.983ms      26.033us      49.542ms         0.03%      49.542ms      25.803us          1920  
        LinearWithGradAccumulationAndAsyncCommunication         0.01%       9.213ms         0.02%      29.715ms     123.813us       0.000us         0.00%      49.132ms     204.715us           240  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      41.708ms         0.03%      41.708ms       8.328us          5008  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      39.712ms         0.02%      39.712ms       7.930us          5008  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      35.833ms         0.02%      35.833ms       9.332us          3840  
                                 triton_poi_fused_add_0         0.14%     243.902ms         0.15%     257.956ms      33.588us      35.663ms         0.02%      35.710ms       4.650us          7680  
                                            aten::fill_         0.09%     148.277ms         0.10%     180.479ms       6.241us      33.643ms         0.02%      33.643ms       1.163us         28919  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      30.588ms         0.02%      30.588ms      12.216us          2504  
                                            aten::zeros         0.05%      88.273ms         0.22%     383.619ms      17.121us       0.000us         0.00%      30.117ms       1.344us         22406  
                                            aten::zero_         0.05%      81.824ms         0.14%     250.941ms      11.081us       0.000us         0.00%      29.992ms       1.324us         22646  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      29.101ms         0.02%      29.101ms     181.881us           160  
                                          aten::randint         0.02%      42.078ms         0.09%     160.936ms      41.758us       0.000us         0.00%      28.740ms       7.457us          3854  
                                          aten::random_         0.04%      66.892ms         0.07%     116.071ms      30.148us      26.982ms         0.02%      27.790ms       7.218us          3850  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.522ms         0.03%      53.221ms     665.259us       0.000us         0.00%      27.672ms     345.895us            80  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      26.982ms         0.02%      26.982ms       7.008us          3850  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      25.594ms         0.02%      25.594ms     123.046us           208  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.937ms         0.03%      51.146ms     213.107us       0.000us         0.00%      25.144ms     104.766us           240  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      25.012ms         0.02%      25.012ms     312.653us            80  
                                 tex_ts::cast_to_fp8_ts         0.09%     158.315ms         0.13%     234.487ms      30.532us      23.673ms         0.01%      23.673ms       3.082us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      23.673ms         0.01%      23.673ms      20.303us          1166  
                                     hipStreamWaitEvent         0.19%     331.458ms         0.19%     331.495ms      16.188us      23.614ms         0.01%      23.614ms       1.153us         20478  
                                              aten::exp         0.00%       3.197ms         0.01%      17.372ms      72.384us      23.018ms         0.01%      23.018ms      95.908us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.018ms         0.01%      23.018ms     221.326us           104  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      22.217ms         0.01%      22.217ms       8.026us          2768  
                                              aten::add         0.05%      81.717ms         0.07%     116.628ms      65.301us      21.929ms         0.01%      21.929ms      12.278us          1786  
                                             aten::div_         0.00%       6.809ms         0.01%      13.240ms      27.583us      21.009ms         0.01%      21.009ms      43.769us           480  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.354ms         0.01%      20.354ms     195.712us           104  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.912ms         0.01%      19.912ms       7.952us          2504  
                                           aten::linear         0.00%       3.935ms         0.04%      63.787ms      88.593us       0.000us         0.00%      19.860ms      27.583us           720  
                                            aten::addmm         0.03%      45.935ms         0.03%      53.675ms      74.549us      19.860ms         0.01%      19.860ms      27.583us           720  
                                           aten::cumsum         0.07%     129.979ms         0.09%     160.941ms      27.941us      19.844ms         0.01%      19.844ms       3.445us          5760  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      19.844ms         0.01%      19.844ms       7.925us          2504  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      19.749ms         0.01%      19.749ms       7.843us          2518  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      19.574ms         0.01%      19.574ms      30.681us           638  
                                             aten::sub_         0.00%       5.213ms         0.00%       6.711ms      20.972us      19.420ms         0.01%      19.420ms      60.686us           320  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      18.807ms         0.01%      18.807ms     180.838us           104  
                                         AddmmBackward0         0.00%       3.158ms         0.02%      39.231ms     163.461us       0.000us         0.00%      17.815ms      74.230us           240  
                                            aten::index         0.01%      14.822ms         0.04%      77.257ms     136.255us       2.265ms         0.00%      17.331ms      30.566us           567  
                     _VocabParallelCrossEntropyBackward         0.01%      19.447ms         0.03%      47.195ms     589.939us       0.000us         0.00%      17.294ms     216.179us            80  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      16.756ms         0.01%      16.756ms     161.112us           104  
                                        aten::embedding         0.00%       7.200ms         0.02%      31.180ms      43.306us       0.000us         0.00%      16.741ms      23.251us           720  
                                     aten::index_select         0.01%      13.413ms         0.01%      20.930ms      29.070us      16.741ms         0.01%      16.741ms      23.251us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.741ms         0.01%      16.741ms      53.146us           315  
                                          aten::nonzero         0.00%       5.913ms         0.03%      43.686ms     178.312us      15.066ms         0.01%      15.066ms      61.493us           245  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.529ms         0.01%      13.529ms      84.558us           160  
                                             aten::mul_         0.00%       6.576ms         0.00%       7.397ms       5.779us      12.906ms         0.01%      12.906ms      10.082us          1280  
         _compile.<locals>.compile_inner (dynamo_timed)         0.08%     141.551ms         2.00%        3.488s     348.846ms       0.000us         0.00%      12.507ms       1.251ms            10  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.088ms         0.01%      12.088ms     116.228us           104  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.564ms         0.01%      11.564ms     111.197us           104  
                                       aten::index_put_         0.00%       6.071ms         0.09%     151.630ms     135.384us       0.000us         0.00%      10.752ms       9.600us          1120  
                                 aten::_index_put_impl_         0.00%       8.507ms         0.08%     145.554ms     129.959us     925.291us         0.00%      10.752ms       9.600us          1120  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      33.917ms         1.89%        3.300s     330.039ms       0.000us         0.00%      10.567ms       1.057ms            10  
          create_aot_dispatcher_function (dynamo_timed)         0.38%     668.522ms         1.87%        3.266s     326.647ms       0.000us         0.00%      10.567ms       1.057ms            10  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       9.868ms         0.01%       9.868ms      41.118us           240  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.685ms         0.01%       9.685ms      40.353us           240  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.535ms         0.01%      13.642ms     170.520us       0.000us         0.00%       9.075ms     113.439us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.774ms         0.01%      11.106ms     138.831us       9.075ms         0.01%       9.075ms     113.439us            80  
                                              aten::max         0.00%       7.680ms         0.02%      38.697ms     152.352us       8.862ms         0.01%       8.927ms      35.147us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.849ms         0.01%       8.849ms      85.088us           104  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.009ms         0.02%      29.307ms     366.339us       0.000us         0.00%       8.848ms     110.603us            80  
                            torch::autograd::CopySlices         0.00%       4.664ms         0.02%      27.299ms     341.232us       0.000us         0.00%       8.848ms     110.603us            80  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.626ms         0.01%       8.626ms      20.938us           412  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       8.247ms         0.01%       8.247ms      12.022us           686  
                           FusedLayerNormAffineFunction         0.01%      12.975ms         0.01%      21.768ms      90.701us       8.021ms         0.00%       8.021ms      33.420us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       8.021ms         0.00%       8.021ms      77.123us           104  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     571.408us         0.00%       3.552ms     355.184us       7.180ms         0.00%       7.180ms     718.021us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       7.180ms         0.00%       7.180ms      65.275us           110  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       6.957ms         0.00%       6.957ms       7.247us           960  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.819ms         0.00%       6.819ms      85.236us            80  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       6.743ms         0.00%       6.743ms      28.096us           240  
                            hipGetDevicePropertiesR0600         0.05%      88.930ms         0.05%      88.930ms       0.975us       6.665ms         0.00%       6.665ms       0.073us         91203  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      17.415ms         1.25%        2.174s     217.437ms       0.000us         0.00%       5.807ms     580.658us            10  
                        compile_fx_inner (dynamo_timed)         0.05%      85.230ms         1.45%        2.529s     229.875ms       0.000us         0.00%       5.807ms     527.870us            11  
         GraphLowering.compile_to_module (dynamo_timed)         0.70%        1.217s         1.25%        2.173s     197.503ms       0.000us         0.00%       5.779ms     525.396us            11  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.646ms         0.00%       5.646ms       6.253us           903  
                                  hipMemGetAddressRange         0.00%     179.159us         0.00%     179.159us       0.399us       5.521ms         0.00%       5.521ms      12.296us           449  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       5.122ms         0.00%       5.122ms      32.015us           160  
                                        aten::index_put         0.00%       2.019ms         0.01%      12.555ms     151.260us       0.000us         0.00%       4.740ms      57.109us            83  
                                      IndexPutBackward0         0.00%       1.030ms         0.01%      12.008ms     150.096us       0.000us         0.00%       4.740ms      59.251us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.220ms         0.00%       4.220ms      52.746us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       4.099ms         0.00%       4.099ms      51.239us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     964.251us         0.01%      22.640ms     282.996us       0.000us         0.00%       3.916ms      48.953us            80  
                                     _LayerNormBackward         0.00%       5.661ms         0.01%      21.675ms     270.943us       3.916ms         0.00%       3.916ms      48.953us            80  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     719.332us         0.00%       3.160ms      39.502us       0.000us         0.00%       3.661ms      45.764us            80  
                                          GeluBackward0         0.00%     437.254us         0.00%       2.441ms      30.510us       0.000us         0.00%       3.661ms      45.764us            80  
                                    aten::gelu_backward         0.00%       1.257ms         0.00%       2.004ms      25.044us       3.661ms         0.00%       3.661ms      45.764us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.661ms         0.00%       3.661ms      45.764us            80  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     689.500us         0.00%       4.673ms      58.410us       0.000us         0.00%       3.496ms      43.697us            80  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       3.265ms         0.00%       3.265ms       6.172us           529  
                                           aten::select         0.23%     399.116ms         0.28%     485.218ms       4.957us       0.000us         0.00%       2.923ms       0.030us         97887  
                                             aten::ones         0.00%       1.002ms         0.00%       6.227ms      12.973us       0.000us         0.00%       2.843ms       5.923us           480  
                                             aten::gelu         0.00%       4.407ms         0.01%       9.464ms      39.432us       2.756ms         0.00%       2.756ms      11.482us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.756ms         0.00%       2.756ms      26.497us           104  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.577ms         0.00%       2.577ms      24.781us           104  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.530ms         0.00%       2.530ms       6.052us           418  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.518ms         0.00%       2.518ms       6.592us           382  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       2.491ms         0.00%       2.491ms      10.380us           240  
                                              aten::div         0.01%      11.319ms         0.01%      14.656ms      22.073us       2.488ms         0.00%       2.488ms       3.747us           664  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     576.519us         0.00%       7.661ms      47.882us       0.000us         0.00%       2.472ms      15.452us           160  
                                         SliceBackward0         0.00%     467.180us         0.00%       7.085ms      44.279us       0.000us         0.00%       2.472ms      15.452us           160  
                                   aten::slice_backward         0.00%     980.133us         0.00%       6.617ms      41.359us       0.000us         0.00%       2.472ms      15.452us           160  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.265ms         0.00%       2.265ms      12.113us           187  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       2.086ms         0.00%       2.086ms       4.320us           483  
                                             _LayerNorm         0.00%       6.381ms         0.01%      11.294ms     141.169us       2.068ms         0.00%       2.068ms      25.855us            80  
      autograd::engine::evaluate_function: MulBackward0         0.01%      14.618ms         0.04%      69.421ms     403.608us       0.000us         0.00%       1.939ms      11.273us           172  
                                               aten::lt         0.01%      19.882ms         0.01%      22.807ms      31.676us       1.902ms         0.00%       1.902ms       2.641us           720  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.879ms         0.00%       1.879ms       7.731us           243  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.804ms         0.00%       1.804ms      17.345us           104  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.743ms         0.00%       1.743ms       8.338us           209  
                       Scheduler.codegen (dynamo_timed)         0.08%     144.035ms         0.08%     144.099ms      13.100ms       0.000us         0.00%       1.734ms     157.595us            11  
                                            aten::empty         0.56%     978.644ms         0.56%     984.554ms       3.750us       0.000us         0.00%       1.682ms       0.006us        262555  
                                        SelectBackward0         0.00%     222.725us         0.00%       2.923ms      36.540us       0.000us         0.00%       1.678ms      20.970us            80  
                                  aten::select_backward         0.00%     419.937us         0.00%       2.700ms      33.756us       0.000us         0.00%       1.678ms      20.970us            80  
                                              hipMemcpy         0.01%      14.102ms         0.01%      14.102ms     293.798us       1.665ms         0.00%       1.665ms      34.690us            48  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.640ms         0.00%       1.640ms       5.326us           308  
                                               aten::gt         0.02%      36.774ms         0.03%      46.034ms      10.605us       1.634ms         0.00%       1.634ms       0.376us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.632ms         0.00%       1.632ms       6.742us           242  
                               aten::cross_entropy_loss         0.00%       1.611ms         0.01%      20.408ms      85.033us       0.000us         0.00%       1.557ms       6.486us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.503ms         0.00%       1.503ms       8.166us           184  
                            hipGetDevicePropertiesR0000         0.00%      56.543us         0.00%      56.543us       5.654us       1.400ms         0.00%       1.400ms     140.034us            10  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.368ms         0.00%       1.368ms       8.550us           160  
                                    hipFuncGetAttribute         0.00%       6.901us         0.00%       6.901us       0.575us       1.346ms         0.00%       1.346ms     112.189us            12  
                                    hipModuleLoadDataEx         0.36%     632.455ms         0.36%     632.455ms      48.650ms       1.294ms         0.00%       1.294ms      99.506us            13  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.282ms         0.00%       1.282ms       6.134us           209  
                                           aten::__or__         0.00%       1.579ms         0.01%      20.686ms      43.096us       0.000us         0.00%       1.279ms       2.664us           480  
                                       aten::bitwise_or         0.01%       9.492ms         0.01%      19.107ms      39.807us       1.279ms         0.00%       1.279ms       2.664us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.279ms         0.00%       1.279ms       6.119us           209  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.261ms         0.00%       1.261ms      15.765us            80  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.787ms         0.01%      10.328ms     129.099us       0.000us         0.00%       1.241ms      15.508us            80  
                                       NllLossBackward0         0.00%       1.032ms         0.00%       8.541ms     106.759us       0.000us         0.00%       1.241ms      15.508us            80  
                                aten::nll_loss_backward         0.00%       3.206ms         0.00%       7.509ms      93.858us     640.035us         0.00%       1.241ms      15.508us            80  
                                           MulBackward0         0.01%      11.247ms         0.02%      41.491ms     241.225us       0.000us         0.00%       1.234ms       7.174us           172  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.948ms         0.00%       8.719ms      54.494us       0.000us         0.00%       1.193ms       7.458us           160  
                                           DivBackward0         0.00%       1.326ms         0.00%       6.771ms      42.318us       0.000us         0.00%       1.193ms       7.458us           160  
                                               aten::ge         0.00%       7.391ms         0.00%       8.589ms      17.894us       1.177ms         0.00%       1.177ms       2.452us           480  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us       1.138ms         0.00%       1.138ms       4.683us           243  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.123ms         0.00%       1.123ms       4.622us           243  
                                 c10d::_allgather_base_         0.00%     278.755us         0.00%       1.916ms     136.841us       0.000us         0.00%       1.118ms      79.844us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       1.118ms         0.00%       1.118ms      93.151us            12  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.003ms         0.00%       1.003ms       4.179us           240  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     967.903us         0.00%     967.903us       4.033us           240  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     925.291us         0.00%     925.291us      11.566us            80  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     903.888us         0.00%     903.888us       8.691us           104  
                                   hipDeviceSynchronize         0.00%     684.043us         0.00%     684.043us      20.119us     879.764us         0.00%     879.764us      25.875us            34  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     856.291us         0.00%     856.291us      10.704us            80  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     854.287us         0.00%     854.287us      10.679us            80  
                                      aten::nll_loss_nd         0.00%     909.317us         0.01%      11.929ms      49.706us       0.000us         0.00%     809.829us       3.374us           240  
                                         aten::nll_loss         0.00%     967.359us         0.01%      11.020ms      45.917us       0.000us         0.00%     809.829us       3.374us           240  
                                 aten::nll_loss_forward         0.00%       5.046ms         0.01%      10.053ms      41.887us     809.829us         0.00%     809.829us       3.374us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     809.829us         0.00%     809.829us       7.787us           104  
                                             aten::tanh         0.01%      14.534ms         0.01%      25.124ms      92.707us     809.704us         0.00%     809.704us       2.988us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     809.704us         0.00%     809.704us       7.786us           104  
                                  hipDeviceGetAttribute         0.00%     311.805us         0.00%     311.805us       4.654us     807.939us         0.00%     807.939us      12.059us            67  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     805.166us         0.00%     805.166us       7.742us           104  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     785.089us         0.00%     785.089us       7.549us           104  
                                             aten::item         0.02%      29.658ms         0.15%     255.935ms      15.235us       0.000us         0.00%     782.811us       0.047us         16799  
                              aten::_local_scalar_dense         0.01%      13.911ms         0.13%     226.278ms      13.470us     782.811us         0.00%     782.811us       0.047us         16799  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     766.683us         0.00%     766.683us       9.584us            80  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     765.869us         0.00%     765.869us       3.191us           240  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     756.378us         0.00%     756.378us       9.455us            80  
                                      aten::log_softmax         0.00%       1.264ms         0.00%       6.864ms      28.602us       0.000us         0.00%     746.921us       3.112us           240  
                                     aten::_log_softmax         0.00%       4.310ms         0.00%       5.446ms      22.692us     746.921us         0.00%     746.921us       3.112us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     746.921us         0.00%     746.921us       7.182us           104  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     697.733us         0.00%     697.733us       2.907us           240  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     640.035us         0.00%     640.035us       8.000us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     627.564us         0.00%     627.564us       7.845us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     620.110us         0.00%     620.110us       7.751us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.437ms         0.02%      28.350ms     345.733us       0.000us         0.00%     602.266us       7.345us            82  
                                          TanhBackward0         0.00%       2.582ms         0.02%      26.913ms     328.211us       0.000us         0.00%     602.266us       7.345us            82  
                                    aten::tanh_backward         0.00%       3.501ms         0.01%      21.130ms     257.687us     602.266us         0.00%     602.266us       7.345us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     602.266us         0.00%     602.266us       7.528us            80  
                                          aten::normal_         1.05%        1.834s         1.05%        1.836s      17.655ms     590.270us         0.00%     595.241us       5.723us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     590.270us         0.00%     590.270us       6.085us            97  
                                                hipFree         0.06%     104.834ms         0.06%     104.898ms       5.828ms      11.387us         0.00%     589.337us      32.741us            18  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     841.102us         0.00%       5.615ms      70.186us       0.000us         0.00%     583.704us       7.296us            80  
                                    LogSoftmaxBackward0         0.00%       1.110ms         0.00%       4.774ms      59.672us       0.000us         0.00%     583.704us       7.296us            80  
                       aten::_log_softmax_backward_data         0.00%       2.304ms         0.00%       3.663ms      45.793us     583.704us         0.00%     583.704us       7.296us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     583.704us         0.00%     583.704us       7.296us            80  
                                        aten::ones_like         0.00%     659.053us         0.00%       2.605ms      32.561us       0.000us         0.00%     570.749us       7.134us            80  
                                             aten::rsub         0.00%       3.468ms         0.01%      10.444ms     121.437us       0.000us         0.00%     556.812us       6.475us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     556.812us         0.00%     556.812us       6.960us            80  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     548.699us         0.00%     548.699us       5.226us           105  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     531.391us         0.00%     531.391us       3.321us           160  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       6.964ms         0.01%      13.406ms      83.789us     508.875us         0.00%     508.875us       3.180us           160  
                                              aten::log         0.00%       4.067ms         0.01%       9.028ms      37.618us     437.564us         0.00%     437.564us       1.823us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     437.564us         0.00%     437.564us       4.207us           104  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     411.224us         0.00%     411.224us       4.375us            94  
                                        hipLaunchKernel         0.81%        1.419s         0.81%        1.420s       9.320us      82.109us         0.00%     402.396us       0.003us        152320  
                                          hipHostMalloc         0.08%     148.103ms         0.08%     148.163ms       4.490ms     334.690us         0.00%     334.690us      10.142us            33  
                                         _SplitAlongDim         0.09%     161.421ms         0.14%     236.869ms      41.123us       0.000us         0.00%     331.925us       0.058us          5760  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     297.167us         0.00%     297.167us       3.715us            80  
                                        aten::transpose         0.17%     296.208ms         0.21%     366.229ms       3.844us       0.000us         0.00%     227.825us       0.002us         95285  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     219.700us         0.00%     219.700us       3.788us            58  
                                             aten::rand         0.00%       2.828ms         0.00%       6.274ms     448.122us       0.000us         0.00%     153.011us      10.929us            14  
                                         aten::uniform_         0.01%      12.519ms         0.01%      14.380ms       1.106ms     153.011us         0.00%     153.011us      11.770us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     153.011us         0.00%     153.011us      30.602us             5  
                                       aten::reciprocal         0.00%     171.838us         0.01%      17.794ms       1.779ms     132.224us         0.00%     132.224us      13.222us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     132.224us         0.00%     132.224us      13.222us            10  
                                     hipExtLaunchKernel         0.07%     117.038ms         0.07%     117.087ms      11.948us       0.000us         0.00%      81.186us       0.008us          9800  
                                          aten::maximum         0.00%     126.729us         0.01%      23.929ms       2.659ms      65.310us         0.00%      65.310us       7.257us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      65.310us         0.00%      65.310us       7.257us             9  
                                   hipFuncGetAttributes         0.16%     280.263ms         0.16%     280.263ms       2.123ms      62.593us         0.00%      62.593us       0.474us           132  
                                       aten::lift_fresh         0.03%      55.396ms         0.04%      61.978ms      35.095us       0.000us         0.00%      53.363us       0.030us          1766  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      43.179us         0.00%      43.179us       4.318us            10  
                                          aten::squeeze         0.05%      83.598ms         0.06%      99.700ms       4.327us       0.000us         0.00%      39.180us       0.002us         23040  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      29.066us         0.00%      29.066us       2.907us            10  
                               TorchDynamo Cache Lookup         0.12%     215.895ms         0.12%     215.916ms      11.233us       0.000us         0.00%      25.338us       0.001us         19221  
                                       aten::empty_like         0.12%     213.926ms         0.35%     611.074ms       6.871us       0.000us         0.00%      23.054us       0.000us         88930  
                                       aten::as_strided         0.16%     272.973ms         0.16%     273.324ms       0.812us       0.000us         0.00%      20.327us       0.000us        336543  
                                    hipFuncSetAttribute         0.00%      10.821us         0.00%      10.821us       0.451us      18.764us         0.00%      18.764us       0.782us            24  
                                              aten::min         0.00%     125.673us         0.00%       5.683ms       1.137ms      15.074us         0.00%      15.074us       3.015us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.074us         0.00%      15.074us       5.025us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      12.789us         0.00%      12.789us       4.263us             3  
                                             aten::view         0.20%     347.843ms         0.20%     355.611ms       2.459us       0.000us         0.00%       9.181us       0.000us        144633  
                                          aten::resize_         0.07%     124.502ms         0.07%     124.788ms       3.601us       0.000us         0.00%       7.297us       0.000us         34655  
                                              hipMalloc         0.01%      16.862ms         0.01%      16.862ms     102.817us       5.613us         0.00%       5.613us       0.034us           164  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.405us         0.00%       2.405us       2.405us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       1.764us         0.00%       1.764us       1.764us             1  
                                            aten::slice         0.06%     104.884ms         0.07%     124.801ms       4.778us       0.000us         0.00%       1.724us       0.000us         26118  
                        hipDeviceGetStreamPriorityRange         0.00%       3.116us         0.00%       3.116us       3.116us       0.000us         0.00%       0.000us       0.000us             1  
                            hipStreamCreateWithPriority         0.00%     550.162us         0.00%     550.162us      91.694us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.221s      72.495us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      15.074ms         0.01%      15.074ms       1.538us       0.000us         0.00%       0.000us       0.000us          9802  
                                    aten::empty_strided         0.21%     372.519ms         0.22%     380.254ms       4.290us       0.000us         0.00%       0.000us       0.000us         88647  
                                           aten::detach         0.04%      74.735ms         0.13%     221.223ms       6.236us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.07%     115.201ms         0.08%     139.217ms       4.116us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.01%      11.015ms         0.01%      19.897ms     160.461us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.04%      76.730ms         0.06%     102.156ms       2.820us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     315.789us         0.00%     419.383us      52.423us       0.000us         0.00%       0.000us       0.000us             8  
                                             prims::add         0.00%       1.527ms         0.00%       2.085ms     109.738us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     574.116us         0.00%       1.151ms      27.400us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     933.472us         0.00%       1.262ms      90.125us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     114.437us         0.00%     152.684us      76.342us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       4.185ms         0.00%       8.537ms     224.668us       0.000us         0.00%       0.000us       0.000us            38  
                                         prims::view_of         0.00%     635.440us         0.00%     827.510us      34.480us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       6.552ms         0.00%       6.677ms       6.962us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       8.639ms         0.01%       9.847ms      12.202us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%       1.208ms         0.00%       1.208ms       1.497us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     402.560us         0.00%     402.560us      12.986us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     124.354us         0.00%     124.354us      11.305us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      13.582ms         0.02%      28.685ms     112.050us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     732.618us         0.00%     732.618us       2.862us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     252.454us         0.00%     345.601us     115.200us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     132.923us         0.00%     132.923us      66.461us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     167.927us         0.00%     180.786us      90.393us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      38.247us         0.00%      38.247us       2.732us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.569ms         0.00%       3.102ms     620.384us       0.000us         0.00%       0.000us       0.000us             5  
                                        aten::index_add         0.00%     337.753us         0.00%       1.914ms       1.914ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     623.685us         0.00%     707.233us     353.617us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     307.564us         0.00%     307.564us     307.564us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.12%     215.205ms         0.13%     218.083ms      19.826ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.10%     181.915ms         0.10%     181.952ms      16.541ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.01%       9.526ms         0.01%       9.526ms     865.991us       0.000us         0.00%       0.000us       0.000us            11  
                                 hipPointerGetAttribute         0.03%      53.877ms         0.03%      53.877ms       0.864us       0.000us         0.00%       0.000us       0.000us         62326  
                                        aten::expand_as         0.00%       1.173ms         0.00%       4.000ms       7.367us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.977ms         0.00%       7.103ms     645.723us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     170.084us         0.00%     195.125us      97.562us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     191.642us         0.00%     191.642us      95.821us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      97.290us         0.00%     120.929us     120.929us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     398.033us         0.00%       3.516ms       1.172ms       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     292.287us         0.00%     329.446us     109.815us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.503ms         0.00%       4.992ms     832.030us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%       1.105ms         0.00%       5.309ms     589.883us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.485ms         0.00%       3.480ms     580.014us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     429.320us         0.00%       1.165ms     388.187us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     281.889us         0.00%       1.424ms     474.693us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     574.542us         0.00%       1.142ms     380.730us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     415.028us         0.00%     437.296us     109.324us       0.000us         0.00%       0.000us       0.000us             4  
                                               aten::eq         0.03%      45.683ms         0.03%      45.694ms       7.802us       0.000us         0.00%       0.000us       0.000us          5857  
                                              aten::all         0.05%      88.077ms         0.06%     100.136ms      17.097us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       3.642ms         0.00%       3.642ms       0.149us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0       1.093ms      78.097us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       6.004ms         0.01%      14.206ms       6.328us       0.000us         0.00%       0.000us       0.000us          2245  
                                          aten::reshape         0.07%     121.963ms         0.12%     217.114ms       5.025us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      71.435ms     148.513us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.01%       8.861ms         0.01%      19.146ms       4.693us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.00%       8.569ms         0.02%      28.589ms      10.829us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.02%      35.364ms         0.02%      43.017ms       5.845us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.564ms         0.00%       3.324ms       4.617us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      40.295ms         0.03%      47.983ms       5.998us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.620us         0.00%       1.620us       0.231us       0.000us         0.00%       0.000us       0.000us             7  
                              hipDevicePrimaryCtxRetain         0.00%       2.686us         0.00%       2.686us       0.384us       0.000us         0.00%       0.000us       0.000us             7  
                             hipDevicePrimaryCtxRelease         0.00%       1.515us         0.00%       1.515us       0.216us       0.000us         0.00%       0.000us       0.000us             7  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      49.495ms         0.03%      49.495ms       2.732us       0.000us         0.00%       0.000us       0.000us         18114  
                                              hipMemset         0.00%      23.986us         0.00%      23.986us      11.993us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.22%     377.962ms         0.22%     377.962ms     125.987ms       0.000us         0.00%       0.000us       0.000us             3  
                               hipExtModuleLaunchKernel         0.17%     300.847ms         0.17%     300.877ms       7.661us       0.000us         0.00%       0.000us       0.000us         39274  
                                 aten::split_with_sizes         0.03%      58.574ms         0.04%      75.379ms      13.087us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      35.498ms         0.02%      35.503ms       2.311us       0.000us         0.00%       0.000us       0.000us         15360  
                                      hipModuleLoadData         0.25%     437.134ms         0.25%     437.134ms     109.284ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     752.872us         0.00%       1.720ms     429.905us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       7.401ms         0.01%       8.817ms      36.736us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     901.545us         0.00%     901.545us       2.817us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      42.173ms         0.07%     123.089ms       7.850us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      19.901ms         0.05%      80.916ms       5.160us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     505.160us         0.00%       2.869ms      35.863us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.273ms         0.00%       2.364ms      29.549us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      59.254ms         0.08%     140.214ms       6.589us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      20.867ms         0.05%      80.960ms       3.805us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      41.882ms         0.05%      94.390ms       3.907us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.099ms         0.00%       2.873ms      11.972us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     421.608us         0.00%       1.774ms       7.393us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     315.908us         0.00%       1.008ms      12.594us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     691.627us         0.00%     691.627us       8.645us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     980.586us         0.21%     372.656ms     372.656ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      19.994ms         0.01%      22.623ms       2.945us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.629ms         0.00%       2.629ms       0.342us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       5.525ms         0.01%      20.915ms      10.458us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       4.120ms         0.01%      15.391ms       7.695us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       4.976ms         0.01%      13.564ms       7.064us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       2.223ms         0.00%       8.587ms       4.473us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     376.608us         0.00%     376.608us       0.196us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.230ms         0.00%       3.401ms      42.507us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       2.171ms         0.00%       2.171ms      27.137us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       2.117ms         0.00%       2.893ms      36.167us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.102ms     210.163us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      17.262us         0.00%      36.081us       9.020us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 174.408s
Self CUDA time total: 160.868s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       82.293s        53.23%       82.293s       82.293s             1  
                                             bert_train        36.88%       64.418s        71.04%      124.077s      124.077s       0.000us         0.00%       36.787s       36.787s             1  
                                            aten::copy_        13.31%       23.252s        15.91%       27.796s     351.602us       16.958s        10.97%       17.001s     215.048us         79055  
                                               aten::to         0.04%      69.221ms        15.91%       27.784s     526.919us       0.000us         0.00%       12.384s     234.855us         52729  
                                         aten::_to_copy         0.11%     198.036ms        15.87%       27.715s     635.876us       0.000us         0.00%       12.384s     284.127us         43585  
                                      aten::masked_fill         0.04%      75.946ms         0.26%     452.370ms      47.122us       0.000us         0.00%       11.975s       1.247ms          9600  
                                     aten::masked_fill_         0.11%     198.836ms         0.26%     451.597ms      27.536us       11.180s         7.23%       11.181s     681.740us         16400  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      15.470ms         0.09%     164.979ms      42.963us       0.000us         0.00%        7.919s       2.062ms          3840  
                                    MaskedFillBackward0         0.00%       6.233ms         0.09%     149.509ms      38.935us       0.000us         0.00%        7.919s       2.062ms          3840  
                                              aten::bmm         0.26%     460.485ms         0.32%     558.967ms      41.590us        7.336s         4.75%        7.336s     545.839us         13440  
                                     record_param_comms         2.86%        5.001s         4.12%        7.192s     207.192us        5.108s         3.30%        7.325s     211.020us         34714  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.613s         4.28%        6.613s       1.480ms          4468  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       7.211ms         0.04%      63.180ms      32.906us       0.000us         0.00%        6.506s       3.389ms          1920  
                                       SoftmaxBackward0         0.00%       6.071ms         0.03%      55.969ms      29.151us       0.000us         0.00%        6.506s       3.389ms          1920  
                           aten::_softmax_backward_data         0.01%      16.662ms         0.03%      49.899ms      25.989us        3.358s         2.17%        6.506s       3.389ms          1920  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.283s         4.06%        6.283s     766.316us          8199  
                                       c10d::allreduce_         0.25%     442.758ms         2.19%        3.829s     227.781us       0.000us         0.00%        5.945s     353.634us         16811  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.932s         3.84%        5.932s       1.279ms          4638  
autograd::engine::evaluate_function: _LayerNormLinea...         0.05%      81.358ms         2.45%        4.285s       1.116ms       0.000us         0.00%        5.379s       1.401ms          3840  
                               _LayerNormLinearBackward         1.63%        2.843s         2.38%        4.149s       1.081ms     469.081ms         0.30%        5.228s       1.361ms          3840  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      12.436ms         0.04%      78.527ms      20.032us       0.000us         0.00%        5.177s       1.321ms          3920  
                                        ToCopyBackward0         0.00%       5.637ms         0.04%      66.091ms      16.860us       0.000us         0.00%        5.177s       1.321ms          3920  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        5.104s         3.30%        5.104s     529.054us          9647  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        5.076s         3.28%        5.076s     531.186us          9556  
                                            aten::clone         0.07%     129.112ms         0.47%     817.632ms      23.668us       0.000us         0.00%        4.613s     133.540us         34546  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.565s         2.95%        4.565s     980.917us          4654  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.494s         2.91%        4.494s     560.876us          8013  
                                     tex_ts::te_gemm_ts         1.32%        2.312s         1.95%        3.400s      88.540us        4.492s         2.91%        4.494s     117.029us         38400  
                                          aten::softmax         0.01%      14.231ms         0.09%     163.707ms      28.421us       0.000us         0.00%        4.341s     753.561us          5760  
                                         aten::_softmax         0.05%      90.384ms         0.09%     149.476ms      25.951us        4.340s         2.81%        4.341s     753.561us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.340s         2.81%        4.340s       1.703ms          2548  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.972s         2.57%        3.972s     889.270us          4467  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.877s         2.51%        3.877s     336.521us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.358s         2.17%        3.358s       1.749ms          1920  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      15.105ms         0.10%     172.309ms      89.744us       0.000us         0.00%        3.206s       1.670ms          1920  
                                       BaddbmmBackward0         0.01%      16.261ms         0.09%     157.204ms      81.877us       0.000us         0.00%        3.206s       1.670ms          1920  
                                              aten::mul         0.09%     156.683ms         0.13%     225.912ms      28.342us        3.184s         2.06%        3.184s     399.443us          7971  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.150s         2.04%        3.150s       1.435ms          2195  
                                                _Linear         1.27%        2.213s         1.91%        3.340s     869.690us     153.822ms         0.10%        2.221s     578.437us          3840  
                                       aten::logical_or         0.07%     127.194ms         0.22%     381.072ms      33.079us     938.822ms         0.61%        1.880s     163.183us         11520  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.874s         1.21%        1.874s     409.611us          4574  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      18.525ms         0.10%     175.992ms      91.662us       0.000us         0.00%        1.798s     936.586us          1920  
                                           BmmBackward0         0.01%      11.360ms         0.09%     157.467ms      82.014us       0.000us         0.00%        1.798s     936.586us          1920  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      34.126ms         1.44%        2.516s     655.246us       0.000us         0.00%        1.756s     457.262us          3840  
                                        _LinearBackward         1.15%        2.003s         1.42%        2.482s     646.359us     205.667ms         0.13%        1.756s     457.262us          3840  
                                              aten::sub         0.07%     117.663ms         0.09%     151.536ms      23.065us        1.626s         1.05%        1.626s     247.415us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.623s         1.05%        1.623s     637.028us          2548  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.565s         1.01%        1.565s     815.317us          1920  
                                          aten::dropout         0.01%      12.597ms         0.07%     129.365ms      21.507us       0.000us         0.00%        1.497s     248.923us          6015  
                                   aten::native_dropout         0.03%      45.530ms         0.06%     111.911ms      55.705us        1.497s         0.97%        1.497s     745.278us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.497s         0.97%        1.497s     748.556us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.407s         0.91%        1.407s      81.491us         17261  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      10.241ms         0.04%      63.955ms      31.929us       0.000us         0.00%        1.397s     697.561us          2003  
                                 NativeDropoutBackward0         0.00%       6.423ms         0.03%      53.714ms      26.817us       0.000us         0.00%        1.397s     697.561us          2003  
                          aten::native_dropout_backward         0.01%      17.442ms         0.03%      47.290ms      23.610us        1.397s         0.90%        1.397s     697.561us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.397s         0.90%        1.397s     698.607us          2000  
                                   hipStreamIsCapturing         0.03%      59.941ms         0.03%      59.943ms       1.177us        1.309s         0.85%        1.309s      25.703us         50915  
                                          aten::baddbmm         0.24%     422.944ms         0.51%     891.425ms     154.761us        1.171s         0.76%        1.172s     203.505us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.134s         0.73%        1.134s     590.478us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      21.183ms         0.56%     974.780ms     253.849us       0.000us         0.00%        1.004s     261.478us          3840  
                               CompiledFunctionBackward         0.25%     437.464ms         0.55%     953.597ms     248.333us       0.000us         0.00%        1.004s     261.478us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     938.822ms         0.61%     938.822ms     368.455us          2548  
                                       c10d::broadcast_         0.02%      36.215ms         0.46%     801.861ms       1.667ms       0.000us         0.00%     938.606ms       1.951ms           481  
                                 triton_red_fused_sum_1         0.02%      30.152ms         0.03%      50.429ms      13.133us     899.252ms         0.58%     899.252ms     234.180us          3840  
                                      aten::logical_not         0.10%     169.674ms         0.29%     500.847ms      21.738us     328.685ms         0.21%     658.775ms      28.593us         23040  
                                  hipExtMallocWithFlags         0.03%      49.038ms         0.03%      49.038ms      11.943us     581.656ms         0.38%     581.656ms     141.660us          4106  
                                   hipDeviceGetPCIBusId         0.00%       8.180ms         0.00%       8.180ms       0.766us     525.775ms         0.34%     525.775ms      49.216us         10683  
                                        hipEventDestroy         0.02%      39.975ms         0.02%      40.329ms       2.016us     510.159ms         0.33%     510.323ms      25.514us         20002  
                                      hipGetProcAddress         0.04%      75.651ms         0.04%      75.667ms       0.973us     474.405ms         0.31%     474.462ms       6.103us         77745  
                                  Torch-Compiled Region         0.59%        1.031s         1.78%        3.115s     162.069us       0.000us         0.00%     448.611ms      23.341us         19220  
                                       _LayerNormLinear         0.44%     772.051ms         1.19%        2.081s     541.858us     277.091ms         0.18%     431.233ms     112.300us          3840  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.724ms         0.00%       2.724ms       0.196us     410.012ms         0.27%     410.012ms      29.472us         13912  
                                       hipCtxGetCurrent         0.01%      10.991ms         0.01%      10.991ms       0.186us     390.180ms         0.25%     390.180ms       6.604us         59079  
                                             aten::add_         0.08%     145.199ms         0.15%     265.914ms       8.463us     347.741ms         0.22%     347.741ms      11.068us         31420  
                                          c10d::barrier         0.00%     900.111us         1.36%        2.370s      62.373ms       0.000us         0.00%     338.953ms       8.920ms            38  
                                       CompiledFunction         0.73%        1.278s         1.05%        1.835s     158.977us       0.000us         0.00%     338.545ms      29.337us         11540  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     328.685ms         0.21%     328.685ms      64.499us          5096  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     312.686ms         0.20%     312.686ms      61.371us          5095  
                                              aten::sum         0.24%     411.780ms         0.50%     871.678ms      42.828us     226.412ms         0.15%     301.228ms      14.800us         20353  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     282.197ms         0.18%     282.197ms     282.197ms             1  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     267.309ms         0.17%     267.309ms      46.408us          5760  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     260.486ms         0.17%     260.486ms      67.835us          3840  
                  triton_poi_fused_add_native_dropout_0         0.05%      95.229ms         0.08%     142.521ms      37.018us     254.450ms         0.16%     256.101ms      66.520us          3850  
autograd::engine::evaluate_function: torch::autograd...         0.17%     288.823ms         0.32%     563.299ms      23.315us       0.000us         0.00%     195.732ms       8.101us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     193.815ms         0.13%     193.815ms       8.103us         23920  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.680ms         0.07%     119.860ms       1.498ms       0.000us         0.00%     190.648ms       2.383ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      20.618ms         0.07%     118.181ms       1.477ms       0.000us         0.00%     190.648ms       2.383ms            80  
                                   hipStreamSynchronize         0.12%     204.998ms         0.18%     313.233ms     102.197us     186.578ms         0.12%     190.454ms      62.138us          3065  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     176.273ms         0.11%     176.273ms      34.003us          5184  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     174.729ms         0.11%     174.729ms      34.301us          5094  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.01%      22.947ms         0.40%     704.409ms     366.880us       0.000us         0.00%     162.706ms      84.743us          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     162.182ms         0.10%     162.182ms      36.413us          4454  
                                              aten::cat         0.14%     247.136ms         0.17%     296.413ms      35.627us     138.816ms         0.09%     138.969ms      16.703us          8320  
                             _VocabParallelCrossEntropy         0.05%      84.136ms         0.18%     307.346ms       1.281ms       0.000us         0.00%     138.795ms     578.311us           240  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     136.623ms         0.09%     136.623ms      34.853us          3920  
                                         hipMemcpyAsync         0.12%     212.038ms         0.12%     212.080ms      17.663us     129.556ms         0.08%     129.923ms      10.821us         12007  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.006ms        22.90%       40.000s     166.666ms       0.000us         0.00%     128.280ms     534.498us           240  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     127.979ms         0.08%     127.979ms      12.429us         10297  
                                     EmbeddingBackward0         0.00%       3.042ms        22.90%       39.992s     166.635ms       0.000us         0.00%     127.182ms     529.926us           240  
                               aten::embedding_backward         0.00%       3.022ms        22.90%       39.989s     166.623ms       0.000us         0.00%     127.182ms     529.926us           240  
                         aten::embedding_dense_backward         1.22%        2.133s        22.89%       39.986s     166.610ms     121.030ms         0.08%     127.182ms     529.926us           240  
                                       aten::contiguous         0.02%      30.704ms         0.33%     572.618ms      24.853us       0.000us         0.00%     124.489ms       5.403us         23040  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      13.683ms         0.12%     202.646ms     105.545us       0.000us         0.00%     117.271ms      61.079us          1920  
                                 _SplitAlongDimBackward         0.08%     143.363ms         0.11%     188.963ms      98.418us       0.000us         0.00%     117.271ms      61.079us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     117.271ms         0.08%     117.271ms      61.079us          1920  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     115.602ms         0.07%     115.602ms      53.520us          2160  
                                         hipMemsetAsync         0.06%     113.240ms         0.06%     113.254ms       9.650us     106.449ms         0.07%     106.449ms       9.070us         11736  
             triton_poi_fused_native_dropout_backward_0         0.03%      56.163ms         0.05%      84.920ms      22.115us     104.825ms         0.07%     104.825ms      27.298us          3840  
                                               aten::mm         0.03%      54.328ms         0.06%     108.960ms     123.818us     101.073ms         0.07%     101.073ms     114.856us           880  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      99.704ms         0.06%      99.704ms      39.146us          2547  
                             c10d::allreduce_coalesced_         0.00%       1.760ms         0.06%     110.070ms      11.007ms       0.000us         0.00%      97.994ms       9.799ms            10  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      86.830ms         0.06%      86.830ms      11.359us          7644  
                                           aten::matmul         0.00%       3.306ms         0.05%      84.223ms     210.558us       0.000us         0.00%      83.832ms     209.580us           400  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      82.967ms         0.05%      82.967ms       7.084us         11712  
                         _ReduceFromModelParallelRegion         0.01%      26.085ms         0.04%      67.878ms     282.825us       0.000us         0.00%      82.160ms     342.334us           240  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      81.104ms         0.05%      81.104ms      42.242us          1920  
                                           aten::arange         0.09%     150.502ms         0.25%     434.081ms      17.617us      40.211ms         0.03%      80.688ms       3.275us         24640  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.23%     393.923ms         0.39%     685.011ms      89.194us      79.988ms         0.05%      80.041ms      10.422us          7680  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      80.023ms         0.05%      80.023ms      31.406us          2548  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      74.803ms         0.05%      74.803ms      19.082us          3920  
                                  hipModuleLaunchKernel         0.13%     223.478ms         0.13%     223.516ms       6.573us      67.294ms         0.04%      68.494ms       2.014us         34004  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      67.164ms         0.04%      67.164ms     279.851us           240  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      66.381ms         0.04%      66.381ms      15.466us          4292  
                                           GeLUFunction         0.11%     200.076ms         0.66%        1.155s     200.509us       0.000us         0.00%      61.762ms      10.722us          5760  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      60.797ms         0.04%      60.797ms      15.832us          3840  
                        triton_poi_fused_add_mul_tanh_0         0.08%     140.778ms         0.09%     165.570ms      28.695us      60.424ms         0.04%      60.510ms      10.487us          5770  
                                       hipStreamDestroy         0.03%      52.599ms         0.03%      52.599ms      20.956us      56.957ms         0.04%      56.957ms      22.692us          2510  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      55.854ms         0.04%      55.854ms      29.091us          1920  
                                            aten::fill_         0.08%     144.414ms         0.10%     177.485ms       6.137us      51.420ms         0.03%      51.473ms       1.780us         28919  
        LinearWithGradAccumulationAndAsyncCommunication         0.01%       9.468ms         0.02%      29.944ms     124.765us       0.000us         0.00%      50.106ms     208.775us           240  
                                   GeLUFunctionBackward         0.03%      50.076ms         0.35%     611.281ms     318.375us       0.000us         0.00%      48.880ms      25.458us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      27.503ms         0.02%      42.549ms      22.161us      48.880ms         0.03%      48.880ms      25.458us          1920  
                                 hipDeviceCanAccessPeer         0.00%     343.160us         0.00%     343.160us       0.188us      48.805ms         0.03%      48.805ms      26.699us          1828  
                                    hipMemcpyWithStream        25.32%       44.230s        25.33%       44.233s      49.039ms       0.000us         0.00%      47.460ms      52.617us           902  
                               hipStreamCreateWithFlags         0.29%     510.379ms         0.29%     510.379ms     201.731us      47.092ms         0.03%      47.092ms      18.613us          2530  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      42.017ms         0.03%      42.017ms       8.245us          5096  
                                    hipIpcOpenMemHandle         0.05%      84.943ms         0.05%      84.943ms      52.727us      41.225ms         0.03%      41.225ms      25.589us          1611  
                                 triton_poi_fused_add_0         0.13%     235.695ms         0.14%     250.345ms      32.597us      38.786ms         0.03%      39.645ms       5.162us          7680  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      37.654ms         0.02%      37.654ms       7.389us          5096  
                                          aten::randint         0.02%      41.539ms         0.09%     163.769ms      42.493us       0.000us         0.00%      36.270ms       9.411us          3854  
                                            aten::zero_         0.05%      78.976ms         0.14%     244.945ms      10.816us       0.000us         0.00%      35.859ms       1.583us         22646  
                                            aten::zeros         0.05%      83.813ms         0.21%     371.891ms      16.598us       0.000us         0.00%      35.536ms       1.586us         22406  
                                          aten::random_         0.04%      71.435ms         0.07%     119.475ms      31.008us      33.594ms         0.02%      34.972ms       9.077us          3853  
                                     hipIpcGetMemHandle         0.01%      10.820ms         0.01%      10.820ms       6.742us      34.405ms         0.02%      34.405ms      21.436us          1605  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      33.594ms         0.02%      33.594ms       8.726us          3850  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      33.255ms         0.02%      33.255ms       8.660us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      32.009ms         0.02%      32.009ms      12.562us          2548  
                                hipPointerGetAttributes         0.00%       3.799ms         0.00%       3.872ms       4.654us      30.895ms         0.02%      30.895ms      37.134us           832  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      28.712ms         0.02%      28.712ms     179.449us           160  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.520ms         0.03%      51.239ms     640.486us       0.000us         0.00%      27.864ms     348.302us            80  
                                 tex_ts::cast_to_fp8_ts         0.09%     149.980ms         0.13%     224.818ms      29.273us      26.653ms         0.02%      26.945ms       3.508us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      26.653ms         0.02%      26.653ms      21.254us          1254  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       4.035ms         0.03%      49.662ms     206.926us       0.000us         0.00%      24.242ms     101.008us           240  
                                              aten::exp         0.00%       3.207ms         0.01%      21.759ms      90.662us      23.786ms         0.02%      23.786ms      99.109us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.786ms         0.02%      23.786ms     224.397us           106  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      23.590ms         0.02%      23.590ms     294.875us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.280ms         0.02%      23.280ms      25.781us           903  
                                              aten::add         0.05%      90.034ms         0.07%     128.205ms      71.783us      22.499ms         0.01%      22.499ms      12.598us          1786  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      21.544ms         0.01%      21.544ms       7.656us          2814  
                                             aten::div_         0.00%       6.529ms         0.01%      14.820ms      30.876us      21.542ms         0.01%      21.542ms      44.880us           480  
                                     hipStreamWaitEvent         0.17%     301.891ms         0.17%     301.932ms      14.599us      20.716ms         0.01%      20.781ms       1.005us         20682  
                                           aten::linear         0.00%       3.894ms         0.04%      63.278ms      87.885us       0.000us         0.00%      20.774ms      28.853us           720  
                                            aten::addmm         0.03%      45.298ms         0.03%      53.009ms      73.623us      20.717ms         0.01%      20.774ms      28.853us           720  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.768ms         0.01%      20.768ms     195.923us           106  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.161ms         0.01%      20.161ms       7.913us          2548  
                                             aten::sub_         0.00%       5.082ms         0.00%       6.487ms      20.271us      19.903ms         0.01%      19.903ms      62.196us           320  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      19.693ms         0.01%      19.693ms       7.687us          2562  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.399ms         0.01%      19.399ms     183.007us           106  
                                           aten::cumsum         0.07%     124.607ms         0.09%     156.325ms      27.140us      19.290ms         0.01%      19.296ms       3.350us          5760  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      19.290ms         0.01%      19.290ms       7.571us          2548  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      17.756ms         0.01%      17.756ms      27.744us           640  
                     _VocabParallelCrossEntropyBackward         0.01%      19.108ms         0.03%      45.669ms     570.869us       0.000us         0.00%      17.290ms     216.123us            80  
                                         AddmmBackward0         0.00%       3.089ms         0.02%      37.855ms     157.730us       0.000us         0.00%      17.241ms      71.838us           240  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      17.029ms         0.01%      17.029ms      80.325us           212  
                                        aten::embedding         0.00%       6.644ms         0.02%      29.004ms      40.284us       0.000us         0.00%      16.969ms      23.569us           720  
                                     aten::index_select         0.01%      12.514ms         0.01%      19.904ms      27.644us      16.969ms         0.01%      16.969ms      23.569us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.969ms         0.01%      16.969ms      52.864us           321  
                                             aten::ones         0.00%       1.386ms         0.00%       8.049ms      16.768us       0.000us         0.00%      14.898ms      31.037us           480  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      14.863ms         0.01%      14.863ms     140.220us           106  
                                            aten::index         0.01%      14.447ms         0.04%      72.523ms     127.907us       2.584ms         0.00%      13.873ms      24.468us           567  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.564ms         0.01%      13.564ms      84.775us           160  
                                             aten::mul_         0.00%       6.525ms         0.00%       7.362ms       5.752us      13.074ms         0.01%      13.074ms      10.214us          1280  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.588ms         0.01%      12.588ms     118.757us           106  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.972ms         0.01%      11.972ms     112.942us           106  
                                          aten::nonzero         0.00%       5.707ms         0.02%      38.782ms     158.293us      11.283ms         0.01%      11.283ms      46.055us           245  
                                       aten::index_put_         0.00%       6.182ms         0.11%     193.129ms     172.436us       0.000us         0.00%      10.356ms       9.247us          1120  
                                 aten::_index_put_impl_         0.00%       8.044ms         0.11%     186.946ms     166.916us     897.075us         0.00%      10.356ms       9.247us          1120  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.831ms         0.01%       9.831ms      40.964us           240  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       9.783ms         0.01%       9.783ms      40.761us           240  
                                              aten::max         0.00%       7.556ms         0.02%      37.122ms     146.150us       9.108ms         0.01%       9.772ms      38.473us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.240ms         0.01%       9.240ms      22.105us           418  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.283ms         0.01%      12.963ms     162.036us       0.000us         0.00%       9.168ms     114.594us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.607ms         0.01%      10.680ms     133.500us       9.168ms         0.01%       9.168ms     114.594us            80  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.094ms         0.01%       9.094ms      85.796us           106  
autograd::engine::evaluate_function: torch::autograd...         0.00%       1.920ms         0.02%      26.965ms     337.065us       0.000us         0.00%       8.995ms     112.437us            80  
                            torch::autograd::CopySlices         0.00%       3.694ms         0.01%      25.045ms     313.061us       0.000us         0.00%       8.995ms     112.437us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       8.446ms         0.01%       8.446ms      12.312us           686  
                           FusedLayerNormAffineFunction         0.01%      14.860ms         0.01%      24.806ms     103.357us       8.047ms         0.01%       8.047ms      33.530us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       8.047ms         0.01%       8.047ms      75.917us           106  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.809ms         0.00%       6.809ms      85.112us            80  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       6.707ms         0.00%       6.707ms      27.945us           240  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     509.749us         0.00%       2.624ms     262.417us       6.650ms         0.00%       6.650ms     664.980us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.650ms         0.00%       6.650ms      60.453us           110  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       6.412ms         0.00%       6.412ms       6.679us           960  
         _compile.<locals>.compile_inner (dynamo_timed)         0.09%     155.724ms         2.08%        3.634s     363.400ms       0.000us         0.00%       6.240ms     624.043us            10  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      35.807ms         1.96%        3.423s     342.294ms       0.000us         0.00%       6.115ms     611.542us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.40%     700.992ms         1.94%        3.387s     338.714ms       0.000us         0.00%       6.115ms     611.542us            10  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       5.512ms         0.00%       5.512ms      34.452us           160  
                                        hipLaunchKernel         0.81%        1.418s         0.81%        1.418s       9.229us       3.361ms         0.00%       4.685ms       0.030us        153676  
                                        aten::index_put         0.00%       1.878ms         0.01%      11.423ms     137.620us       0.000us         0.00%       4.671ms      56.277us            83  
                                      IndexPutBackward0         0.00%       1.075ms         0.01%      11.321ms     141.510us       0.000us         0.00%       4.671ms      58.388us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       4.360ms         0.00%       4.360ms      54.506us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.271ms         0.00%       4.271ms      53.383us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     923.528us         0.01%      21.803ms     272.543us       0.000us         0.00%       4.165ms      52.059us            80  
                                     _LayerNormBackward         0.00%       5.024ms         0.01%      20.880ms     260.999us       4.165ms         0.00%       4.165ms      52.059us            80  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     705.908us         0.00%       2.999ms      37.493us       0.000us         0.00%       4.115ms      51.443us            80  
                                          GeluBackward0         0.00%     460.078us         0.00%       2.294ms      28.669us       0.000us         0.00%       4.115ms      51.443us            80  
                                    aten::gelu_backward         0.00%       1.187ms         0.00%       1.833ms      22.918us       4.115ms         0.00%       4.115ms      51.443us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       4.115ms         0.00%       4.115ms      51.443us            80  
                            hipGetDevicePropertiesR0600         0.05%      84.533ms         0.05%      84.536ms       0.920us       4.048ms         0.00%       4.058ms       0.044us         91926  
                                  hipMemGetAddressRange         0.00%     176.335us         0.00%     176.335us       0.393us       3.836ms         0.00%       3.836ms       8.543us           449  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     622.194us         0.00%       4.126ms      51.580us       0.000us         0.00%       3.559ms      44.491us            80  
                                          hipHostMalloc         0.15%     256.711ms         0.15%     269.583ms       2.174ms     415.734us         0.00%       3.325ms      26.811us           124  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      19.120ms         1.28%        2.233s     223.307ms       0.000us         0.00%       3.246ms     324.591us            10  
                        compile_fx_inner (dynamo_timed)         0.05%      90.429ms         1.49%        2.594s     235.797ms       0.000us         0.00%       3.246ms     295.083us            11  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us       3.105ms         0.00%       3.105ms      14.442us           215  
                                             aten::gelu         0.00%       4.259ms         0.01%      10.388ms      43.284us       2.774ms         0.00%       2.774ms      11.559us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.774ms         0.00%       2.774ms      26.171us           106  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.584ms         0.00%       2.584ms      13.671us           189  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.557ms         0.00%       2.557ms       4.797us           533  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.456ms         0.00%       2.456ms      23.166us           106  
                                              aten::div         0.01%      11.669ms         0.01%      14.927ms      22.481us       2.378ms         0.00%       2.378ms       3.581us           664  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.328ms         0.00%       2.328ms       6.032us           386  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     568.570us         0.00%       7.136ms      44.599us       0.000us         0.00%       2.317ms      14.480us           160  
                                         SliceBackward0         0.00%     447.812us         0.00%       6.567ms      41.045us       0.000us         0.00%       2.317ms      14.480us           160  
                                   aten::slice_backward         0.00%     880.986us         0.00%       6.119ms      38.246us       0.000us         0.00%       2.317ms      14.480us           160  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       2.258ms         0.00%       2.258ms       9.406us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.246ms         0.00%       2.246ms       5.272us           426  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       2.228ms         0.00%       2.228ms       4.614us           483  
                                             _LayerNorm         0.00%       6.693ms         0.01%      11.603ms     145.032us       1.906ms         0.00%       1.906ms      23.830us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.895ms         0.00%       1.895ms       6.075us           312  
                                  hipDeviceGetAttribute         0.00%     245.828us         0.00%     245.828us       3.669us       1.863ms         0.00%       1.863ms      27.800us            67  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.828ms         0.00%       1.828ms      17.245us           106  
      autograd::engine::evaluate_function: MulBackward0         0.01%      15.023ms         0.04%      70.298ms     408.707us       0.000us         0.00%       1.719ms       9.997us           172  
                                        SelectBackward0         0.00%     194.619us         0.00%       2.604ms      32.548us       0.000us         0.00%       1.684ms      21.045us            80  
                                  aten::select_backward         0.00%     398.485us         0.00%       2.409ms      30.115us       0.000us         0.00%       1.684ms      21.045us            80  
                                               aten::lt         0.01%      18.699ms         0.01%      21.434ms      29.770us       1.609ms         0.00%       1.609ms       2.235us           720  
                               aten::cross_entropy_loss         0.00%       1.684ms         0.01%      21.460ms      89.418us       0.000us         0.00%       1.565ms       6.520us           240  
                                   hipFuncGetAttributes         0.17%     288.327ms         0.17%     288.327ms       2.184ms       1.507ms         0.00%       1.507ms      11.420us           132  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.290ms         0.00%       1.290ms       6.058us           213  
      autograd::engine::evaluate_function: DivBackward0         0.00%       2.001ms         0.01%       8.863ms      55.395us       0.000us         0.00%       1.287ms       8.044us           160  
                                           DivBackward0         0.00%     831.197us         0.00%       6.862ms      42.886us       0.000us         0.00%       1.287ms       8.044us           160  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.257ms         0.00%       1.257ms       6.756us           186  
                                   hipDeviceSynchronize         0.00%     698.242us         0.00%     698.242us      20.537us       1.247ms         0.00%       1.247ms      36.680us            34  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.227ms         0.00%       1.227ms       7.672us           160  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.138ms         0.00%       1.138ms       5.345us           213  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.983ms         0.01%      10.393ms     129.911us       0.000us         0.00%       1.122ms      14.019us            80  
                                       NllLossBackward0         0.00%       1.026ms         0.00%       8.410ms     105.121us       0.000us         0.00%       1.122ms      14.019us            80  
                                aten::nll_loss_backward         0.00%       2.966ms         0.00%       7.384ms      92.295us     651.695us         0.00%       1.122ms      14.019us            80  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us       1.117ms         0.00%       1.117ms       4.597us           243  
                                           MulBackward0         0.01%      10.770ms         0.02%      41.429ms     240.868us       0.000us         0.00%       1.104ms       6.420us           172  
                                               aten::ge         0.00%       6.924ms         0.00%       7.992ms      16.651us       1.103ms         0.00%       1.103ms       2.298us           480  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.102ms         0.00%       1.102ms       4.537us           243  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.077ms         0.00%       1.077ms      13.462us            80  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.038ms         0.00%       1.038ms      12.969us            80  
                                           aten::__or__         0.00%       1.468ms         0.01%      23.681ms      49.334us       0.000us         0.00%       1.021ms       2.127us           480  
                                       aten::bitwise_or         0.01%       8.854ms         0.01%      22.213ms      46.276us       1.021ms         0.00%       1.021ms       2.127us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.021ms         0.00%       1.021ms       4.794us           213  
                                 c10d::_allgather_base_         0.00%     274.542us         0.00%       1.634ms     116.685us       0.000us         0.00%       1.011ms      72.212us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       1.011ms         0.00%       1.011ms      84.247us            12  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     999.698us         0.00%     999.698us       9.431us           106  
                               TorchDynamo Cache Lookup         0.13%     220.870ms         0.13%     220.907ms      11.493us       0.000us         0.00%     973.611us       0.051us         19221  
                                            aten::empty         0.52%     909.699ms         0.52%     915.887ms       3.492us       0.000us         0.00%     969.331us       0.004us        262318  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     932.020us         0.00%     932.020us       3.835us           243  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     926.932us         0.00%     926.932us       3.862us           240  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     897.075us         0.00%     897.075us      11.213us            80  
                                      aten::log_softmax         0.00%       1.233ms         0.00%       6.676ms      27.817us       0.000us         0.00%     873.531us       3.640us           240  
                                     aten::_log_softmax         0.00%       4.161ms         0.00%       5.289ms      22.039us     873.531us         0.00%     873.531us       3.640us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     873.531us         0.00%     873.531us       8.241us           106  
                                               aten::gt         0.02%      36.278ms         0.03%      45.518ms      10.486us     845.393us         0.00%     845.393us       0.195us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     843.228us         0.00%     843.228us       3.484us           242  
                                             aten::tanh         0.01%      16.437ms         0.02%      29.460ms     108.708us     807.102us         0.00%     807.102us       2.978us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     807.102us         0.00%     807.102us       7.614us           106  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     777.713us         0.00%     777.713us       7.337us           106  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     772.137us         0.00%     772.137us       9.652us            80  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     739.427us         0.00%     739.427us       3.081us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     737.931us         0.00%     737.931us       6.962us           106  
                                             aten::item         0.02%      26.941ms         0.10%     169.455ms      10.232us       0.000us         0.00%     712.067us       0.043us         16562  
                              aten::_local_scalar_dense         0.01%      14.109ms         0.08%     142.514ms       8.605us     701.202us         0.00%     712.067us       0.043us         16562  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     703.861us         0.00%     703.861us       8.798us            80  
                                      aten::nll_loss_nd         0.00%     807.361us         0.01%      13.100ms      54.585us       0.000us         0.00%     691.354us       2.881us           240  
                                         aten::nll_loss         0.00%     931.900us         0.01%      12.293ms      51.221us       0.000us         0.00%     691.354us       2.881us           240  
                                 aten::nll_loss_forward         0.00%       4.917ms         0.01%      11.361ms      47.338us     691.354us         0.00%     691.354us       2.881us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     691.354us         0.00%     691.354us       6.522us           106  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.457ms         0.02%      29.225ms     356.398us       0.000us         0.00%     685.981us       8.366us            82  
                                          TanhBackward0         0.00%       2.602ms         0.02%      27.767ms     338.628us       0.000us         0.00%     685.981us       8.366us            82  
                                    aten::tanh_backward         0.00%       3.505ms         0.01%      21.908ms     267.169us     685.981us         0.00%     685.981us       8.366us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     685.981us         0.00%     685.981us       8.575us            80  
                                          aten::maximum         0.00%     123.639us         0.01%      22.670ms       2.519ms      23.252us         0.00%     663.926us      73.770us             9  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     651.695us         0.00%     651.695us       8.146us            80  
                                              aten::log         0.00%       4.058ms         0.01%      10.288ms      42.865us     630.969us         0.00%     630.969us       2.629us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     630.969us         0.00%     630.969us       5.953us           106  
                                          aten::normal_         1.05%        1.832s         1.05%        1.834s      17.637ms     531.704us         0.00%     589.557us       5.669us           104  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     836.623us         0.00%       5.467ms      68.333us       0.000us         0.00%     589.277us       7.366us            80  
                                    LogSoftmaxBackward0         0.00%       1.323ms         0.00%       4.630ms      57.876us       0.000us         0.00%     589.277us       7.366us            80  
                       aten::_log_softmax_backward_data         0.00%       2.081ms         0.00%       3.308ms      41.344us     589.277us         0.00%     589.277us       7.366us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     589.277us         0.00%     589.277us       7.366us            80  
                                        aten::transpose         0.16%     284.869ms         0.20%     351.074ms       3.684us       0.000us         0.00%     573.079us       0.006us         95285  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       6.703ms         0.01%      12.708ms      79.422us     549.105us         0.00%     549.105us       3.432us           160  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     539.084us         0.00%     539.084us       2.246us           240  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     536.481us         0.00%     536.481us       6.706us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     536.228us         0.00%     536.228us       6.703us            80  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     531.704us         0.00%     531.704us       5.481us            97  
                                                hipFree         0.06%     106.792ms         0.06%     106.822ms       5.935ms     530.461us         0.00%     530.461us      29.470us            18  
                                        aten::ones_like         0.00%     471.823us         0.00%       2.405ms      30.068us       0.000us         0.00%     519.153us       6.489us            80  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     503.717us         0.00%     503.717us       2.099us           240  
                                             aten::rsub         0.00%       3.716ms         0.01%      10.872ms     126.422us       0.000us         0.00%     479.140us       5.571us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     479.140us         0.00%     479.140us       5.989us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     473.692us         0.00%     473.692us       5.921us            80  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     465.952us         0.00%     465.952us       4.355us           107  
                                           aten::select         0.22%     381.299ms         0.26%     462.314ms       4.723us       0.000us         0.00%     374.231us       0.004us         97887  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     350.766us         0.00%     350.766us       2.192us           160  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     300.611us         0.00%     300.611us       3.758us            80  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     215.694us         0.00%     215.694us       3.719us            58  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     212.811us         0.00%     212.811us       2.264us            94  
         GraphLowering.compile_to_module (dynamo_timed)         0.72%        1.264s         1.27%        2.217s     201.539ms       0.000us         0.00%     170.793us      15.527us            11  
                                             aten::rand         0.00%       2.819ms         0.00%       6.479ms     462.812us       0.000us         0.00%     150.056us      10.718us            14  
                                         aten::uniform_         0.01%      15.323ms         0.01%      17.565ms       1.351ms     150.056us         0.00%     150.056us      11.543us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     150.056us         0.00%     150.056us      30.011us             5  
                            hipGetDevicePropertiesR0000         0.00%      58.646us         0.00%      58.646us       5.865us     125.449us         0.00%     125.449us      12.545us            10  
                                         _SplitAlongDim         0.10%     176.711ms         0.14%     249.540ms      43.323us       0.000us         0.00%      75.213us       0.013us          5760  
                                              hipMemcpy         0.01%      13.295ms         0.01%      13.295ms     276.984us      70.291us         0.00%      70.291us       1.464us            48  
                                       aten::reciprocal         0.00%     161.579us         0.01%      11.490ms       1.149ms      67.196us         0.00%      67.196us       6.720us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      67.196us         0.00%      67.196us       6.720us            10  
enumerate(DataLoader)#_MultiProcessingDataLoaderIter...         0.03%      54.878ms         0.03%      54.916ms     228.818us       0.000us         0.00%      66.954us       0.279us           240  
                                    hipFuncSetAttribute         0.00%       9.258us         0.00%       9.258us       0.386us      63.707us         0.00%      63.707us       2.654us            24  
                                           aten::expand         0.04%      72.124ms         0.06%      96.503ms       2.664us       0.000us         0.00%      62.584us       0.002us         36229  
                                    hipModuleLoadDataEx         0.35%     615.238ms         0.35%     615.238ms      47.326ms      52.882us         0.00%      52.882us       4.068us            13  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      52.722us         0.00%      52.722us       5.272us            10  
                                       aten::lift_fresh         0.03%      58.289ms         0.04%      64.862ms      36.728us       0.000us         0.00%      45.586us       0.026us          1766  
                                    hipFuncGetAttribute         0.00%       5.815us         0.00%       5.815us       0.485us      39.731us         0.00%      39.731us       3.311us            12  
                                       aten::empty_like         0.12%     204.243ms         0.34%     586.543ms       6.596us       0.000us         0.00%      35.742us       0.000us         88930  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      29.908us         0.00%      29.908us       2.991us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.252us         0.00%      23.252us       2.584us             9  
                              hipDevicePrimaryCtxRetain         0.00%       2.459us         0.00%       2.459us       0.351us      22.492us         0.00%      22.492us       3.213us             7  
                               hipExtModuleLaunchKernel         0.16%     272.795ms         0.16%     272.849ms       6.900us       0.000us         0.00%      17.280us       0.000us         39545  
                                              aten::min         0.00%     129.524us         0.00%       5.690ms       1.138ms      15.356us         0.00%      15.356us       3.071us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.356us         0.00%      15.356us       5.119us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.791us         0.00%      13.791us       4.597us             3  
                                             aten::view         0.20%     344.668ms         0.20%     353.048ms       2.417us       0.000us         0.00%      12.990us       0.000us        146073  
                                          aten::reshape         0.06%     113.374ms         0.12%     202.648ms       4.690us       0.000us         0.00%      10.785us       0.000us         43206  
                                          aten::squeeze         0.05%      81.567ms         0.06%      97.761ms       4.243us       0.000us         0.00%      10.223us       0.000us         23040  
                                    aten::empty_strided         0.22%     379.417ms         0.22%     387.611ms       4.361us       0.000us         0.00%       7.056us       0.000us         88887  
                                               aten::eq         0.03%      44.255ms         0.03%      44.268ms       7.558us       0.000us         0.00%       5.653us       0.001us          5857  
                      Scheduler.__init__ (dynamo_timed)         0.11%     192.809ms         0.11%     192.872ms      17.534ms       0.000us         0.00%       5.613us       0.510us            11  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.165us         0.00%       2.165us       2.165us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.124us         0.00%       2.124us       2.124us             1  
                        hipDeviceGetStreamPriorityRange         0.00%       4.260us         0.00%       4.260us       4.260us       0.000us         0.00%       0.000us       0.000us             1  
                                              hipMalloc         0.01%      18.176ms         0.01%      18.191ms     110.920us       0.000us         0.00%       0.000us       0.000us           164  
                            hipStreamCreateWithPriority         0.00%     523.233us         0.00%     523.233us      87.206us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.121s      66.530us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      12.606ms         0.01%      12.607ms       1.273us       0.000us         0.00%       0.000us       0.000us          9902  
                                     hipExtLaunchKernel         0.06%     101.249ms         0.06%     101.260ms      10.228us       0.000us         0.00%       0.000us       0.000us          9900  
                                           aten::detach         0.04%      76.331ms         0.13%     227.864ms       6.423us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.07%     116.236ms         0.08%     143.509ms       4.243us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.01%      12.205ms         0.01%      21.865ms     176.328us       0.000us         0.00%       0.000us       0.000us           124  
                                prims::broadcast_in_dim         0.00%     393.818us         0.00%     514.056us      64.257us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.15%     262.887ms         0.15%     263.219ms       0.782us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%       1.462ms         0.00%       2.068ms     108.827us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     633.845us         0.00%       1.269ms      30.208us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     951.955us         0.00%       1.323ms      94.474us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     144.894us         0.00%     196.317us      98.158us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       4.780ms         0.01%       9.765ms     256.964us       0.000us         0.00%       0.000us       0.000us            38  
                                         prims::view_of         0.00%     710.504us         0.00%     921.988us      38.416us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       7.167ms         0.00%       7.302ms       7.614us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       6.190ms         0.00%       7.282ms       9.024us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%       1.092ms         0.00%       1.092ms       1.353us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     456.307us         0.00%     456.307us      14.720us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     132.753us         0.00%     132.753us      12.068us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      13.750ms         0.02%      30.233ms     118.098us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     725.606us         0.00%     725.606us       2.834us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     284.220us         0.00%     389.800us     129.933us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     146.316us         0.00%     146.316us      73.158us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     224.601us         0.00%     239.598us     119.799us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      38.577us         0.00%      38.577us       2.756us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.607ms         0.00%       3.167ms     633.441us       0.000us         0.00%       0.000us       0.000us             5  
                                            aten::slice         0.06%     103.251ms         0.07%     123.069ms       4.712us       0.000us         0.00%       0.000us       0.000us         26118  
                                        aten::index_add         0.00%     315.763us         0.00%       1.725ms       1.725ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     663.938us         0.00%     746.063us     373.032us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     319.165us         0.00%     319.165us     319.165us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.13%     226.106ms         0.13%     229.319ms      20.847ms       0.000us         0.00%       0.000us       0.000us            11  
                       Scheduler.codegen (dynamo_timed)         0.09%     152.259ms         0.09%     152.290ms      13.845ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.01%      10.047ms         0.01%      10.047ms     913.320us       0.000us         0.00%       0.000us       0.000us            11  
                                 hipPointerGetAttribute         0.03%      52.043ms         0.03%      52.043ms       0.829us       0.000us         0.00%       0.000us       0.000us         62810  
                                        aten::expand_as         0.00%       1.045ms         0.00%       3.645ms       6.714us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       2.234ms         0.00%       7.707ms     700.591us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     203.341us         0.00%     228.414us     114.207us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     197.391us         0.00%     197.391us      98.695us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%     101.999us         0.00%     129.932us     129.932us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     463.496us         0.00%       4.120ms       1.373ms       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     309.305us         0.00%     344.726us     114.909us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.516ms         0.00%       5.085ms     847.435us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%       1.175ms         0.00%       5.761ms     640.149us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.724ms         0.00%       3.839ms     639.813us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     464.308us         0.00%       1.206ms     401.947us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     303.290us         0.00%       1.536ms     511.906us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     642.914us         0.00%       1.232ms     410.810us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     459.775us         0.00%     486.254us     121.564us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.07%     121.929ms         0.07%     122.254ms       3.528us       0.000us         0.00%       0.000us       0.000us         34655  
                                              aten::all         0.05%      87.133ms         0.06%      98.742ms      16.859us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       3.396ms         0.00%       3.396ms       0.139us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     877.481us      62.677us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.865ms         0.01%      13.986ms       6.230us       0.000us         0.00%       0.000us       0.000us          2245  
                                         nccl:broadcast         0.00%       0.000us             0      67.366ms     140.055us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.00%       7.715ms         0.01%      18.470ms       4.527us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.00%       6.853ms         0.01%      24.504ms       9.282us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.02%      33.857ms         0.02%      41.047ms       5.577us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.424ms         0.00%       3.076ms       4.272us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      37.774ms         0.03%      45.097ms       5.637us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       2.472us         0.00%       2.472us       0.353us       0.000us         0.00%       0.000us       0.000us             7  
                             hipDevicePrimaryCtxRelease         0.00%       1.726us         0.00%       1.726us       0.247us       0.000us         0.00%       0.000us       0.000us             7  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      53.590ms         0.03%      53.590ms       2.929us       0.000us         0.00%       0.000us       0.000us         18294  
                                              hipMemset         0.00%      30.654us         0.00%      30.654us      15.327us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.29%     503.315ms         0.29%     503.315ms     167.772ms       0.000us         0.00%       0.000us       0.000us             3  
                                 aten::split_with_sizes         0.03%      56.028ms         0.04%      72.790ms      12.637us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      32.807ms         0.02%      32.807ms       2.136us       0.000us         0.00%       0.000us       0.000us         15360  
                                      hipModuleLoadData         0.31%     536.467ms         0.31%     536.467ms     134.117ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     897.362us         0.00%       2.130ms     532.516us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       7.132ms         0.00%       8.507ms      35.444us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     928.872us         0.00%     928.872us       2.903us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      36.216ms         0.06%     104.074ms       6.637us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      16.839ms         0.04%      67.858ms       4.328us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     512.286us         0.00%       3.380ms      42.246us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.320ms         0.00%       2.867ms      35.842us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      49.822ms         0.07%     118.519ms       5.570us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      17.926ms         0.04%      68.697ms       3.228us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      36.871ms         0.05%      82.430ms       3.412us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.120ms         0.00%       2.852ms      11.883us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     391.909us         0.00%       1.732ms       7.218us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     299.363us         0.00%     908.313us      11.354us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     608.950us         0.00%     608.950us       7.612us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     974.228us         0.22%     380.784ms     380.784ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      17.093ms         0.01%      19.322ms       2.515us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.230ms         0.00%       2.230ms       0.290us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       4.707ms         0.01%      17.641ms       8.820us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       3.670ms         0.01%      12.934ms       6.467us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       4.146ms         0.01%      11.201ms       5.834us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       1.902ms         0.00%       7.055ms       3.674us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     303.823us         0.00%     303.823us       0.158us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.156ms         0.00%       3.030ms      37.869us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.873ms         0.00%       1.873ms      23.414us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.659ms         0.00%       2.491ms      31.131us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.529ms     252.929us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      16.932us         0.00%      35.112us       8.778us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 174.661s
Self CUDA time total: 154.592s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       81.668s        51.61%       81.668s       81.668s             1  
                                             bert_train        37.13%       64.766s        70.75%      123.431s      123.431s       0.000us         0.00%       37.640s       37.640s             1  
                                            aten::copy_        13.58%       23.694s        16.39%       28.591s     362.757us       16.129s        10.19%       16.171s     205.180us         78815  
                                               aten::to         0.04%      65.368ms        16.36%       28.543s     543.796us       0.000us         0.00%       11.600s     220.991us         52489  
                                         aten::_to_copy         0.11%     192.972ms        16.32%       28.478s     657.006us       0.000us         0.00%       11.600s     267.611us         43345  
                                      aten::masked_fill         0.04%      74.290ms         0.26%     446.585ms      46.519us       0.000us         0.00%       11.490s       1.197ms          9600  
                                     record_param_comms         2.69%        4.700s         4.14%        7.221s     208.001us        8.563s         5.41%       11.360s     327.253us         34714  
                                     aten::masked_fill_         0.11%     195.144ms         0.26%     447.568ms      27.291us       10.736s         6.79%       10.738s     654.750us         16400  
                                       c10d::allreduce_         0.25%     434.159ms         2.27%        3.961s     235.638us       0.000us         0.00%        8.922s     530.740us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        8.535s         5.39%        8.535s     902.537us          9457  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        8.438s         5.33%        8.438s     883.952us          9546  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      15.704ms         0.10%     167.922ms      43.730us       0.000us         0.00%        7.669s       1.997ms          3840  
                                    MaskedFillBackward0         0.00%       6.293ms         0.09%     152.218ms      39.640us       0.000us         0.00%        7.669s       1.997ms          3840  
                                              aten::bmm         0.26%     455.670ms         0.32%     555.775ms      41.352us        6.841s         4.32%        6.841s     508.993us         13440  
autograd::engine::evaluate_function: _LayerNormLinea...         0.05%      81.850ms         2.49%        4.342s       1.131ms       0.000us         0.00%        6.717s       1.749ms          3840  
                               _LayerNormLinearBackward         1.64%        2.866s         2.41%        4.206s       1.095ms     495.793ms         0.31%        6.557s       1.708ms          3840  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       7.206ms         0.04%      64.190ms      33.432us       0.000us         0.00%        6.488s       3.379ms          1920  
                                       SoftmaxBackward0         0.00%       6.324ms         0.03%      56.984ms      29.679us       0.000us         0.00%        6.488s       3.379ms          1920  
                           aten::_softmax_backward_data         0.01%      16.829ms         0.03%      50.659ms      26.385us        3.351s         2.12%        6.488s       3.379ms          1920  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.332s         4.00%        6.332s       1.432ms          4421  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.978s         3.78%        5.978s     733.914us          8146  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.460s         3.45%        5.460s       1.189ms          4591  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      11.915ms         0.05%      79.766ms      20.348us       0.000us         0.00%        4.966s       1.267ms          3920  
                                        ToCopyBackward0         0.00%       5.624ms         0.04%      67.850ms      17.309us       0.000us         0.00%        4.966s       1.267ms          3920  
                                            aten::clone         0.07%     123.706ms         0.47%     813.177ms      23.539us       0.000us         0.00%        4.568s     132.222us         34546  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.456s         2.82%        4.456s     560.348us          7952  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.402s         2.78%        4.402s     955.633us          4606  
                                          aten::softmax         0.01%      13.929ms         0.09%     164.636ms      28.583us       0.000us         0.00%        4.251s     738.006us          5760  
                                         aten::_softmax         0.05%      91.330ms         0.09%     150.693ms      26.162us        4.251s         2.69%        4.251s     738.005us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.251s         2.69%        4.251s       1.700ms          2501  
                                     tex_ts::te_gemm_ts         1.35%        2.358s         1.97%        3.441s      89.612us        4.128s         2.61%        4.131s     107.591us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.601s         2.28%        3.601s     814.501us          4421  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.534s         2.23%        3.534s     306.782us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.351s         2.12%        3.351s       1.745ms          1920  
                                              aten::mul         0.09%     156.649ms         0.13%     226.228ms      28.381us        3.180s         2.01%        3.180s     398.895us          7971  
                                                _Linear         1.25%        2.185s         1.90%        3.321s     864.936us     145.590ms         0.09%        3.171s     825.806us          3840  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.140s         1.98%        3.140s       1.432ms          2193  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      15.658ms         0.10%     178.005ms      92.711us       0.000us         0.00%        3.017s       1.572ms          1920  
                                       BaddbmmBackward0         0.01%      16.202ms         0.09%     162.347ms      84.556us       0.000us         0.00%        3.017s       1.572ms          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.848s         1.17%        1.848s     408.453us          4525  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      18.539ms         0.10%     177.381ms      92.386us       0.000us         0.00%        1.774s     924.176us          1920  
                                           BmmBackward0         0.01%      11.536ms         0.09%     158.842ms      82.730us       0.000us         0.00%        1.774s     924.176us          1920  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      35.247ms         1.45%        2.529s     658.534us       0.000us         0.00%        1.699s     442.505us          3840  
                                        _LinearBackward         1.14%        1.997s         1.43%        2.494s     649.356us     210.596ms         0.13%        1.699s     442.505us          3840  
                                       aten::logical_or         0.07%     126.791ms         0.22%     379.974ms      32.984us     785.420ms         0.50%        1.571s     136.358us         11520  
                                          aten::dropout         0.01%      11.914ms         0.07%     124.340ms      20.672us       0.000us         0.00%        1.495s     248.576us          6015  
                                   aten::native_dropout         0.03%      43.843ms         0.06%     108.782ms      54.147us        1.495s         0.94%        1.495s     744.245us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.495s         0.94%        1.495s     747.536us          2000  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.465s         0.93%        1.465s     763.240us          1920  
                                          c10d::barrier         0.00%     832.898us         1.09%        1.898s      49.955ms       0.000us         0.00%        1.438s      37.831ms            38  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      10.237ms         0.04%      64.827ms      32.365us       0.000us         0.00%        1.405s     701.285us          2003  
                                 NativeDropoutBackward0         0.00%       6.530ms         0.03%      54.590ms      27.254us       0.000us         0.00%        1.405s     701.285us          2003  
                          aten::native_dropout_backward         0.01%      17.472ms         0.03%      48.060ms      23.994us        1.405s         0.89%        1.405s     701.285us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.405s         0.89%        1.405s     702.337us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.383s         0.87%        1.383s      80.760us         17122  
                                              aten::sub         0.07%     116.404ms         0.09%     150.183ms      22.859us        1.372s         0.87%        1.372s     208.854us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.369s         0.87%        1.369s     547.548us          2501  
                                   hipStreamIsCapturing         0.03%      54.845ms         0.03%      54.845ms       1.089us        1.264s         0.80%        1.264s      25.099us         50349  
                                          aten::baddbmm         0.23%     407.523ms         0.50%     880.082ms     152.792us        1.166s         0.74%        1.167s     202.547us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.132s         0.72%        1.132s     589.501us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      21.162ms         0.56%     976.129ms     254.200us       0.000us         0.00%        1.002s     260.951us          3840  
                               CompiledFunctionBackward         0.25%     436.911ms         0.55%     954.966ms     248.689us       0.000us         0.00%        1.002s     260.951us          3840  
                                   hipDeviceGetPCIBusId         0.01%      15.588ms         0.01%      15.588ms       0.940us     902.851ms         0.57%     902.851ms      54.457us         16579  
                                       c10d::broadcast_         0.02%      38.881ms         0.46%     810.543ms       1.685ms       0.000us         0.00%     894.933ms       1.861ms           481  
                                 triton_red_fused_sum_1         0.02%      29.957ms         0.03%      51.526ms      13.418us     889.631ms         0.56%     889.631ms     231.675us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     785.420ms         0.50%     785.420ms     314.042us          2501  
                                      aten::logical_not         0.10%     166.596ms         0.28%     488.733ms      21.212us     323.826ms         0.20%     650.424ms      28.230us         23040  
                                        hipEventDestroy         0.03%      59.272ms         0.03%      59.972ms       3.029us     561.648ms         0.35%     563.685ms      28.475us         19796  
                                   hipStreamSynchronize         0.39%     685.180ms         0.39%     685.227ms     212.210us     542.710ms         0.34%     543.287ms     168.252us          3229  
                                      hipGetProcAddress         0.04%      74.010ms         0.04%      74.010ms       0.953us     483.050ms         0.31%     483.050ms       6.223us         77621  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.590ms         0.00%       2.590ms       0.182us     453.850ms         0.29%     453.850ms      31.871us         14240  
                                  Torch-Compiled Region         0.57%     986.905ms         1.70%        2.970s     154.539us       0.000us         0.00%     424.773ms      22.101us         19220  
                                       hipCtxGetCurrent         0.01%      10.851ms         0.01%      10.851ms       0.184us     407.581ms         0.26%     407.581ms       6.912us         58965  
                                       _LayerNormLinear         0.41%     717.082ms         1.16%        2.026s     527.710us     259.028ms         0.16%     403.502ms     105.079us          3840  
                                             aten::add_         0.08%     143.858ms         0.16%     270.812ms       8.619us     379.705ms         0.24%     379.705ms      12.085us         31420  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     323.826ms         0.20%     323.826ms      64.739us          5002  
                                       CompiledFunction         0.68%        1.195s         1.00%        1.739s     150.669us       0.000us         0.00%     317.980ms      27.555us         11540  
                                              aten::sum         0.23%     405.674ms         0.49%     858.632ms      42.185us     219.384ms         0.14%     302.604ms      14.867us         20354  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     283.923ms         0.18%     283.923ms      56.762us          5002  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     275.799ms         0.17%     275.799ms     275.799ms             1  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     275.140ms         0.17%     275.140ms      47.767us          5760  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     262.116ms         0.17%     262.116ms      68.259us          3840  
                  triton_poi_fused_add_native_dropout_0         0.05%      92.851ms         0.08%     140.138ms      36.400us     242.457ms         0.15%     243.828ms      63.332us          3850  
autograd::engine::evaluate_function: torch::autograd...         0.16%     277.325ms         0.32%     558.154ms      23.102us       0.000us         0.00%     219.371ms       9.080us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     217.249ms         0.14%     217.249ms       9.082us         23920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     170.965ms         0.11%     170.965ms      38.419us          4450  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.01%      22.843ms         0.41%     706.733ms     368.090us       0.000us         0.00%     165.660ms      86.281us          1920  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     164.857ms         0.10%     164.857ms      32.274us          5108  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     164.310ms         0.10%     164.310ms      32.855us          5001  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     150.096ms         0.09%     150.096ms      38.290us          3920  
                                     hipIpcGetMemHandle         0.01%      10.590ms         0.01%      10.590ms       5.986us     149.840ms         0.09%     149.840ms      84.703us          1769  
                                              aten::cat         0.09%     161.293ms         0.12%     209.803ms      25.966us     139.203ms         0.09%     139.208ms      17.229us          8080  
                                  hipExtMallocWithFlags         0.03%      48.652ms         0.03%      48.655ms      11.395us     138.411ms         0.09%     138.411ms      32.415us          4270  
                             _VocabParallelCrossEntropy         0.05%      83.019ms         0.17%     302.533ms       1.261ms       0.000us         0.00%     135.384ms     564.102us           240  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.176ms        23.13%       40.347s     168.113ms       0.000us         0.00%     134.596ms     560.818us           240  
                                         hipMemsetAsync         0.07%     117.090ms         0.07%     117.118ms       9.913us     133.339ms         0.08%     133.339ms      11.287us         11814  
                                     EmbeddingBackward0         0.00%       3.122ms        23.12%       40.340s     168.082ms       0.000us         0.00%     133.235ms     555.146us           240  
                               aten::embedding_backward         0.00%       3.215ms        23.12%       40.337s     168.069ms       0.000us         0.00%     133.235ms     555.146us           240  
                         aten::embedding_dense_backward         0.60%        1.054s        23.12%       40.333s     168.056ms     126.180ms         0.08%     133.235ms     555.146us           240  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     123.394ms         0.08%     123.394ms     584.807us           211  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     120.399ms         0.08%     120.399ms      11.911us         10108  
                                       aten::contiguous         0.02%      30.636ms         0.32%     565.847ms      24.559us       0.000us         0.00%     117.664ms       5.107us         23040  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      14.102ms         0.12%     205.435ms     106.998us       0.000us         0.00%     116.758ms      60.811us          1920  
                                 _SplitAlongDimBackward         0.08%     144.418ms         0.11%     191.333ms      99.653us       0.000us         0.00%     116.758ms      60.811us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     116.758ms         0.07%     116.758ms      60.811us          1920  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     115.222ms         0.07%     115.222ms      53.344us          2160  
             triton_poi_fused_native_dropout_backward_0         0.03%      56.670ms         0.05%      86.325ms      22.481us     112.422ms         0.07%     112.422ms      29.277us          3840  
                                         hipMemcpyAsync         0.13%     229.362ms         0.13%     229.395ms      18.935us     111.921ms         0.07%     111.929ms       9.239us         12115  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.641ms         0.07%     119.387ms       1.492ms       0.000us         0.00%     111.710ms       1.396ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      20.384ms         0.07%     117.746ms       1.472ms       0.000us         0.00%     111.710ms       1.396ms            80  
                                               aten::mm         0.03%      53.355ms         0.06%     107.644ms     122.322us     104.082ms         0.07%     104.082ms     118.274us           880  
                             c10d::allreduce_coalesced_         0.00%       1.952ms         0.05%      94.877ms       9.488ms       0.000us         0.00%     103.312ms      10.331ms            10  
                         _ReduceFromModelParallelRegion         0.02%      26.618ms         0.04%      72.006ms     300.025us       0.000us         0.00%     101.507ms     422.944us           240  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      92.729ms         0.06%      92.729ms       7.870us         11783  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      91.901ms         0.06%      91.901ms      36.746us          2501  
                                    hipIpcOpenMemHandle         0.06%      97.960ms         0.06%      97.960ms      55.189us      91.574ms         0.06%      91.574ms      51.591us          1775  
                                           aten::matmul         0.00%       3.330ms         0.05%      83.215ms     208.038us       0.000us         0.00%      86.684ms     216.710us           400  
                                           aten::arange         0.09%     149.164ms         0.25%     427.643ms      17.356us      43.022ms         0.03%      86.170ms       3.497us         24640  
                                 hipDeviceCanAccessPeer         0.00%     487.398us         0.00%     487.398us       0.245us      84.398ms         0.05%      84.398ms      42.369us          1992  
                               hipStreamCreateWithFlags         0.24%     416.756ms         0.24%     416.756ms     154.698us      81.577ms         0.05%      81.577ms      30.281us          2694  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      80.516ms         0.05%      80.516ms      41.936us          1920  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      79.443ms         0.05%      79.443ms      10.588us          7503  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      79.240ms         0.05%      79.240ms      20.214us          3920  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      75.590ms         0.05%      75.590ms      30.224us          2501  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.22%     386.875ms         0.38%     665.426ms      86.644us      67.074ms         0.04%      67.100ms       8.737us          7680  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      66.763ms         0.04%      66.763ms     278.180us           240  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      66.367ms         0.04%      66.367ms      17.283us          3840  
                                  hipModuleLaunchKernel         0.13%     228.256ms         0.13%     228.288ms       6.741us      65.295ms         0.04%      65.295ms       1.928us         33865  
                                       hipStreamDestroy         0.04%      64.678ms         0.04%      64.678ms      24.188us      64.693ms         0.04%      64.693ms      24.193us          2674  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      63.632ms         0.04%      63.632ms      14.638us          4347  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      56.562ms         0.04%      56.562ms      29.460us          1920  
                                           GeLUFunction         0.10%     182.085ms         0.62%        1.080s     187.482us       0.000us         0.00%      55.023ms       9.553us          5760  
                        triton_poi_fused_add_mul_tanh_0         0.08%     135.864ms         0.09%     159.472ms      27.638us      53.292ms         0.03%      53.371ms       9.250us          5770  
        LinearWithGradAccumulationAndAsyncCommunication         0.01%       9.099ms         0.02%      29.297ms     122.072us       0.000us         0.00%      51.710ms     215.458us           240  
                                   GeLUFunctionBackward         0.03%      48.894ms         0.35%     611.441ms     318.459us       0.000us         0.00%      50.140ms      26.115us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      26.892ms         0.02%      42.221ms      21.990us      50.140ms         0.03%      50.140ms      26.115us          1920  
                                    hipMemcpyWithStream        25.69%       44.824s        25.70%       44.828s      56.673ms       0.000us         0.00%      44.607ms      56.393us           791  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      42.127ms         0.03%      42.127ms       8.422us          5002  
                                            aten::fill_         0.08%     144.587ms         0.10%     177.826ms       6.149us      40.792ms         0.03%      40.792ms       1.411us         28919  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      39.754ms         0.03%      39.754ms       7.948us          5002  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      38.769ms         0.02%      38.769ms      10.096us          3840  
                                 triton_poi_fused_add_0         0.13%     233.599ms         0.14%     244.871ms      31.884us      34.834ms         0.02%      34.834ms       4.536us          7680  
                                          aten::randint         0.02%      41.172ms         0.09%     158.775ms      41.198us       0.000us         0.00%      34.739ms       9.014us          3854  
                                          aten::random_         0.04%      65.748ms         0.07%     114.791ms      29.816us      34.667ms         0.02%      34.739ms       9.023us          3850  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      34.667ms         0.02%      34.667ms       9.004us          3850  
                                            aten::zero_         0.04%      77.690ms         0.14%     243.793ms      10.765us       0.000us         0.00%      32.530ms       1.436us         22646  
                                            aten::zeros         0.05%      82.904ms         0.21%     368.163ms      16.431us       0.000us         0.00%      30.982ms       1.383us         22406  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      30.861ms         0.02%      30.861ms      12.339us          2501  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      28.845ms         0.02%      28.845ms     180.282us           160  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.586ms         0.03%      51.622ms     645.271us       0.000us         0.00%      27.393ms     342.415us            80  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.879ms         0.02%      24.879ms     310.986us            80  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.753ms         0.03%      48.532ms     202.215us       0.000us         0.00%      24.138ms     100.575us           240  
                                              aten::exp         0.00%       3.186ms         0.01%      21.870ms      91.125us      23.255ms         0.01%      23.255ms      96.896us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.255ms         0.01%      23.255ms     223.606us           104  
                                              aten::add         0.05%      82.899ms         0.07%     118.589ms      66.399us      23.115ms         0.01%      23.115ms      12.942us          1786  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      22.445ms         0.01%      22.445ms       8.117us          2765  
                                             aten::div_         0.00%       6.431ms         0.01%      14.672ms      30.566us      21.659ms         0.01%      21.659ms      45.124us           480  
                                             aten::sub_         0.00%       5.109ms         0.00%       6.499ms      20.311us      21.314ms         0.01%      21.314ms      66.607us           320  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.806ms         0.01%      20.806ms     200.058us           104  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.801ms         0.01%      20.801ms     200.009us           104  
                                           aten::cumsum         0.07%     122.478ms         0.09%     153.093ms      26.579us      19.644ms         0.01%      20.391ms       3.540us          5760  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.347ms         0.01%      20.347ms       8.136us          2501  
                                 tex_ts::cast_to_fp8_ts         0.09%     150.955ms         0.13%     223.376ms      29.085us      20.262ms         0.01%      20.315ms       2.645us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      20.262ms         0.01%      20.262ms      17.452us          1161  
                                           aten::linear         0.00%       3.832ms         0.04%      61.871ms      85.932us       0.000us         0.00%      19.944ms      27.700us           720  
                                            aten::addmm         0.03%      44.713ms         0.03%      52.117ms      72.385us      19.944ms         0.01%      19.944ms      27.700us           720  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      19.644ms         0.01%      19.644ms       7.855us          2501  
                                            aten::index         0.01%      14.085ms         0.04%      77.477ms     136.645us       2.280ms         0.00%      19.534ms      34.451us           567  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      18.921ms         0.01%      18.921ms       7.523us          2515  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      18.257ms         0.01%      18.257ms      28.616us           638  
                                         AddmmBackward0         0.00%       2.970ms         0.02%      37.283ms     155.345us       0.000us         0.00%      17.398ms      72.490us           240  
                                          aten::nonzero         0.00%       5.489ms         0.03%      43.957ms     179.417us      17.254ms         0.01%      17.254ms      70.424us           245  
                     _VocabParallelCrossEntropyBackward         0.01%      18.834ms         0.03%      45.604ms     570.044us       0.000us         0.00%      17.071ms     213.383us            80  
                                        aten::embedding         0.00%       7.101ms         0.02%      30.365ms      42.173us       0.000us         0.00%      16.826ms      23.369us           720  
                                     aten::index_select         0.01%      13.215ms         0.01%      20.470ms      28.431us      16.826ms         0.01%      16.826ms      23.369us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.826ms         0.01%      16.826ms      53.415us           315  
                                     hipStreamWaitEvent         0.17%     304.417ms         0.17%     304.468ms      14.865us      16.107ms         0.01%      16.107ms       0.786us         20482  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      14.239ms         0.01%      14.239ms      68.457us           208  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      13.646ms         0.01%      13.646ms     131.215us           104  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.134ms         0.01%      13.134ms      82.089us           160  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      12.646ms         0.01%      12.646ms      14.004us           903  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.597ms         0.01%      12.597ms     121.126us           104  
                                             aten::mul_         0.00%       6.565ms         0.00%       7.320ms       5.719us      12.537ms         0.01%      12.537ms       9.795us          1280  
                                       aten::index_put_         0.00%       5.975ms         0.11%     194.764ms     173.896us       0.000us         0.00%      12.256ms      10.943us          1120  
                                 aten::_index_put_impl_         0.00%       8.418ms         0.11%     188.789ms     168.562us       1.125ms         0.00%      12.256ms      10.943us          1120  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.071ms         0.01%      12.071ms     116.067us           104  
                                        hipLaunchKernel         0.82%        1.424s         0.82%        1.425s       9.351us       4.887ms         0.00%      10.633ms       0.070us        152351  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us      10.399ms         0.01%      10.399ms      43.329us           240  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.749ms         0.01%       9.749ms      40.621us           240  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.225ms         0.01%      11.929ms     149.118us       0.000us         0.00%       9.291ms     116.141us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.013ms         0.01%       9.705ms     121.312us       9.291ms         0.01%       9.291ms     116.141us            80  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.012ms         0.02%      27.603ms     345.043us       0.000us         0.00%       9.285ms     116.062us            80  
                            torch::autograd::CopySlices         0.00%       4.096ms         0.01%      25.592ms     319.897us       0.000us         0.00%       9.285ms     116.062us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       9.224ms         0.01%       9.224ms      13.447us           686  
                                              aten::max         0.00%       7.370ms         0.02%      37.433ms     147.374us       8.998ms         0.01%       9.101ms      35.829us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.986ms         0.01%       8.986ms      86.402us           104  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.798ms         0.01%       8.798ms      21.354us           412  
                            hipGetDevicePropertiesR0600         0.05%      82.871ms         0.05%      82.874ms       0.908us       7.835ms         0.00%       7.835ms       0.086us         91222  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       7.718ms         0.00%       7.718ms       8.040us           960  
                                             aten::ones         0.00%       1.389ms         0.00%       8.327ms      17.348us       0.000us         0.00%       7.443ms      15.506us           480  
                           FusedLayerNormAffineFunction         0.01%      13.249ms         0.01%      23.124ms      96.349us       7.439ms         0.00%       7.439ms      30.996us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.439ms         0.00%       7.439ms      71.529us           104  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       7.156ms         0.00%       7.156ms      29.817us           240  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     491.221us         0.00%       2.648ms     264.780us       7.117ms         0.00%       7.117ms     711.686us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       7.117ms         0.00%       7.117ms      64.699us           110  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.490ms         0.00%       6.490ms      81.129us            80  
                                  hipMemGetAddressRange         0.00%     184.758us         0.00%     184.758us       0.411us       5.982ms         0.00%       5.982ms      13.322us           449  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       5.262ms         0.00%       5.262ms      32.890us           160  
                                        aten::index_put         0.00%       1.996ms         0.01%      11.986ms     144.411us       0.000us         0.00%       4.905ms      59.102us            83  
                                      IndexPutBackward0         0.00%       1.074ms         0.01%      11.657ms     145.711us       0.000us         0.00%       4.905ms      61.318us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.394ms         0.00%       4.394ms      54.929us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       4.337ms         0.00%       4.337ms      54.207us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     954.502us         0.01%      22.295ms     278.690us       0.000us         0.00%       4.008ms      50.098us            80  
                                     _LayerNormBackward         0.00%       5.445ms         0.01%      21.341ms     266.759us       4.008ms         0.00%       4.008ms      50.098us            80  
                                              hipMemcpy         0.01%      14.705ms         0.01%      14.705ms     306.360us       3.664ms         0.00%       3.664ms      76.329us            48  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     656.735us         0.00%       4.432ms      55.398us       0.000us         0.00%       3.655ms      45.690us            80  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     662.155us         0.00%       2.831ms      35.386us       0.000us         0.00%       3.577ms      44.707us            80  
                                          GeluBackward0         0.00%     427.409us         0.00%       2.169ms      27.109us       0.000us         0.00%       3.577ms      44.707us            80  
                                    aten::gelu_backward         0.00%       1.133ms         0.00%       1.741ms      21.766us       3.577ms         0.00%       3.577ms      44.707us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.577ms         0.00%       3.577ms      44.707us            80  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       3.511ms         0.00%       3.511ms       7.269us           483  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       3.268ms         0.00%       3.268ms       6.177us           529  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       3.103ms         0.00%       3.103ms      12.927us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.843ms         0.00%       2.843ms       6.801us           418  
                                                hipFree         0.06%     104.977ms         0.06%     105.019ms       5.834ms       2.780ms         0.00%       2.839ms     157.727us            18  
                                              aten::div         0.01%      11.412ms         0.01%      14.567ms      21.938us       2.636ms         0.00%       2.636ms       3.969us           664  
                                             aten::gelu         0.00%       4.171ms         0.01%      10.321ms      43.002us       2.604ms         0.00%       2.604ms      10.849us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.604ms         0.00%       2.604ms      25.036us           104  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.423ms         0.00%       2.423ms       6.344us           382  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     553.504us         0.00%       7.463ms      46.643us       0.000us         0.00%       2.360ms      14.749us           160  
                                         SliceBackward0         0.00%     515.790us         0.00%       6.909ms      43.184us       0.000us         0.00%       2.360ms      14.749us           160  
                                   aten::slice_backward         0.00%     934.597us         0.00%       6.394ms      39.960us       0.000us         0.00%       2.360ms      14.749us           160  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.280ms         0.00%       2.280ms      12.193us           187  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.276ms         0.00%       2.276ms      21.885us           104  
         _compile.<locals>.compile_inner (dynamo_timed)         0.08%     142.899ms         2.02%        3.530s     352.959ms       0.000us         0.00%       2.270ms     226.994us            10  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      33.986ms         1.91%        3.337s     333.656ms       0.000us         0.00%       2.216ms     221.562us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.38%     665.396ms         1.89%        3.303s     330.257ms       0.000us         0.00%       2.216ms     221.562us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.083ms         0.00%       2.083ms       6.764us           308  
                                               aten::lt         0.01%      19.789ms         0.01%      22.472ms      31.211us       2.041ms         0.00%       2.041ms       2.834us           720  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.920ms         0.00%       1.920ms       7.900us           243  
      autograd::engine::evaluate_function: MulBackward0         0.01%      14.771ms         0.04%      69.370ms     403.312us       0.000us         0.00%       1.845ms      10.730us           172  
                                             _LayerNorm         0.00%       6.376ms         0.01%      11.244ms     140.554us       1.800ms         0.00%       1.800ms      22.495us            80  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.784ms         0.00%       1.784ms      17.153us           104  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.764ms         0.00%       1.764ms       7.261us           243  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us       1.736ms         0.00%       1.736ms       7.144us           243  
                                        aten::unsqueeze         0.02%      33.280ms         0.02%      40.438ms       5.494us       0.000us         0.00%       1.707ms       0.232us          7360  
                                        SelectBackward0         0.00%     217.157us         0.00%       2.824ms      35.294us       0.000us         0.00%       1.700ms      21.255us            80  
                                  aten::select_backward         0.00%     413.085us         0.00%       2.606ms      32.580us       0.000us         0.00%       1.700ms      21.255us            80  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.691ms         0.00%       1.691ms      10.571us           160  
                               aten::cross_entropy_loss         0.00%       1.599ms         0.01%      21.261ms      88.587us       0.000us         0.00%       1.690ms       7.040us           240  
                                  hipDeviceGetAttribute         0.00%     323.043us         0.00%     323.043us       4.822us       1.659ms         0.00%       1.659ms      24.758us            67  
                                          hipHostMalloc         0.08%     146.357ms         0.08%     146.377ms       4.436ms       1.589ms         0.00%       1.589ms      48.150us            33  
                                 c10d::_allgather_base_         0.00%     256.188us         0.00%       1.681ms     120.053us       0.000us         0.00%       1.577ms     112.659us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       1.577ms         0.00%       1.577ms     131.436us            12  
                                               aten::gt         0.02%      38.040ms         0.03%      47.430ms      10.926us       1.555ms         0.00%       1.555ms       0.358us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.552ms         0.00%       1.552ms       6.415us           242  
      autograd::engine::evaluate_function: DivBackward0         0.00%       2.083ms         0.01%       9.221ms      57.631us       0.000us         0.00%       1.504ms       9.400us           160  
                                           DivBackward0         0.00%       1.288ms         0.00%       7.138ms      44.615us       0.000us         0.00%       1.504ms       9.400us           160  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.417ms         0.00%       1.417ms       6.782us           209  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.406ms         0.00%       1.406ms       7.640us           184  
                                               aten::ge         0.00%       7.306ms         0.00%       8.395ms      17.490us       1.366ms         0.00%       1.366ms       2.845us           480  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.892ms         0.01%      11.057ms     138.213us       0.000us         0.00%       1.335ms      16.690us            80  
                                       NllLossBackward0         0.00%       1.005ms         0.01%       9.165ms     114.564us       0.000us         0.00%       1.335ms      16.690us            80  
                                aten::nll_loss_backward         0.00%       3.151ms         0.00%       8.160ms     102.005us     748.209us         0.00%       1.335ms      16.690us            80  
                                           aten::__or__         0.00%       1.566ms         0.01%      23.024ms      47.966us       0.000us         0.00%       1.328ms       2.766us           480  
                                       aten::bitwise_or         0.01%       9.128ms         0.01%      21.458ms      44.703us       1.328ms         0.00%       1.328ms       2.766us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.328ms         0.00%       1.328ms       6.352us           209  
                                           MulBackward0         0.01%      10.622ms         0.02%      40.945ms     238.052us       0.000us         0.00%       1.313ms       7.632us           172  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.288ms         0.00%       1.288ms      16.102us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.242ms         0.00%       1.242ms       5.940us           209  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us       1.203ms         0.00%       1.203ms       5.014us           240  
                               hipExtModuleLaunchKernel         0.16%     272.689ms         0.16%     272.728ms       6.943us       0.000us         0.00%       1.184ms       0.030us         39282  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.146ms         0.00%       1.146ms       4.776us           240  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.125ms         0.00%       1.125ms      14.066us            80  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     963.784us         0.00%     963.784us      12.047us            80  
                                      aten::log_softmax         0.00%       1.196ms         0.00%       6.569ms      27.371us       0.000us         0.00%     928.615us       3.869us           240  
                                     aten::_log_softmax         0.00%       4.154ms         0.00%       5.227ms      21.777us     928.615us         0.00%     928.615us       3.869us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     928.615us         0.00%     928.615us       8.929us           104  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     859.901us         0.00%     859.901us       3.583us           240  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     845.711us         0.00%     845.711us       8.132us           104  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     839.490us         0.00%     839.490us      10.494us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     817.325us         0.00%     817.325us       7.859us           104  
                                      aten::nll_loss_nd         0.00%     865.513us         0.01%      13.092ms      54.551us       0.000us         0.00%     761.043us       3.171us           240  
                                         aten::nll_loss         0.00%     898.078us         0.01%      12.227ms      50.945us       0.000us         0.00%     761.043us       3.171us           240  
                                 aten::nll_loss_forward         0.00%       4.896ms         0.01%      11.329ms      47.203us     761.043us         0.00%     761.043us       3.171us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     761.043us         0.00%     761.043us       7.318us           104  
                                   hipFuncGetAttributes         0.16%     281.703ms         0.16%     281.703ms       2.134ms     758.947us         0.00%     758.947us       5.750us           132  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     748.209us         0.00%     748.209us       9.353us            80  
                                             aten::tanh         0.01%      15.879ms         0.02%      28.930ms     106.754us     731.042us         0.00%     731.042us       2.698us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     731.042us         0.00%     731.042us       7.029us           104  
                                             aten::item         0.02%      27.984ms         0.04%      65.897ms       3.923us       0.000us         0.00%     694.991us       0.041us         16799  
                              aten::_local_scalar_dense         0.01%      14.387ms         0.02%      37.911ms       2.257us     694.991us         0.00%     694.991us       0.041us         16799  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     688.501us         0.00%     688.501us       8.606us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     670.386us         0.00%     670.386us       8.380us            80  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     638.626us         0.00%     638.626us       3.991us           160  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     613.325us         0.00%     613.325us       2.556us           240  
                                          aten::normal_         1.05%        1.840s         1.06%        1.843s      17.718ms     609.321us         0.00%     609.321us       5.859us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     609.321us         0.00%     609.321us       6.282us            97  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     606.278us         0.00%     606.278us       5.830us           104  
                                             aten::rsub         0.00%       3.532ms         0.01%      10.723ms     124.691us       0.000us         0.00%     604.349us       7.027us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     604.349us         0.00%     604.349us       7.554us            80  
                                        aten::ones_like         0.00%     580.770us         0.00%       2.442ms      30.530us       0.000us         0.00%     567.745us       7.097us            80  
                                              aten::log         0.00%       4.061ms         0.01%      10.288ms      42.866us     565.822us         0.00%     565.822us       2.358us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     565.822us         0.00%     565.822us       5.441us           104  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     563.297us         0.00%     563.297us       5.365us           105  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     560.374us         0.00%     560.374us       7.005us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.457ms         0.02%      29.459ms     359.259us       0.000us         0.00%     542.605us       6.617us            82  
                                          TanhBackward0         0.00%       2.651ms         0.02%      28.002ms     341.491us       0.000us         0.00%     542.605us       6.617us            82  
                                    aten::tanh_backward         0.00%       3.627ms         0.01%      22.081ms     269.281us     542.605us         0.00%     542.605us       6.617us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     542.605us         0.00%     542.605us       6.783us            80  
                                            aten::empty         0.53%     926.577ms         0.53%     933.045ms       3.554us       0.000us         0.00%     539.481us       0.002us        262555  
                                       aten::empty_like         0.11%     200.037ms         0.33%     584.161ms       6.569us       0.000us         0.00%     539.481us       0.006us         88930  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     818.346us         0.00%       5.846ms      73.075us       0.000us         0.00%     497.054us       6.213us            80  
                                    LogSoftmaxBackward0         0.00%       1.404ms         0.00%       5.028ms      62.846us       0.000us         0.00%     497.054us       6.213us            80  
                       aten::_log_softmax_backward_data         0.00%       2.214ms         0.00%       3.624ms      45.300us     497.054us         0.00%     497.054us       6.213us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     497.054us         0.00%     497.054us       6.213us            80  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       6.589ms         0.01%      12.620ms      78.875us     476.517us         0.00%     476.517us       2.978us           160  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     466.550us         0.00%     466.550us       5.832us            80  
                                    hipFuncSetAttribute         0.00%      10.319us         0.00%      10.319us       0.430us     422.573us         0.00%     422.573us      17.607us            24  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     418.764us         0.00%     418.764us       4.455us            94  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     292.192us         0.00%     292.192us       3.652us            80  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     272.944us         0.00%     272.944us       4.706us            58  
                                   hipDeviceSynchronize         0.00%     800.612us         0.00%     800.612us      23.547us     174.813us         0.00%     174.813us       5.142us            34  
                                             aten::rand         0.00%       2.962ms         0.00%       7.712ms     550.861us       0.000us         0.00%     153.863us      10.990us            14  
                                         aten::uniform_         0.01%      15.285ms         0.01%      18.316ms       1.409ms     153.863us         0.00%     153.863us      11.836us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     153.863us         0.00%     153.863us      30.773us             5  
                                       aten::reciprocal         0.00%     152.440us         0.01%      11.647ms       1.165ms     126.409us         0.00%     126.409us      12.641us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     126.409us         0.00%     126.409us      12.641us            10  
                                          aten::maximum         0.00%     123.460us         0.01%      23.042ms       2.560ms     102.236us         0.00%     102.236us      11.360us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     102.236us         0.00%     102.236us      11.360us             9  
                                       aten::lift_fresh         0.03%      54.455ms         0.03%      60.917ms      34.494us       0.000us         0.00%      65.389us       0.037us          1766  
                                              hipMalloc         0.01%      19.440ms         0.01%      19.497ms     118.887us       0.000us         0.00%      62.103us       0.379us           164  
                                    aten::empty_strided         0.20%     357.526ms         0.21%     366.167ms       4.131us       0.000us         0.00%      62.103us       0.001us         88647  
                                           aten::select         0.21%     371.120ms         0.26%     451.242ms       4.610us       0.000us         0.00%      55.167us       0.001us         97887  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      48.230us         0.00%      48.230us       4.823us            10  
                                        aten::transpose         0.16%     278.175ms         0.20%     343.634ms       3.606us       0.000us         0.00%      41.296us       0.000us         95285  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      17.550ms         1.26%        2.197s     219.750ms       0.000us         0.00%      36.124us       3.612us            10  
                        compile_fx_inner (dynamo_timed)         0.05%      84.262ms         1.47%        2.559s     232.652ms       0.000us         0.00%      36.124us       3.284us            11  
         GraphLowering.compile_to_module (dynamo_timed)         0.70%        1.226s         1.25%        2.182s     198.406ms       0.000us         0.00%      30.592us       2.781us            11  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      27.424us         0.00%      27.424us       2.742us            10  
                            hipGetDevicePropertiesR0000         0.00%      51.584us         0.00%      51.584us       5.158us      19.125us         0.00%      19.125us       1.913us            10  
                                              aten::min         0.00%     125.302us         0.00%       5.723ms       1.145ms      15.034us         0.00%      15.034us       3.007us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.034us         0.00%      15.034us       5.011us             3  
                       Scheduler.codegen (dynamo_timed)         0.08%     142.550ms         0.08%     142.593ms      12.963ms       0.000us         0.00%      12.750us       1.159us            11  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      12.589us         0.00%      12.589us       4.196us             3  
                                              aten::all         0.05%      84.146ms         0.05%      95.260ms      16.264us       0.000us         0.00%       8.780us       0.001us          5857  
                                             aten::view         0.19%     333.581ms         0.20%     341.646ms       2.362us       0.000us         0.00%       8.419us       0.000us        144633  
                               TorchDynamo Cache Lookup         0.12%     216.442ms         0.12%     216.469ms      11.262us       0.000us         0.00%       6.816us       0.000us         19221  
                                    hipFuncGetAttribute         0.00%       8.669us         0.00%       8.669us       0.722us       6.054us         0.00%       6.054us       0.504us            12  
                                           aten::expand         0.04%      69.937ms         0.05%      93.908ms       2.592us       0.000us         0.00%       5.893us       0.000us         36229  
                                       aten::as_strided         0.15%     256.009ms         0.15%     256.324ms       0.762us       0.000us         0.00%       5.893us       0.000us        336543  
                                    hipModuleLoadDataEx         0.36%     631.560ms         0.36%     631.560ms      48.582ms       5.413us         0.00%       5.413us       0.416us            13  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.285us         0.00%       2.285us       2.285us             1  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.165us         0.00%       2.165us       2.165us             1  
                        hipDeviceGetStreamPriorityRange         0.00%       2.373us         0.00%       2.373us       2.373us       0.000us         0.00%       0.000us       0.000us             1  
                            hipStreamCreateWithPriority         0.00%     634.637us         0.00%     634.637us     105.773us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.156s      68.587us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      13.096ms         0.01%      13.096ms       1.336us       0.000us         0.00%       0.000us       0.000us          9804  
                                     hipExtLaunchKernel         0.06%     107.271ms         0.06%     107.305ms      10.947us       0.000us         0.00%       0.000us       0.000us          9802  
                                           aten::detach         0.04%      74.070ms         0.13%     223.227ms       6.292us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.07%     115.955ms         0.08%     141.441ms       4.182us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.01%      11.925ms         0.01%      21.389ms     172.493us       0.000us         0.00%       0.000us       0.000us           124  
                                prims::broadcast_in_dim         0.00%     353.983us         0.00%     465.826us      58.228us       0.000us         0.00%       0.000us       0.000us             8  
                                             prims::add         0.00%       1.398ms         0.00%       2.003ms     105.417us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     623.247us         0.00%       1.269ms      30.213us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%       1.075ms         0.00%       1.453ms     103.775us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     152.256us         0.00%     204.349us     102.174us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       4.765ms         0.01%       9.760ms     256.846us       0.000us         0.00%       0.000us       0.000us            38  
                                         prims::view_of         0.00%     705.170us         0.00%     903.728us      37.655us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       6.733ms         0.00%       6.868ms       7.161us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       7.869ms         0.01%       9.074ms      11.244us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%       1.205ms         0.00%       1.205ms       1.493us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     447.045us         0.00%     447.045us      14.421us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     134.795us         0.00%     134.795us      12.254us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      13.071ms         0.02%      28.254ms     110.368us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     741.855us         0.00%     741.855us       2.898us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     268.117us         0.00%     365.581us     121.860us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     163.426us         0.00%     163.426us      81.713us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     193.030us         0.00%     206.929us     103.464us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      40.157us         0.00%      40.157us       2.868us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.599ms         0.00%       3.122ms     624.466us       0.000us         0.00%       0.000us       0.000us             5  
                                            aten::slice         0.06%     103.296ms         0.07%     122.237ms       4.680us       0.000us         0.00%       0.000us       0.000us         26118  
                                        aten::index_add         0.00%     333.921us         0.00%       1.856ms       1.856ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     644.760us         0.00%     724.961us     362.480us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     316.955us         0.00%     316.955us     316.955us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.13%     234.199ms         0.14%     237.494ms      21.590ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.11%     186.543ms         0.11%     186.603ms      16.964ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.01%       9.376ms         0.01%       9.376ms     852.333us       0.000us         0.00%       0.000us       0.000us            11  
                                 hipPointerGetAttribute         0.03%      48.892ms         0.03%      48.892ms       0.784us       0.000us         0.00%       0.000us       0.000us         62337  
                                        aten::expand_as         0.00%       1.221ms         0.00%       4.050ms       7.459us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       2.098ms         0.00%       7.355ms     668.613us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     169.343us         0.00%     190.032us      95.016us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     182.667us         0.00%     182.667us      91.333us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%     118.206us         0.00%     147.290us     147.290us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     442.460us         0.00%       3.863ms       1.288ms       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     241.453us         0.00%     273.365us      91.122us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.670ms         0.00%       5.266ms     877.627us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%       1.172ms         0.00%       5.701ms     633.466us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.678ms         0.00%       3.787ms     631.213us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     451.783us         0.00%       1.179ms     393.088us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     301.048us         0.00%       1.538ms     512.741us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     641.184us         0.00%       1.237ms     412.391us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     467.753us         0.00%     493.027us     123.257us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.07%     121.191ms         0.07%     121.549ms       3.507us       0.000us         0.00%       0.000us       0.000us         34655  
                                               aten::eq         0.02%      43.590ms         0.02%      43.590ms       7.442us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       3.238ms         0.00%       3.238ms       0.132us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     941.975us      67.284us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.701ms         0.01%      13.516ms       6.021us       0.000us         0.00%       0.000us       0.000us          2245  
                                          aten::reshape         0.06%     112.217ms         0.12%     200.910ms       4.650us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      70.409ms     146.381us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.00%       7.660ms         0.01%      17.903ms       4.388us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.00%       8.129ms         0.02%      28.325ms      10.729us       0.000us         0.00%       0.000us       0.000us          2640  
                                          aten::view_as         0.00%       1.462ms         0.00%       3.165ms       4.396us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      37.057ms         0.03%      44.089ms       5.511us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       2.877us         0.00%       2.877us       0.411us       0.000us         0.00%       0.000us       0.000us             7  
                              hipDevicePrimaryCtxRetain         0.00%       2.131us         0.00%       2.131us       0.304us       0.000us         0.00%       0.000us       0.000us             7  
                             hipDevicePrimaryCtxRelease         0.00%       1.947us         0.00%       1.947us       0.278us       0.000us         0.00%       0.000us       0.000us             7  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      52.896ms         0.03%      52.896ms       2.920us       0.000us         0.00%       0.000us       0.000us         18118  
                                              hipMemset         0.00%      26.904us         0.00%      26.904us      13.452us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.29%     507.289ms         0.29%     507.289ms     169.096ms       0.000us         0.00%       0.000us       0.000us             3  
                                         _SplitAlongDim         0.09%     159.402ms         0.13%     230.168ms      39.960us       0.000us         0.00%       0.000us       0.000us          5760  
                                 aten::split_with_sizes         0.03%      54.864ms         0.04%      70.673ms      12.270us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      32.902ms         0.02%      32.905ms       2.142us       0.000us         0.00%       0.000us       0.000us         15360  
                                          aten::squeeze         0.05%      79.652ms         0.05%      94.735ms       4.112us       0.000us         0.00%       0.000us       0.000us         23040  
                                      hipModuleLoadData         0.31%     542.106ms         0.31%     542.106ms     135.527ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     762.577us         0.00%       1.753ms     438.327us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       7.279ms         0.00%       8.615ms      35.895us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     886.445us         0.00%     886.445us       2.770us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      36.489ms         0.06%     105.545ms       6.731us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      17.043ms         0.04%      69.056ms       4.404us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     481.313us         0.00%       3.322ms      41.530us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.303ms         0.00%       2.841ms      35.514us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      50.116ms         0.07%     119.536ms       5.617us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      18.225ms         0.04%      69.420ms       3.262us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      36.198ms         0.05%      83.637ms       3.462us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.035ms         0.00%       2.751ms      11.464us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     423.255us         0.00%       1.716ms       7.150us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     298.022us         0.00%     915.185us      11.440us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     617.163us         0.00%     617.163us       7.715us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     984.919us         0.22%     380.204ms     380.204ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      17.008ms         0.01%      19.243ms       2.505us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.235ms         0.00%       2.235ms       0.291us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       4.677ms         0.01%      17.508ms       8.754us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       3.607ms         0.01%      12.832ms       6.416us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       4.221ms         0.01%      11.243ms       5.855us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       1.895ms         0.00%       7.022ms       3.657us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     336.992us         0.00%     336.992us       0.176us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.046ms         0.00%       3.009ms      37.615us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.964ms         0.00%       1.964ms      24.545us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.516ms         0.00%       2.314ms      28.927us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.278ms     227.811us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      17.977us         0.00%      36.232us       9.058us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 174.450s
Self CUDA time total: 158.230s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       81.968s        49.59%       81.968s       81.968s             1  
                                             bert_train        35.55%       62.714s        71.17%      125.568s      125.568s       0.000us         0.00%       44.178s       44.178s             1  
                                     record_param_comms         4.36%        7.685s         6.11%       10.771s     310.280us       11.327s         6.85%       17.881s     515.081us         34714  
                                            aten::copy_        15.08%       26.604s        17.52%       30.912s     392.210us       16.633s        10.06%       16.661s     211.399us         78815  
                                               aten::to         0.03%      61.358ms        17.49%       30.857s     587.883us       0.000us         0.00%       12.098s     230.484us         52489  
                                         aten::_to_copy         0.10%     179.899ms        17.46%       30.796s     710.487us       0.000us         0.00%       12.098s     279.107us         43345  
                                      aten::masked_fill         0.04%      72.985ms         0.25%     436.036ms      45.420us       0.000us         0.00%       11.795s       1.229ms          9600  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us       11.292s         6.83%       11.292s       1.188ms          9505  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us       11.183s         6.77%       11.183s       1.166ms          9595  
                                       c10d::allreduce_         0.23%     414.202ms         2.70%        4.765s     283.468us       0.000us         0.00%       11.034s     656.346us         16811  
                                     aten::masked_fill_         0.10%     181.419ms         0.22%     385.114ms      23.483us       10.928s         6.61%       10.928s     666.336us         16400  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      17.213ms         0.11%     185.935ms      48.420us       0.000us         0.00%        7.841s       2.042ms          3840  
                                    MaskedFillBackward0         0.00%       7.263ms         0.10%     168.722ms      43.938us       0.000us         0.00%        7.841s       2.042ms          3840  
autograd::engine::evaluate_function: _LayerNormLinea...         0.05%      87.811ms         2.58%        4.543s       1.183ms       0.000us         0.00%        7.483s       1.949ms          3840  
                               _LayerNormLinearBackward         1.70%        2.992s         2.49%        4.398s       1.145ms     458.430ms         0.28%        7.334s       1.910ms          3840  
                                              aten::bmm         0.26%     463.538ms         0.31%     554.164ms      41.232us        7.196s         4.35%        7.196s     535.388us         13440  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       8.081ms         0.04%      68.594ms      35.726us       0.000us         0.00%        6.483s       3.377ms          1920  
                                       SoftmaxBackward0         0.00%       6.567ms         0.03%      60.513ms      31.517us       0.000us         0.00%        6.483s       3.377ms          1920  
                           aten::_softmax_backward_data         0.01%      18.565ms         0.03%      53.946ms      28.097us        3.350s         2.03%        6.483s       3.377ms          1920  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.440s         3.90%        6.440s       1.449ms          4443  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.163s         3.73%        6.163s     754.236us          8171  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.798s         3.51%        5.798s       1.257ms          4613  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      13.372ms         0.05%      85.978ms      21.933us       0.000us         0.00%        5.120s       1.306ms          3920  
                                        ToCopyBackward0         0.00%       6.192ms         0.04%      72.606ms      18.522us       0.000us         0.00%        5.120s       1.306ms          3920  
                                          c10d::barrier         0.00%     808.694us         2.28%        4.026s     105.934ms       0.000us         0.00%        4.738s     124.693ms            38  
                                            aten::clone         0.07%     117.306ms         0.43%     754.871ms      21.851us       0.000us         0.00%        4.561s     132.028us         34546  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.486s         2.71%        4.486s     969.059us          4629  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.457s         2.70%        4.457s     558.502us          7981  
                                                _Linear         1.04%        1.828s         1.67%        2.944s     766.565us     141.139ms         0.09%        4.394s       1.144ms          3840  
                                          aten::softmax         0.01%      13.781ms         0.08%     144.378ms      25.066us       0.000us         0.00%        4.346s     754.461us          5760  
                                         aten::_softmax         0.05%      81.622ms         0.07%     130.597ms      22.673us        4.345s         2.63%        4.346s     754.461us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.345s         2.63%        4.345s       1.722ms          2523  
                                     tex_ts::te_gemm_ts         1.20%        2.123s         1.74%        3.069s      79.921us        4.283s         2.59%        4.288s     111.664us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.860s         2.34%        3.860s     868.834us          4443  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.697s         2.24%        3.697s     320.936us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.350s         2.03%        3.350s       1.745ms          1920  
                                              aten::mul         0.08%     137.977ms         0.11%     198.456ms      24.897us        3.168s         1.92%        3.168s     397.497us          7971  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      16.830ms         0.11%     196.449ms     102.317us       0.000us         0.00%        3.153s       1.642ms          1920  
                                       BaddbmmBackward0         0.01%      18.449ms         0.10%     179.619ms      93.551us       0.000us         0.00%        3.153s       1.642ms          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.135s         1.90%        3.135s       1.429ms          2194  
                                       c10d::broadcast_         0.02%      37.246ms         0.46%     805.855ms       1.675ms       0.000us         0.00%        1.990s       4.137ms           481  
                                   hipDeviceGetPCIBusId         0.01%      11.184ms         0.01%      11.184ms       0.842us        1.901s         1.15%        1.901s     143.044us         13287  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.859s         1.12%        1.859s     408.765us          4548  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      20.243ms         0.11%     195.675ms     101.914us       0.000us         0.00%        1.793s     933.973us          1920  
                                           BmmBackward0         0.01%      12.611ms         0.10%     175.433ms      91.371us       0.000us         0.00%        1.793s     933.973us          1920  
                                       aten::logical_or         0.06%     113.003ms         0.19%     336.536ms      29.213us     872.058ms         0.53%        1.745s     151.442us         11520  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      37.461ms         1.27%        2.246s     585.007us       0.000us         0.00%        1.723s     448.578us          3840  
                                        _LinearBackward         0.96%        1.686s         1.25%        2.209s     575.252us     202.101ms         0.12%        1.723s     448.578us          3840  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.542s         0.93%        1.542s     803.202us          1920  
                                              aten::sub         0.06%     104.785ms         0.08%     133.716ms      20.352us        1.519s         0.92%        1.519s     231.139us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.516s         0.92%        1.516s     600.906us          2523  
                                          aten::dropout         0.01%      11.199ms         0.07%     116.271ms      19.330us       0.000us         0.00%        1.468s     244.018us          6015  
                                   aten::native_dropout         0.02%      42.432ms         0.06%     100.146ms      49.849us        1.468s         0.89%        1.468s     730.598us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.468s         0.89%        1.468s     733.878us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      10.990ms         0.04%      63.845ms      31.875us       0.000us         0.00%        1.391s     694.518us          2003  
                                 NativeDropoutBackward0         0.00%       6.390ms         0.03%      52.854ms      26.388us       0.000us         0.00%        1.391s     694.518us          2003  
                          aten::native_dropout_backward         0.01%      18.118ms         0.03%      46.464ms      23.197us        1.391s         0.84%        1.391s     694.518us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.391s         0.84%        1.391s     695.559us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.359s         0.82%        1.359s      79.036us         17189  
                                   hipStreamIsCapturing         0.03%      60.504ms         0.03%      60.504ms       1.197us        1.298s         0.79%        1.298s      25.673us         50556  
                                  hipExtMallocWithFlags         0.03%      53.441ms         0.03%      53.441ms      12.446us        1.183s         0.72%        1.183s     275.587us          4294  
                                          aten::baddbmm         0.21%     374.444ms         0.43%     755.560ms     131.174us        1.161s         0.70%        1.165s     202.296us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.133s         0.69%        1.133s     590.049us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      22.544ms         0.58%        1.026s     267.125us       0.000us         0.00%     992.043ms     258.344us          3840  
                               CompiledFunctionBackward         0.27%     476.284ms         0.57%        1.003s     261.254us       0.000us         0.00%     992.043ms     258.344us          3840  
                                  hipMemGetAddressRange         0.00%     184.651us         0.00%     184.651us       0.411us     934.528ms         0.57%     934.528ms       2.081ms           449  
                                 triton_red_fused_sum_1         0.02%      34.567ms         0.03%      55.756ms      14.520us     889.363ms         0.54%     889.363ms     231.605us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     872.058ms         0.53%     872.058ms     345.506us          2524  
                                         hipMemsetAsync         0.07%     116.098ms         0.07%     116.128ms       9.784us     712.045ms         0.43%     712.102ms      59.997us         11869  
                                      aten::logical_not         0.08%     148.368ms         0.25%     438.227ms      19.020us     315.568ms         0.19%     631.140ms      27.393us         23040  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.755ms         0.00%       2.755ms       0.193us     619.207ms         0.37%     619.207ms      43.338us         14288  
                                     hipIpcGetMemHandle         0.01%      12.526ms         0.01%      12.526ms       6.986us     600.491ms         0.36%     600.491ms     334.908us          1793  
                                        hipEventDestroy         0.02%      36.330ms         0.02%      36.560ms       1.839us     527.479ms         0.32%     529.932ms      26.650us         19885  
                                      hipGetProcAddress         0.05%      80.949ms         0.05%      80.954ms       1.042us     430.038ms         0.26%     430.038ms       5.535us         77691  
                                       hipCtxGetCurrent         0.01%      11.556ms         0.01%      11.556ms       0.196us     408.199ms         0.25%     408.199ms       6.916us         59025  
                                  Torch-Compiled Region         0.53%     926.578ms         1.57%        2.766s     143.898us       0.000us         0.00%     405.351ms      21.090us         19220  
                                       _LayerNormLinear         0.41%     723.482ms         1.04%        1.842s     479.714us     252.671ms         0.15%     387.803ms     100.990us          3840  
                                             aten::add_         0.09%     152.970ms         0.16%     279.500ms       8.896us     336.884ms         0.20%     336.884ms      10.722us         31420  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     315.568ms         0.19%     315.568ms      62.513us          5048  
                                       CompiledFunction         0.63%        1.106s         0.91%        1.612s     139.715us       0.000us         0.00%     300.052ms      26.001us         11540  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     288.428ms         0.17%     288.428ms      57.148us          5047  
                                              aten::sum         0.21%     367.486ms         0.44%     779.722ms      38.310us     216.055ms         0.13%     282.171ms      13.864us         20353  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     263.856ms         0.16%     263.856ms      45.808us          5760  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     256.980ms         0.16%     256.980ms      66.922us          3840  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     239.151ms         0.14%     239.151ms     239.151ms             1  
                  triton_poi_fused_add_native_dropout_0         0.05%      94.267ms         0.08%     141.265ms      36.692us     229.157ms         0.14%     231.870ms      60.226us          3850  
autograd::engine::evaluate_function: torch::autograd...         0.17%     298.331ms         0.34%     592.541ms      24.526us       0.000us         0.00%     187.582ms       7.764us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     185.872ms         0.11%     185.872ms       7.771us         23920  
                         _ReduceFromModelParallelRegion         0.01%      25.152ms         0.04%      66.848ms     278.534us       0.000us         0.00%     163.781ms     682.421us           240  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     163.401ms         0.10%     163.401ms      32.382us          5046  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     160.611ms         0.10%     160.611ms      30.982us          5184  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     159.393ms         0.10%     159.393ms      35.803us          4452  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.01%      25.304ms         0.37%     660.778ms     344.155us       0.000us         0.00%     158.993ms      82.809us          1920  
                             _VocabParallelCrossEntropy         0.04%      76.297ms         0.16%     279.995ms       1.167ms       0.000us         0.00%     144.639ms     602.664us           240  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     141.847ms         0.09%     141.847ms     665.947us           213  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     136.373ms         0.08%     136.373ms      34.789us          3920  
                                              aten::cat         0.09%     154.769ms         0.11%     202.207ms      25.026us     135.587ms         0.08%     135.683ms      16.792us          8080  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.090ms        22.74%       40.118s     167.156ms       0.000us         0.00%     127.444ms     531.018us           240  
                                     EmbeddingBackward0         0.00%       3.021ms        22.74%       40.110s     167.125ms       0.000us         0.00%     126.402ms     526.677us           240  
                               aten::embedding_backward         0.00%       3.018ms        22.73%       40.107s     167.112ms       0.000us         0.00%     126.402ms     526.677us           240  
                         aten::embedding_dense_backward         0.93%        1.633s        22.73%       40.104s     167.100ms     120.405ms         0.07%     126.402ms     526.677us           240  
                                         hipMemcpyAsync         0.11%     196.706ms         0.11%     196.729ms      16.177us     121.759ms         0.07%     121.759ms      10.012us         12161  
                             c10d::allreduce_coalesced_         0.00%       1.751ms         0.06%      98.258ms       9.826ms       0.000us         0.00%     116.926ms      11.693ms            10  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.644ms         0.07%     118.262ms       1.478ms       0.000us         0.00%     116.596ms       1.457ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      20.425ms         0.07%     116.618ms       1.458ms       0.000us         0.00%     116.596ms       1.457ms            80  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      15.962ms         0.13%     221.702ms     115.470us       0.000us         0.00%     115.398ms      60.103us          1920  
                                 _SplitAlongDimBackward         0.09%     156.608ms         0.12%     205.740ms     107.156us       0.000us         0.00%     115.398ms      60.103us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     115.398ms         0.07%     115.398ms      60.103us          1920  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     112.214ms         0.07%     112.214ms      51.951us          2160  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     111.830ms         0.07%     111.830ms      10.964us         10200  
                                       aten::contiguous         0.02%      27.642ms         0.29%     511.969ms      22.221us       0.000us         0.00%     108.953ms       4.729us         23040  
                                   hipStreamSynchronize         0.73%        1.285s         0.73%        1.285s     394.878us     107.837ms         0.07%     107.845ms      33.152us          3253  
             triton_poi_fused_native_dropout_backward_0         0.04%      63.807ms         0.05%      93.847ms      24.439us     102.680ms         0.06%     102.680ms      26.739us          3840  
                                               aten::mm         0.03%      54.492ms         0.06%     107.539ms     122.204us     100.924ms         0.06%     100.924ms     114.686us           880  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      91.329ms         0.06%      91.329ms      36.199us          2523  
                                       hipStreamDestroy         0.03%      59.168ms         0.03%      59.168ms      21.930us      84.290ms         0.05%      84.290ms      31.242us          2698  
                                           aten::matmul         0.00%       3.157ms         0.05%      81.697ms     204.243us       0.000us         0.00%      83.916ms     209.789us           400  
                               hipStreamCreateWithFlags         0.24%     430.185ms         0.24%     430.207ms     158.281us      83.361ms         0.05%      83.367ms      30.672us          2718  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      79.855ms         0.05%      79.855ms      10.549us          7570  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      79.675ms         0.05%      79.675ms      41.497us          1920  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.19%     327.828ms         0.33%     573.996ms      74.739us      73.984ms         0.04%      74.907ms       9.754us          7680  
                                           aten::arange         0.08%     135.282ms         0.22%     392.495ms      15.929us      36.785ms         0.02%      74.244ms       3.013us         24640  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      73.788ms         0.04%      73.788ms      29.235us          2524  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      70.995ms         0.04%      70.995ms      18.111us          3920  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      70.983ms         0.04%      70.983ms       5.989us         11852  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      66.382ms         0.04%      66.382ms     276.594us           240  
                                 hipDeviceCanAccessPeer         0.00%     377.722us         0.00%     377.722us       0.187us      64.846ms         0.04%      64.846ms      32.166us          2016  
                                    hipIpcOpenMemHandle         0.06%     101.721ms         0.06%     101.721ms      56.543us      62.053ms         0.04%      62.053ms      34.493us          1799  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      59.902ms         0.04%      59.902ms      13.701us          4372  
                                  hipModuleLaunchKernel         0.13%     230.375ms         0.13%     230.411ms       6.792us      56.986ms         0.03%      58.411ms       1.722us         33923  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      57.555ms         0.03%      57.555ms      14.988us          3840  
                                           GeLUFunction         0.10%     168.627ms         0.58%        1.024s     177.817us       0.000us         0.00%      54.848ms       9.522us          5760  
                        triton_poi_fused_add_mul_tanh_0         0.07%     119.852ms         0.08%     144.557ms      25.053us      54.420ms         0.03%      54.447ms       9.436us          5770  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      53.605ms         0.03%      53.605ms      27.919us          1920  
        LinearWithGradAccumulationAndAsyncCommunication         0.00%       8.465ms         0.02%      26.982ms     112.425us       0.000us         0.00%      49.914ms     207.974us           240  
                                   GeLUFunctionBackward         0.03%      53.055ms         0.32%     559.530ms     291.422us       0.000us         0.00%      47.874ms      24.935us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      30.915ms         0.03%      46.894ms      24.424us      47.874ms         0.03%      47.874ms      24.935us          1920  
                                    hipMemcpyWithStream        25.24%       44.537s        25.25%       44.540s      56.166ms       0.000us         0.00%      39.906ms      50.322us           793  
                                     hipStreamWaitEvent         0.17%     305.732ms         0.17%     305.763ms      14.872us      38.779ms         0.02%      38.815ms       1.888us         20560  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      36.097ms         0.02%      36.097ms       7.152us          5047  
                                 triton_poi_fused_add_0         0.11%     194.380ms         0.12%     208.282ms      27.120us      35.062ms         0.02%      35.062ms       4.565us          7680  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      34.047ms         0.02%      34.047ms       6.747us          5046  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      32.553ms         0.02%      32.553ms       8.477us          3840  
                                            aten::fill_         0.08%     135.713ms         0.09%     166.523ms       5.758us      30.996ms         0.02%      30.996ms       1.072us         28919  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      29.725ms         0.02%      29.725ms      11.782us          2523  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      28.082ms         0.02%      28.082ms     175.511us           160  
                                            aten::zero_         0.04%      72.628ms         0.13%     229.025ms      10.113us       0.000us         0.00%      27.557ms       1.217us         22646  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.290ms         0.03%      47.258ms     590.725us       0.000us         0.00%      27.403ms     342.537us            80  
                                            aten::zeros         0.04%      79.016ms         0.20%     345.647ms      15.427us       0.000us         0.00%      27.208ms       1.214us         22406  
                                          aten::randint         0.02%      41.624ms         0.09%     157.286ms      40.811us       0.000us         0.00%      27.174ms       7.051us          3854  
                                          aten::random_         0.04%      66.628ms         0.06%     112.872ms      29.317us      27.169ms         0.02%      27.174ms       7.058us          3850  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      27.169ms         0.02%      27.169ms       7.057us          3850  
                                 tex_ts::cast_to_fp8_ts         0.07%     127.326ms         0.11%     189.965ms      24.735us      24.746ms         0.01%      26.727ms       3.480us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      24.746ms         0.01%      24.746ms      20.519us          1206  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      24.299ms         0.01%      24.299ms     303.738us            80  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.978ms         0.03%      50.314ms     209.642us       0.000us         0.00%      23.852ms      99.382us           240  
                                              aten::exp         0.00%       3.003ms         0.01%      22.115ms      92.145us      23.075ms         0.01%      23.075ms      96.144us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.075ms         0.01%      23.075ms     219.758us           105  
                                              aten::add         0.04%      70.795ms         0.06%      99.988ms      55.984us      22.474ms         0.01%      22.597ms      12.652us          1786  
                                             aten::div_         0.00%       5.954ms         0.01%      14.306ms      29.804us      20.606ms         0.01%      20.606ms      42.928us           480  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      20.188ms         0.01%      20.188ms       7.239us          2789  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.837ms         0.01%      19.837ms     188.922us           105  
                                           aten::linear         0.00%       3.610ms         0.03%      57.509ms      79.874us       0.000us         0.00%      19.610ms      27.237us           720  
                                            aten::addmm         0.02%      41.126ms         0.03%      48.423ms      67.254us      19.455ms         0.01%      19.610ms      27.237us           720  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      19.250ms         0.01%      19.250ms      30.126us           639  
                                             aten::sub_         0.00%       4.665ms         0.00%       6.022ms      18.819us      18.925ms         0.01%      18.925ms      59.140us           320  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      18.271ms         0.01%      18.271ms     174.012us           105  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      18.233ms         0.01%      18.233ms      86.824us           210  
                                           aten::cumsum         0.06%     111.429ms         0.08%     141.197ms      24.513us      17.358ms         0.01%      18.066ms       3.136us          5760  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      17.896ms         0.01%      17.896ms       7.090us          2524  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      17.358ms         0.01%      17.358ms       6.877us          2524  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      17.296ms         0.01%      17.296ms       6.815us          2538  
                                         AddmmBackward0         0.00%       3.018ms         0.02%      38.490ms     160.373us       0.000us         0.00%      17.008ms      70.868us           240  
                     _VocabParallelCrossEntropyBackward         0.01%      17.036ms         0.02%      41.817ms     522.712us       0.000us         0.00%      17.002ms     212.525us            80  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      16.698ms         0.01%      16.698ms     159.024us           105  
                                        aten::embedding         0.00%       6.939ms         0.02%      28.844ms      40.062us       0.000us         0.00%      16.422ms      22.808us           720  
                                     aten::index_select         0.01%      12.384ms         0.01%      19.303ms      26.810us      16.422ms         0.01%      16.422ms      22.808us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.422ms         0.01%      16.422ms      51.641us           318  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.429ms         0.01%      13.429ms      83.932us           160  
                                             aten::mul_         0.00%       6.760ms         0.00%       7.512ms       5.868us      12.796ms         0.01%      12.796ms       9.997us          1280  
                                            aten::index         0.01%      13.307ms         0.04%      65.106ms     114.826us       2.117ms         0.00%      12.706ms      22.410us           567  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.869ms         0.01%      11.869ms     113.035us           105  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      11.854ms         0.01%      11.854ms     112.894us           105  
                                          aten::nonzero         0.00%       6.064ms         0.02%      36.092ms     147.315us      10.589ms         0.01%      10.589ms      43.220us           245  
                                       aten::index_put_         0.00%       6.088ms         0.08%     148.740ms     132.803us       0.000us         0.00%      10.013ms       8.940us          1120  
                                 aten::_index_put_impl_         0.00%       8.087ms         0.08%     142.651ms     127.367us     886.561us         0.00%      10.013ms       8.940us          1120  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.634ms         0.01%       9.634ms      40.143us           240  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       9.618ms         0.01%       9.618ms      40.073us           240  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.471ms         0.01%       9.471ms      22.821us           415  
                                              aten::max         0.00%       6.946ms         0.02%      37.959ms     149.447us       8.795ms         0.01%       8.869ms      34.918us           254  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.349ms         0.01%      13.068ms     163.345us       0.000us         0.00%       8.797ms     109.963us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.536ms         0.01%      10.719ms     133.984us       8.797ms         0.01%       8.797ms     109.963us            80  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.781ms         0.01%       8.781ms      83.630us           105  
autograd::engine::evaluate_function: torch::autograd...         0.00%       1.992ms         0.02%      27.789ms     347.368us       0.000us         0.00%       8.444ms     105.554us            80  
                            torch::autograd::CopySlices         0.00%       4.094ms         0.01%      25.797ms     322.467us       0.000us         0.00%       8.444ms     105.554us            80  
                                        hipLaunchKernel         0.76%        1.347s         0.76%        1.347s       8.815us       7.815ms         0.00%       8.323ms       0.054us        152836  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       8.318ms         0.01%       8.318ms      12.126us           686  
         _compile.<locals>.compile_inner (dynamo_timed)         0.08%     132.370ms         1.76%        3.102s     310.207ms       0.000us         0.00%       8.243ms     824.319us            10  
                           FusedLayerNormAffineFunction         0.01%      12.104ms         0.01%      21.713ms      90.470us       7.722ms         0.00%       7.722ms      32.176us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.722ms         0.00%       7.722ms      73.544us           105  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      29.344ms         1.66%        2.929s     292.888ms       0.000us         0.00%       7.010ms     701.049us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.32%     561.806ms         1.64%        2.900s     289.953ms       0.000us         0.00%       7.010ms     701.049us            10  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.755ms         0.00%       6.755ms      84.439us            80  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     508.407us         0.00%       2.261ms     226.114us       6.722ms         0.00%       6.722ms     672.211us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.722ms         0.00%       6.722ms      61.110us           110  
                            hipGetDevicePropertiesR0600         0.05%      88.399ms         0.05%      88.401ms       0.966us       6.659ms         0.00%       6.665ms       0.073us         91480  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       6.443ms         0.00%       6.443ms      26.844us           240  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       6.235ms         0.00%       6.235ms       6.495us           960  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.382ms         0.00%       5.382ms       5.960us           903  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       5.042ms         0.00%       5.042ms      31.514us           160  
                                        aten::index_put         0.00%       1.697ms         0.01%      11.610ms     139.880us       0.000us         0.00%       4.523ms      54.490us            83  
                                      IndexPutBackward0         0.00%       1.103ms         0.01%      11.876ms     148.450us       0.000us         0.00%       4.523ms      56.534us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.115ms         0.00%       4.115ms      51.432us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       4.079ms         0.00%       4.079ms      50.993us            80  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     697.852us         0.00%       4.640ms      58.000us       0.000us         0.00%       3.893ms      48.658us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%     966.796us         0.01%      22.016ms     275.203us       0.000us         0.00%       3.837ms      47.965us            80  
                                     _LayerNormBackward         0.00%       5.469ms         0.01%      21.049ms     263.118us       3.837ms         0.00%       3.837ms      47.965us            80  
                                  hipDeviceGetAttribute         0.00%     265.919us         0.00%     265.919us       3.969us       3.806ms         0.00%       3.806ms      56.802us            67  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     729.475us         0.00%       3.070ms      38.370us       0.000us         0.00%       3.469ms      43.362us            80  
                                          GeluBackward0         0.00%     461.313us         0.00%       2.340ms      29.251us       0.000us         0.00%       3.469ms      43.362us            80  
                                    aten::gelu_backward         0.00%       1.197ms         0.00%       1.879ms      23.485us       3.469ms         0.00%       3.469ms      43.362us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.469ms         0.00%       3.469ms      43.362us            80  
                                         _SplitAlongDim         0.08%     141.645ms         0.12%     205.137ms      35.614us       0.000us         0.00%       3.357ms       0.583us          5760  
                                                hipFree         0.06%     106.355ms         0.06%     106.403ms       5.911ms       0.000us         0.00%       2.993ms     166.260us            18  
                                             aten::ones         0.00%       1.012ms         0.00%       6.150ms      12.812us       0.000us         0.00%       2.776ms       5.783us           480  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.738ms         0.00%       2.738ms       5.157us           531  
                                             aten::gelu         0.00%       3.977ms         0.01%      10.468ms      43.618us       2.616ms         0.00%       2.616ms      10.899us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.616ms         0.00%       2.616ms      24.913us           105  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      15.814ms         1.12%        1.983s     198.310ms       0.000us         0.00%       2.474ms     247.418us            10  
                        compile_fx_inner (dynamo_timed)         0.04%      72.206ms         1.33%        2.344s     213.058ms       0.000us         0.00%       2.474ms     224.925us            11  
                                              aten::div         0.01%       9.986ms         0.01%      13.055ms      19.661us       2.473ms         0.00%       2.473ms       3.725us           664  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.425ms         0.00%       2.425ms       6.315us           384  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.343ms         0.00%       2.343ms       5.551us           422  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.247ms         0.00%       2.247ms      21.399us           105  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     585.429us         0.00%       7.809ms      48.806us       0.000us         0.00%       2.146ms      13.415us           160  
                                         SliceBackward0         0.00%     526.039us         0.00%       7.224ms      45.147us       0.000us         0.00%       2.146ms      13.415us           160  
                                   aten::slice_backward         0.00%       1.002ms         0.00%       6.698ms      41.860us       0.000us         0.00%       2.146ms      13.415us           160  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.117ms         0.00%       2.117ms      11.262us           188  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       2.100ms         0.00%       2.100ms       8.748us           240  
                               TorchDynamo Cache Lookup         0.12%     206.207ms         0.12%     206.229ms      10.729us       0.000us         0.00%       2.023ms       0.105us         19221  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.935ms         0.00%       1.935ms       6.242us           310  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.837ms         0.00%       1.837ms       3.804us           483  
      autograd::engine::evaluate_function: MulBackward0         0.01%      11.379ms         0.03%      53.442ms     310.710us       0.000us         0.00%       1.836ms      10.673us           172  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.765ms         0.00%       1.765ms      16.810us           105  
                                             _LayerNorm         0.00%       6.321ms         0.01%      11.159ms     139.485us       1.762ms         0.00%       1.762ms      22.020us            80  
                                               aten::lt         0.01%      19.202ms         0.01%      22.037ms      30.607us       1.719ms         0.00%       1.719ms       2.387us           720  
         GraphLowering.compile_to_module (dynamo_timed)         0.66%        1.158s         1.16%        2.054s     186.759ms       0.000us         0.00%       1.687ms     153.338us            11  
                                 c10d::_allgather_base_         0.00%     266.385us         0.00%       1.542ms     110.153us       0.000us         0.00%       1.638ms     116.981us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       1.638ms         0.00%       1.638ms     136.478us            12  
                                              hipMemcpy         0.01%      13.800ms         0.01%      13.800ms     287.501us       1.637ms         0.00%       1.637ms      34.111us            48  
                                 aten::split_with_sizes         0.03%      49.319ms         0.04%      63.470ms      11.019us       0.000us         0.00%       1.614ms       0.280us          5760  
                                        SelectBackward0         0.00%     221.567us         0.00%       2.946ms      36.819us       0.000us         0.00%       1.581ms      19.767us            80  
                                  aten::select_backward         0.00%     428.671us         0.00%       2.724ms      34.050us       0.000us         0.00%       1.581ms      19.767us            80  
                                           aten::select         0.20%     351.099ms         0.24%     427.927ms       4.372us       0.000us         0.00%       1.567ms       0.016us         97887  
                               aten::cross_entropy_loss         0.00%       1.564ms         0.01%      20.905ms      87.105us       0.000us         0.00%       1.478ms       6.160us           240  
                                        aten::unsqueeze         0.02%      31.549ms         0.02%      38.122ms       5.180us       0.000us         0.00%       1.368ms       0.186us          7360  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.307ms         0.00%       1.307ms       7.065us           185  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.299ms         0.00%       1.299ms       6.155us           211  
                                           MulBackward0         0.00%       7.759ms         0.02%      31.016ms     180.326us       0.000us         0.00%       1.246ms       7.245us           172  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.789ms         0.00%       7.977ms      49.855us       0.000us         0.00%       1.210ms       7.563us           160  
                                           DivBackward0         0.00%       1.242ms         0.00%       6.188ms      38.674us       0.000us         0.00%       1.210ms       7.563us           160  
                                               aten::ge         0.00%       7.038ms         0.00%       8.098ms      16.871us       1.175ms         0.00%       1.175ms       2.447us           480  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.685ms         0.01%      10.553ms     131.910us       0.000us         0.00%       1.172ms      14.644us            80  
                                       NllLossBackward0         0.00%     899.832us         0.01%       8.868ms     110.849us       0.000us         0.00%       1.172ms      14.644us            80  
                                aten::nll_loss_backward         0.00%       3.594ms         0.00%       7.968ms      99.601us     607.917us         0.00%       1.172ms      14.644us            80  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.164ms         0.00%       1.164ms       7.275us           160  
                                           aten::__or__         0.00%       1.550ms         0.01%      19.918ms      41.496us       0.000us         0.00%       1.146ms       2.388us           480  
                                       aten::bitwise_or         0.01%       9.039ms         0.01%      18.365ms      38.261us       1.146ms         0.00%       1.146ms       2.388us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.146ms         0.00%       1.146ms       5.432us           211  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.130ms         0.00%       1.130ms      14.129us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.065ms         0.00%       1.065ms       5.047us           211  
                                   hipDeviceSynchronize         0.00%     815.270us         0.00%     815.270us      23.979us       1.022ms         0.00%       1.022ms      30.065us            34  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us     998.257us         0.00%     998.257us       4.108us           243  
                                     hipExtLaunchKernel         0.06%     104.622ms         0.06%     104.656ms      10.636us       0.000us         0.00%     950.147us       0.097us          9840  
                            hipGetDevicePropertiesR0000         0.00%      52.598us         0.00%      52.598us       5.260us     949.967us         0.00%     949.967us      94.997us            10  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     915.465us         0.00%     915.465us      11.443us            80  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     912.454us         0.00%     912.454us       8.690us           105  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     896.945us         0.00%     896.945us       3.691us           243  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     886.561us         0.00%     886.561us      11.082us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     879.744us         0.00%     879.744us       8.379us           105  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     849.028us         0.00%     849.028us       3.494us           243  
                                               aten::gt         0.02%      35.735ms         0.02%      42.798ms       9.859us     799.084us         0.00%     799.084us       0.184us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     796.678us         0.00%     796.678us       3.292us           242  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     769.103us         0.00%     769.103us       3.205us           240  
                                      aten::log_softmax         0.00%       1.186ms         0.00%       6.336ms      26.400us       0.000us         0.00%     764.918us       3.187us           240  
                                     aten::_log_softmax         0.00%       3.851ms         0.00%       4.986ms      20.774us     764.918us         0.00%     764.918us       3.187us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     764.918us         0.00%     764.918us       7.285us           105  
                                             aten::tanh         0.01%      13.044ms         0.01%      23.215ms      85.664us     744.714us         0.00%     744.714us       2.748us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     744.714us         0.00%     744.714us       7.093us           105  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     716.653us         0.00%     716.653us       8.958us            80  
                                      aten::nll_loss_nd         0.00%     819.536us         0.01%      13.005ms      54.187us       0.000us         0.00%     713.440us       2.973us           240  
                                         aten::nll_loss         0.00%     839.673us         0.01%      12.185ms      50.772us       0.000us         0.00%     713.440us       2.973us           240  
                                 aten::nll_loss_forward         0.00%       4.568ms         0.01%      11.346ms      47.274us     713.440us         0.00%     713.440us       2.973us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     713.440us         0.00%     713.440us       6.795us           105  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     696.119us         0.00%     696.119us       6.630us           105  
                                             aten::item         0.02%      27.737ms         0.34%     604.135ms      35.963us       0.000us         0.00%     694.836us       0.041us         16799  
                              aten::_local_scalar_dense         0.01%      13.562ms         0.33%     576.396ms      34.311us     688.822us         0.00%     688.822us       0.041us         16799  
                                             aten::rsub         0.00%       2.817ms         0.00%       8.363ms      97.246us       0.000us         0.00%     658.714us       7.659us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     658.714us         0.00%     658.714us       8.234us            80  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     651.858us         0.00%     651.858us       8.148us            80  
                                       aten::empty_like         0.10%     183.711ms         0.30%     528.127ms       5.939us       0.000us         0.00%     626.923us       0.007us         88930  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     607.917us         0.00%     607.917us       7.599us            80  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     603.025us         0.00%     603.025us       7.538us            80  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     602.660us         0.00%     602.660us       2.511us           240  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.194ms         0.01%      22.659ms     276.333us       0.000us         0.00%     589.882us       7.194us            82  
                                          TanhBackward0         0.00%       1.975ms         0.01%      21.465ms     261.771us       0.000us         0.00%     589.882us       7.194us            82  
                                    aten::tanh_backward         0.00%       2.859ms         0.01%      17.211ms     209.890us     589.882us         0.00%     589.882us       7.194us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     589.882us         0.00%     589.882us       7.374us            80  
                                        aten::ones_like         0.00%     676.126us         0.00%       2.570ms      32.127us       0.000us         0.00%     572.515us       7.156us            80  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     751.463us         0.00%       5.435ms      67.936us       0.000us         0.00%     552.836us       6.910us            80  
                                    LogSoftmaxBackward0         0.00%       1.291ms         0.00%       4.683ms      58.542us       0.000us         0.00%     552.836us       6.910us            80  
                       aten::_log_softmax_backward_data         0.00%       2.123ms         0.00%       3.392ms      42.406us     552.836us         0.00%     552.836us       6.910us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     552.836us         0.00%     552.836us       6.910us            80  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     550.704us         0.00%     550.704us       5.195us           106  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     533.707us         0.00%     533.707us       2.224us           240  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     533.624us         0.00%     533.624us       6.670us            80  
                                          aten::normal_         0.74%        1.307s         0.74%        1.309s      12.583ms     530.421us         0.00%     530.421us       5.100us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     530.421us         0.00%     530.421us       5.468us            97  
                                               aten::eq         0.02%      40.476ms         0.02%      40.485ms       6.912us       0.000us         0.00%     525.890us       0.090us          5857  
                                              aten::log         0.00%       3.578ms         0.01%       9.915ms      41.314us     522.441us         0.00%     522.441us       2.177us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     522.441us         0.00%     522.441us       4.976us           105  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     519.239us         0.00%     519.239us       2.163us           240  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     511.620us         0.00%     511.620us       6.395us            80  
                                    hipFuncSetAttribute         0.00%       9.646us         0.00%       9.646us       0.402us     495.840us         0.00%     495.840us      20.660us            24  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       5.706ms         0.01%      10.931ms      68.320us     485.245us         0.00%     485.245us       3.033us           160  
                                              aten::all         0.04%      75.128ms         0.05%      85.263ms      14.557us       0.000us         0.00%     466.113us       0.080us          5857  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     416.404us         0.00%     416.404us       2.603us           160  
                       Scheduler.codegen (dynamo_timed)         0.07%     121.847ms         0.07%     121.881ms      11.080ms       0.000us         0.00%     308.530us      28.048us            11  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     302.581us         0.00%     302.581us       3.219us            94  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     301.373us         0.00%     301.373us       3.767us            80  
                                            aten::empty         0.48%     850.646ms         0.49%     855.704ms       3.259us       0.000us         0.00%     287.742us       0.001us        262555  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     205.634us         0.00%     205.634us       3.545us            58  
                                             aten::rand         0.00%       2.205ms         0.00%       5.411ms     386.509us       0.000us         0.00%     149.304us      10.665us            14  
                                         aten::uniform_         0.01%      10.619ms         0.01%      12.487ms     960.572us     149.304us         0.00%     149.304us      11.485us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     149.304us         0.00%     149.304us      29.861us             5  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      88.966us         0.00%      88.966us       8.897us            10  
                                          aten::maximum         0.00%     130.090us         0.01%      25.505ms       2.834ms      61.260us         0.00%      74.210us       8.246us             9  
                                             aten::view         0.17%     305.124ms         0.18%     311.895ms       2.156us       0.000us         0.00%      66.072us       0.000us        144633  
                                          aten::reshape         0.06%     109.599ms         0.11%     194.368ms       4.499us       0.000us         0.00%      66.072us       0.002us         43206  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      61.260us         0.00%      61.260us       6.807us             9  
                                       aten::lift_fresh         0.03%      50.979ms         0.03%      56.885ms      32.211us       0.000us         0.00%      47.830us       0.027us          1766  
                                          hipHostMalloc         0.08%     134.694ms         0.08%     134.694ms       4.082ms      43.180us         0.00%      43.180us       1.308us            33  
                                       aten::reciprocal         0.00%     146.725us         0.00%       8.810ms     880.985us      31.150us         0.00%      31.150us       3.115us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      31.150us         0.00%      31.150us       3.115us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      25.338us         0.00%      25.338us       2.534us            10  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.831us         0.00%      13.831us       4.610us             3  
                                              aten::min         0.00%     120.737us         0.00%       4.225ms     845.087us      13.151us         0.00%      13.151us       2.630us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.151us         0.00%      13.151us       4.384us             3  
                                          aten::resize_         0.06%     107.840ms         0.06%     108.110ms       3.120us       0.000us         0.00%       7.939us       0.000us         34655  
                                   hipFuncGetAttributes         0.16%     284.322ms         0.16%     284.322ms       2.154ms       6.295us         0.00%       6.295us       0.048us           132  
                                        aten::transpose         0.15%     262.052ms         0.18%     321.977ms       3.379us       0.000us         0.00%       4.611us       0.000us         95285  
                                          aten::squeeze         0.04%      71.256ms         0.05%      84.773ms       3.679us       0.000us         0.00%       3.849us       0.000us         23040  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.406us         0.00%       2.406us       2.406us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       1.924us         0.00%       1.924us       1.924us             1  
                        hipDeviceGetStreamPriorityRange         0.00%       1.934us         0.00%       1.934us       1.934us       0.000us         0.00%       0.000us       0.000us             1  
                                              hipMalloc         0.01%      15.511ms         0.01%      15.511ms      94.577us       0.000us         0.00%       0.000us       0.000us           164  
                            hipStreamCreateWithPriority         0.00%     509.245us         0.00%     509.245us      84.874us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.049s      62.236us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      12.927ms         0.01%      12.927ms       1.313us       0.000us         0.00%       0.000us       0.000us          9842  
                                    aten::empty_strided         0.18%     324.679ms         0.19%     331.760ms       3.742us       0.000us         0.00%       0.000us       0.000us         88647  
                                           aten::detach         0.04%      64.904ms         0.11%     191.912ms       5.410us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.06%     100.573ms         0.07%     121.054ms       3.579us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.00%       8.697ms         0.01%      15.555ms     125.442us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.04%      66.769ms         0.05%      88.240ms       2.436us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     282.060us         0.00%     371.567us      46.446us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.13%     236.344ms         0.13%     236.611ms       0.703us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%       1.124ms         0.00%       1.605ms      84.498us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     473.334us         0.00%     968.912us      23.069us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     783.435us         0.00%       1.057ms      75.493us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     111.889us         0.00%     150.705us      75.353us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       3.348ms         0.00%       6.892ms     181.381us       0.000us         0.00%       0.000us       0.000us            38  
                                         prims::view_of         0.00%     507.988us         0.00%     655.558us      27.315us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       5.681ms         0.00%       5.791ms       6.039us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       7.458ms         0.00%       8.655ms      10.725us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%       1.197ms         0.00%       1.197ms       1.483us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     351.164us         0.00%     351.164us      11.328us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     109.966us         0.00%     109.966us       9.997us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      11.511ms         0.01%      24.719ms      96.558us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     725.936us         0.00%     725.936us       2.836us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     190.154us         0.00%     259.329us      86.443us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     103.575us         0.00%     103.575us      51.788us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     141.356us         0.00%     150.873us      75.437us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      33.037us         0.00%      33.037us       2.360us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.167ms         0.00%       2.278ms     455.550us       0.000us         0.00%       0.000us       0.000us             5  
                                            aten::slice         0.05%      90.544ms         0.06%     107.334ms       4.110us       0.000us         0.00%       0.000us       0.000us         26118  
                                        aten::index_add         0.00%     241.013us         0.00%       1.406ms       1.406ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     455.984us         0.00%     517.490us     258.745us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     241.292us         0.00%     241.292us     241.292us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.10%     170.927ms         0.10%     173.387ms      15.762ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.09%     150.661ms         0.09%     150.691ms      13.699ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.00%       8.154ms         0.00%       8.154ms     741.284us       0.000us         0.00%       0.000us       0.000us            11  
                                    hipModuleLoadDataEx         0.36%     628.873ms         0.36%     628.873ms      48.375ms       0.000us         0.00%       0.000us       0.000us            13  
                                    hipFuncGetAttribute         0.00%       6.422us         0.00%       6.422us       0.535us       0.000us         0.00%       0.000us       0.000us            12  
                                 hipPointerGetAttribute         0.03%      53.430ms         0.03%      53.430ms       0.855us       0.000us         0.00%       0.000us       0.000us         62513  
                                        aten::expand_as         0.00%       1.151ms         0.00%       3.753ms       6.911us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.550ms         0.00%       5.561ms     505.576us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     129.433us         0.00%     144.940us      72.470us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     149.248us         0.00%     149.248us      74.624us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      74.397us         0.00%      93.104us      93.104us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     327.944us         0.00%       2.861ms     953.689us       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     280.839us         0.00%     319.683us     106.561us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.208ms         0.00%       3.843ms     640.459us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%     834.196us         0.00%       4.027ms     447.392us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.209ms         0.00%       2.676ms     445.940us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     316.114us         0.00%     835.798us     278.599us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     235.675us         0.00%       1.103ms     367.715us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     444.474us         0.00%     867.471us     289.157us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     350.639us         0.00%     373.163us      93.291us       0.000us         0.00%       0.000us       0.000us             4  
                aten::_has_compatible_shallow_copy_type         0.00%       3.412ms         0.00%       3.412ms       0.139us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     812.217us      58.015us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       5.635ms         0.01%      13.155ms       5.860us       0.000us         0.00%       0.000us       0.000us          2245  
                                         nccl:broadcast         0.00%       0.000us             0      68.036ms     141.446us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.00%       8.409ms         0.01%      18.858ms       4.622us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.01%       8.926ms         0.02%      29.571ms      11.201us       0.000us         0.00%       0.000us       0.000us          2640  
                                          aten::view_as         0.00%       1.413ms         0.00%       2.916ms       4.050us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      34.796ms         0.02%      41.420ms       5.178us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.645us         0.00%       1.645us       0.235us       0.000us         0.00%       0.000us       0.000us             7  
                              hipDevicePrimaryCtxRetain         0.00%       2.078us         0.00%       2.078us       0.297us       0.000us         0.00%       0.000us       0.000us             7  
                             hipDevicePrimaryCtxRelease         0.00%       1.484us         0.00%       1.484us       0.212us       0.000us         0.00%       0.000us       0.000us             7  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      48.479ms         0.03%      48.479ms       2.666us       0.000us         0.00%       0.000us       0.000us         18183  
                                              hipMemset         0.00%      25.086us         0.00%      25.086us      12.543us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.21%     376.896ms         0.21%     376.896ms     125.632ms       0.000us         0.00%       0.000us       0.000us             3  
                               hipExtModuleLaunchKernel         0.16%     279.611ms         0.16%     279.641ms       7.101us       0.000us         0.00%       0.000us       0.000us         39378  
                                   aten::_reshape_alias         0.02%      32.127ms         0.02%      32.127ms       2.092us       0.000us         0.00%       0.000us       0.000us         15360  
                                      hipModuleLoadData         0.25%     437.983ms         0.25%     437.983ms     109.496ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     747.809us         0.00%       1.743ms     435.824us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       6.652ms         0.00%       7.846ms      32.693us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     889.923us         0.00%     889.923us       2.781us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.02%      40.338ms         0.07%     116.642ms       7.439us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      18.959ms         0.04%      76.304ms       4.866us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     463.051us         0.00%       3.164ms      39.553us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.273ms         0.00%       2.701ms      33.765us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.03%      55.915ms         0.08%     132.848ms       6.243us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      19.905ms         0.04%      76.933ms       3.615us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.02%      39.820ms         0.05%      89.698ms       3.713us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.066ms         0.00%       2.826ms      11.777us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     412.570us         0.00%       1.760ms       7.334us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     303.750us         0.00%     972.134us      12.152us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     668.384us         0.00%     668.384us       8.355us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%     975.196us         0.21%     377.328ms     377.328ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      18.967ms         0.01%      21.405ms       2.786us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.438ms         0.00%       2.438ms       0.317us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       5.231ms         0.01%      19.674ms       9.837us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       3.983ms         0.01%      14.443ms       7.222us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       4.742ms         0.01%      12.881ms       6.709us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       2.155ms         0.00%       8.139ms       4.239us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     364.815us         0.00%     364.815us       0.190us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%     750.179us         0.00%       2.691ms      33.643us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.941ms         0.00%       1.941ms      24.266us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.611ms         0.00%       2.383ms      29.792us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.315ms     231.475us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      16.180us         0.00%      31.264us       7.816us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 176.423s
Self CUDA time total: 165.302s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       81.921s        51.62%       81.921s       81.921s             1  
                                             bert_train        35.19%       61.894s        71.05%      124.946s      124.946s       0.000us         0.00%       38.350s       38.350s             1  
                                            aten::copy_        13.98%       24.588s        16.45%       28.927s     367.026us       16.546s        10.43%       16.561s     210.128us         78815  
                                               aten::to         0.04%      66.048ms        16.43%       28.892s     550.433us       0.000us         0.00%       11.962s     227.892us         52489  
                                         aten::_to_copy         0.11%     196.277ms        16.39%       28.826s     665.028us       0.000us         0.00%       11.962s     275.968us         43345  
                                      aten::masked_fill         0.04%      79.083ms         0.27%     472.308ms      49.199us       0.000us         0.00%       11.686s       1.217ms          9600  
                                     record_param_comms         3.78%        6.647s         5.18%        9.105s     262.286us        8.216s         5.18%       11.450s     329.837us         34714  
                                     aten::masked_fill_         0.11%     196.202ms         0.26%     450.381ms      27.462us       10.752s         6.78%       10.753s     655.662us         16400  
                                       c10d::allreduce_         0.25%     445.228ms         2.47%        4.348s     258.649us       0.000us         0.00%        8.511s     506.247us         16811  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        8.174s         5.15%        8.174s     860.812us          9496  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        8.081s         5.09%        8.081s     842.773us          9588  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      19.516ms         0.11%     200.983ms      52.339us       0.000us         0.00%        7.758s       2.020ms          3840  
                                    MaskedFillBackward0         0.00%       7.846ms         0.10%     181.467ms      47.257us       0.000us         0.00%        7.758s       2.020ms          3840  
                                              aten::bmm         0.28%     486.762ms         0.34%     591.026ms      43.975us        7.043s         4.44%        7.043s     524.033us         13440  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       8.768ms         0.04%      75.508ms      39.327us       0.000us         0.00%        6.492s       3.381ms          1920  
                                       SoftmaxBackward0         0.00%       7.370ms         0.04%      66.740ms      34.760us       0.000us         0.00%        6.492s       3.381ms          1920  
                           aten::_softmax_backward_data         0.01%      20.816ms         0.03%      59.370ms      30.922us        3.352s         2.11%        6.492s       3.381ms          1920  
autograd::engine::evaluate_function: _LayerNormLinea...         0.06%      97.053ms         2.75%        4.841s       1.261ms       0.000us         0.00%        6.474s       1.686ms          3840  
                               _LayerNormLinearBackward         1.78%        3.137s         2.66%        4.682s       1.219ms     495.326ms         0.31%        6.316s       1.645ms          3840  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.309s         3.98%        6.309s       1.421ms          4440  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.121s         3.86%        6.121s     749.516us          8167  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.700s         3.59%        5.700s       1.236ms          4610  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      14.880ms         0.05%      93.864ms      23.945us       0.000us         0.00%        5.081s       1.296ms          3920  
                                        ToCopyBackward0         0.00%       6.911ms         0.04%      78.984ms      20.149us       0.000us         0.00%        5.081s       1.296ms          3920  
                                            aten::clone         0.07%     126.534ms         0.46%     802.955ms      23.243us       0.000us         0.00%        4.598s     133.107us         34546  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.477s         2.82%        4.477s     561.264us          7977  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.441s         2.80%        4.441s     960.116us          4625  
                                          aten::softmax         0.01%      13.850ms         0.09%     159.366ms      27.668us       0.000us         0.00%        4.291s     744.943us          5760  
                                         aten::_softmax         0.05%      86.685ms         0.08%     145.509ms      25.262us        4.291s         2.70%        4.291s     744.943us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.291s         2.70%        4.291s       1.703ms          2520  
                                     tex_ts::te_gemm_ts         1.34%        2.360s         1.98%        3.489s      90.861us        4.224s         2.66%        4.231s     110.189us         38400  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.744s         2.36%        3.744s     843.303us          4440  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.617s         2.28%        3.617s     313.957us         11520  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.352s         2.11%        3.352s       1.746ms          1920  
                                                _Linear         1.07%        1.889s         1.70%        2.995s     780.035us     156.835ms         0.10%        3.312s     862.532us          3840  
                                              aten::mul         0.09%     165.623ms         0.13%     233.622ms      29.309us        3.178s         2.00%        3.180s     398.920us          7971  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.142s         1.98%        3.142s       1.432ms          2194  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      19.117ms         0.12%     217.438ms     113.249us       0.000us         0.00%        3.093s       1.611ms          1920  
                                       BaddbmmBackward0         0.01%      20.407ms         0.11%     198.321ms     103.292us       0.000us         0.00%        3.093s       1.611ms          1920  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.884s         1.19%        1.884s     414.461us          4545  
                                          c10d::barrier         0.00%     844.398us         1.94%        3.409s      89.702ms       0.000us         0.00%        1.859s      48.909ms            38  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      22.548ms         0.12%     211.004ms     109.898us       0.000us         0.00%        1.793s     934.007us          1920  
                                           BmmBackward0         0.01%      14.095ms         0.11%     188.456ms      98.154us       0.000us         0.00%        1.793s     934.007us          1920  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      42.276ms         1.58%        2.775s     722.552us       0.000us         0.00%        1.716s     446.945us          3840  
                                        _LinearBackward         1.22%        2.138s         1.55%        2.732s     711.543us     210.378ms         0.13%        1.716s     446.945us          3840  
                                       aten::logical_or         0.07%     123.208ms         0.21%     371.876ms      32.281us     822.791ms         0.52%        1.646s     142.874us         11520  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.505s         0.95%        1.505s     784.078us          1920  
                                          aten::dropout         0.01%      12.043ms         0.07%     124.174ms      20.644us       0.000us         0.00%        1.477s     245.610us          6015  
                                   aten::native_dropout         0.02%      43.609ms         0.06%     107.150ms      53.335us        1.477s         0.93%        1.477s     735.364us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.477s         0.93%        1.477s     738.673us          2000  
                                              aten::sub         0.07%     114.367ms         0.08%     147.584ms      22.463us        1.430s         0.90%        1.430s     217.667us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.427s         0.90%        1.427s     566.417us          2520  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      12.322ms         0.04%      72.990ms      36.441us       0.000us         0.00%        1.401s     699.412us          2003  
                                 NativeDropoutBackward0         0.00%       7.326ms         0.03%      60.668ms      30.289us       0.000us         0.00%        1.401s     699.412us          2003  
                          aten::native_dropout_backward         0.01%      20.450ms         0.03%      53.342ms      26.631us        1.401s         0.88%        1.401s     699.412us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.401s         0.88%        1.401s     700.461us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.396s         0.88%        1.396s      81.240us         17180  
                                   hipStreamIsCapturing         0.03%      58.727ms         0.03%      58.730ms       1.165us        1.249s         0.79%        1.250s      24.786us         50420  
                                          aten::baddbmm         0.23%     397.495ms         0.50%     871.156ms     151.242us        1.185s         0.75%        1.186s     205.858us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.134s         0.71%        1.134s     590.729us          1920  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      25.465ms         0.62%        1.083s     282.011us       0.000us         0.00%        1.003s     261.313us          3840  
                               CompiledFunctionBackward         0.30%     521.309ms         0.60%        1.057s     275.379us       0.000us         0.00%        1.003s     261.313us          3840  
                                         hipMemsetAsync         0.07%     115.168ms         0.07%     115.181ms       9.718us     973.659ms         0.61%     973.999ms      82.180us         11852  
                                       c10d::broadcast_         0.02%      37.942ms         0.46%     807.199ms       1.678ms       0.000us         0.00%     964.689ms       2.006ms           481  
                                 triton_red_fused_sum_1         0.02%      37.305ms         0.03%      59.845ms      15.585us     893.265ms         0.56%     893.265ms     232.621us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     822.791ms         0.52%     822.791ms     326.505us          2520  
                                      aten::logical_not         0.09%     161.031ms         0.27%     478.207ms      20.756us     327.319ms         0.21%     655.430ms      28.447us         23040  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.621ms         0.00%       2.621ms       0.183us     573.139ms         0.36%     573.139ms      40.091us         14296  
                                   hipDeviceGetPCIBusId         0.01%      12.231ms         0.01%      12.231ms       0.846us     565.274ms         0.36%     565.274ms      39.084us         14463  
                                        hipEventDestroy         0.03%      45.015ms         0.03%      45.371ms       2.286us     461.706ms         0.29%     461.913ms      23.269us         19851  
                               hipStreamCreateWithFlags         0.24%     418.059ms         0.24%     418.059ms     153.585us     458.245ms         0.29%     458.245ms     168.349us          2722  
                                  Torch-Compiled Region         0.56%     991.733ms         1.69%        2.965s     154.279us       0.000us         0.00%     439.604ms      22.872us         19220  
                                      hipGetProcAddress         0.05%      82.316ms         0.05%      82.318ms       1.060us     439.336ms         0.28%     439.336ms       5.656us         77671  
                                       _LayerNormLinear         0.40%     711.060ms         1.14%        2.003s     521.570us     273.262ms         0.17%     425.547ms     110.819us          3840  
                                       hipCtxGetCurrent         0.01%      12.203ms         0.01%      12.203ms       0.207us     388.387ms         0.24%     388.387ms       6.582us         59005  
                                             aten::add_         0.10%     170.785ms         0.17%     305.419ms       9.721us     372.388ms         0.23%     372.388ms      11.852us         31420  
                                       CompiledFunction         0.67%        1.181s         0.98%        1.722s     149.193us       0.000us         0.00%     329.297ms      28.535us         11540  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     327.319ms         0.21%     327.319ms      64.944us          5040  
                                              aten::sum         0.23%     403.475ms         0.48%     848.717ms      41.698us     226.767ms         0.14%     312.756ms      15.366us         20354  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     295.989ms         0.19%     295.989ms      58.728us          5040  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us     280.655ms         0.18%     280.655ms     280.655ms             1  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     274.911ms         0.17%     274.911ms      47.728us          5760  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     260.353ms         0.16%     260.353ms      67.800us          3840  
                  triton_poi_fused_add_native_dropout_0         0.05%      94.257ms         0.08%     141.499ms      36.753us     247.704ms         0.16%     247.898ms      64.389us          3850  
autograd::engine::evaluate_function: torch::autograd...         0.19%     334.484ms         0.37%     659.206ms      27.285us       0.000us         0.00%     213.616ms       8.842us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     211.320ms         0.13%     211.320ms       8.834us         23920  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     176.804ms         0.11%     176.804ms      34.106us          5184  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     173.794ms         0.11%     173.794ms      34.483us          5040  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     169.448ms         0.11%     169.448ms      38.078us          4450  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.02%      28.776ms         0.44%     776.890ms     404.630us       0.000us         0.00%     167.273ms      87.121us          1920  
                                  hipExtMallocWithFlags         0.03%      51.269ms         0.03%      51.269ms      11.929us     150.266ms         0.09%     150.266ms      34.962us          4298  
                             _VocabParallelCrossEntropy         0.05%      80.850ms         0.16%     288.444ms       1.202ms       0.000us         0.00%     148.202ms     617.508us           240  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     144.979ms         0.09%     144.979ms      36.984us          3920  
                                              aten::cat         0.10%     167.531ms         0.13%     220.090ms      27.239us     141.862ms         0.09%     141.866ms      17.558us          8080  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.710ms         0.07%     120.010ms       1.500ms       0.000us         0.00%     135.928ms       1.699ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      20.590ms         0.07%     118.299ms       1.479ms       0.000us         0.00%     135.928ms       1.699ms            80  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.095ms        22.16%       38.977s     162.404ms       0.000us         0.00%     134.135ms     558.896us           240  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     134.021ms         0.08%     134.021ms     635.170us           211  
                                     EmbeddingBackward0         0.00%       3.044ms        22.16%       38.969s     162.373ms       0.000us         0.00%     133.047ms     554.364us           240  
                               aten::embedding_backward         0.00%       2.958ms        22.16%       38.966s     162.360ms       0.000us         0.00%     133.047ms     554.364us           240  
                         aten::embedding_dense_backward         2.19%        3.853s        22.16%       38.963s     162.348ms     126.264ms         0.08%     133.047ms     554.364us           240  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     129.141ms         0.08%     129.141ms      12.680us         10185  
                                       aten::contiguous         0.02%      30.363ms         0.31%     549.904ms      23.867us       0.000us         0.00%     126.437ms       5.488us         23040  
                                         hipMemcpyAsync         0.11%     193.278ms         0.11%     193.330ms      15.905us     118.348ms         0.07%     118.870ms       9.779us         12155  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      17.927ms         0.14%     247.800ms     129.063us       0.000us         0.00%     118.177ms      61.551us          1920  
                                 _SplitAlongDimBackward         0.10%     173.958ms         0.13%     229.873ms     119.726us       0.000us         0.00%     118.177ms      61.551us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     118.177ms         0.07%     118.177ms      61.551us          1920  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     116.124ms         0.07%     116.124ms      53.761us          2160  
                             c10d::allreduce_coalesced_         0.00%       1.711ms         0.05%      94.211ms       9.421ms       0.000us         0.00%     115.741ms      11.574ms            10  
             triton_poi_fused_native_dropout_backward_0         0.04%      68.968ms         0.06%     102.344ms      26.652us     110.176ms         0.07%     110.176ms      28.692us          3840  
                                               aten::mm         0.03%      54.039ms         0.06%     108.019ms     122.749us     105.214ms         0.07%     105.214ms     119.561us           880  
                         _ReduceFromModelParallelRegion         0.01%      25.998ms         0.04%      69.181ms     288.253us       0.000us         0.00%     103.109ms     429.622us           240  
                                   hipStreamSynchronize         0.38%     675.532ms         0.38%     675.555ms     207.416us     100.382ms         0.06%     100.400ms      30.826us          3257  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      95.581ms         0.06%      95.581ms      37.929us          2520  
                                           aten::arange         0.08%     145.847ms         0.24%     420.180ms      17.053us      43.987ms         0.03%      90.655ms       3.679us         24640  
                                           aten::matmul         0.00%       3.319ms         0.05%      83.287ms     208.216us       0.000us         0.00%      87.381ms     218.452us           400  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      85.040ms         0.05%      85.040ms      11.249us          7560  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      82.439ms         0.05%      82.439ms      42.937us          1920  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      81.762ms         0.05%      81.762ms       6.900us         11849  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      80.346ms         0.05%      80.346ms      20.496us          3920  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      77.377ms         0.05%      77.377ms      30.705us          2520  
                                       hipStreamDestroy         0.03%      53.804ms         0.03%      53.804ms      19.913us      70.694ms         0.04%      70.694ms      26.163us          2702  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.21%     366.799ms         0.36%     639.193ms      83.228us      69.256ms         0.04%      70.415ms       9.169us          7680  
                                    hipIpcOpenMemHandle         0.06%     104.317ms         0.06%     104.317ms      57.858us      67.406ms         0.04%      67.406ms      37.386us          1803  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      67.317ms         0.04%      67.317ms      17.530us          3840  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      67.266ms         0.04%      67.266ms     280.276us           240  
                                  hipModuleLaunchKernel         0.14%     244.683ms         0.14%     244.711ms       7.221us      64.064ms         0.04%      64.114ms       1.892us         33890  
                                 hipDeviceCanAccessPeer         0.00%     348.717us         0.00%     348.717us       0.173us      62.039ms         0.04%      62.039ms      30.713us          2020  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      60.770ms         0.04%      60.770ms      13.890us          4375  
                                           GeLUFunction         0.10%     182.205ms         0.61%        1.080s     187.439us       0.000us         0.00%      59.920ms      10.403us          5760  
                        triton_poi_fused_add_mul_tanh_0         0.08%     135.183ms         0.09%     159.943ms      27.720us      58.829ms         0.04%      58.834ms      10.197us          5770  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      57.286ms         0.04%      57.286ms      29.836us          1920  
        LinearWithGradAccumulationAndAsyncCommunication         0.01%       9.487ms         0.02%      28.897ms     120.404us       0.000us         0.00%      52.127ms     217.196us           240  
                                   GeLUFunctionBackward         0.03%      59.047ms         0.38%     664.390ms     346.037us       0.000us         0.00%      51.152ms      26.642us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      34.816ms         0.03%      52.827ms      27.514us      51.152ms         0.03%      51.152ms      26.642us          1920  
                                     hipIpcGetMemHandle         0.01%      12.260ms         0.01%      12.260ms       6.822us      50.303ms         0.03%      50.303ms      27.993us          1797  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      45.106ms         0.03%      45.106ms       8.950us          5040  
                                    hipMemcpyWithStream        24.40%       42.918s        24.41%       42.922s      54.126ms       0.000us         0.00%      41.444ms      52.262us           793  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      40.940ms         0.03%      40.940ms       8.123us          5040  
                                          aten::randint         0.02%      40.385ms         0.09%     157.329ms      40.822us       0.000us         0.00%      38.127ms       9.893us          3854  
                                          aten::random_         0.04%      64.957ms         0.06%     114.072ms      29.629us      37.913ms         0.02%      38.122ms       9.902us          3850  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      37.913ms         0.02%      37.913ms       9.847us          3850  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      35.719ms         0.02%      35.719ms       9.302us          3840  
                                            aten::fill_         0.08%     142.765ms         0.10%     175.228ms       6.059us      35.263ms         0.02%      35.270ms       1.220us         28919  
                                 triton_poi_fused_add_0         0.13%     227.872ms         0.14%     241.518ms      31.448us      34.572ms         0.02%      34.572ms       4.502us          7680  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      31.946ms         0.02%      31.946ms      12.677us          2520  
                                            aten::zero_         0.04%      78.583ms         0.14%     243.348ms      10.746us       0.000us         0.00%      31.927ms       1.410us         22646  
                                            aten::zeros         0.05%      84.351ms         0.21%     369.633ms      16.497us       0.000us         0.00%      30.498ms       1.361us         22406  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      29.035ms         0.02%      29.035ms     181.471us           160  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.327ms         0.03%      47.869ms     598.368us       0.000us         0.00%      27.733ms     346.659us            80  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      25.162ms         0.02%      25.162ms     314.521us            80  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       3.928ms         0.03%      49.720ms     207.169us       0.000us         0.00%      25.059ms     104.414us           240  
                                     hipStreamWaitEvent         0.18%     309.937ms         0.18%     309.977ms      15.109us      23.767ms         0.01%      24.906ms       1.214us         20516  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      24.733ms         0.02%      24.733ms     117.777us           210  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      23.684ms         0.01%      23.684ms       8.504us          2785  
                                 tex_ts::cast_to_fp8_ts         0.08%     141.544ms         0.12%     213.346ms      27.779us      23.482ms         0.01%      23.502ms       3.060us          7680  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      23.482ms         0.01%      23.482ms      19.568us          1200  
                                              aten::exp         0.00%       3.314ms         0.01%      17.631ms      73.462us      23.295ms         0.01%      23.295ms      97.064us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      23.295ms         0.01%      23.295ms     221.860us           105  
                                              aten::add         0.05%      83.898ms         0.07%     120.223ms      67.277us      23.037ms         0.01%      23.037ms      12.892us          1787  
                                             aten::div_         0.00%       6.421ms         0.01%      12.811ms      26.689us      21.421ms         0.01%      21.421ms      44.626us           480  
                                           aten::cumsum         0.07%     119.838ms         0.09%     150.939ms      26.205us      21.070ms         0.01%      21.196ms       3.680us          5760  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      21.070ms         0.01%      21.070ms       8.361us          2520  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      20.917ms         0.01%      20.917ms       8.255us          2534  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.889ms         0.01%      20.889ms       8.289us          2520  
                                           aten::linear         0.00%       3.823ms         0.03%      60.596ms      84.161us       0.000us         0.00%      20.771ms      28.848us           720  
                                            aten::addmm         0.02%      43.280ms         0.03%      50.800ms      70.555us      20.203ms         0.01%      20.679ms      28.720us           720  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      20.555ms         0.01%      20.555ms     195.761us           105  
                                             aten::sub_         0.00%       4.898ms         0.00%       6.229ms      19.466us      20.498ms         0.01%      20.498ms      64.056us           320  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.831ms         0.01%      19.831ms     188.867us           105  
                                         AddmmBackward0         0.00%       3.090ms         0.02%      37.932ms     158.049us       0.000us         0.00%      17.833ms      74.306us           240  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      17.354ms         0.01%      17.354ms      27.200us           638  
                     _VocabParallelCrossEntropyBackward         0.01%      17.401ms         0.02%      42.361ms     529.508us       0.000us         0.00%      17.245ms     215.562us            80  
                                            aten::index         0.01%      14.173ms         0.04%      74.585ms     131.544us       2.457ms         0.00%      17.177ms      30.295us           567  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      16.905ms         0.01%      16.905ms     161.004us           105  
                                        aten::embedding         0.00%       7.107ms         0.02%      30.746ms      42.703us       0.000us         0.00%      16.846ms      23.398us           720  
                                     aten::index_select         0.01%      13.297ms         0.01%      20.834ms      28.937us      16.846ms         0.01%      16.846ms      23.398us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.846ms         0.01%      16.846ms      53.481us           315  
                                          aten::nonzero         0.00%       5.565ms         0.02%      41.181ms     168.087us      14.720ms         0.01%      14.720ms      60.083us           245  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.008ms         0.01%      13.008ms      81.302us           160  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      12.586ms         0.01%      12.586ms     119.868us           105  
                                             aten::mul_         0.00%       6.598ms         0.00%       7.370ms       5.758us      12.465ms         0.01%      12.465ms       9.738us          1280  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      12.247ms         0.01%      12.247ms     116.633us           105  
                                       aten::index_put_         0.00%       6.118ms         0.11%     194.512ms     173.671us       0.000us         0.00%      10.598ms       9.462us          1120  
                                 aten::_index_put_impl_         0.00%       8.234ms         0.11%     188.393ms     168.208us     955.957us         0.00%      10.598ms       9.462us          1120  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us      10.358ms         0.01%      10.358ms      43.159us           240  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us      10.130ms         0.01%      10.130ms      42.207us           240  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.528ms         0.01%      13.493ms     168.665us       0.000us         0.00%       9.755ms     121.932us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.660ms         0.01%      10.965ms     137.061us       9.755ms         0.01%       9.755ms     121.932us            80  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.042ms         0.02%      27.632ms     345.394us       0.000us         0.00%       9.466ms     118.322us            80  
                            torch::autograd::CopySlices         0.00%       4.091ms         0.01%      25.589ms     319.863us       0.000us         0.00%       9.466ms     118.322us            80  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.310ms         0.01%       9.310ms      22.434us           415  
                                              aten::max         0.00%       7.492ms         0.02%      37.496ms     147.620us       9.055ms         0.01%       9.152ms      36.031us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       9.042ms         0.01%       9.042ms      86.116us           105  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       9.007ms         0.01%       9.007ms      13.130us           686  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       8.038ms         0.01%       8.038ms       8.373us           960  
                           FusedLayerNormAffineFunction         0.01%      13.001ms         0.01%      21.471ms      89.464us       7.618ms         0.00%       7.618ms      31.743us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.618ms         0.00%       7.618ms      72.554us           105  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       7.250ms         0.00%       7.250ms      30.208us           240  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       7.000ms         0.00%       7.000ms      87.506us            80  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     507.738us         0.00%       2.267ms     226.743us       6.755ms         0.00%       6.755ms     675.462us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.755ms         0.00%       6.755ms      61.406us           110  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       5.537ms         0.00%       5.537ms      34.608us           160  
                                  hipMemGetAddressRange         0.00%     180.653us         0.00%     180.653us       0.402us       5.503ms         0.00%       5.503ms      12.256us           449  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.339ms         0.00%       5.339ms       5.912us           903  
                                        aten::index_put         0.00%       2.022ms         0.01%      12.019ms     144.811us       0.000us         0.00%       5.059ms      60.948us            83  
                                      IndexPutBackward0         0.00%       1.063ms         0.01%      11.629ms     145.365us       0.000us         0.00%       5.059ms      63.234us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.669ms         0.00%       4.669ms      58.358us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       4.490ms         0.00%       4.490ms      56.119us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%       1.060ms         0.01%      23.199ms     289.982us       0.000us         0.00%       4.130ms      51.623us            80  
                                     _LayerNormBackward         0.00%       5.811ms         0.01%      22.139ms     276.731us       4.130ms         0.00%       4.130ms      51.623us            80  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     768.957us         0.00%       3.301ms      41.261us       0.000us         0.00%       3.665ms      45.818us            80  
                                          GeluBackward0         0.00%     494.848us         0.00%       2.532ms      31.649us       0.000us         0.00%       3.665ms      45.818us            80  
                                    aten::gelu_backward         0.00%       1.357ms         0.00%       2.037ms      25.463us       3.665ms         0.00%       3.665ms      45.818us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.665ms         0.00%       3.665ms      45.818us            80  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     728.021us         0.00%       4.815ms      60.192us       0.000us         0.00%       3.604ms      45.045us            80  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       3.261ms         0.00%       3.261ms       6.751us           483  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       3.238ms         0.00%       3.238ms      13.491us           240  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       3.047ms         0.00%       3.047ms       5.750us           530  
                                              aten::div         0.01%      11.121ms         0.01%      14.733ms      22.188us       2.837ms         0.00%       2.837ms       4.273us           664  
                                             aten::ones         0.00%     996.391us         0.00%       6.083ms      12.673us       0.000us         0.00%       2.725ms       5.677us           480  
                                             aten::gelu         0.00%       4.324ms         0.01%       9.110ms      37.958us       2.699ms         0.00%       2.699ms      11.246us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.699ms         0.00%       2.699ms      25.706us           105  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.604ms         0.00%       2.604ms       6.782us           384  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.510ms         0.00%       2.510ms       5.977us           420  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     620.096us         0.00%       8.063ms      50.397us       0.000us         0.00%       2.485ms      15.531us           160  
                                         SliceBackward0         0.00%     549.154us         0.00%       7.443ms      46.521us       0.000us         0.00%       2.485ms      15.531us           160  
                                   aten::slice_backward         0.00%       1.044ms         0.00%       6.894ms      43.089us       0.000us         0.00%       2.485ms      15.531us           160  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.457ms         0.00%       2.457ms      13.068us           188  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.430ms         0.00%       2.430ms      23.140us           105  
         _compile.<locals>.compile_inner (dynamo_timed)         0.09%     151.557ms         2.02%        3.559s     355.882ms       0.000us         0.00%       2.307ms     230.658us            10  
                                        hipLaunchKernel         0.81%        1.430s         0.81%        1.431s       9.378us     678.593us         0.00%       2.261ms       0.015us        152543  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.091ms         0.00%       2.091ms       6.788us           308  
                                               aten::lt         0.01%      20.069ms         0.01%      22.980ms      31.917us       1.944ms         0.00%       1.944ms       2.699us           720  
                                             _LayerNorm         0.00%       6.408ms         0.01%      11.276ms     140.954us       1.923ms         0.00%       1.923ms      24.032us            80  
      autograd::engine::evaluate_function: MulBackward0         0.01%      13.672ms         0.04%      65.680ms     381.862us       0.000us         0.00%       1.859ms      10.806us           172  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.816ms         0.00%       1.816ms      17.292us           105  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.775ms         0.00%       1.775ms       7.304us           243  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us       1.755ms         0.00%       1.755ms       7.222us           243  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      34.008ms         1.91%        3.357s     335.685ms       0.000us         0.00%       1.735ms     173.488us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.38%     675.883ms         1.89%        3.323s     332.285ms       0.000us         0.00%       1.735ms     173.488us            10  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.827ms         0.01%       8.895ms      55.592us       0.000us         0.00%       1.727ms      10.791us           160  
                                           DivBackward0         0.00%       1.269ms         0.00%       7.068ms      44.173us       0.000us         0.00%       1.727ms      10.791us           160  
                               aten::cross_entropy_loss         0.00%       1.698ms         0.01%      20.226ms      84.275us       0.000us         0.00%       1.692ms       7.050us           240  
                                        SelectBackward0         0.00%     251.757us         0.00%       3.039ms      37.985us       0.000us         0.00%       1.691ms      21.138us            80  
                                  aten::select_backward         0.00%     481.510us         0.00%       2.787ms      34.838us       0.000us         0.00%       1.691ms      21.138us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.612ms         0.00%       1.612ms       8.714us           185  
                                   hipFuncGetAttributes         0.16%     284.481ms         0.16%     284.481ms       2.155ms       1.533ms         0.00%       1.533ms      11.612us           132  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.432ms         0.00%       1.432ms       8.952us           160  
                                         _SplitAlongDim         0.09%     155.792ms         0.13%     225.216ms      39.100us       0.000us         0.00%       1.402ms       0.243us          5760  
                                 c10d::_allgather_base_         0.00%     294.462us         0.00%       1.678ms     119.891us       0.000us         0.00%       1.381ms      98.630us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       1.381ms         0.00%       1.381ms     115.068us            12  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.372ms         0.00%       1.372ms       5.645us           243  
                                           aten::__or__         0.00%       1.614ms         0.01%      24.309ms      50.643us       0.000us         0.00%       1.344ms       2.800us           480  
                                       aten::bitwise_or         0.01%       9.459ms         0.01%      22.695ms      47.280us       1.344ms         0.00%       1.344ms       2.800us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.344ms         0.00%       1.344ms       6.400us           210  
                                           MulBackward0         0.01%      10.249ms         0.02%      39.006ms     226.781us       0.000us         0.00%       1.335ms       7.762us           172  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.673ms         0.01%       9.639ms     120.489us       0.000us         0.00%       1.325ms      16.564us            80  
                                       NllLossBackward0         0.00%       1.002ms         0.00%       7.966ms      99.579us       0.000us         0.00%       1.325ms      16.564us            80  
                                aten::nll_loss_backward         0.00%       2.865ms         0.00%       6.964ms      87.050us     702.464us         0.00%       1.325ms      16.564us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.297ms         0.00%       1.297ms      16.213us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.281ms         0.00%       1.281ms       6.099us           210  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.252ms         0.00%       1.252ms       5.962us           210  
                                               aten::ge         0.00%       7.387ms         0.00%       8.490ms      17.687us       1.132ms         0.00%       1.132ms       2.359us           480  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.105ms         0.00%       1.105ms       4.606us           240  
                                               aten::gt         0.02%      37.694ms         0.03%      46.850ms      10.793us       1.057ms         0.00%       1.062ms       0.245us          4341  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.054ms         0.00%       1.054ms       4.357us           242  
                                  hipDeviceGetAttribute         0.00%     257.987us         0.00%     257.987us       3.851us       1.013ms         0.00%       1.013ms      15.119us            67  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     955.957us         0.00%     955.957us      11.949us            80  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     954.595us         0.00%     954.595us      11.932us            80  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     900.885us         0.00%     900.885us       3.754us           240  
                                      aten::log_softmax         0.00%       1.260ms         0.00%       6.829ms      28.455us       0.000us         0.00%     880.229us       3.668us           240  
                                     aten::_log_softmax         0.00%       4.268ms         0.00%       5.406ms      22.526us     880.229us         0.00%     880.229us       3.668us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     880.229us         0.00%     880.229us       8.383us           105  
                                            aten::empty         0.54%     942.417ms         0.54%     948.465ms       3.612us       0.000us         0.00%     880.146us       0.003us        262555  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     852.643us         0.00%     852.643us       8.120us           105  
                                             aten::tanh         0.01%      15.811ms         0.02%      28.496ms     105.150us     812.466us         0.00%     812.466us       2.998us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     812.466us         0.00%     812.466us       7.738us           105  
                                      aten::nll_loss_nd         0.00%     884.635us         0.01%      11.696ms      48.733us       0.000us         0.00%     811.666us       3.382us           240  
                                         aten::nll_loss         0.00%     947.332us         0.01%      10.811ms      45.047us       0.000us         0.00%     811.666us       3.382us           240  
                                 aten::nll_loss_forward         0.00%       4.971ms         0.01%       9.864ms      41.099us     811.666us         0.00%     811.666us       3.382us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     811.666us         0.00%     811.666us       7.730us           105  
                            hipGetDevicePropertiesR0600         0.05%      96.327ms         0.05%      96.327ms       1.055us     807.209us         0.00%     807.209us       0.009us         91310  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     795.832us         0.00%     795.832us       9.948us            80  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     791.855us         0.00%     791.855us       7.541us           105  
                               TorchDynamo Cache Lookup         0.12%     212.873ms         0.12%     212.883ms      11.076us       0.000us         0.00%     775.505us       0.040us         19221  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     775.273us         0.00%     775.273us       3.230us           240  
                                             aten::item         0.02%      28.543ms         0.05%      89.597ms       5.333us       0.000us         0.00%     726.564us       0.043us         16799  
                              aten::_local_scalar_dense         0.01%      14.323ms         0.03%      61.054ms       3.634us     726.564us         0.00%     726.564us       0.043us         16799  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     717.895us         0.00%     717.895us       6.903us           104  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     702.464us         0.00%     702.464us       8.781us            80  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     674.229us         0.00%     674.229us       8.428us            80  
                                           aten::select         0.22%     386.355ms         0.27%     469.981ms       4.801us       0.000us         0.00%     663.768us       0.007us         97887  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     657.597us         0.00%     657.597us       8.220us            80  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     630.414us         0.00%     630.414us       2.627us           240  
                                              aten::log         0.00%       3.984ms         0.01%       8.805ms      36.687us     627.325us         0.00%     627.325us       2.614us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     627.325us         0.00%     627.325us       5.975us           105  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.474ms         0.02%      29.026ms     353.977us       0.000us         0.00%     602.109us       7.343us            82  
                                          TanhBackward0         0.00%       2.606ms         0.02%      27.552ms     336.005us       0.000us         0.00%     602.109us       7.343us            82  
                                    aten::tanh_backward         0.00%       3.749ms         0.01%      21.692ms     264.531us     602.109us         0.00%     602.109us       7.343us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     602.109us         0.00%     602.109us       7.526us            80  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     596.416us         0.00%     596.416us       7.455us            80  
                                       aten::empty_like         0.12%     204.450ms         0.33%     587.047ms       6.601us       0.000us         0.00%     570.153us       0.006us         88930  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     565.620us         0.00%     565.620us       5.387us           105  
                                             aten::rsub         0.00%       3.392ms         0.01%      10.228ms     118.928us       0.000us         0.00%     554.158us       6.444us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     554.158us         0.00%     554.158us       6.927us            80  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     552.388us         0.00%     552.388us       6.905us            80  
                                          aten::normal_         1.05%        1.841s         1.05%        1.844s      17.731ms     521.602us         0.00%     521.602us       5.015us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     521.602us         0.00%     521.602us       5.377us            97  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     508.122us         0.00%     508.122us       3.176us           160  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       6.280ms         0.01%      12.163ms      76.019us     507.109us         0.00%     507.109us       3.169us           160  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     770.195us         0.00%       5.008ms      62.594us       0.000us         0.00%     497.542us       6.219us            80  
                                    LogSoftmaxBackward0         0.00%       1.318ms         0.00%       4.237ms      52.967us       0.000us         0.00%     497.542us       6.219us            80  
                       aten::_log_softmax_backward_data         0.00%       1.668ms         0.00%       2.919ms      36.489us     497.542us         0.00%     497.542us       6.219us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     497.542us         0.00%     497.542us       6.219us            80  
                                        aten::ones_like         0.00%     659.035us         0.00%       2.561ms      32.010us       0.000us         0.00%     492.498us       6.156us            80  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     394.667us         0.00%     394.667us       4.199us            94  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     307.668us         0.00%     307.668us       3.846us            80  
                                              hipMemcpy         0.01%      13.227ms         0.01%      13.227ms     275.559us     221.450us         0.00%     221.450us       4.614us            48  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     197.017us         0.00%     197.017us       3.397us            58  
                                    hipFuncSetAttribute         0.00%       9.584us         0.00%       9.584us       0.399us     161.783us         0.00%     161.783us       6.741us            24  
                                             aten::rand         0.00%       2.823ms         0.00%       7.669ms     547.766us       0.000us         0.00%     148.142us      10.582us            14  
                                         aten::uniform_         0.01%      15.265ms         0.01%      18.284ms       1.406ms     148.142us         0.00%     148.142us      11.396us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     148.142us         0.00%     148.142us      29.628us             5  
                                          aten::maximum         0.00%     128.942us         0.01%      23.039ms       2.560ms      96.903us         0.00%      96.903us      10.767us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      96.903us         0.00%      96.903us      10.767us             9  
                                                hipFree         0.06%     106.371ms         0.06%     106.405ms       5.911ms      10.625us         0.00%      95.380us       5.299us            18  
                                          hipHostMalloc         0.07%     129.319ms         0.07%     129.336ms       3.919ms      58.565us         0.00%      75.203us       2.279us            33  
                                       aten::reciprocal         0.00%     150.578us         0.01%       8.807ms     880.688us      69.521us         0.00%      69.521us       6.952us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      69.521us         0.00%      69.521us       6.952us            10  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      17.132ms         1.26%        2.214s     221.354ms       0.000us         0.00%      64.690us       6.469us            10  
                        compile_fx_inner (dynamo_timed)         0.05%      85.063ms         1.46%        2.569s     233.577ms       0.000us         0.00%      64.690us       5.881us            11  
                                   hipDeviceSynchronize         0.00%     574.865us         0.00%     574.865us      16.908us      56.930us         0.00%      56.930us       1.674us            34  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      51.240us         0.00%      51.240us       5.124us            10  
                                            aten::slice         0.06%     100.221ms         0.07%     119.233ms       4.565us       0.000us         0.00%      49.905us       0.002us         26118  
                                       aten::lift_fresh         0.03%      57.469ms         0.04%      64.137ms      36.318us       0.000us         0.00%      46.306us       0.026us          1766  
                                                aten::t         0.00%       5.862ms         0.01%      14.036ms       6.252us       0.000us         0.00%      43.660us       0.019us          2245  
                                        aten::transpose         0.16%     287.516ms         0.20%     354.986ms       3.726us       0.000us         0.00%      43.660us       0.000us         95285  
         GraphLowering.compile_to_module (dynamo_timed)         0.71%        1.245s         1.26%        2.211s     201.034ms       0.000us         0.00%      41.276us       3.752us            11  
                                    hipFuncGetAttribute         0.00%       8.189us         0.00%       8.189us       0.682us      35.342us         0.00%      35.342us       2.945us            12  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      26.862us         0.00%      26.862us       2.686us            10  
                                              aten::min         0.00%     129.237us         0.00%       5.652ms       1.130ms      15.034us         0.00%      15.034us       3.007us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      15.034us         0.00%      15.034us       5.011us             3  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      12.870us         0.00%      12.870us       4.290us             3  
                                     hipExtLaunchKernel         0.06%     106.601ms         0.06%     106.623ms      10.860us       0.000us         0.00%      11.186us       0.001us          9818  
                               hipExtModuleLaunchKernel         0.17%     293.785ms         0.17%     293.803ms       7.473us       0.000us         0.00%       8.098us       0.000us         39315  
                            hipGetDevicePropertiesR0000         0.00%      52.726us         0.00%      52.726us       5.273us       5.934us         0.00%       5.934us       0.593us            10  
                              hipDevicePrimaryCtxRetain         0.00%       3.339us         0.00%       3.339us       0.477us       3.247us         0.00%       3.247us       0.464us             7  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.606us         0.00%       2.606us       2.606us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       2.084us         0.00%       2.084us       2.084us             1  
                        hipDeviceGetStreamPriorityRange         0.00%       2.305us         0.00%       2.305us       2.305us       0.000us         0.00%       0.000us       0.000us             1  
                                              hipMalloc         0.01%      16.456ms         0.01%      16.456ms     100.343us       0.000us         0.00%       0.000us       0.000us           164  
                            hipStreamCreateWithPriority         0.00%     545.102us         0.00%     545.102us      90.850us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.122s      66.606us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      13.877ms         0.01%      13.877ms       1.413us       0.000us         0.00%       0.000us       0.000us          9820  
                                    aten::empty_strided         0.21%     360.912ms         0.21%     368.259ms       4.154us       0.000us         0.00%       0.000us       0.000us         88647  
                                           aten::detach         0.04%      76.711ms         0.13%     227.465ms       6.412us       0.000us         0.00%       0.000us       0.000us         35476  
                                                 detach         0.07%     117.587ms         0.08%     143.218ms       4.234us       0.000us         0.00%       0.000us       0.000us         33825  
                            prims::convert_element_type         0.01%      11.456ms         0.01%      20.470ms     165.085us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.04%      73.934ms         0.06%      98.458ms       2.718us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     328.087us         0.00%     433.276us      54.159us       0.000us         0.00%       0.000us       0.000us             8  
                                       aten::as_strided         0.15%     262.578ms         0.15%     262.886ms       0.781us       0.000us         0.00%       0.000us       0.000us        336543  
                                             prims::add         0.00%       1.411ms         0.00%       2.005ms     105.545us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     604.804us         0.00%       1.236ms      29.434us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%       1.080ms         0.00%       1.446ms     103.306us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     146.187us         0.00%     198.960us      99.480us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       4.674ms         0.01%       9.571ms     251.860us       0.000us         0.00%       0.000us       0.000us            38  
                                             aten::view         0.19%     341.313ms         0.20%     349.507ms       2.417us       0.000us         0.00%       0.000us       0.000us        144633  
                                         prims::view_of         0.00%     698.254us         0.00%     889.581us      37.066us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       6.716ms         0.00%       6.856ms       7.150us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       7.933ms         0.01%       9.123ms      11.304us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%       1.189ms         0.00%       1.189ms       1.474us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     445.486us         0.00%     445.486us      14.371us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     140.598us         0.00%     140.598us      12.782us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      13.219ms         0.02%      28.776ms     112.405us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     737.439us         0.00%     737.439us       2.881us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     255.253us         0.00%     346.630us     115.543us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     146.744us         0.00%     146.744us      73.372us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     172.381us         0.00%     184.895us      92.448us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      37.874us         0.00%      37.874us       2.705us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.591ms         0.00%       3.111ms     622.144us       0.000us         0.00%       0.000us       0.000us             5  
                                        aten::index_add         0.00%     334.542us         0.00%       1.860ms       1.860ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     639.818us         0.00%     720.671us     360.336us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     324.421us         0.00%     324.421us     324.421us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.12%     216.032ms         0.12%     219.065ms      19.915ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.10%     181.943ms         0.10%     181.979ms      16.544ms       0.000us         0.00%       0.000us       0.000us            11  
                       Scheduler.codegen (dynamo_timed)         0.08%     146.197ms         0.08%     146.248ms      13.295ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.01%      10.105ms         0.01%      10.105ms     918.655us       0.000us         0.00%       0.000us       0.000us            11  
                                    hipModuleLoadDataEx         0.36%     640.704ms         0.36%     640.704ms      49.285ms       0.000us         0.00%       0.000us       0.000us            13  
                                 hipPointerGetAttribute         0.03%      56.332ms         0.03%      56.332ms       0.903us       0.000us         0.00%       0.000us       0.000us         62392  
                                        aten::expand_as         0.00%       1.220ms         0.00%       4.176ms       7.691us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       1.948ms         0.00%       6.966ms     633.297us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     166.859us         0.00%     186.286us      93.143us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     181.424us         0.00%     181.424us      90.712us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      97.286us         0.00%     121.741us     121.741us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     398.436us         0.00%       3.728ms       1.243ms       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     291.437us         0.00%     326.680us     108.893us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.480ms         0.00%       4.922ms     820.337us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%       1.068ms         0.00%       5.313ms     590.305us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.524ms         0.00%       3.517ms     586.243us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     425.312us         0.00%       1.167ms     389.132us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     284.622us         0.00%       1.453ms     484.385us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     592.020us         0.00%       1.169ms     389.511us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     429.634us         0.00%     451.219us     112.805us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.07%     120.073ms         0.07%     120.362ms       3.473us       0.000us         0.00%       0.000us       0.000us         34655  
                                               aten::eq         0.02%      42.738ms         0.02%      42.742ms       7.298us       0.000us         0.00%       0.000us       0.000us          5857  
                                              aten::all         0.05%      83.784ms         0.05%      94.765ms      16.180us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       4.071ms         0.00%       4.071ms       0.166us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     913.419us      65.244us       0.000us         0.00%       0.000us       0.000us            14  
                                          aten::reshape         0.07%     118.707ms         0.12%     211.220ms       4.889us       0.000us         0.00%       0.000us       0.000us         43206  
                                         nccl:broadcast         0.00%       0.000us             0      68.577ms     142.571us       0.000us         0.00%       0.000us       0.000us           481  
                                       aten::is_nonzero         0.00%       8.414ms         0.01%      18.966ms       4.648us       0.000us         0.00%       0.000us       0.000us          4080  
                                           aten::narrow         0.01%       8.805ms         0.02%      29.808ms      11.291us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.02%      32.921ms         0.02%      40.167ms       5.457us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.475ms         0.00%       3.134ms       4.353us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      38.128ms         0.03%      45.531ms       5.691us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       1.963us         0.00%       1.963us       0.280us       0.000us         0.00%       0.000us       0.000us             7  
                             hipDevicePrimaryCtxRelease         0.00%       1.578us         0.00%       1.578us       0.225us       0.000us         0.00%       0.000us       0.000us             7  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      54.142ms         0.03%      54.142ms       2.985us       0.000us         0.00%       0.000us       0.000us         18140  
                                              hipMemset         0.00%      25.993us         0.00%      25.993us      12.996us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.29%     506.064ms         0.29%     506.064ms     168.688ms       0.000us         0.00%       0.000us       0.000us             3  
                                 aten::split_with_sizes         0.03%      53.149ms         0.04%      69.407ms      12.050us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      34.469ms         0.02%      34.469ms       2.244us       0.000us         0.00%       0.000us       0.000us         15360  
                                          aten::squeeze         0.04%      77.890ms         0.05%      92.791ms       4.027us       0.000us         0.00%       0.000us       0.000us         23040  
                                      hipModuleLoadData         0.31%     541.987ms         0.31%     541.987ms     135.497ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     757.710us         0.00%       1.740ms     435.078us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       7.292ms         0.00%       8.665ms      36.106us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     880.320us         0.00%     880.320us       2.751us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.03%      44.759ms         0.07%     130.445ms       8.319us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      21.080ms         0.05%      85.686ms       5.465us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     479.978us         0.00%       3.338ms      41.725us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%       1.413ms         0.00%       2.858ms      35.725us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.04%      62.017ms         0.08%     147.662ms       6.939us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      22.080ms         0.05%      85.645ms       4.025us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.03%      44.353ms         0.06%      99.838ms       4.132us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.074ms         0.00%       2.890ms      12.041us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     403.798us         0.00%       1.816ms       7.568us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     337.443us         0.00%       1.037ms      12.965us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     699.793us         0.00%     699.793us       8.747us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%       1.018ms         0.21%     373.958ms     373.958ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      21.198ms         0.01%      23.976ms       3.121us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.777ms         0.00%       2.777ms       0.362us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       5.815ms         0.01%      21.561ms      10.780us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       4.337ms         0.01%      15.746ms       7.873us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       5.257ms         0.01%      14.457ms       7.530us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       2.389ms         0.01%       9.201ms       4.792us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     386.895us         0.00%     386.895us       0.202us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.135ms         0.00%       3.273ms      40.911us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       2.138ms         0.00%       2.138ms      26.726us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.487ms         0.00%       2.402ms      30.025us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.178ms     217.777us       0.000us         0.00%       0.000us       0.000us            10  
                                           aten::unbind         0.00%      17.228us         0.00%      35.621us       8.905us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 175.863s
Self CUDA time total: 158.689s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                             bert_train         0.00%       0.000us         0.00%       0.000us       0.000us       81.618s        51.71%       81.618s       81.618s             1  
                                             bert_train        36.66%       63.897s        71.12%      123.970s      123.970s       0.000us         0.00%       38.671s       38.671s             1  
                                            aten::copy_        13.48%       23.493s        15.86%       27.646s     350.591us       16.449s        10.42%       16.478s     208.970us         78855  
                                               aten::to         0.04%      70.619ms        15.84%       27.611s     525.229us       0.000us         0.00%       11.939s     227.117us         52569  
                                         aten::_to_copy         0.12%     206.302ms        15.80%       27.540s     634.784us       0.000us         0.00%       11.939s     275.180us         43385  
                                      aten::masked_fill         0.05%      82.072ms         0.28%     492.261ms      51.277us       0.000us         0.00%       11.796s       1.229ms          9600  
                                     record_param_comms         3.32%        5.785s         4.76%        8.303s     239.196us        7.912s         5.01%       11.562s     333.056us         34714  
                                     aten::masked_fill_         0.12%     208.310ms         0.27%     467.966ms      28.535us       11.154s         7.07%       11.154s     680.127us         16400  
                                       c10d::allreduce_         0.27%     471.769ms         2.66%        4.640s     275.991us       0.000us         0.00%        8.311s     494.391us         16811  
autograd::engine::evaluate_function: MaskedFillBackw...         0.01%      19.252ms         0.12%     201.958ms      52.593us       0.000us         0.00%        7.909s       2.060ms          3840  
                                    MaskedFillBackward0         0.00%       7.804ms         0.10%     182.706ms      47.580us       0.000us         0.00%        7.909s       2.060ms          3840  
ncclDevKernel_Generic(ncclDevComm*, channelMasks, nc...         0.00%       0.000us         0.00%       0.000us       0.000us        7.883s         4.99%        7.883s     834.225us          9449  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        7.768s         4.92%        7.768s     814.403us          9538  
                                              aten::bmm         0.29%     508.273ms         0.35%     604.408ms      44.971us        7.160s         4.54%        7.161s     532.846us         13440  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.634s         4.20%        6.634s       1.502ms          4417  
autograd::engine::evaluate_function: SoftmaxBackward...         0.00%       8.696ms         0.04%      76.301ms      39.740us       0.000us         0.00%        6.488s       3.379ms          1920  
                                       SoftmaxBackward0         0.00%       7.379ms         0.04%      67.605ms      35.211us       0.000us         0.00%        6.488s       3.379ms          1920  
                           aten::_softmax_backward_data         0.01%      20.776ms         0.03%      60.226ms      31.368us        3.350s         2.12%        6.488s       3.379ms          1920  
autograd::engine::evaluate_function: _LayerNormLinea...         0.06%      97.218ms         2.80%        4.886s       1.272ms       0.000us         0.00%        6.348s       1.653ms          3840  
                               _LayerNormLinearBackward         1.80%        3.143s         2.71%        4.727s       1.231ms     441.303ms         0.28%        6.205s       1.616ms          3840  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        6.100s         3.87%        6.100s     749.254us          8142  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        5.704s         3.61%        5.704s       1.243ms          4587  
autograd::engine::evaluate_function: ToCopyBackward0...         0.01%      15.193ms         0.06%      96.609ms      24.645us       0.000us         0.00%        5.086s       1.297ms          3920  
                                        ToCopyBackward0         0.00%       6.939ms         0.05%      81.416ms      20.769us       0.000us         0.00%        5.086s       1.297ms          3920  
                                            aten::clone         0.08%     133.423ms         0.49%     855.875ms      24.775us       0.000us         0.00%        4.536s     131.314us         34546  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        4.518s         2.86%        4.518s     981.708us          4602  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us        4.440s         2.81%        4.440s     558.630us          7948  
                                     tex_ts::te_gemm_ts         1.46%        2.548s         2.12%        3.692s      96.150us        4.290s         2.72%        4.294s     111.811us         38400  
                                          aten::softmax         0.01%      14.567ms         0.09%     158.067ms      27.442us       0.000us         0.00%        4.256s     738.916us          5760  
                                         aten::_softmax         0.05%      93.514ms         0.08%     143.500ms      24.913us        4.256s         2.70%        4.256s     738.916us          5760  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        4.256s         2.70%        4.256s       1.704ms          2497  
Cijk_Ailk_Bljk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        3.829s         2.43%        3.829s     866.832us          4417  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us        3.717s         2.35%        3.717s     322.614us         11520  
                                                _Linear         1.07%        1.861s         1.75%        3.052s     794.763us     134.457ms         0.09%        3.360s     874.926us          3840  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us        3.350s         2.12%        3.350s       1.745ms          1920  
                                              aten::mul         0.10%     166.046ms         0.14%     237.766ms      29.829us        3.171s         2.01%        3.171s     397.810us          7971  
autograd::engine::evaluate_function: BaddbmmBackward...         0.01%      18.890ms         0.12%     216.610ms     112.818us       0.000us         0.00%        3.159s       1.645ms          1920  
                                       BaddbmmBackward0         0.01%      20.018ms         0.11%     197.720ms     102.979us       0.000us         0.00%        3.159s       1.645ms          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        3.140s         1.99%        3.140s       1.432ms          2193  
                                          c10d::barrier         0.00%       1.066ms         1.36%        2.365s      62.231ms       0.000us         0.00%        2.129s      56.013ms            38  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.853s         1.17%        1.853s     409.820us          4521  
      autograd::engine::evaluate_function: BmmBackward0         0.01%      22.305ms         0.12%     211.371ms     110.089us       0.000us         0.00%        1.785s     929.842us          1920  
                                           BmmBackward0         0.01%      13.963ms         0.11%     189.066ms      98.472us       0.000us         0.00%        1.785s     929.842us          1920  
                                       aten::logical_or         0.08%     133.332ms         0.23%     400.630ms      34.777us     873.519ms         0.55%        1.750s     151.880us         11520  
autograd::engine::evaluate_function: _LinearBackward...         0.02%      42.024ms         1.59%        2.772s     721.917us       0.000us         0.00%        1.709s     444.928us          3840  
                                        _LinearBackward         1.22%        2.127s         1.57%        2.730s     710.974us     193.716ms         0.12%        1.709s     444.928us          3840  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.545s         0.98%        1.545s     804.928us          1920  
                                              aten::sub         0.07%     121.647ms         0.09%     155.709ms      23.700us        1.514s         0.96%        1.514s     230.401us          6570  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.512s         0.96%        1.512s     605.329us          2497  
                                          aten::dropout         0.01%      12.750ms         0.08%     133.883ms      22.258us       0.000us         0.00%        1.499s     249.172us          6015  
                                   aten::native_dropout         0.03%      48.356ms         0.07%     116.119ms      57.800us        1.497s         0.95%        1.499s     745.992us          2009  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us        1.497s         0.95%        1.497s     748.692us          2000  
autograd::engine::evaluate_function: NativeDropoutBa...         0.01%      12.357ms         0.04%      74.888ms      37.388us       0.000us         0.00%        1.385s     691.577us          2003  
                                 NativeDropoutBackward0         0.00%       7.195ms         0.04%      62.531ms      31.219us       0.000us         0.00%        1.385s     691.577us          2003  
                          aten::native_dropout_backward         0.01%      20.537ms         0.03%      55.336ms      27.627us        1.385s         0.88%        1.385s     691.577us          2003  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us        1.385s         0.88%        1.385s     692.614us          2000  
                                                triton_         0.00%       0.000us         0.00%       0.000us       0.000us        1.362s         0.86%        1.362s      79.632us         17109  
                                   hipStreamIsCapturing         0.03%      58.453ms         0.03%      58.453ms       1.166us        1.205s         0.76%        1.205s      24.043us         50121  
                                          aten::baddbmm         0.24%     420.607ms         0.51%     890.041ms     154.521us        1.155s         0.73%        1.155s     200.551us          5760  
Cijk_Ailk_Bjlk_HHS_BH_MT256x256x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us        1.125s         0.71%        1.125s     585.828us          1920  
                                       c10d::broadcast_         0.02%      37.759ms         0.47%     811.674ms       1.687ms       0.000us         0.00%        1.018s       2.117ms           481  
autograd::engine::evaluate_function: CompiledFunctio...         0.01%      25.552ms         0.62%        1.082s     281.857us       0.000us         0.00%     985.095ms     256.535us          3840  
                               CompiledFunctionBackward         0.30%     521.520ms         0.61%        1.057s     275.202us       0.000us         0.00%     985.095ms     256.535us          3840  
                     hipThreadExchangeStreamCaptureMode         0.00%       2.605ms         0.00%       2.605ms       0.184us     895.878ms         0.57%     895.878ms      63.268us         14160  
                                 triton_red_fused_sum_1         0.02%      38.048ms         0.04%      61.550ms      16.029us     886.060ms         0.56%     886.060ms     230.745us          3840  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     873.519ms         0.55%     873.519ms     349.828us          2497  
                                   hipDeviceGetPCIBusId         0.01%      17.164ms         0.01%      17.164ms       0.880us     680.511ms         0.43%     680.511ms      34.871us         19515  
                               hipStreamCreateWithFlags         0.24%     415.076ms         0.24%     415.076ms     156.396us     675.968ms         0.43%     675.968ms     254.698us          2654  
                                      aten::logical_not         0.10%     173.933ms         0.29%     513.261ms      22.277us     308.372ms         0.20%     616.852ms      26.773us         23040  
                                         hipMemsetAsync         0.07%     120.775ms         0.07%     120.794ms      10.289us     465.149ms         0.29%     466.513ms      39.737us         11740  
                                      hipGetProcAddress         0.05%      82.319ms         0.05%      82.325ms       1.065us     465.075ms         0.29%     465.075ms       6.016us         77309  
                                        hipEventDestroy         0.03%      53.513ms         0.03%      53.944ms       2.730us     441.549ms         0.28%     442.614ms      22.403us         19757  
                                  Torch-Compiled Region         0.61%        1.061s         1.80%        3.144s     163.600us       0.000us         0.00%     410.247ms      21.345us         19220  
                                       _LayerNormLinear         0.43%     753.480ms         1.20%        2.087s     543.613us     244.977ms         0.16%     379.770ms      98.899us          3840  
                                       hipCtxGetCurrent         0.01%      12.474ms         0.01%      12.474ms       0.212us     368.364ms         0.23%     368.364ms       6.273us         58722  
                                             aten::add_         0.10%     171.104ms         0.18%     311.925ms       9.928us     322.014ms         0.20%     322.014ms      10.249us         31420  
                                       CompiledFunction         0.72%        1.248s         1.04%        1.816s     157.394us       0.000us         0.00%     310.323ms      26.891us         11540  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     308.372ms         0.20%     308.372ms      61.748us          4994  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     282.744ms         0.18%     282.744ms      56.617us          4994  
                                              aten::sum         0.25%     428.963ms         0.52%     905.569ms      44.493us     208.041ms         0.13%     274.350ms      13.480us         20353  
Cijk_Alik_Bljk_F8B8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_...         0.00%       0.000us         0.00%       0.000us       0.000us     255.787ms         0.16%     255.787ms      66.611us          3840  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     252.381ms         0.16%     252.381ms      43.816us          5760  
                  triton_poi_fused_add_native_dropout_0         0.06%      99.235ms         0.08%     147.584ms      38.334us     243.907ms         0.15%     243.942ms      63.362us          3850  
                                   hipStreamSynchronize         0.37%     653.035ms         0.37%     653.078ms     204.791us     183.849ms         0.12%     183.884ms      57.662us          3189  
autograd::engine::evaluate_function: torch::autograd...         0.20%     341.260ms         0.39%     673.727ms      27.886us       0.000us         0.00%     177.976ms       7.367us         24160  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us     176.323ms         0.11%     176.323ms       7.371us         23920  
                                       hipStreamDestroy         0.04%      65.606ms         0.04%      65.606ms      24.907us     169.708ms         0.11%     169.708ms      64.430us          2634  
autograd::engine::evaluate_function: GeLUFunctionBac...         0.02%      28.274ms         0.44%     769.035ms     400.539us       0.000us         0.00%     154.740ms      80.594us          1920  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us     154.025ms         0.10%     154.025ms      30.848us          4993  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     153.241ms         0.10%     153.241ms      34.436us          4450  
cast_transpose_optimized_kernel(__half const*, float...         0.00%       0.000us         0.00%       0.000us       0.000us     152.512ms         0.10%     152.512ms      29.957us          5091  
                                         nccl:broadcast         0.00%       0.000us         0.00%       0.000us       0.000us     143.546ms         0.09%     143.546ms     680.313us           211  
void transformer_engine::layer_norm::ln_bwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us     135.577ms         0.09%     135.577ms      34.586us          3920  
                                         hipMemcpyAsync         0.13%     227.958ms         0.13%     227.958ms      18.907us     134.615ms         0.09%     134.615ms      11.165us         12057  
                             _VocabParallelCrossEntropy         0.05%      86.072ms         0.18%     314.516ms       1.310ms       0.000us         0.00%     132.100ms     550.416us           240  
                                              aten::cat         0.10%     175.593ms         0.13%     227.707ms      28.182us     131.685ms         0.08%     131.685ms      16.298us          8080  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.00%       6.361ms        22.00%       38.344s     159.768ms       0.000us         0.00%     123.879ms     516.162us           240  
                                     EmbeddingBackward0         0.00%       3.000ms        21.99%       38.336s     159.734ms       0.000us         0.00%     122.922ms     512.175us           240  
                               aten::embedding_backward         0.00%       2.420ms        21.99%       38.333s     159.722ms       0.000us         0.00%     122.922ms     512.175us           240  
                         aten::embedding_dense_backward         1.14%        1.991s        21.99%       38.331s     159.712ms     117.120ms         0.07%     122.922ms     512.175us           240  
autograd::engine::evaluate_function: LinearWithGradA...         0.00%       1.781ms         0.07%     122.601ms       1.533ms       0.000us         0.00%     121.905ms       1.524ms            80  
LinearWithGradAccumulationAndAsyncCommunicationBackw...         0.01%      21.478ms         0.07%     120.820ms       1.510ms       0.000us         0.00%     121.905ms       1.524ms            80  
autograd::engine::evaluate_function: _SplitAlongDimB...         0.01%      17.990ms         0.14%     247.302ms     128.803us       0.000us         0.00%     113.997ms      59.373us          1920  
                                 _SplitAlongDimBackward         0.10%     173.852ms         0.13%     229.312ms     119.433us       0.000us         0.00%     113.997ms      59.373us          1920  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     113.997ms         0.07%     113.997ms      59.373us          1920  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     109.893ms         0.07%     109.893ms      50.876us          2160  
                                  hipExtMallocWithFlags         0.03%      50.867ms         0.03%      50.867ms      12.025us     105.162ms         0.07%     105.162ms      24.861us          4230  
                             c10d::allreduce_coalesced_         0.00%       1.923ms         0.05%      85.789ms       8.579ms       0.000us         0.00%     104.734ms      10.473ms            10  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     104.399ms         0.07%     104.399ms      10.345us         10092  
                                     hipStreamWaitEvent         0.18%     320.542ms         0.18%     320.640ms      15.707us     103.286ms         0.07%     103.286ms       5.060us         20414  
                                       aten::contiguous         0.02%      31.969ms         0.34%     587.515ms      25.500us       0.000us         0.00%     101.769ms       4.417us         23040  
                                               aten::mm         0.03%      55.437ms         0.06%     109.712ms     124.672us     100.277ms         0.06%     100.277ms     113.952us           880  
             triton_poi_fused_native_dropout_backward_0         0.04%      69.016ms         0.06%     101.984ms      26.558us      99.035ms         0.06%      99.035ms      25.790us          3840  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      89.083ms         0.06%      89.083ms      35.690us          2496  
          create_aot_dispatcher_function (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us      85.878ms         0.05%      85.878ms      85.878ms             1  
                         _ReduceFromModelParallelRegion         0.02%      26.446ms         0.04%      72.653ms     302.720us       0.000us         0.00%      84.700ms     352.917us           240  
                                           aten::matmul         0.00%       3.281ms         0.05%      83.689ms     209.223us       0.000us         0.00%      83.360ms     208.399us           400  
                                 hipDeviceCanAccessPeer         0.00%     476.961us         0.00%     476.961us       0.244us      78.549ms         0.05%      78.549ms      40.240us          1952  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      77.619ms         0.05%      77.619ms       6.614us         11735  
void transformer_engine::(anonymous namespace)::redu...         0.00%       0.000us         0.00%       0.000us       0.000us      76.938ms         0.05%      76.938ms      40.072us          1920  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      74.884ms         0.05%      74.884ms       9.997us          7491  
Cijk_Alik_Bljk_F8HS_BH_BiasSH_AS_SAB_SAV_UserArgs_MT...         0.00%       0.000us         0.00%       0.000us       0.000us      74.147ms         0.05%      74.147ms      29.694us          2497  
                                           aten::arange         0.09%     156.217ms         0.26%     448.652ms      18.208us      34.964ms         0.02%      73.678ms       2.990us         24640  
                       tex_ts::layernorm_fwd_fp8_inf_ts         0.23%     402.229ms         0.40%     695.469ms      90.556us      71.943ms         0.05%      71.943ms       9.368us          7680  
void transformer_engine::layer_norm::ln_bwd_finalize...         0.00%       0.000us         0.00%       0.000us       0.000us      68.442ms         0.04%      68.442ms      17.460us          3920  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      66.138ms         0.04%      66.138ms     275.575us           240  
                                     hipIpcGetMemHandle         0.01%      10.923ms         0.01%      10.923ms       6.317us      64.991ms         0.04%      64.991ms      37.589us          1729  
                           Memcpy HtoD (Host -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      63.426ms         0.04%      63.426ms      14.726us          4307  
                                    hipIpcOpenMemHandle         0.06%     105.541ms         0.06%     105.541ms      60.830us      55.354ms         0.04%      55.354ms      31.904us          1735  
                                           GeLUFunction         0.11%     196.957ms         0.65%        1.127s     195.701us       0.000us         0.00%      55.058ms       9.559us          5760  
                        triton_poi_fused_add_mul_tanh_0         0.08%     146.011ms         0.10%     171.602ms      29.740us      52.597ms         0.03%      53.126ms       9.207us          5770  
transpose_optimized_kernel(hip_f8<(hip_f8_type)1> co...         0.00%       0.000us         0.00%       0.000us       0.000us      53.051ms         0.03%      53.051ms      13.815us          3840  
                                  hipModuleLaunchKernel         0.14%     245.908ms         0.14%     245.935ms       7.288us      52.850ms         0.03%      52.850ms       1.566us         33745  
cast_transpose_fusion_kernel_optimized(transformer_e...         0.00%       0.000us         0.00%       0.000us       0.000us      50.196ms         0.03%      50.196ms      26.144us          1920  
        LinearWithGradAccumulationAndAsyncCommunication         0.01%       9.882ms         0.02%      30.831ms     128.465us       0.000us         0.00%      49.101ms     204.586us           240  
                                   GeLUFunctionBackward         0.03%      58.645ms         0.38%     655.893ms     341.611us       0.000us         0.00%      45.210ms      23.547us          1920  
                   triton_poi_fused_add_mul_rsub_tanh_0         0.02%      34.628ms         0.03%      52.570ms      27.380us      45.210ms         0.03%      45.210ms      23.547us          1920  
                                 triton_poi_fused_add_0         0.14%     243.811ms         0.15%     257.264ms      33.498us      35.619ms         0.02%      35.619ms       4.638us          7680  
                                    hipMemcpyWithStream        24.18%       42.148s        24.18%       42.151s      50.724ms       0.000us         0.00%      33.738ms      40.599us           831  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      33.698ms         0.02%      33.698ms       6.748us          4994  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us      32.283ms         0.02%      32.283ms       6.464us          4994  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      30.815ms         0.02%      30.815ms       8.025us          3840  
                                            aten::fill_         0.09%     149.588ms         0.10%     182.611ms       6.315us      28.943ms         0.02%      28.943ms       1.001us         28919  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      28.920ms         0.02%      28.920ms      11.582us          2497  
Cijk_Ailk_Bljk_HHS_BH_MT256x128x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      28.539ms         0.02%      28.539ms     178.371us           160  
autograd::engine::evaluate_function: _VocabParallelC...         0.00%       2.379ms         0.03%      50.789ms     634.859us       0.000us         0.00%      26.639ms     332.982us            80  
                                            aten::zero_         0.05%      83.701ms         0.15%     254.495ms      11.238us       0.000us         0.00%      25.397ms       1.121us         22646  
                                            aten::zeros         0.05%      88.968ms         0.22%     388.107ms      17.322us       0.000us         0.00%      23.946ms       1.069us         22406  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      23.724ms         0.02%      23.724ms     296.548us            80  
                                 tex_ts::cast_to_fp8_ts         0.09%     154.963ms         0.13%     231.454ms      30.137us      23.520ms         0.01%      23.530ms       3.064us          7680  
    autograd::engine::evaluate_function: AddmmBackward0         0.00%       4.067ms         0.03%      51.680ms     215.335us       0.000us         0.00%      23.530ms      98.041us           240  
_ZN18transformer_engine12unary_kernelILi16ELb1EfNS_6...         0.00%       0.000us         0.00%       0.000us       0.000us      23.520ms         0.01%      23.520ms      20.399us          1153  
                                          aten::randint         0.02%      42.799ms         0.09%     163.646ms      42.461us       0.000us         0.00%      23.365ms       6.063us          3854  
                                          aten::random_         0.04%      67.855ms         0.07%     117.624ms      30.552us      23.365ms         0.01%      23.365ms       6.069us          3850  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us      23.365ms         0.01%      23.365ms       6.069us          3850  
                                              aten::exp         0.00%       3.219ms         0.01%      22.207ms      92.530us      22.939ms         0.01%      22.939ms      95.577us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      22.939ms         0.01%      22.939ms     220.563us           104  
                                              aten::add         0.05%      85.757ms         0.07%     124.068ms      69.467us      21.310ms         0.01%      21.310ms      11.932us          1786  
                                             aten::div_         0.00%       6.633ms         0.01%      15.037ms      31.328us      20.467ms         0.01%      20.467ms      42.640us           480  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      19.796ms         0.01%      19.796ms     190.341us           104  
                                           aten::linear         0.00%       3.961ms         0.04%      64.424ms      89.478us       0.000us         0.00%      19.323ms      26.838us           720  
                                            aten::addmm         0.03%      46.618ms         0.03%      54.334ms      75.464us      19.323ms         0.01%      19.323ms      26.838us           720  
                                             aten::sub_         0.00%       5.154ms         0.00%       6.538ms      20.432us      18.758ms         0.01%      18.758ms      58.620us           320  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      18.231ms         0.01%      18.231ms     175.302us           104  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      17.688ms         0.01%      17.688ms       6.406us          2761  
mscclKernel_Sum_float_LL_false(ncclDevComm*, mscclAl...         0.00%       0.000us         0.00%       0.000us       0.000us      17.441ms         0.01%      17.441ms      83.853us           208  
                           Memcpy DtoH (Device -> Host)         0.00%       0.000us         0.00%       0.000us       0.000us      17.367ms         0.01%      17.367ms      25.615us           678  
                                         AddmmBackward0         0.00%       3.182ms         0.02%      39.390ms     164.126us       0.000us         0.00%      16.918ms      70.491us           240  
                     _VocabParallelCrossEntropyBackward         0.01%      18.673ms         0.03%      44.571ms     557.140us       0.000us         0.00%      16.612ms     207.649us            80  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      16.600ms         0.01%      16.600ms       6.648us          2497  
                                        aten::embedding         0.00%       7.295ms         0.02%      31.557ms      43.829us       0.000us         0.00%      16.325ms      22.674us           720  
                                     aten::index_select         0.01%      13.793ms         0.01%      21.543ms      29.920us      16.325ms         0.01%      16.325ms      22.674us           720  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      16.325ms         0.01%      16.325ms      51.826us           315  
                                           aten::cumsum         0.07%     129.036ms         0.09%     161.220ms      27.990us      16.077ms         0.01%      16.101ms       2.795us          5760  
void rocprim::detail::single_scan_kernel<false, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us      16.077ms         0.01%      16.077ms       6.439us          2497  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      15.887ms         0.01%      15.887ms       6.327us          2511  
                                            aten::index         0.01%      14.165ms         0.04%      71.967ms     126.926us       2.115ms         0.00%      13.909ms      24.531us           567  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      13.451ms         0.01%      13.451ms      84.066us           160  
                                             aten::mul_         0.00%       6.482ms         0.00%       7.276ms       5.684us      12.915ms         0.01%      12.915ms      10.089us          1280  
mscclKernel_MinMax_float_LL_false(ncclDevComm*, mscc...         0.00%       0.000us         0.00%       0.000us       0.000us      12.463ms         0.01%      12.463ms     119.833us           104  
Cijk_Alik_Bljk_HHS_BH_MT128x256x32_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us      11.980ms         0.01%      11.980ms     115.191us           104  
                                          aten::nonzero         0.00%       5.682ms         0.02%      38.344ms     156.505us      11.794ms         0.01%      11.794ms      48.137us           245  
                                  hipMemGetAddressRange         0.00%     179.987us         0.00%     179.987us       0.401us      11.721ms         0.01%      11.721ms      26.104us           449  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      11.404ms         0.01%      11.404ms     109.652us           104  
                                       aten::index_put_         0.00%       6.042ms         0.11%     196.159ms     175.142us       0.000us         0.00%       9.653ms       8.619us          1120  
                                 aten::_index_put_impl_         0.00%       8.305ms         0.11%     190.117ms     169.747us     758.379us         0.00%       9.653ms       8.619us          1120  
void at::native::(anonymous namespace)::krn_partial_...         0.00%       0.000us         0.00%       0.000us       0.000us       9.623ms         0.01%       9.623ms      40.094us           240  
void at::native::(anonymous namespace)::compute_grad...         0.00%       0.000us         0.00%       0.000us       0.000us       9.279ms         0.01%       9.279ms      38.664us           240  
                                              aten::max         0.00%       7.714ms         0.02%      37.466ms     147.504us       8.856ms         0.01%       8.915ms      35.100us           254  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.842ms         0.01%       8.842ms      85.021us           104  
autograd::engine::evaluate_function: FusedLayerNormA...         0.00%       2.605ms         0.01%      13.812ms     172.653us       0.000us         0.00%       8.572ms     107.155us            80  
                   FusedLayerNormAffineFunctionBackward         0.00%       4.731ms         0.01%      11.208ms     140.095us       8.572ms         0.01%       8.572ms     107.155us            80  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       8.515ms         0.01%       8.515ms      20.667us           412  
autograd::engine::evaluate_function: torch::autograd...         0.00%       2.064ms         0.02%      29.138ms     364.222us       0.000us         0.00%       8.352ms     104.402us            80  
                            torch::autograd::CopySlices         0.00%       4.210ms         0.02%      27.074ms     338.424us       0.000us         0.00%       8.352ms     104.402us            80  
                                        hipLaunchKernel         0.85%        1.484s         0.85%        1.484s       9.772us       5.419ms         0.00%       7.990ms       0.053us        151838  
                           FusedLayerNormAffineFunction         0.01%      13.329ms         0.01%      23.377ms      97.404us       7.695ms         0.00%       7.695ms      32.064us           240  
void cuApplyLayerNorm<c10::Half, float, c10::Half>(c...         0.00%       0.000us         0.00%       0.000us       0.000us       7.695ms         0.00%       7.695ms      73.993us           104  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.580ms         0.00%       7.580ms      11.049us           686  
       aten::_amp_foreach_non_finite_check_and_unscale_         0.00%     568.184us         0.00%       3.534ms     353.381us       6.778ms         0.00%       6.778ms     677.820us            10  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       6.778ms         0.00%       6.778ms      61.620us           110  
Cijk_Ailk_Bjlk_HHS_BH_MT128x128x64_MI16x16x16x1_SN_1...         0.00%       0.000us         0.00%       0.000us       0.000us       6.705ms         0.00%       6.705ms      83.806us            80  
void rocprim::detail::radix_sort_block_sort_kernel<r...         0.00%       0.000us         0.00%       0.000us       0.000us       6.296ms         0.00%       6.296ms      26.234us           240  
void rocprim::detail::device_block_merge_oddeven_ker...         0.00%       0.000us         0.00%       0.000us       0.000us       5.678ms         0.00%       5.678ms       5.914us           960  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.476ms         0.00%       5.476ms       6.064us           903  
transformer_engine::delayed_scaling_recipe::(anonymo...         0.00%       0.000us         0.00%       0.000us       0.000us       4.787ms         0.00%       4.787ms      29.918us           160  
                                        aten::index_put         0.00%       2.706ms         0.01%      13.807ms     166.349us       0.000us         0.00%       4.476ms      53.933us            83  
                                      IndexPutBackward0         0.00%       1.133ms         0.01%      12.131ms     151.638us       0.000us         0.00%       4.476ms      55.955us            80  
void cuComputePartGradGammaBeta<c10::Half, float, c1...         0.00%       0.000us         0.00%       0.000us       0.000us       4.134ms         0.00%       4.134ms      51.681us            80  
void cuComputeGradInput<c10::Half, float, c10::Half>...         0.00%       0.000us         0.00%       0.000us       0.000us       3.949ms         0.00%       3.949ms      49.368us            80  
autograd::engine::evaluate_function: _LayerNormBackw...         0.00%       1.059ms         0.01%      23.261ms     290.768us       0.000us         0.00%       3.726ms      46.578us            80  
                                     _LayerNormBackward         0.00%       5.906ms         0.01%      22.202ms     277.527us       3.726ms         0.00%       3.726ms      46.578us            80  
                                               aten::gt         0.02%      35.687ms         0.03%      44.936ms      10.351us       1.041ms         0.00%       3.653ms       0.842us          4341  
                                     hipExtLaunchKernel         0.07%     119.598ms         0.07%     119.649ms      12.249us       0.000us         0.00%       3.617ms       0.370us          9768  
     autograd::engine::evaluate_function: GeluBackward0         0.00%     843.232us         0.00%       3.469ms      43.359us       0.000us         0.00%       3.383ms      42.292us            80  
                                          GeluBackward0         0.00%     494.746us         0.00%       2.625ms      32.818us       0.000us         0.00%       3.383ms      42.292us            80  
                                    aten::gelu_backward         0.00%       1.375ms         0.00%       2.131ms      26.634us       3.383ms         0.00%       3.383ms      42.292us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.383ms         0.00%       3.383ms      42.292us            80  
autograd::engine::evaluate_function: SelectBackward0...         0.00%     736.197us         0.00%       4.836ms      60.451us       0.000us         0.00%       3.019ms      37.733us            80  
                                             aten::ones         0.00%       1.016ms         0.00%       6.337ms      13.202us       0.000us         0.00%       2.857ms       5.952us           480  
void (anonymous namespace)::elementwise_kernel_with_...         0.00%       0.000us         0.00%       0.000us       0.000us       2.681ms         0.00%       2.681ms       5.068us           529  
                                             aten::gelu         0.00%       4.420ms         0.01%      10.691ms      44.545us       2.638ms         0.00%       2.638ms      10.991us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.638ms         0.00%       2.638ms      25.364us           104  
void transformer_engine::layer_norm::ln_fwd_tuned_ke...         0.00%       0.000us         0.00%       0.000us       0.000us       2.486ms         0.00%       2.486ms      23.908us           104  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.289ms         0.00%       2.289ms       5.476us           418  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.268ms         0.00%       2.268ms       5.937us           382  
                            hipGetDevicePropertiesR0600         0.05%      93.750ms         0.05%      93.755ms       1.031us       2.133ms         0.00%       2.140ms       0.024us         90944  
                                              aten::div         0.01%      11.358ms         0.01%      14.844ms      22.356us       2.129ms         0.00%       2.129ms       3.207us           664  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.115ms         0.00%       2.115ms      11.312us           187  
    autograd::engine::evaluate_function: SliceBackward0         0.00%     623.196us         0.00%       8.216ms      51.353us       0.000us         0.00%       2.034ms      12.715us           160  
                                         SliceBackward0         0.00%     542.019us         0.00%       7.593ms      47.458us       0.000us         0.00%       2.034ms      12.715us           160  
                                   aten::slice_backward         0.00%       1.037ms         0.00%       7.051ms      44.070us       0.000us         0.00%       2.034ms      12.715us           160  
                                             _LayerNorm         0.00%       6.752ms         0.01%      11.844ms     148.051us       1.974ms         0.00%       1.974ms      24.675us            80  
         _compile.<locals>.compile_inner (dynamo_timed)         0.08%     146.058ms         2.05%        3.573s     357.309ms       0.000us         0.00%       1.966ms     196.645us            10  
          OutputGraph.call_user_compiler (dynamo_timed)         0.02%      33.631ms         1.94%        3.377s     337.672ms       0.000us         0.00%       1.917ms     191.715us            10  
          create_aot_dispatcher_function (dynamo_timed)         0.39%     676.957ms         1.92%        3.343s     334.309ms       0.000us         0.00%       1.917ms     191.715us            10  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.856ms         0.00%       1.856ms       7.732us           240  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us       1.835ms         0.00%       1.835ms       3.800us           483  
                                            aten::slice         0.06%     105.376ms         0.07%     125.280ms       4.797us       0.000us         0.00%       1.734ms       0.066us         26118  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.683ms         0.00%       1.683ms       5.465us           308  
Cijk_Alik_Bljk_HHS_BH_MT32x64x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.649ms         0.00%       1.649ms      15.852us           104  
                                               aten::lt         0.01%      20.375ms         0.01%      23.312ms      32.378us       1.631ms         0.00%       1.631ms       2.265us           720  
      autograd::engine::evaluate_function: MulBackward0         0.01%      14.165ms         0.04%      68.401ms     397.681us       0.000us         0.00%       1.489ms       8.659us           172  
                               hipExtModuleLaunchKernel         0.17%     298.380ms         0.17%     298.428ms       7.617us       0.000us         0.00%       1.361ms       0.035us         39177  
                               aten::cross_entropy_loss         0.00%       1.557ms         0.01%      21.641ms      90.172us       0.000us         0.00%       1.338ms       5.574us           240  
                                        SelectBackward0         0.00%     228.488us         0.00%       3.019ms      37.731us       0.000us         0.00%       1.327ms      16.582us            80  
                                  aten::select_backward         0.00%     448.229us         0.00%       2.790ms      34.875us       0.000us         0.00%       1.327ms      16.582us            80  
                                              hipMalloc         0.01%      17.123ms         0.01%      17.123ms     104.410us       1.300ms         0.00%       1.300ms       7.929us           164  
void rocprim::detail::lookback_scan_kernel<(rocprim:...         0.00%       0.000us         0.00%       0.000us       0.000us       1.280ms         0.00%       1.280ms       7.998us           160  
void rocprim::detail::partition_kernel<(rocprim::det...         0.00%       0.000us         0.00%       0.000us       0.000us       1.253ms         0.00%       1.253ms       5.155us           243  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.228ms         0.00%       1.228ms       5.877us           209  
                                           aten::__or__         0.00%       1.516ms         0.01%      23.544ms      49.051us       0.000us         0.00%       1.187ms       2.472us           480  
                                       aten::bitwise_or         0.01%       9.485ms         0.01%      22.025ms      45.885us       1.187ms         0.00%       1.187ms       2.472us           480  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.187ms         0.00%       1.187ms       5.678us           209  
                                 c10d::_allgather_base_         0.00%     284.766us         0.00%       1.726ms     123.276us       0.000us         0.00%       1.169ms      83.512us            14  
                                  nccl:_all_gather_base         0.00%       0.000us         0.00%       0.000us       0.000us       1.169ms         0.00%       1.169ms      97.431us            12  
                                               aten::ge         0.00%       7.323ms         0.00%       8.493ms      17.694us       1.157ms         0.00%       1.157ms       2.411us           480  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us       1.138ms         0.00%       1.138ms      14.226us            80  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.118ms         0.00%       1.118ms       6.074us           184  
                                  hipDeviceGetAttribute         0.00%     291.316us         0.00%     291.316us       4.348us       1.086ms         0.00%       1.086ms      16.206us            67  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us       1.063ms         0.00%       1.063ms       4.375us           243  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.039ms         0.00%       1.039ms       4.972us           209  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.039ms         0.00%       1.039ms       4.292us           242  
                                           MulBackward0         0.01%      10.862ms         0.02%      40.690ms     236.569us       0.000us         0.00%       1.011ms       5.876us           172  
      autograd::engine::evaluate_function: DivBackward0         0.00%       1.872ms         0.00%       8.572ms      53.578us       0.000us         0.00%       1.010ms       6.310us           160  
                                           DivBackward0         0.00%       1.311ms         0.00%       6.700ms      41.875us       0.000us         0.00%       1.010ms       6.310us           160  
autograd::engine::evaluate_function: NllLossBackward...         0.00%       1.717ms         0.01%       9.814ms     122.677us       0.000us         0.00%     996.612us      12.458us            80  
                                       NllLossBackward0         0.00%     991.800us         0.00%       8.097ms     101.216us       0.000us         0.00%     996.612us      12.458us            80  
                                aten::nll_loss_backward         0.00%       2.933ms         0.00%       7.105ms      88.819us     479.025us         0.00%     996.612us      12.458us            80  
void rocprim::detail::block_reduce_kernel<true, rocp...         0.00%       0.000us         0.00%       0.000us       0.000us     993.727us         0.00%     993.727us       4.089us           243  
                                                hipFree         0.06%     103.580ms         0.06%     103.645ms       5.758ms      47.469us         0.00%     918.153us      51.009us            18  
void at::native::(anonymous namespace)::krn_partials...         0.00%       0.000us         0.00%       0.000us       0.000us     858.422us         0.00%     858.422us       3.577us           240  
Cijk_Alik_Bljk_HHS_BH_MT16x16x128_MI16x16x16x1_SN_1L...         0.00%       0.000us         0.00%       0.000us       0.000us     848.273us         0.00%     848.273us       8.156us           104  
Cijk_Ailk_Bljk_HHS_BH_MT64x96x16_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     798.557us         0.00%     798.557us       9.982us            80  
void rocprim::detail::transform_kernel<rocprim::deta...         0.00%       0.000us         0.00%       0.000us       0.000us     772.244us         0.00%     772.244us       3.218us           240  
                                          aten::squeeze         0.05%      83.675ms         0.06%      99.836ms       4.333us       0.000us         0.00%     758.867us       0.033us         23040  
void at::native::index_elementwise_kernel<128, 4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     758.379us         0.00%     758.379us       9.480us            80  
                                             aten::item         0.02%      28.825ms         0.09%     160.939ms       9.576us       0.000us         0.00%     722.744us       0.043us         16807  
                              aten::_local_scalar_dense         0.01%      14.855ms         0.08%     132.116ms       7.861us     722.744us         0.00%     722.744us       0.043us         16807  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     706.909us         0.00%     706.909us       6.797us           104  
                                    Cijk_H_PostGSU4_VW2         0.00%       0.000us         0.00%       0.000us       0.000us     688.667us         0.00%     688.667us       8.608us            80  
                                      aten::log_softmax         0.00%       1.302ms         0.00%       6.816ms      28.400us       0.000us         0.00%     674.755us       2.811us           240  
                                     aten::_log_softmax         0.00%       4.242ms         0.00%       5.375ms      22.394us     674.755us         0.00%     674.755us       2.811us           240  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     674.755us         0.00%     674.755us       6.488us           104  
                                   hipDeviceSynchronize         0.00%     587.406us         0.00%     587.406us      17.277us     665.501us         0.00%     665.501us      19.574us            34  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     664.601us         0.00%     664.601us       8.308us            80  
                                             aten::tanh         0.01%      15.835ms         0.02%      29.222ms     107.831us     664.284us         0.00%     664.284us       2.451us           271  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     664.284us         0.00%     664.284us       6.387us           104  
                                      aten::nll_loss_nd         0.00%     867.274us         0.01%      13.268ms      55.285us       0.000us         0.00%     662.965us       2.762us           240  
                                         aten::nll_loss         0.00%     879.610us         0.01%      12.401ms      51.671us       0.000us         0.00%     662.965us       2.762us           240  
                                 aten::nll_loss_forward         0.00%       5.001ms         0.01%      11.521ms      48.006us     662.965us         0.00%     662.965us       2.762us           240  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     662.965us         0.00%     662.965us       6.375us           104  
at::native::(anonymous namespace)::write_num_of_segm...         0.00%       0.000us         0.00%       0.000us       0.000us     653.486us         0.00%     653.486us       2.723us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     604.988us         0.00%     604.988us       5.817us           104  
                                          aten::normal_         1.06%        1.843s         1.06%        1.846s      17.746ms     593.926us         0.00%     593.926us       5.711us           104  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     593.926us         0.00%     593.926us       6.123us            97  
                                           aten::select         0.23%     406.384ms         0.28%     494.325ms       5.050us       0.000us         0.00%     578.692us       0.006us         97887  
                                       aten::as_strided         0.16%     279.113ms         0.16%     279.423ms       0.830us       0.000us         0.00%     567.827us       0.002us        336543  
autograd::engine::evaluate_function: LogSoftmaxBackw...         0.00%     807.001us         0.00%       5.006ms      62.578us       0.000us         0.00%     518.997us       6.487us            80  
                                    LogSoftmaxBackward0         0.00%     917.241us         0.00%       4.199ms      52.490us       0.000us         0.00%     518.997us       6.487us            80  
                       aten::_log_softmax_backward_data         0.00%       1.970ms         0.00%       3.282ms      41.025us     518.997us         0.00%     518.997us       6.487us            80  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     518.997us         0.00%     518.997us       6.487us            80  
                                        aten::ones_like         0.00%     714.284us         0.00%       3.054ms      38.171us       0.000us         0.00%     518.235us       6.478us            80  
                           tex_ts::layernorm_fwd_inf_ts         0.00%       6.704ms         0.01%      12.997ms      81.231us     512.420us         0.00%     512.420us       3.203us           160  
void rocprim::detail::init_lookback_scan_state_kerne...         0.00%       0.000us         0.00%       0.000us       0.000us     506.884us         0.00%     506.884us       3.168us           160  
void at::native::(anonymous namespace)::compute_num_...         0.00%       0.000us         0.00%       0.000us       0.000us     502.916us         0.00%     502.916us       2.095us           240  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     498.742us         0.00%     498.742us       4.750us           105  
Cijk_Ailk_Bljk_HHS_BH_MT16x32x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     496.224us         0.00%     496.224us       6.203us            80  
                                             aten::rsub         0.00%       3.458ms         0.01%      10.351ms     120.362us       0.000us         0.00%     495.779us       5.765us            86  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     495.779us         0.00%     495.779us       6.197us            80  
Cijk_Ailk_Bljk_HHS_BH_MT32x16x64_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     491.583us         0.00%     491.583us       6.145us            80  
void cuComputeGradGammaBeta<float, c10::Half>(float ...         0.00%       0.000us         0.00%       0.000us       0.000us     488.489us         0.00%     488.489us       6.106us            80  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     479.025us         0.00%     479.025us       5.988us            80  
     autograd::engine::evaluate_function: TanhBackward0         0.00%       1.498ms         0.02%      29.623ms     361.261us       0.000us         0.00%     470.045us       5.732us            82  
                                          TanhBackward0         0.00%       2.675ms         0.02%      28.125ms     342.989us       0.000us         0.00%     470.045us       5.732us            82  
                                    aten::tanh_backward         0.00%       3.732ms         0.01%      22.055ms     268.966us     470.045us         0.00%     470.045us       5.732us            82  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     470.045us         0.00%     470.045us       5.876us            80  
                                              aten::log         0.00%       4.003ms         0.01%      10.373ms      43.220us     428.024us         0.00%     428.024us       1.783us           240  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     428.024us         0.00%     428.024us       4.116us           104  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     400.444us         0.00%     400.444us       4.260us            94  
void rocprim::detail::single_scan_kernel<true, rocpr...         0.00%       0.000us         0.00%       0.000us       0.000us     291.712us         0.00%     291.712us       3.646us            80  
    compile_fx.<locals>.fw_compiler_base (dynamo_timed)         0.01%      17.998ms         1.27%        2.222s     222.173ms       0.000us         0.00%     277.327us      27.733us            10  
                        compile_fx_inner (dynamo_timed)         0.05%      85.030ms         1.48%        2.574s     234.041ms       0.000us         0.00%     277.327us      25.212us            11  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     264.694us         0.00%     264.694us       4.564us            58  
                                          aten::reshape         0.07%     122.769ms         0.13%     221.288ms       5.122us       0.000us         0.00%     241.516us       0.006us         43206  
         GraphLowering.compile_to_module (dynamo_timed)         0.71%        1.232s         1.27%        2.215s     201.390ms       0.000us         0.00%     239.220us      21.747us            11  
                                             aten::view         0.21%     357.499ms         0.21%     365.202ms       2.525us       0.000us         0.00%     235.503us       0.002us        144633  
                            hipGetDevicePropertiesR0000         0.00%      60.017us         0.00%      60.017us       6.002us     166.973us         0.00%     166.973us      16.697us            10  
                                   hipFuncGetAttributes         0.16%     282.727ms         0.16%     282.727ms       2.142ms     159.407us         0.00%     159.407us       1.208us           132  
                                             aten::rand         0.00%       4.123ms         0.00%       7.890ms     563.551us       0.000us         0.00%     154.687us      11.049us            14  
                                         aten::uniform_         0.01%      12.244ms         0.01%      14.490ms       1.115ms     154.687us         0.00%     154.687us      11.899us            13  
void at::native::(anonymous namespace)::distribution...         0.00%       0.000us         0.00%       0.000us       0.000us     154.687us         0.00%     154.687us      30.937us             5  
                                              hipMemcpy         0.01%      15.491ms         0.01%      15.491ms     322.720us     112.799us         0.00%     112.799us       2.350us            48  
                       Scheduler.codegen (dynamo_timed)         0.08%     143.739ms         0.08%     143.767ms      13.070ms       0.000us         0.00%     105.813us       9.619us            11  
                                          hipHostMalloc         0.08%     138.588ms         0.08%     138.588ms       4.200ms      91.872us         0.00%      91.872us       2.784us            33  
                                    hipFuncSetAttribute         0.00%       9.175us         0.00%       9.175us       0.382us      86.240us         0.00%      86.240us       3.593us            24  
                                       aten::reciprocal         0.00%     164.924us         0.01%      17.644ms       1.764ms      82.271us         0.00%      82.271us       8.227us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      82.271us         0.00%      82.271us       8.227us            10  
                                         _SplitAlongDim         0.10%     168.241ms         0.14%     241.691ms      41.960us       0.000us         0.00%      78.178us       0.014us          5760  
                                    hipModuleLoadDataEx         0.38%     661.295ms         0.38%     661.295ms      50.869ms      61.381us         0.00%      61.381us       4.722us            13  
                                          aten::maximum         0.00%     132.774us         0.01%      22.624ms       2.514ms      59.014us         0.00%      59.014us       6.557us             9  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      59.014us         0.00%      59.014us       6.557us             9  
                                       aten::lift_fresh         0.03%      54.369ms         0.03%      60.619ms      34.326us       0.000us         0.00%      52.961us       0.030us          1766  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      40.975us         0.00%      40.975us       4.097us            10  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      30.228us         0.00%      30.228us       3.023us            10  
                               TorchDynamo Cache Lookup         0.13%     221.956ms         0.13%     221.993ms      11.549us       0.000us         0.00%      25.979us       0.001us         19221  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      14.152us         0.00%      14.152us       4.717us             3  
                                              aten::min         0.00%     133.076us         0.00%       5.597ms       1.119ms      13.511us         0.00%      13.511us       2.702us             5  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      13.511us         0.00%      13.511us       4.504us             3  
                                       aten::empty_like         0.12%     216.285ms         0.36%     629.113ms       7.074us       0.000us         0.00%       7.698us       0.000us         88930  
                                       aten::is_nonzero         0.00%       7.492ms         0.01%      18.138ms       4.446us       0.000us         0.00%       6.254us       0.002us          4080  
                                    aten::empty_strided         0.22%     386.041ms         0.23%     393.823ms       4.441us       0.000us         0.00%       5.252us       0.000us         88687  
                                    hipFuncGetAttribute         0.00%       7.485us         0.00%       7.485us       0.624us       5.172us         0.00%       5.172us       0.431us            12  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.325us         0.00%       2.325us       2.325us             1  
         _compile.<locals>.compile_inner (dynamo_timed)         0.00%       0.000us         0.00%       0.000us       0.000us       1.965us         0.00%       1.965us       1.965us             1  
                                        aten::transpose         0.17%     303.447ms         0.22%     376.019ms       3.946us       0.000us         0.00%       1.844us       0.000us         95285  
                                            aten::empty         0.58%        1.009s         0.58%        1.015s       3.865us       0.000us         0.00%       0.000us       0.000us        262555  
                        hipDeviceGetStreamPriorityRange         0.00%       3.091us         0.00%       3.091us       3.091us       0.000us         0.00%       0.000us       0.000us             1  
                            hipStreamCreateWithPriority         0.00%     685.853us         0.00%     685.853us     114.309us       0.000us         0.00%       0.000us       0.000us             6  
                                        nccl:all_reduce         0.00%       0.000us             0        1.256s      74.540us       0.000us         0.00%       0.000us       0.000us         16849  
                             hipStreamGetCaptureInfo_v2         0.01%      16.381ms         0.01%      16.381ms       1.677us       0.000us         0.00%       0.000us       0.000us          9770  
                                           aten::detach         0.04%      77.775ms         0.14%     235.585ms       6.626us       0.000us         0.00%       0.000us       0.000us         35556  
                                                 detach         0.07%     124.176ms         0.09%     150.221ms       4.431us       0.000us         0.00%       0.000us       0.000us         33905  
                            prims::convert_element_type         0.01%      14.052ms         0.01%      25.282ms     203.891us       0.000us         0.00%       0.000us       0.000us           124  
                                           aten::expand         0.04%      76.473ms         0.06%     102.342ms       2.825us       0.000us         0.00%       0.000us       0.000us         36229  
                                prims::broadcast_in_dim         0.00%     325.359us         0.00%     430.261us      53.783us       0.000us         0.00%       0.000us       0.000us             8  
                                             prims::add         0.00%       1.416ms         0.00%       2.026ms     106.636us       0.000us         0.00%       0.000us       0.000us            19  
                                   aten::empty_permuted         0.00%     608.484us         0.00%       1.234ms      29.371us       0.000us         0.00%       0.000us       0.000us            42  
                                             prims::mul         0.00%     909.716us         0.00%       1.278ms      91.303us       0.000us         0.00%       0.000us       0.000us            14  
                                            prims::tanh         0.00%     149.114us         0.00%     198.217us      99.109us       0.000us         0.00%       0.000us       0.000us             2  
                                            aten::alias         0.00%       4.848ms         0.01%      10.019ms     263.670us       0.000us         0.00%       0.000us       0.000us            38  
                                         prims::view_of         0.00%     693.137us         0.00%     884.035us      36.835us       0.000us         0.00%       0.000us       0.000us            24  
                                             aten::set_         0.00%       6.692ms         0.00%       6.830ms       7.122us       0.000us         0.00%       0.000us       0.000us           959  
                                          aten::detach_         0.00%       7.922ms         0.01%       9.102ms      11.279us       0.000us         0.00%       0.000us       0.000us           807  
                                                detach_         0.00%       1.181ms         0.00%       1.181ms       1.463us       0.000us         0.00%       0.000us       0.000us           807  
                               aten::sym_storage_offset         0.00%     443.490us         0.00%     443.490us      14.306us       0.000us         0.00%       0.000us       0.000us            31  
                                        aten::sym_numel         0.00%     137.808us         0.00%     137.808us      12.528us       0.000us         0.00%       0.000us       0.000us            11  
      autograd::engine::evaluate_function: AddBackward0         0.01%      13.746ms         0.02%      29.128ms     113.780us       0.000us         0.00%       0.000us       0.000us           256  
                                           AddBackward0         0.00%     742.091us         0.00%     742.091us       2.899us       0.000us         0.00%       0.000us       0.000us           256  
                                             prims::sub         0.00%     258.872us         0.00%     347.878us     115.959us       0.000us         0.00%       0.000us       0.000us             3  
                                    aten::conj_physical         0.00%     143.344us         0.00%     143.344us      71.672us       0.000us         0.00%       0.000us       0.000us             2  
                                             prims::sum         0.00%     174.245us         0.00%     187.301us      93.650us       0.000us         0.00%       0.000us       0.000us             2  
autograd::engine::evaluate_function: torch::autograd...         0.00%      40.274us         0.00%      40.274us       2.877us       0.000us         0.00%       0.000us       0.000us            14  
                                         aten::randperm         0.00%       1.566ms         0.00%       3.028ms     605.553us       0.000us         0.00%       0.000us       0.000us             5  
                                        aten::index_add         0.00%     348.048us         0.00%       2.577ms       2.577ms       0.000us         0.00%       0.000us       0.000us             1  
                                        aten::new_empty         0.00%     621.009us         0.00%     702.193us     351.097us       0.000us         0.00%       0.000us       0.000us             2  
                       mkldnn::_is_mkldnn_acl_supported         0.00%     315.064us         0.00%     315.064us     315.064us       0.000us         0.00%       0.000us       0.000us             1  
                       GraphLowering.run (dynamo_timed)         0.12%     216.176ms         0.13%     219.193ms      19.927ms       0.000us         0.00%       0.000us       0.000us            11  
                      Scheduler.__init__ (dynamo_timed)         0.10%     182.621ms         0.10%     182.661ms      16.606ms       0.000us         0.00%       0.000us       0.000us            11  
                 WrapperCodeGen.generate (dynamo_timed)         0.01%       9.540ms         0.01%       9.540ms     867.269us       0.000us         0.00%       0.000us       0.000us            11  
                                 hipPointerGetAttribute         0.03%      54.877ms         0.03%      54.877ms       0.883us       0.000us         0.00%       0.000us       0.000us         62150  
                                        aten::expand_as         0.00%       1.140ms         0.00%       4.023ms       7.410us       0.000us         0.00%       0.000us       0.000us           543  
                                        aten::rand_like         0.00%       2.047ms         0.00%       8.435ms     766.815us       0.000us         0.00%       0.000us       0.000us            11  
                                         prims::uniform         0.00%     167.699us         0.00%     188.791us      94.396us       0.000us         0.00%       0.000us       0.000us             2  
                      aten::_debug_has_internal_overlap         0.00%     178.984us         0.00%     178.984us      89.492us       0.000us         0.00%       0.000us       0.000us             2  
                                              prims::gt         0.00%      98.611us         0.00%     123.295us     123.295us       0.000us         0.00%       0.000us       0.000us             1  
                                          aten::type_as         0.00%     415.746us         0.00%       5.436ms       1.812ms       0.000us         0.00%       0.000us       0.000us             3  
                                           prims::clone         0.00%     301.016us         0.00%     341.375us     113.792us       0.000us         0.00%       0.000us       0.000us             3  
                                   prims::inductor_seed         0.00%       1.376ms         0.00%       4.857ms     809.521us       0.000us         0.00%       0.000us       0.000us             6  
                                 prims::inductor_random         0.00%       1.076ms         0.00%       5.430ms     603.323us       0.000us         0.00%       0.000us       0.000us             9  
     GeneratedBackwardFor_prims_inductor_random_default         0.00%       1.506ms         0.00%       3.575ms     595.798us       0.000us         0.00%       0.000us       0.000us             6  
                                  prims::inductor_seeds         0.00%     427.451us         0.00%       1.139ms     379.722us       0.000us         0.00%       0.000us       0.000us             3  
                            prims::inductor_lookup_seed         0.00%     278.313us         0.00%       1.486ms     495.218us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_inductor_lookup_seed_defa...         0.00%     604.399us         0.00%       1.207ms     402.447us       0.000us         0.00%       0.000us       0.000us             3  
GeneratedBackwardFor_prims_convert_element_type_defa...         0.00%     422.618us         0.00%     445.962us     111.490us       0.000us         0.00%       0.000us       0.000us             4  
                                          aten::resize_         0.07%     127.192ms         0.07%     127.514ms       3.680us       0.000us         0.00%       0.000us       0.000us         34655  
                                               aten::eq         0.03%      45.634ms         0.03%      45.636ms       7.792us       0.000us         0.00%       0.000us       0.000us          5857  
                                              aten::all         0.05%      89.969ms         0.06%     102.489ms      17.499us       0.000us         0.00%       0.000us       0.000us          5857  
                aten::_has_compatible_shallow_copy_type         0.00%       4.309ms         0.00%       4.309ms       0.176us       0.000us         0.00%       0.000us       0.000us         24488  
                                  nccl:_all_gather_base         0.00%       0.000us             0     950.958us      67.926us       0.000us         0.00%       0.000us       0.000us            14  
                                                aten::t         0.00%       6.157ms         0.01%      14.349ms       6.392us       0.000us         0.00%       0.000us       0.000us          2245  
                                         nccl:broadcast         0.00%       0.000us             0      71.898ms     149.476us       0.000us         0.00%       0.000us       0.000us           481  
                                           aten::narrow         0.00%       8.577ms         0.02%      28.407ms      10.760us       0.000us         0.00%       0.000us       0.000us          2640  
                                        aten::unsqueeze         0.02%      34.493ms         0.02%      41.916ms       5.695us       0.000us         0.00%       0.000us       0.000us          7360  
                                          aten::view_as         0.00%       1.569ms         0.00%       3.319ms       4.610us       0.000us         0.00%       0.000us       0.000us           720  
                                          aten::permute         0.02%      40.621ms         0.03%      48.803ms       6.100us       0.000us         0.00%       0.000us       0.000us          8000  
                                           hipDeviceGet         0.00%       2.424us         0.00%       2.424us       0.346us       0.000us         0.00%       0.000us       0.000us             7  
                              hipDevicePrimaryCtxRetain         0.00%       3.316us         0.00%       3.316us       0.474us       0.000us         0.00%       0.000us       0.000us             7  
                             hipDevicePrimaryCtxRelease         0.00%       1.716us         0.00%       1.716us       0.245us       0.000us         0.00%       0.000us       0.000us             7  
           hipOccupancyMaxActiveBlocksPerMultiprocessor         0.03%      55.118ms         0.03%      55.118ms       3.054us       0.000us         0.00%       0.000us       0.000us         18050  
                                              hipMemset         0.00%      28.292us         0.00%      28.292us      14.146us       0.000us         0.00%       0.000us       0.000us             2  
                                          hipModuleLoad         0.29%     503.762ms         0.29%     503.762ms     167.921ms       0.000us         0.00%       0.000us       0.000us             3  
                                 aten::split_with_sizes         0.03%      55.740ms         0.04%      73.424ms      12.747us       0.000us         0.00%       0.000us       0.000us          5760  
                                   aten::_reshape_alias         0.02%      36.986ms         0.02%      36.986ms       2.408us       0.000us         0.00%       0.000us       0.000us         15360  
                                      hipModuleLoadData         0.30%     527.141ms         0.30%     527.141ms     131.785ms       0.000us         0.00%       0.000us       0.000us             4  
                          torch::autograd::DelayedError         0.00%     761.948us         0.00%       1.751ms     437.752us       0.000us         0.00%       0.000us       0.000us             4  
                                     MakeViewlessTensor         0.00%       7.317ms         0.01%       8.823ms      36.762us       0.000us         0.00%       0.000us       0.000us           240  
                                     aten::_unsafe_view         0.00%     906.877us         0.00%     906.877us       2.834us       0.000us         0.00%       0.000us       0.000us           320  
     autograd::engine::evaluate_function: ViewBackward0         0.03%      44.110ms         0.07%     128.828ms       8.216us       0.000us         0.00%       0.000us       0.000us         15680  
                                          ViewBackward0         0.01%      20.651ms         0.05%      84.718ms       5.403us       0.000us         0.00%       0.000us       0.000us         15680  
      autograd::engine::evaluate_function: SumBackward0         0.00%     474.511us         0.00%       2.940ms      36.745us       0.000us         0.00%       0.000us       0.000us            80  
                                           SumBackward0         0.00%     958.896us         0.00%       2.465ms      30.813us       0.000us         0.00%       0.000us       0.000us            80  
autograd::engine::evaluate_function: TransposeBackwa...         0.04%      61.173ms         0.08%     145.488ms       6.837us       0.000us         0.00%       0.000us       0.000us         21280  
                                     TransposeBackward0         0.01%      21.397ms         0.05%      84.315ms       3.962us       0.000us         0.00%       0.000us       0.000us         21280  
                        torch::autograd::AccumulateGrad         0.03%      44.028ms         0.06%     101.961ms       4.220us       0.000us         0.00%       0.000us       0.000us         24160  
        autograd::engine::evaluate_function: TBackward0         0.00%       1.143ms         0.00%       3.074ms      12.810us       0.000us         0.00%       0.000us       0.000us           240  
                                             TBackward0         0.00%     436.990us         0.00%       1.931ms       8.047us       0.000us         0.00%       0.000us       0.000us           240  
autograd::engine::evaluate_function: MakeViewlessTen...         0.00%     335.051us         0.00%       1.020ms      12.750us       0.000us         0.00%       0.000us       0.000us            80  
                             MakeViewlessTensorBackward         0.00%     684.924us         0.00%     684.924us       8.562us       0.000us         0.00%       0.000us       0.000us            80  
         compile_fx.<locals>.bw_compiler (dynamo_timed)         0.00%       1.000ms         0.21%     371.724ms     371.724ms       0.000us         0.00%       0.000us       0.000us             1  
    autograd::engine::evaluate_function: CloneBackward0         0.01%      20.749ms         0.01%      23.428ms       3.050us       0.000us         0.00%       0.000us       0.000us          7682  
                                         CloneBackward0         0.00%       2.679ms         0.00%       2.679ms       0.349us       0.000us         0.00%       0.000us       0.000us          7682  
autograd::engine::evaluate_function: PermuteBackward...         0.00%       5.763ms         0.01%      21.814ms      10.907us       0.000us         0.00%       0.000us       0.000us          2000  
                                       PermuteBackward0         0.00%       4.480ms         0.01%      16.051ms       8.025us       0.000us         0.00%       0.000us       0.000us          2000  
autograd::engine::evaluate_function: ReshapeAliasBac...         0.00%       5.235ms         0.01%      14.332ms       7.465us       0.000us         0.00%       0.000us       0.000us          1920  
                                  ReshapeAliasBackward0         0.00%       2.379ms         0.01%       9.097ms       4.738us       0.000us         0.00%       0.000us       0.000us          1920  
                                  hipFuncSetCacheConfig         0.00%     420.273us         0.00%     420.273us       0.219us       0.000us         0.00%       0.000us       0.000us          1920  
autograd::engine::evaluate_function: _ReduceFromMode...         0.00%       1.154ms         0.00%       3.104ms      38.795us       0.000us         0.00%       0.000us       0.000us            80  
                 _ReduceFromModelParallelRegionBackward         0.00%       1.950ms         0.00%       1.950ms      24.374us       0.000us         0.00%       0.000us       0.000us            80  
                                aten::new_empty_strided         0.00%       1.770ms         0.00%       2.599ms      32.481us       0.000us         0.00%       0.000us       0.000us            80  
                               nccl:allreduce_coalesced         0.00%       0.000us             0       2.260ms     226.040us       0.000us         0.00%       0.000us       0.000us            10  
                                     aten::resolve_conj         0.00%      12.290us         0.00%      12.290us       0.307us       0.000us         0.00%       0.000us       0.000us            40  
                                      aten::resolve_neg         0.00%       8.997us         0.00%       8.997us       0.225us       0.000us         0.00%       0.000us       0.000us            40  
                                           aten::unbind         0.00%      17.374us         0.00%      36.286us       9.071us       0.000us         0.00%       0.000us       0.000us             4  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 174.312s
Self CUDA time total: 157.832s

[rank6]:[W124 08:40:18.238872789 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank3]:[W124 08:40:19.523531124 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank5]:[W124 08:40:19.560284940 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank0]:[W124 08:40:20.119422519 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank4]:[W124 08:40:20.671801686 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank2]:[W124 08:40:23.129906909 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank1]:[W124 08:40:23.221427534 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank7]:[W124 08:40:46.930990606 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
============================================================================================================
throughput per GPU: 18.73333333333333
elapsed time per iteration: 5978.55
samples_per_sec: 1.3381171019728864
============================================================================================================
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3440: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/opt/conda/envs/py_3.10/lib/python3.10/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
mem usages: nan
